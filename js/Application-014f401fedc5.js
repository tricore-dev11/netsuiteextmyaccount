/*
* json2.js
*    2011-10-19
*
*    Public Domain.
*    NO WARRANTY EXPRESSED OR IMPLIED. USE AT YOUR OWN RISK.
*    See http://www.JSON.org/js.html
*/
var JSON;if(!JSON){JSON={};}(function(){function f(n){return n<10?"0"+n:n;}if(typeof Date.prototype.toJSON!=="function"){Date.prototype.toJSON=function(key){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+f(this.getUTCMonth()+1)+"-"+f(this.getUTCDate())+"T"+f(this.getUTCHours())+":"+f(this.getUTCMinutes())+":"+f(this.getUTCSeconds())+"Z":null;};String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(key){return this.valueOf();};}var cx=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,escapable=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,gap,indent,meta={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},rep;function quote(string){escapable.lastIndex=0;return escapable.test(string)?'"'+string.replace(escapable,function(a){var c=meta[a];return typeof c==="string"?c:"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4);})+'"':'"'+string+'"';}function str(key,holder){var i,k,v,length,mind=gap,partial,value=holder[key];if(value&&typeof value==="object"&&typeof value.toJSON==="function"){value=value.toJSON(key);}if(typeof rep==="function"){value=rep.call(holder,key,value);}switch(typeof value){case"string":return quote(value);case"number":return isFinite(value)?String(value):"null";case"boolean":case"null":return String(value);case"object":if(!value){return"null";}gap+=indent;partial=[];if(Object.prototype.toString.apply(value)==="[object Array]"){length=value.length;for(i=0;i<length;i+=1){partial[i]=str(i,value)||"null";}v=partial.length===0?"[]":gap?"[\n"+gap+partial.join(",\n"+gap)+"\n"+mind+"]":"["+partial.join(",")+"]";gap=mind;return v;}if(rep&&typeof rep==="object"){length=rep.length;for(i=0;i<length;i+=1){if(typeof rep[i]==="string"){k=rep[i];v=str(k,value);if(v){partial.push(quote(k)+(gap?": ":":")+v);}}}}else{for(k in value){if(Object.prototype.hasOwnProperty.call(value,k)){v=str(k,value);if(v){partial.push(quote(k)+(gap?": ":":")+v);}}}}v=partial.length===0?"{}":gap?"{\n"+gap+partial.join(",\n"+gap)+"\n"+mind+"}":"{"+partial.join(",")+"}";gap=mind;return v;}}if(typeof JSON.stringify!=="function"){JSON.stringify=function(value,replacer,space){var i;gap="";indent="";if(typeof space==="number"){for(i=0;i<space;i+=1){indent+=" ";}}else{if(typeof space==="string"){indent=space;}}rep=replacer;if(replacer&&typeof replacer!=="function"&&(typeof replacer!=="object"||typeof replacer.length!=="number")){throw new Error("JSON.stringify");}return str("",{"":value});};}if(typeof JSON.parse!=="function"){JSON.parse=function(text,reviver){var j;function walk(holder,key){var k,v,value=holder[key];if(value&&typeof value==="object"){for(k in value){if(Object.prototype.hasOwnProperty.call(value,k)){v=walk(value,k);if(v!==undefined){value[k]=v;}else{delete value[k];}}}}return reviver.call(holder,key,value);}text=String(text);cx.lastIndex=0;if(cx.test(text)){text=text.replace(cx,function(a){return"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4);});}if(/^[\],:{}\s]*$/.test(text.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,""))){j=eval("("+text+")");return typeof reviver==="function"?walk({"":j},""):j;}throw new SyntaxError("JSON.parse");};}}());(function(){if(typeof window.console==="undefined"){window.console={};}var b=0,c=function(){},a=["assert","error","clear","count","debug","dir","dirxml","exception","group","groupCollapsed","groupEnd","info","log","profile","profileEnd","table","time","timeEnd","trace","warn"];for(;b<a.length;b++){if(!window.console[a[b]]){window.console[a[b]]=c;}}if(typeof window.console.memory==="undefined"){window.console.memory={};}})();function loadScript(b){var a;if(b.url){a='<script src="'+b.url+'"><\/script>';}else{a="<script>"+b.code+"<\/script>";}if(b.seo_remove){document.write(a);}else{document.write("</div>"+a+'<div class="seo-remove">');}}
/* bignumber.js v1.4.1 https://github.com/MikeMcl/bignumber.js/LICENCE */
(function(r){var y=1000000000,j=1000000,o=20,x=4,d=-7,k=21,b=-y,e=y,l=true,p=parseInt,g=a.prototype,m="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ$_",f,q=0,s=/^-?(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i,t=String.prototype.trim||function(){return this.replace(/^\s+|\s+$/g,"");},w=a(1);function a(B,F){var E,D,C,A,z,H,G=this;if(!(G instanceof a)){return new a(B,F);}if(B instanceof a){q=0;if(F!==E){B+="";}else{G.s=B.s;G.e=B.e;G.c=(B=B.c)?B.slice():B;return;}}if(typeof B!="string"){B=(C=typeof B=="number"||Object.prototype.toString.call(B)=="[object Number]")&&B===0&&1/B<0?"-0":B+"";}H=B;if(F===E&&s.test(B)){G.s=B.charAt(0)=="-"?(B=B.slice(1),-1):1;}else{if(F==10){return u(B,o,x);}B=t.call(B).replace(/^\+(?!-)/,"");G.s=B.charAt(0)=="-"?(B=B.replace(/^-(?!-)/,""),-1):1;if(F!=null){if((F==(F|0)||!l)&&!(f=!(F>=2&&F<65))){A="["+m.slice(0,F=F|0)+"]+";B=B.replace(/\.$/,"").replace(/^\./,"0.");if(z=new RegExp("^"+A+"(?:\\."+A+")?$",F<37?"i":"").test(B)){if(C){if(B.replace(/^0\.0*|\./,"").length>15){c(H,0);}C=!C;}B=i(B,10,F,G.s);}else{if(B!="Infinity"&&B!="NaN"){c(H,1,F);B="NaN";}}}else{c(F,2);z=s.test(B);}}else{z=s.test(B);}if(!z){G.c=G.e=null;if(B!="Infinity"){if(B!="NaN"){c(H,3);}G.s=null;}q=0;return;}}if((E=B.indexOf("."))>-1){B=B.replace(".","");}if((D=B.search(/e/i))>0){if(E<0){E=D;}E+=+B.slice(D+1);B=B.substring(0,D);}else{if(E<0){E=B.length;}}for(D=0;B.charAt(D)=="0";D++){}F=B.length;if(C&&F>15&&B.slice(D).length>15){c(H,0);}q=0;if((E-=D+1)>e){G.c=G.e=null;}else{if(D==F||E<b){G.c=[G.e=0];}else{for(;B.charAt(--F)=="0";){}G.e=E;G.c=[];for(E=0;D<=F;G.c[E++]=+B.charAt(D++)){}}}}a.ROUND_UP=0;a.ROUND_DOWN=1;a.ROUND_CEIL=2;a.ROUND_FLOOR=3;a.ROUND_HALF_UP=4;a.ROUND_HALF_DOWN=5;a.ROUND_HALF_EVEN=6;a.ROUND_HALF_CEIL=7;a.ROUND_HALF_FLOOR=8;a.config=function(){var H,A,C=0,z={},E=arguments,B=E[0],D="config",G=function(K,J,I){return !((f=K<J||K>I)||p(K)!=K&&K!==0);},F=B&&typeof B=="object"?function(){if(B.hasOwnProperty(A)){return(H=B[A])!=null;}}:function(){if(E.length>C){return(H=E[C++])!=null;}};if(F(A="DECIMAL_PLACES")){if(G(H,0,y)){o=H|0;}else{c(H,A,D);}}z[A]=o;if(F(A="ROUNDING_MODE")){if(G(H,0,8)){x=H|0;}else{c(H,A,D);}}z[A]=x;if(F(A="EXPONENTIAL_AT")){if(G(H,-y,y)){d=-(k=~~(H<0?-H:+H));}else{if(!f&&H&&G(H[0],-y,0)&&G(H[1],0,y)){d=~~H[0];k=~~H[1];}else{c(H,A,D,1);}}}z[A]=[d,k];if(F(A="RANGE")){if(G(H,-y,y)&&~~H){b=-(e=~~(H<0?-H:+H));}else{if(!f&&H&&G(H[0],-y,-1)&&G(H[1],1,y)){b=~~H[0],e=~~H[1];}else{c(H,A,D,1,1);}}}z[A]=[b,e];if(F(A="ERRORS")){if(H===!!H||H===1||H===0){p=(f=q=0,l=!!H)?parseInt:parseFloat;}else{c(H,A,D,0,0,1);}}z[A]=l;return z;};function c(G,D,B,E,A,C){if(l){var F,z=["new BigNumber","cmp","div","eq","gt","gte","lt","lte","minus","mod","plus","times","toFr"][q?q<0?-q:q:1/q<0?1:0]+"()",H=f?" out of range":" not a"+(A?" non-zero":"n")+" integer";H=([z+" number type has more than 15 significant digits",z+" not a base "+B+" number",z+" base"+H,z+" not a number"][D]||B+"() "+D+(C?" not a boolean or binary digit":H+(E?" or not ["+(f?" negative, positive":" integer, integer")+" ]":"")))+": "+G;f=q=0;F=new Error(H);F.name="BigNumber Error";throw F;}}function i(z,K,E,A){var G,H,C,I,F,B;function D(R,P){var N,O=0,M=R.length,Q,L=[0];for(P=P||E;O<M;O++){for(Q=L.length,N=0;N<Q;L[N]*=P,N++){}for(L[0]+=m.indexOf(R.charAt(O)),N=0;N<L.length;N++){if(L[N]>K-1){if(L[N+1]==null){L[N+1]=0;}L[N+1]+=L[N]/K^0;L[N]%=K;}}}return L.reverse();}function J(L){var M=0,O=L.length,N="";for(;M<O;N+=m.charAt(L[M++])){}return N;}if(E<37){z=z.toLowerCase();}if((G=z.indexOf("."))>-1){G=z.length-G-1;H=D(new a(E)["pow"](G)["toF"](),10);I=z.split(".");C=D(I[1]);I=D(I[0]);B=n(C,H,C.length-H.length,A,K,I[I.length-1]&1);F=B.c;if(G=B.e){for(;++G;F.unshift(0)){}z=J(I)+"."+J(F);}else{if(F[0]){if(I[G=I.length-1]<K-1){++I[G];z=J(I);}else{z=new a(J(I),K)["plus"](w)["toS"](K);}}else{z=J(I);}}}else{z=J(D(z));}return z;}function n(G,z,E,M,C,L){var Q,K,O,J,I,H=z.slice(),P=Q=z.length,N=G.length,A=G.slice(0,Q),D=A.length,S=new a(w),F=S.c=[],B=0,R=o+(S.e=E)+1;S.s=M;M=R<0?0:R;for(;D++<Q;A.push(0)){}H.unshift(0);do{for(O=0;O<C;O++){if(Q!=(D=A.length)){J=Q>D?1:-1;}else{for(I=-1,J=0;++I<Q;){if(z[I]!=A[I]){J=z[I]>A[I]?1:-1;break;}}}if(J<0){for(K=D==Q?z:H;D;){if(A[--D]<K[D]){for(I=D;I&&!A[--I];A[I]=C-1){}--A[I];A[D]+=C;}A[D]-=K[D];}for(;!A[0];A.shift()){}}else{break;}}F[B++]=J?O:++O;A[0]&&J?(A[D]=G[P]||0):(A=[G[P]]);}while((P++<N||A[0]!=null)&&M--);if(!F[0]&&B!=1){--S.e;F.shift();}if(B>R){h(S,o,C,L,A[0]!=null);}if(S.e>e){S.c=S.e=null;}else{if(S.e<b){S.c=[S.e=0];}}return S;}function v(D,B,A){var z=B-(D=new a(D))["e"],C=D.c;if(!C){return D.toS();}if(C.length>++B){h(D,z,10);}z=C[0]==0?z+1:A?B:D.e+z+1;for(;C.length<z;C.push(0)){}z=D.e;return A==1||A==2&&(--B<z||z<=d)?(D.s<0&&C[0]?"-":"")+(C.length>1?(C.splice(1,0,"."),C.join("")):C[0])+(z<0?"e":"e+")+z:D.toS();}function h(G,C,A,H,z){var I=G.c,B=G.s<0,J=A/2,D=G.e+C+1,E=I[D],F=z||D<0||I[D+1]!=null;z=x<4?(E!=null||F)&&(x==0||x==2&&!B||x==3&&B):E>J||E==J&&(x==4||F||x==6&&(I[D-1]&1||!C&&H)||x==7&&!B||x==8&&B);if(D<1||!I[0]){I.length=0;I.push(0);if(z){I[0]=1;G.e=-C;}else{G.e=0;}return G;}I.length=D--;if(z){for(--A;++I[D]>A;){I[D]=0;if(!D--){++G.e;I.unshift(1);}}}for(D=I.length;!I[--D];I.pop()){}return G;}function u(z,C,B){var A=x;x=B;z=new a(z);z.c&&h(z,C,10);x=A;return z;}g.abs=g.absoluteValue=function(){var z=new a(this);if(z.s<0){z.s=1;}return z;};g.ceil=function(){return u(this,0,2);};g.comparedTo=g.cmp=function(E,F){var G,H=this,I=H.c,D=(q=-q,E=new a(E,F))["c"],C=H.s,B=E.s,A=H.e,z=E.e;if(!C||!B){return null;}G=I&&!I[0],F=D&&!D[0];if(G||F){return G?F?0:-B:C;}if(C!=B){return C;}if(G=C<0,F=A==z,!I||!D){return F?0:!I^G?1:-1;}if(!F){return A>z^G?1:-1;}for(C=-1,B=(A=I.length)<(z=D.length)?A:z;++C<B;){if(I[C]!=D[C]){return I[C]>D[C]^G?1:-1;}}return A==z?0:A>z^G?1:-1;};g.dividedBy=g.div=function(C,D){var G=this["c"],E=this["e"],z=this["s"],B=(q=2,C=new a(C,D))["c"],A=C.e,F=C.s,H=z==F?1:-1;return !E&&(!G||!G[0])||!A&&(!B||!B[0])?new a(!z||!F||(G?B&&G[0]==B[0]:!B)?NaN:G&&G[0]==0||!B?H*0:H/0):n(G,B,E-A,H,10);};g.equals=g.eq=function(A,z){q=3;return this["cmp"](A,z)===0;};g.floor=function(){return u(this,0,3);};g.greaterThan=g.gt=function(A,z){q=4;return this["cmp"](A,z)>0;};g.greaterThanOrEqualTo=g.gte=function(A,z){q=5;return(z=this["cmp"](A,z))==1||z===0;};g.isFinite=g.isF=function(){return !!this["c"];};g.isNaN=function(){return !this["s"];};g.isNegative=g.isNeg=function(){return this["s"]<0;};g.isZero=g.isZ=function(){return !!this["c"]&&this["c"][0]==0;};g.lessThan=g.lt=function(A,z){q=6;return this["cmp"](A,z)<0;};g.lessThanOrEqualTo=g.lte=function(A,z){q=7;return(z=this["cmp"](A,z))==-1||z===0;};g.minus=function(E,G){var D,A,z,F,I=this,H=I.s;G=(q=8,E=new a(E,G))["s"];if(!H||!G){return new a(NaN);}if(H!=G){return E.s=-G,I.plus(E);}var K=I.c,J=I.e,C=E.c,B=E.e;if(!J||!B){if(!K||!C){return K?(E.s=-G,E):new a(C?I:NaN);}if(!K[0]||!C[0]){return C[0]?(E.s=-G,E):new a(K[0]?I:x==3?-0:0);}}if(K=K.slice(),H=J-B){D=(F=H<0)?(H=-H,K):(B=J,C);for(D.reverse(),G=H;G--;D.push(0)){}D.reverse();}else{z=((F=K.length<C.length)?K:C).length;for(H=G=0;G<z;G++){if(K[G]!=C[G]){F=K[G]<C[G];break;}}}if(F){D=K,K=C,C=D;E.s=-E.s;}if((G=-((z=K.length)-C.length))>0){for(;G--;K[z++]=0){}}for(G=C.length;G>H;){if(K[--G]<C[G]){for(A=G;A&&!K[--A];K[A]=9){}--K[A];K[G]+=10;}K[G]-=C[G];}for(;K[--z]==0;K.pop()){}for(;K[0]==0;K.shift(),--B){}if(B<b||!K[0]){if(!K[0]){E.s=x==3?-1:1;}K=[B=0];}return E.c=K,E.e=B,E;};g.modulo=g.mod=function(F,A){var z=this,D=z.c,E=(q=9,F=new a(F,A))["c"],C=z.s,B=F.s;A=!C||!B||E&&!E[0];if(A||D&&!D[0]){return new a(A?NaN:z);}z.s=F.s=1;A=F.cmp(z)==1;z.s=C,F.s=B;return A?new a(z):(C=o,B=x,o=0,x=1,z=z.div(F),o=C,x=B,this["minus"](z.times(F)));};g.negated=g.neg=function(){var z=new a(this);return z.s=-z.s||null,z;};g.plus=function(C,D){var B,F=this,E=F.s;D=(q=10,C=new a(C,D))["s"];if(!E||!D){return new a(NaN);}if(E!=D){return C.s=-D,F.minus(C);}var G=F.e,H=F.c,z=C.e,A=C.c;if(!G||!z){if(!H||!A){return new a(E/0);}if(!H[0]||!A[0]){return A[0]?C:new a(H[0]?F:E*0);}}if(H=H.slice(),E=G-z){B=E>0?(z=G,A):(E=-E,H);for(B.reverse();E--;B.push(0)){}B.reverse();}if(H.length-A.length<0){B=A,A=H,H=B;}for(E=A.length,D=0;E;D=(H[--E]=H[E]+A[E]+D)/10^0,H[E]%=10){}if(D){H.unshift(D);if(++z>e){H=z=null;}}for(E=H.length;H[--E]==0;H.pop()){}return C.c=H,C.e=z,C;};g.toPower=g.pow=function(B){var A=B*0==0?B|0:B,z=new a(this),C=new a(w);if((((f=B<-j||B>j)&&(A=B*1/0))||p(B)!=B&&B!==0&&!(A=NaN))&&!c(B,"exponent","pow")||!A){return new a(Math.pow(z.toS(),A));}for(A=A<0?-A:A;;){if(A&1){C=C.times(z);}A>>=1;if(!A){break;}z=z.times(z);}return B<0?w.div(C):C;};g.round=function(A,z){A=A==null||(((f=A<0||A>y)||p(A)!=A)&&!c(A,"decimal places","round"))?0:A|0;z=z==null||(((f=z<0||z>8)||p(z)!=z&&z!==0)&&!c(z,"mode","round"))?x:z|0;return u(this,A,z);};g.squareRoot=g.sqrt=function(){var A,z,H,I,F=this,E=F.c,J=F.s,D=F.e,B=o,C=x,G=new a("0.5");if(J!==1||!E||!E[0]){return new a(!J||J<0&&(!E||E[0])?NaN:E?F:1/0);}J=Math.sqrt(F.toS());x=1;if(J==0||J==1/0){A=E.join("");if(!(A.length+D&1)){A+="0";}z=new a(Math.sqrt(A)+"");if(!z.c){z.c=[1];}z.e=(((D+1)/2)|0)-(D<0||D&1);}else{z=new a(A=J.toString());}H=z.e;J=H+(o+=4);if(J<3){J=0;}D=J;for(;;){I=z;z=G.times(I.plus(F.div(I)));if(I.c.slice(0,J).join("")===z.c.slice(0,J).join("")){E=z.c;J=J-(A&&z.e<H);if(E[J]==9&&E[J-1]==9&&E[J-2]==9&&(E[J-3]==9||A&&E[J-3]==4)){if(A&&E[J-3]==9){I=z.round(B,0);if(I.times(I)["eq"](F)){x=C;o=B;return I;}}o+=4;J+=4;A="";}else{if(!E[D]&&!E[D-1]&&!E[D-2]&&(!E[D-3]||E[D-3]==5)){if(E.length>D-2){E.length=D-2;}if(!z.times(z)["eq"](F)){while(E.length<D-3){E.push(0);}E[D-3]++;}}x=C;h(z,o=B,10);return z;}}}};g.times=function(D,E){var C,G=this,H=G.c,B=(q=11,D=new a(D,E))["c"],A=G.e,z=D.e,F=G.s;D.s=F==(E=D.s)?1:-1;if(!A&&(!H||!H[0])||!z&&(!B||!B[0])){return new a(!F||!E||H&&!H[0]&&!B||B&&!B[0]&&!H?NaN:!H||!B?D.s/0:D.s*0);}D.e=A+z;if((F=H.length)<(E=B.length)){C=H,H=B,B=C,z=F,F=E,E=z;}for(z=F+E,C=[];z--;C.push(0)){}for(A=E-1;A>-1;A--){for(E=0,z=F+A;z>A;E=C[z]+B[A]*H[z-A-1]+E,C[z--]=E%10|0,E=E/10|0){}if(E){C[z]=(C[z]+E)%10;}}E&&++D.e;!C[0]&&C.shift();for(z=C.length;!C[--z];C.pop()){}D.c=D.e>e?(D.e=null):D.e<b?[D.e=0]:C;return D;};g.toExponential=g.toE=function(z){return v(this,(z==null||((f=z<0||z>y)||p(z)!=z&&z!==0)&&!c(z,"decimal places","toE"))&&this["c"]?this["c"].length-1:z|0,1);};g.toFixed=g.toF=function(D){var C,B,A,z=this;if(!(D==null||((f=D<0||D>y)||p(D)!=D&&D!==0)&&!c(D,"decimal places","toF"))){A=z.e+(D|0);}C=d,D=k;d=-(k=1/0);if(A==B){B=z.toS();}else{B=v(z,A);if(z.s<0&&z.c){if(!z.c[0]){B=B.replace(/^-/,"");}else{if(B.indexOf("-")<0){B="-"+B;}}}}d=C,k=D;return B;};g.toFraction=g.toFr=function(O){var B,D,L,C,z,E,J,I=C=new a(w),A=L=new a("0"),M=this,N=M.c,G=e,F=o,H=x,K=new a(w);if(!N){return M.toS();}J=K.e=N.length-M.e-1;if(O==null||(!(q=12,E=new a(O))["s"]||(f=E.cmp(I)<0||!E.c)||(l&&E.e<E.c.length-1))&&!c(O,"max denominator","toFr")||(O=E)["cmp"](K)>0){O=J>0?K:I;}e=1/0;E=new a(N.join(""));for(o=0,x=1;;){B=E.div(K);z=C.plus(B.times(A));if(z.cmp(O)==1){break;}C=A,A=z;I=L.plus(B.times(z=I));L=z;K=E.minus(B.times(z=K));E=z;}z=O.minus(C)["div"](A);L=L.plus(z.times(I));C=C.plus(z.times(A));L.s=I.s=M.s;o=J*2;x=H;D=I.div(A)["minus"](M)["abs"]()["cmp"](L.div(C)["minus"](M)["abs"]())<1?[I.toS(),A.toS()]:[L.toS(),C.toS()];return e=G,o=F,D;};g.toPrecision=g.toP=function(z){return z==null||(((f=z<1||z>y)||p(z)!=z)&&!c(z,"precision","toP"))?this["toS"]():v(this,--z|0,2);};g.toString=g.toS=function(A){var C,E,B,z=this,D=z.e;if(D===null){E=z.s?"Infinity":"NaN";}else{if(A===C&&(D<=d||D>=k)){return v(z,z.c.length-1,1);}else{E=z.c.join("");if(D<0){for(;++D;E="0"+E){}E="0."+E;}else{if(B=E.length,D>0){if(++D>B){for(D-=B;D--;E+="0"){}}else{if(D<B){E=E.slice(0,D)+"."+E.slice(D);}}}else{if(C=E.charAt(0),B>1){E=C+"."+E.slice(1);}else{if(C=="0"){return C;}}}}if(A!=null){if(!(f=!(A>=2&&A<65))&&(A==(A|0)||!l)){E=i(E,A|0,10,z.s);if(E=="0"){return E;}}else{c(A,"base","toS");}}}}return z.s<0?"-"+E:E;};g.toNumber=g.toN=function(){var z=this;return +z||(z.s?0*z.s:NaN);};g.valueOf=function(){return this["toS"]();};if(typeof module!=="undefined"&&module.exports){module.exports=a;}else{if(typeof define=="function"&&define.amd){define(function(){return a;});}else{r.BigNumber=a;}}})(this);
/* vim: et:ts=4:sw=4:sts=4
 * @license RequireJS 2.1.8 Copyright (c) 2010-2012, The Dojo Foundation All Rights Reserved.
 * Available via the MIT or new BSD license.
 * see: http://github.com/jrburke/requirejs for details
 */
var requirejs,require,define;(function(global){var req,s,head,baseElement,dataMain,src,interactiveScript,currentlyAddingScript,mainScript,subPath,version="2.1.8",commentRegExp=/(\/\*([\s\S]*?)\*\/|([^:]|^)\/\/(.*)$)/mg,cjsRequireRegExp=/[^.]\s*require\s*\(\s*["']([^'"\s]+)["']\s*\)/g,jsSuffixRegExp=/\.js$/,currDirRegExp=/^\.\//,op=Object.prototype,ostring=op.toString,hasOwn=op.hasOwnProperty,ap=Array.prototype,apsp=ap.splice,isBrowser=!!(typeof window!=="undefined"&&navigator&&window.document),isWebWorker=!isBrowser&&typeof importScripts!=="undefined",readyRegExp=isBrowser&&navigator.platform==="PLAYSTATION 3"?/^complete$/:/^(complete|loaded)$/,defContextName="_",isOpera=typeof opera!=="undefined"&&opera.toString()==="[object Opera]",contexts={},cfg={},globalDefQueue=[],useInteractive=false;function isFunction(it){return ostring.call(it)==="[object Function]";}function isArray(it){return ostring.call(it)==="[object Array]";}function each(ary,func){if(ary){var i;for(i=0;i<ary.length;i+=1){if(ary[i]&&func(ary[i],i,ary)){break;}}}}function eachReverse(ary,func){if(ary){var i;for(i=ary.length-1;i>-1;i-=1){if(ary[i]&&func(ary[i],i,ary)){break;}}}}function hasProp(obj,prop){return hasOwn.call(obj,prop);}function getOwn(obj,prop){return hasProp(obj,prop)&&obj[prop];}function eachProp(obj,func){var prop;for(prop in obj){if(hasProp(obj,prop)){if(func(obj[prop],prop)){break;}}}}function mixin(target,source,force,deepStringMixin){if(source){eachProp(source,function(value,prop){if(force||!hasProp(target,prop)){if(deepStringMixin&&typeof value!=="string"){if(!target[prop]){target[prop]={};}mixin(target[prop],value,force,deepStringMixin);}else{target[prop]=value;}}});}return target;}function bind(obj,fn){return function(){return fn.apply(obj,arguments);};}function scripts(){return document.getElementsByTagName("script");}function defaultOnError(err){throw err;}function getGlobal(value){if(!value){return value;}var g=global;each(value.split("."),function(part){g=g[part];});return g;}function makeError(id,msg,err,requireModules){var e=new Error(msg+"\nhttp://requirejs.org/docs/errors.html#"+id);e.requireType=id;e.requireModules=requireModules;if(err){e.originalError=err;}return e;}if(typeof define!=="undefined"){return;}if(typeof requirejs!=="undefined"){if(isFunction(requirejs)){return;}cfg=requirejs;requirejs=undefined;}if(typeof require!=="undefined"&&!isFunction(require)){cfg=require;require=undefined;}function newContext(contextName){var inCheckLoaded,Module,context,handlers,checkLoadedTimeoutId,config={waitSeconds:7,baseUrl:"./",paths:{},pkgs:{},shim:{},config:{}},registry={},enabledRegistry={},undefEvents={},defQueue=[],defined={},urlFetched={},requireCounter=1,unnormalizedCounter=1;function trimDots(ary){var i,part;for(i=0;ary[i];i+=1){part=ary[i];if(part==="."){ary.splice(i,1);i-=1;}else{if(part===".."){if(i===1&&(ary[2]===".."||ary[0]==="..")){break;}else{if(i>0){ary.splice(i-1,2);i-=2;}}}}}}function normalize(name,baseName,applyMap){var pkgName,pkgConfig,mapValue,nameParts,i,j,nameSegment,foundMap,foundI,foundStarMap,starI,baseParts=baseName&&baseName.split("/"),normalizedBaseParts=baseParts,map=config.map,starMap=map&&map["*"];if(name&&name.charAt(0)==="."){if(baseName){if(getOwn(config.pkgs,baseName)){normalizedBaseParts=baseParts=[baseName];}else{normalizedBaseParts=baseParts.slice(0,baseParts.length-1);}name=normalizedBaseParts.concat(name.split("/"));trimDots(name);pkgConfig=getOwn(config.pkgs,(pkgName=name[0]));name=name.join("/");if(pkgConfig&&name===pkgName+"/"+pkgConfig.main){name=pkgName;}}else{if(name.indexOf("./")===0){name=name.substring(2);}}}if(applyMap&&map&&(baseParts||starMap)){nameParts=name.split("/");for(i=nameParts.length;i>0;i-=1){nameSegment=nameParts.slice(0,i).join("/");if(baseParts){for(j=baseParts.length;j>0;j-=1){mapValue=getOwn(map,baseParts.slice(0,j).join("/"));if(mapValue){mapValue=getOwn(mapValue,nameSegment);if(mapValue){foundMap=mapValue;foundI=i;break;}}}}if(foundMap){break;}if(!foundStarMap&&starMap&&getOwn(starMap,nameSegment)){foundStarMap=getOwn(starMap,nameSegment);starI=i;}}if(!foundMap&&foundStarMap){foundMap=foundStarMap;foundI=starI;}if(foundMap){nameParts.splice(0,foundI,foundMap);name=nameParts.join("/");}}return name;}function removeScript(name){if(isBrowser){each(scripts(),function(scriptNode){if(scriptNode.getAttribute("data-requiremodule")===name&&scriptNode.getAttribute("data-requirecontext")===context.contextName){scriptNode.parentNode.removeChild(scriptNode);return true;}});}}function hasPathFallback(id){var pathConfig=getOwn(config.paths,id);if(pathConfig&&isArray(pathConfig)&&pathConfig.length>1){removeScript(id);pathConfig.shift();context.require.undef(id);context.require([id]);return true;}}function splitPrefix(name){var prefix,index=name?name.indexOf("!"):-1;if(index>-1){prefix=name.substring(0,index);name=name.substring(index+1,name.length);}return[prefix,name];}function makeModuleMap(name,parentModuleMap,isNormalized,applyMap){var url,pluginModule,suffix,nameParts,prefix=null,parentName=parentModuleMap?parentModuleMap.name:null,originalName=name,isDefine=true,normalizedName="";if(!name){isDefine=false;name="_@r"+(requireCounter+=1);}nameParts=splitPrefix(name);prefix=nameParts[0];name=nameParts[1];if(prefix){prefix=normalize(prefix,parentName,applyMap);pluginModule=getOwn(defined,prefix);}if(name){if(prefix){if(pluginModule&&pluginModule.normalize){normalizedName=pluginModule.normalize(name,function(name){return normalize(name,parentName,applyMap);});}else{normalizedName=normalize(name,parentName,applyMap);}}else{normalizedName=normalize(name,parentName,applyMap);nameParts=splitPrefix(normalizedName);prefix=nameParts[0];normalizedName=nameParts[1];isNormalized=true;url=context.nameToUrl(normalizedName);}}suffix=prefix&&!pluginModule&&!isNormalized?"_unnormalized"+(unnormalizedCounter+=1):"";return{prefix:prefix,name:normalizedName,parentMap:parentModuleMap,unnormalized:!!suffix,url:url,originalName:originalName,isDefine:isDefine,id:(prefix?prefix+"!"+normalizedName:normalizedName)+suffix};}function getModule(depMap){var id=depMap.id,mod=getOwn(registry,id);if(!mod){mod=registry[id]=new context.Module(depMap);}return mod;}function on(depMap,name,fn){var id=depMap.id,mod=getOwn(registry,id);if(hasProp(defined,id)&&(!mod||mod.defineEmitComplete)){if(name==="defined"){fn(defined[id]);}}else{mod=getModule(depMap);if(mod.error&&name==="error"){fn(mod.error);}else{mod.on(name,fn);}}}function onError(err,errback){var ids=err.requireModules,notified=false;if(errback){errback(err);}else{each(ids,function(id){var mod=getOwn(registry,id);if(mod){mod.error=err;if(mod.events.error){notified=true;mod.emit("error",err);}}});if(!notified){req.onError(err);}}}function takeGlobalQueue(){if(globalDefQueue.length){apsp.apply(defQueue,[defQueue.length-1,0].concat(globalDefQueue));globalDefQueue=[];}}handlers={require:function(mod){if(mod.require){return mod.require;}else{return(mod.require=context.makeRequire(mod.map));}},exports:function(mod){mod.usingExports=true;if(mod.map.isDefine){if(mod.exports){return mod.exports;}else{return(mod.exports=defined[mod.map.id]={});}}},module:function(mod){if(mod.module){return mod.module;}else{return(mod.module={id:mod.map.id,uri:mod.map.url,config:function(){var c,pkg=getOwn(config.pkgs,mod.map.id);c=pkg?getOwn(config.config,mod.map.id+"/"+pkg.main):getOwn(config.config,mod.map.id);return c||{};},exports:defined[mod.map.id]});}}};function cleanRegistry(id){delete registry[id];delete enabledRegistry[id];}function breakCycle(mod,traced,processed){var id=mod.map.id;if(mod.error){mod.emit("error",mod.error);}else{traced[id]=true;each(mod.depMaps,function(depMap,i){var depId=depMap.id,dep=getOwn(registry,depId);if(dep&&!mod.depMatched[i]&&!processed[depId]){if(getOwn(traced,depId)){mod.defineDep(i,defined[depId]);mod.check();}else{breakCycle(dep,traced,processed);}}});processed[id]=true;}}function checkLoaded(){var map,modId,err,usingPathFallback,waitInterval=config.waitSeconds*1000,expired=waitInterval&&(context.startTime+waitInterval)<new Date().getTime(),noLoads=[],reqCalls=[],stillLoading=false,needCycleCheck=true;if(inCheckLoaded){return;}inCheckLoaded=true;eachProp(enabledRegistry,function(mod){map=mod.map;modId=map.id;if(!mod.enabled){return;}if(!map.isDefine){reqCalls.push(mod);}if(!mod.error){if(!mod.inited&&expired){if(hasPathFallback(modId)){usingPathFallback=true;stillLoading=true;}else{noLoads.push(modId);removeScript(modId);}}else{if(!mod.inited&&mod.fetched&&map.isDefine){stillLoading=true;if(!map.prefix){return(needCycleCheck=false);}}}}});if(expired&&noLoads.length){err=makeError("timeout","Load timeout for modules: "+noLoads,null,noLoads);err.contextName=context.contextName;return onError(err);}if(needCycleCheck){each(reqCalls,function(mod){breakCycle(mod,{},{});});}if((!expired||usingPathFallback)&&stillLoading){if((isBrowser||isWebWorker)&&!checkLoadedTimeoutId){checkLoadedTimeoutId=setTimeout(function(){checkLoadedTimeoutId=0;checkLoaded();},50);}}inCheckLoaded=false;}Module=function(map){this.events=getOwn(undefEvents,map.id)||{};this.map=map;this.shim=getOwn(config.shim,map.id);this.depExports=[];this.depMaps=[];this.depMatched=[];this.pluginMaps={};this.depCount=0;};Module.prototype={init:function(depMaps,factory,errback,options){options=options||{};if(this.inited){return;}this.factory=factory;if(errback){this.on("error",errback);}else{if(this.events.error){errback=bind(this,function(err){this.emit("error",err);});}}this.depMaps=depMaps&&depMaps.slice(0);this.errback=errback;this.inited=true;this.ignore=options.ignore;if(options.enabled||this.enabled){this.enable();}else{this.check();}},defineDep:function(i,depExports){if(!this.depMatched[i]){this.depMatched[i]=true;this.depCount-=1;this.depExports[i]=depExports;}},fetch:function(){if(this.fetched){return;}this.fetched=true;context.startTime=(new Date()).getTime();var map=this.map;if(this.shim){context.makeRequire(this.map,{enableBuildCallback:true})(this.shim.deps||[],bind(this,function(){return map.prefix?this.callPlugin():this.load();}));}else{return map.prefix?this.callPlugin():this.load();}},load:function(){var url=this.map.url;if(!urlFetched[url]){urlFetched[url]=true;context.load(this.map.id,url);}},check:function(){if(!this.enabled||this.enabling){return;}var err,cjsModule,id=this.map.id,depExports=this.depExports,exports=this.exports,factory=this.factory;if(!this.inited){this.fetch();}else{if(this.error){this.emit("error",this.error);}else{if(!this.defining){this.defining=true;if(this.depCount<1&&!this.defined){if(isFunction(factory)){if((this.events.error&&this.map.isDefine)||req.onError!==defaultOnError){try{exports=context.execCb(id,factory,depExports,exports);}catch(e){err=e;}}else{exports=context.execCb(id,factory,depExports,exports);}if(this.map.isDefine){cjsModule=this.module;if(cjsModule&&cjsModule.exports!==undefined&&cjsModule.exports!==this.exports){exports=cjsModule.exports;}else{if(exports===undefined&&this.usingExports){exports=this.exports;}}}if(err){err.requireMap=this.map;err.requireModules=this.map.isDefine?[this.map.id]:null;err.requireType=this.map.isDefine?"define":"require";return onError((this.error=err));}}else{exports=factory;}this.exports=exports;if(this.map.isDefine&&!this.ignore){defined[id]=exports;if(req.onResourceLoad){req.onResourceLoad(context,this.map,this.depMaps);}}cleanRegistry(id);this.defined=true;}this.defining=false;if(this.defined&&!this.defineEmitted){this.defineEmitted=true;this.emit("defined",this.exports);this.defineEmitComplete=true;}}}}},callPlugin:function(){var map=this.map,id=map.id,pluginMap=makeModuleMap(map.prefix);this.depMaps.push(pluginMap);on(pluginMap,"defined",bind(this,function(plugin){var load,normalizedMap,normalizedMod,name=this.map.name,parentName=this.map.parentMap?this.map.parentMap.name:null,localRequire=context.makeRequire(map.parentMap,{enableBuildCallback:true});if(this.map.unnormalized){if(plugin.normalize){name=plugin.normalize(name,function(name){return normalize(name,parentName,true);})||"";}normalizedMap=makeModuleMap(map.prefix+"!"+name,this.map.parentMap);on(normalizedMap,"defined",bind(this,function(value){this.init([],function(){return value;},null,{enabled:true,ignore:true});}));normalizedMod=getOwn(registry,normalizedMap.id);if(normalizedMod){this.depMaps.push(normalizedMap);if(this.events.error){normalizedMod.on("error",bind(this,function(err){this.emit("error",err);}));}normalizedMod.enable();}return;}load=bind(this,function(value){this.init([],function(){return value;},null,{enabled:true});});load.error=bind(this,function(err){this.inited=true;this.error=err;err.requireModules=[id];eachProp(registry,function(mod){if(mod.map.id.indexOf(id+"_unnormalized")===0){cleanRegistry(mod.map.id);}});onError(err);});load.fromText=bind(this,function(text,textAlt){var moduleName=map.name,moduleMap=makeModuleMap(moduleName),hasInteractive=useInteractive;if(textAlt){text=textAlt;}if(hasInteractive){useInteractive=false;}getModule(moduleMap);if(hasProp(config.config,id)){config.config[moduleName]=config.config[id];}try{req.exec(text);}catch(e){return onError(makeError("fromtexteval","fromText eval for "+id+" failed: "+e,e,[id]));}if(hasInteractive){useInteractive=true;}this.depMaps.push(moduleMap);context.completeLoad(moduleName);localRequire([moduleName],load);});plugin.load(map.name,localRequire,load,config);}));context.enable(pluginMap,this);this.pluginMaps[pluginMap.id]=pluginMap;},enable:function(){enabledRegistry[this.map.id]=this;this.enabled=true;this.enabling=true;each(this.depMaps,bind(this,function(depMap,i){var id,mod,handler;if(typeof depMap==="string"){depMap=makeModuleMap(depMap,(this.map.isDefine?this.map:this.map.parentMap),false,!this.skipMap);this.depMaps[i]=depMap;handler=getOwn(handlers,depMap.id);if(handler){this.depExports[i]=handler(this);return;}this.depCount+=1;on(depMap,"defined",bind(this,function(depExports){this.defineDep(i,depExports);this.check();}));if(this.errback){on(depMap,"error",bind(this,this.errback));}}id=depMap.id;mod=registry[id];if(!hasProp(handlers,id)&&mod&&!mod.enabled){context.enable(depMap,this);}}));eachProp(this.pluginMaps,bind(this,function(pluginMap){var mod=getOwn(registry,pluginMap.id);if(mod&&!mod.enabled){context.enable(pluginMap,this);}}));this.enabling=false;this.check();},on:function(name,cb){var cbs=this.events[name];if(!cbs){cbs=this.events[name]=[];}cbs.push(cb);},emit:function(name,evt){each(this.events[name],function(cb){cb(evt);});if(name==="error"){delete this.events[name];}}};function callGetModule(args){if(!hasProp(defined,args[0])){getModule(makeModuleMap(args[0],null,true)).init(args[1],args[2]);}}function removeListener(node,func,name,ieName){if(node.detachEvent&&!isOpera){if(ieName){node.detachEvent(ieName,func);}}else{node.removeEventListener(name,func,false);}}function getScriptData(evt){var node=evt.currentTarget||evt.srcElement;removeListener(node,context.onScriptLoad,"load","onreadystatechange");removeListener(node,context.onScriptError,"error");return{node:node,id:node&&node.getAttribute("data-requiremodule")};}function intakeDefines(){var args;takeGlobalQueue();while(defQueue.length){args=defQueue.shift();if(args[0]===null){return onError(makeError("mismatch","Mismatched anonymous define() module: "+args[args.length-1]));}else{callGetModule(args);}}}context={config:config,contextName:contextName,registry:registry,defined:defined,urlFetched:urlFetched,defQueue:defQueue,Module:Module,makeModuleMap:makeModuleMap,nextTick:req.nextTick,onError:onError,configure:function(cfg){if(cfg.baseUrl){if(cfg.baseUrl.charAt(cfg.baseUrl.length-1)!=="/"){cfg.baseUrl+="/";}}var pkgs=config.pkgs,shim=config.shim,objs={paths:true,config:true,map:true};eachProp(cfg,function(value,prop){if(objs[prop]){if(prop==="map"){if(!config.map){config.map={};}mixin(config[prop],value,true,true);}else{mixin(config[prop],value,true);}}else{config[prop]=value;}});if(cfg.shim){eachProp(cfg.shim,function(value,id){if(isArray(value)){value={deps:value};}if((value.exports||value.init)&&!value.exportsFn){value.exportsFn=context.makeShimExports(value);}shim[id]=value;});config.shim=shim;}if(cfg.packages){each(cfg.packages,function(pkgObj){var location;pkgObj=typeof pkgObj==="string"?{name:pkgObj}:pkgObj;location=pkgObj.location;pkgs[pkgObj.name]={name:pkgObj.name,location:location||pkgObj.name,main:(pkgObj.main||"main").replace(currDirRegExp,"").replace(jsSuffixRegExp,"")};});config.pkgs=pkgs;}eachProp(registry,function(mod,id){if(!mod.inited&&!mod.map.unnormalized){mod.map=makeModuleMap(id);}});if(cfg.deps||cfg.callback){context.require(cfg.deps||[],cfg.callback);}},makeShimExports:function(value){function fn(){var ret;if(value.init){ret=value.init.apply(global,arguments);}return ret||(value.exports&&getGlobal(value.exports));}return fn;},makeRequire:function(relMap,options){options=options||{};function localRequire(deps,callback,errback){var id,map,requireMod;if(options.enableBuildCallback&&callback&&isFunction(callback)){callback.__requireJsBuild=true;}if(typeof deps==="string"){if(isFunction(callback)){return onError(makeError("requireargs","Invalid require call"),errback);}if(relMap&&hasProp(handlers,deps)){return handlers[deps](registry[relMap.id]);}if(req.get){return req.get(context,deps,relMap,localRequire);}map=makeModuleMap(deps,relMap,false,true);id=map.id;if(!hasProp(defined,id)){return onError(makeError("notloaded",'Module name "'+id+'" has not been loaded yet for context: '+contextName+(relMap?"":". Use require([])")));}return defined[id];}intakeDefines();context.nextTick(function(){intakeDefines();requireMod=getModule(makeModuleMap(null,relMap));requireMod.skipMap=options.skipMap;requireMod.init(deps,callback,errback,{enabled:true});checkLoaded();});return localRequire;}mixin(localRequire,{isBrowser:isBrowser,toUrl:function(moduleNamePlusExt){var ext,index=moduleNamePlusExt.lastIndexOf("."),segment=moduleNamePlusExt.split("/")[0],isRelative=segment==="."||segment==="..";if(index!==-1&&(!isRelative||index>1)){ext=moduleNamePlusExt.substring(index,moduleNamePlusExt.length);moduleNamePlusExt=moduleNamePlusExt.substring(0,index);}return context.nameToUrl(normalize(moduleNamePlusExt,relMap&&relMap.id,true),ext,true);},defined:function(id){return hasProp(defined,makeModuleMap(id,relMap,false,true).id);},specified:function(id){id=makeModuleMap(id,relMap,false,true).id;return hasProp(defined,id)||hasProp(registry,id);}});if(!relMap){localRequire.undef=function(id){takeGlobalQueue();var map=makeModuleMap(id,relMap,true),mod=getOwn(registry,id);delete defined[id];delete urlFetched[map.url];delete undefEvents[id];if(mod){if(mod.events.defined){undefEvents[id]=mod.events;}cleanRegistry(id);}};}return localRequire;},enable:function(depMap){var mod=getOwn(registry,depMap.id);if(mod){getModule(depMap).enable();}},completeLoad:function(moduleName){var found,args,mod,shim=getOwn(config.shim,moduleName)||{},shExports=shim.exports;takeGlobalQueue();while(defQueue.length){args=defQueue.shift();if(args[0]===null){args[0]=moduleName;if(found){break;}found=true;}else{if(args[0]===moduleName){found=true;}}callGetModule(args);}mod=getOwn(registry,moduleName);if(!found&&!hasProp(defined,moduleName)&&mod&&!mod.inited){if(config.enforceDefine&&(!shExports||!getGlobal(shExports))){if(hasPathFallback(moduleName)){return;}else{return onError(makeError("nodefine","No define call for "+moduleName,null,[moduleName]));}}else{callGetModule([moduleName,(shim.deps||[]),shim.exportsFn]);}}checkLoaded();},nameToUrl:function(moduleName,ext,skipExt){var paths,pkgs,pkg,pkgPath,syms,i,parentModule,url,parentPath;if(req.jsExtRegExp.test(moduleName)){url=moduleName+(ext||"");}else{paths=config.paths;pkgs=config.pkgs;syms=moduleName.split("/");for(i=syms.length;i>0;i-=1){parentModule=syms.slice(0,i).join("/");pkg=getOwn(pkgs,parentModule);parentPath=getOwn(paths,parentModule);if(parentPath){if(isArray(parentPath)){parentPath=parentPath[0];}syms.splice(0,i,parentPath);break;}else{if(pkg){if(moduleName===pkg.name){pkgPath=pkg.location+"/"+pkg.main;}else{pkgPath=pkg.location;}syms.splice(0,i,pkgPath);break;}}}url=syms.join("/");url+=(ext||(/\?/.test(url)||skipExt?"":".js"));url=(url.charAt(0)==="/"||url.match(/^[\w\+\.\-]+:/)?"":config.baseUrl)+url;}return config.urlArgs?url+((url.indexOf("?")===-1?"?":"&")+config.urlArgs):url;},load:function(id,url){req.load(context,id,url);},execCb:function(name,callback,args,exports){return callback.apply(exports,args);},onScriptLoad:function(evt){if(evt.type==="load"||(readyRegExp.test((evt.currentTarget||evt.srcElement).readyState))){interactiveScript=null;var data=getScriptData(evt);context.completeLoad(data.id);}},onScriptError:function(evt){var data=getScriptData(evt);if(!hasPathFallback(data.id)){return onError(makeError("scripterror","Script error for: "+data.id,evt,[data.id]));}}};context.require=context.makeRequire();return context;}req=requirejs=function(deps,callback,errback,optional){var context,config,contextName=defContextName;if(!isArray(deps)&&typeof deps!=="string"){config=deps;if(isArray(callback)){deps=callback;callback=errback;errback=optional;}else{deps=[];}}if(config&&config.context){contextName=config.context;}context=getOwn(contexts,contextName);if(!context){context=contexts[contextName]=req.s.newContext(contextName);}if(config){context.configure(config);}return context.require(deps,callback,errback);};req.config=function(config){return req(config);};req.nextTick=typeof setTimeout!=="undefined"?function(fn){setTimeout(fn,4);}:function(fn){fn();};if(!require){require=req;}req.version=version;req.jsExtRegExp=/^\/|:|\?|\.js$/;req.isBrowser=isBrowser;s=req.s={contexts:contexts,newContext:newContext};req({});each(["toUrl","undef","defined","specified"],function(prop){req[prop]=function(){var ctx=contexts[defContextName];return ctx.require[prop].apply(ctx,arguments);};});if(isBrowser){head=s.head=document.getElementsByTagName("head")[0];baseElement=document.getElementsByTagName("base")[0];if(baseElement){head=s.head=baseElement.parentNode;}}req.onError=defaultOnError;req.createNode=function(config,moduleName,url){var node=config.xhtml?document.createElementNS("http://www.w3.org/1999/xhtml","html:script"):document.createElement("script");node.type=config.scriptType||"text/javascript";node.charset="utf-8";node.async=true;return node;};req.load=function(context,moduleName,url){var config=(context&&context.config)||{},node;if(isBrowser){node=req.createNode(config,moduleName,url);node.setAttribute("data-requirecontext",context.contextName);node.setAttribute("data-requiremodule",moduleName);if(node.attachEvent&&!(node.attachEvent.toString&&node.attachEvent.toString().indexOf("[native code")<0)&&!isOpera){useInteractive=true;node.attachEvent("onreadystatechange",context.onScriptLoad);}else{node.addEventListener("load",context.onScriptLoad,false);node.addEventListener("error",context.onScriptError,false);}node.src=url;currentlyAddingScript=node;if(baseElement){head.insertBefore(node,baseElement);}else{head.appendChild(node);}currentlyAddingScript=null;return node;}else{if(isWebWorker){try{importScripts(url);context.completeLoad(moduleName);}catch(e){context.onError(makeError("importscripts","importScripts failed for "+moduleName+" at "+url,e,[moduleName]));}}}};function getInteractiveScript(){if(interactiveScript&&interactiveScript.readyState==="interactive"){return interactiveScript;}eachReverse(scripts(),function(script){if(script.readyState==="interactive"){return(interactiveScript=script);}});return interactiveScript;}if(isBrowser){eachReverse(scripts(),function(script){if(!head){head=script.parentNode;}dataMain=script.getAttribute("data-main");if(dataMain){mainScript=dataMain;if(!cfg.baseUrl){src=mainScript.split("/");mainScript=src.pop();subPath=src.length?src.join("/")+"/":"./";cfg.baseUrl=subPath;}mainScript=mainScript.replace(jsSuffixRegExp,"");if(req.jsExtRegExp.test(mainScript)){mainScript=dataMain;}cfg.deps=cfg.deps?cfg.deps.concat(mainScript):[mainScript];return true;}});}define=function(name,deps,callback){var node,context;if(typeof name!=="string"){callback=deps;deps=name;name=null;}if(!isArray(deps)){callback=deps;deps=null;}if(!deps&&isFunction(callback)){deps=[];if(callback.length){callback.toString().replace(commentRegExp,"").replace(cjsRequireRegExp,function(match,dep){deps.push(dep);});deps=(callback.length===1?["require"]:["require","exports","module"]).concat(deps);}}if(useInteractive){node=currentlyAddingScript||getInteractiveScript();if(node){if(!name){name=node.getAttribute("data-requiremodule");}context=contexts[node.getAttribute("data-requirecontext")];}}(context?context.defQueue:globalDefQueue).push([name,deps,callback]);};define.amd={jQuery:true};req.exec=function(text){return eval(text);};req(cfg);}(this));(function(){var w=this;var k=w._;var D={};var C=Array.prototype,f=Object.prototype,r=Function.prototype;var H=C.push,o=C.slice,y=C.concat,d=f.toString,j=f.hasOwnProperty;var L=C.forEach,q=C.map,E=C.reduce,c=C.reduceRight,b=C.filter,B=C.every,p=C.some,n=C.indexOf,l=C.lastIndexOf,u=Array.isArray,e=Object.keys,F=r.bind;var M=function(N){if(N instanceof M){return N;}if(!(this instanceof M)){return new M(N);}this._wrapped=N;};if(typeof exports!=="undefined"){if(typeof module!=="undefined"&&module.exports){exports=module.exports=M;}exports._=M;}else{w._=M;}M.VERSION="1.5.1";var I=M.each=M.forEach=function(S,R,Q){if(S==null){return;}if(L&&S.forEach===L){S.forEach(R,Q);}else{if(S.length===+S.length){for(var P=0,N=S.length;P<N;P++){if(R.call(Q,S[P],P,S)===D){return;}}}else{for(var O in S){if(M.has(S,O)){if(R.call(Q,S[O],O,S)===D){return;}}}}}};M.map=M.collect=function(Q,P,O){var N=[];if(Q==null){return N;}if(q&&Q.map===q){return Q.map(P,O);}I(Q,function(T,R,S){N.push(P.call(O,T,R,S));});return N;};var g="Reduce of empty array with no initial value";M.reduce=M.foldl=M.inject=function(R,Q,N,P){var O=arguments.length>2;if(R==null){R=[];}if(E&&R.reduce===E){if(P){Q=M.bind(Q,P);}return O?R.reduce(Q,N):R.reduce(Q);}I(R,function(U,S,T){if(!O){N=U;O=true;}else{N=Q.call(P,N,U,S,T);}});if(!O){throw new TypeError(g);}return N;};M.reduceRight=M.foldr=function(T,Q,N,P){var O=arguments.length>2;if(T==null){T=[];}if(c&&T.reduceRight===c){if(P){Q=M.bind(Q,P);}return O?T.reduceRight(Q,N):T.reduceRight(Q);}var S=T.length;if(S!==+S){var R=M.keys(T);S=R.length;}I(T,function(W,U,V){U=R?R[--S]:--S;if(!O){N=T[U];O=true;}else{N=Q.call(P,N,T[U],U,V);}});if(!O){throw new TypeError(g);}return N;};M.find=M.detect=function(Q,P,O){var N;A(Q,function(T,R,S){if(P.call(O,T,R,S)){N=T;return true;}});return N;};M.filter=M.select=function(Q,P,O){var N=[];if(Q==null){return N;}if(b&&Q.filter===b){return Q.filter(P,O);}I(Q,function(T,R,S){if(P.call(O,T,R,S)){N.push(T);}});return N;};M.reject=function(P,O,N){return M.filter(P,function(S,Q,R){return !O.call(N,S,Q,R);},N);};M.every=M.all=function(Q,P,O){P||(P=M.identity);var N=true;if(Q==null){return N;}if(B&&Q.every===B){return Q.every(P,O);}I(Q,function(T,R,S){if(!(N=N&&P.call(O,T,R,S))){return D;}});return !!N;};var A=M.some=M.any=function(Q,P,O){P||(P=M.identity);var N=false;if(Q==null){return N;}if(p&&Q.some===p){return Q.some(P,O);}I(Q,function(T,R,S){if(N||(N=P.call(O,T,R,S))){return D;}});return !!N;};M.contains=M.include=function(O,N){if(O==null){return false;}if(n&&O.indexOf===n){return O.indexOf(N)!=-1;}return A(O,function(P){return P===N;});};M.invoke=function(P,Q){var N=o.call(arguments,2);var O=M.isFunction(Q);return M.map(P,function(R){return(O?Q:R[Q]).apply(R,N);});};M.pluck=function(O,N){return M.map(O,function(P){return P[N];});};M.where=function(O,N,P){if(M.isEmpty(N)){return P?void 0:[];}return M[P?"find":"filter"](O,function(R){for(var Q in N){if(N[Q]!==R[Q]){return false;}}return true;});};M.findWhere=function(O,N){return M.where(O,N,true);};M.max=function(Q,P,O){if(!P&&M.isArray(Q)&&Q[0]===+Q[0]&&Q.length<65535){return Math.max.apply(Math,Q);}if(!P&&M.isEmpty(Q)){return -Infinity;}var N={computed:-Infinity,value:-Infinity};I(Q,function(U,R,T){var S=P?P.call(O,U,R,T):U;S>N.computed&&(N={value:U,computed:S});});return N.value;};M.min=function(Q,P,O){if(!P&&M.isArray(Q)&&Q[0]===+Q[0]&&Q.length<65535){return Math.min.apply(Math,Q);}if(!P&&M.isEmpty(Q)){return Infinity;}var N={computed:Infinity,value:Infinity};I(Q,function(U,R,T){var S=P?P.call(O,U,R,T):U;S<N.computed&&(N={value:U,computed:S});});return N.value;};M.shuffle=function(Q){var P;var O=0;var N=[];I(Q,function(R){P=M.random(O++);N[O-1]=N[P];N[P]=R;});return N;};var a=function(N){return M.isFunction(N)?N:function(O){return O[N];};};M.sortBy=function(Q,P,N){var O=a(P);return M.pluck(M.map(Q,function(T,R,S){return{value:T,index:R,criteria:O.call(N,T,R,S)};}).sort(function(U,T){var S=U.criteria;var R=T.criteria;if(S!==R){if(S>R||S===void 0){return 1;}if(S<R||R===void 0){return -1;}}return U.index<T.index?-1:1;}),"value");};var t=function(S,R,O,Q){var N={};var P=a(R==null?M.identity:R);I(S,function(V,T){var U=P.call(O,V,T,S);Q(N,U,V);});return N;};M.groupBy=function(P,O,N){return t(P,O,N,function(Q,R,S){(M.has(Q,R)?Q[R]:(Q[R]=[])).push(S);});};M.countBy=function(P,O,N){return t(P,O,N,function(Q,R){if(!M.has(Q,R)){Q[R]=0;}Q[R]++;});};M.sortedIndex=function(U,T,Q,P){Q=Q==null?M.identity:a(Q);var S=Q.call(P,T);var N=0,R=U.length;while(N<R){var O=(N+R)>>>1;Q.call(P,U[O])<S?N=O+1:R=O;}return N;};M.toArray=function(N){if(!N){return[];}if(M.isArray(N)){return o.call(N);}if(N.length===+N.length){return M.map(N,M.identity);}return M.values(N);};M.size=function(N){if(N==null){return 0;}return(N.length===+N.length)?N.length:M.keys(N).length;};M.first=M.head=M.take=function(P,O,N){if(P==null){return void 0;}return(O!=null)&&!N?o.call(P,0,O):P[0];};M.initial=function(P,O,N){return o.call(P,0,P.length-((O==null)||N?1:O));};M.last=function(P,O,N){if(P==null){return void 0;}if((O!=null)&&!N){return o.call(P,Math.max(P.length-O,0));}else{return P[P.length-1];}};M.rest=M.tail=M.drop=function(P,O,N){return o.call(P,(O==null)||N?1:O);};M.compact=function(N){return M.filter(N,M.identity);};var x=function(O,P,N){if(P&&M.every(O,M.isArray)){return y.apply(N,O);}I(O,function(Q){if(M.isArray(Q)||M.isArguments(Q)){P?H.apply(N,Q):x(Q,P,N);}else{N.push(Q);}});return N;};M.flatten=function(O,N){return x(O,N,[]);};M.without=function(N){return M.difference(N,o.call(arguments,1));};M.uniq=M.unique=function(T,S,R,Q){if(M.isFunction(S)){Q=R;R=S;S=false;}var O=R?M.map(T,R,Q):T;var P=[];var N=[];I(O,function(V,U){if(S?(!U||N[N.length-1]!==V):!M.contains(N,V)){N.push(V);P.push(T[U]);}});return P;};M.union=function(){return M.uniq(M.flatten(arguments,true));};M.intersection=function(O){var N=o.call(arguments,1);return M.filter(M.uniq(O),function(P){return M.every(N,function(Q){return M.indexOf(Q,P)>=0;});});};M.difference=function(O){var N=y.apply(C,o.call(arguments,1));return M.filter(O,function(P){return !M.contains(N,P);});};M.zip=function(){var P=M.max(M.pluck(arguments,"length").concat(0));var O=new Array(P);for(var N=0;N<P;N++){O[N]=M.pluck(arguments,""+N);}return O;};M.object=function(R,P){if(R==null){return{};}var N={};for(var Q=0,O=R.length;Q<O;Q++){if(P){N[R[Q]]=P[Q];}else{N[R[Q][0]]=R[Q][1];}}return N;};M.indexOf=function(R,P,Q){if(R==null){return -1;}var O=0,N=R.length;if(Q){if(typeof Q=="number"){O=(Q<0?Math.max(0,N+Q):Q);}else{O=M.sortedIndex(R,P);return R[O]===P?O:-1;}}if(n&&R.indexOf===n){return R.indexOf(P,Q);}for(;O<N;O++){if(R[O]===P){return O;}}return -1;};M.lastIndexOf=function(R,P,Q){if(R==null){return -1;}var N=Q!=null;if(l&&R.lastIndexOf===l){return N?R.lastIndexOf(P,Q):R.lastIndexOf(P);}var O=(N?Q:R.length);while(O--){if(R[O]===P){return O;}}return -1;};M.range=function(S,Q,R){if(arguments.length<=1){Q=S||0;S=0;}R=arguments[2]||1;var O=Math.max(Math.ceil((Q-S)/R),0);var N=0;var P=new Array(O);while(N<O){P[N++]=S;S+=R;}return P;};var G=function(){};M.bind=function(Q,O){var N,P;if(F&&Q.bind===F){return F.apply(Q,o.call(arguments,1));}if(!M.isFunction(Q)){throw new TypeError;}N=o.call(arguments,2);return P=function(){if(!(this instanceof P)){return Q.apply(O,N.concat(o.call(arguments)));}G.prototype=Q.prototype;var S=new G;G.prototype=null;var R=Q.apply(S,N.concat(o.call(arguments)));if(Object(R)===R){return R;}return S;};};M.partial=function(O){var N=o.call(arguments,1);return function(){return O.apply(this,N.concat(o.call(arguments)));};};M.bindAll=function(O){var N=o.call(arguments,1);if(N.length===0){throw new Error("bindAll must be passed function names");}I(N,function(P){O[P]=M.bind(O[P],O);});return O;};M.memoize=function(P,O){var N={};O||(O=M.identity);return function(){var Q=O.apply(this,arguments);return M.has(N,Q)?N[Q]:(N[Q]=P.apply(this,arguments));};};M.delay=function(O,P){var N=o.call(arguments,2);return setTimeout(function(){return O.apply(null,N);},P);};M.defer=function(N){return M.delay.apply(M,[N,1].concat(o.call(arguments,1)));};M.throttle=function(O,Q,U){var N,S,V;var T=null;var R=0;U||(U={});var P=function(){R=U.leading===false?0:new Date;T=null;V=O.apply(N,S);};return function(){var W=new Date;if(!R&&U.leading===false){R=W;}var X=Q-(W-R);N=this;S=arguments;if(X<=0){clearTimeout(T);T=null;R=W;V=O.apply(N,S);}else{if(!T&&U.trailing!==false){T=setTimeout(P,X);}}return V;};};M.debounce=function(P,R,O){var N;var Q=null;return function(){var V=this,U=arguments;var T=function(){Q=null;if(!O){N=P.apply(V,U);}};var S=O&&!Q;clearTimeout(Q);Q=setTimeout(T,R);if(S){N=P.apply(V,U);}return N;};};M.once=function(P){var N=false,O;return function(){if(N){return O;}N=true;O=P.apply(this,arguments);P=null;return O;};};M.wrap=function(N,O){return function(){var P=[N];H.apply(P,arguments);return O.apply(this,P);};};M.compose=function(){var N=arguments;return function(){var O=arguments;for(var P=N.length-1;P>=0;P--){O=[N[P].apply(this,O)];}return O[0];};};M.after=function(O,N){return function(){if(--O<1){return N.apply(this,arguments);}};};M.keys=e||function(P){if(P!==Object(P)){throw new TypeError("Invalid object");}var O=[];for(var N in P){if(M.has(P,N)){O.push(N);}}return O;};M.values=function(P){var N=[];for(var O in P){if(M.has(P,O)){N.push(P[O]);}}return N;};M.pairs=function(P){var O=[];for(var N in P){if(M.has(P,N)){O.push([N,P[N]]);}}return O;};M.invert=function(P){var N={};for(var O in P){if(M.has(P,O)){N[P[O]]=O;}}return N;};M.functions=M.methods=function(P){var O=[];for(var N in P){if(M.isFunction(P[N])){O.push(N);}}return O.sort();};M.extend=function(N){I(o.call(arguments,1),function(O){if(O){for(var P in O){N[P]=O[P];}}});return N;};M.pick=function(O){var P={};var N=y.apply(C,o.call(arguments,1));I(N,function(Q){if(Q in O){P[Q]=O[Q];}});return P;};M.omit=function(P){var Q={};var O=y.apply(C,o.call(arguments,1));for(var N in P){if(!M.contains(O,N)){Q[N]=P[N];}}return Q;};M.defaults=function(N){I(o.call(arguments,1),function(O){if(O){for(var P in O){if(N[P]===void 0){N[P]=O[P];}}}});return N;};M.clone=function(N){if(!M.isObject(N)){return N;}return M.isArray(N)?N.slice():M.extend({},N);};M.tap=function(O,N){N(O);return O;};var J=function(U,T,O,P){if(U===T){return U!==0||1/U==1/T;}if(U==null||T==null){return U===T;}if(U instanceof M){U=U._wrapped;}if(T instanceof M){T=T._wrapped;}var R=d.call(U);if(R!=d.call(T)){return false;}switch(R){case"[object String]":return U==String(T);case"[object Number]":return U!=+U?T!=+T:(U==0?1/U==1/T:U==+T);case"[object Date]":case"[object Boolean]":return +U==+T;case"[object RegExp]":return U.source==T.source&&U.global==T.global&&U.multiline==T.multiline&&U.ignoreCase==T.ignoreCase;}if(typeof U!="object"||typeof T!="object"){return false;}var N=O.length;while(N--){if(O[N]==U){return P[N]==T;}}var S=U.constructor,Q=T.constructor;if(S!==Q&&!(M.isFunction(S)&&(S instanceof S)&&M.isFunction(Q)&&(Q instanceof Q))){return false;}O.push(U);P.push(T);var X=0,W=true;if(R=="[object Array]"){X=U.length;W=X==T.length;if(W){while(X--){if(!(W=J(U[X],T[X],O,P))){break;}}}}else{for(var V in U){if(M.has(U,V)){X++;if(!(W=M.has(T,V)&&J(U[V],T[V],O,P))){break;}}}if(W){for(V in T){if(M.has(T,V)&&!(X--)){break;}}W=!X;}}O.pop();P.pop();return W;};M.isEqual=function(O,N){return J(O,N,[],[]);};M.isEmpty=function(O){if(O==null){return true;}if(M.isArray(O)||M.isString(O)){return O.length===0;}for(var N in O){if(M.has(O,N)){return false;}}return true;};M.isElement=function(N){return !!(N&&N.nodeType===1);};M.isArray=u||function(N){return d.call(N)=="[object Array]";};M.isObject=function(N){return N===Object(N);};I(["Arguments","Function","String","Number","Date","RegExp"],function(N){M["is"+N]=function(O){return d.call(O)=="[object "+N+"]";};});if(!M.isArguments(arguments)){M.isArguments=function(N){return !!(N&&M.has(N,"callee"));};}if(typeof(/./)!=="function"){M.isFunction=function(N){return typeof N==="function";};}M.isFinite=function(N){return isFinite(N)&&!isNaN(parseFloat(N));};M.isNaN=function(N){return M.isNumber(N)&&N!=+N;};M.isBoolean=function(N){return N===true||N===false||d.call(N)=="[object Boolean]";};M.isNull=function(N){return N===null;};M.isUndefined=function(N){return N===void 0;};M.has=function(O,N){return j.call(O,N);};M.noConflict=function(){w._=k;return this;};M.identity=function(N){return N;};M.times=function(R,Q,P){var N=Array(Math.max(0,R));for(var O=0;O<R;O++){N[O]=Q.call(P,O);}return N;};M.random=function(O,N){if(N==null){N=O;O=0;}return O+Math.floor(Math.random()*(N-O+1));};var m={escape:{"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","/":"&#x2F;"}};m.unescape=M.invert(m.escape);var K={escape:new RegExp("["+M.keys(m.escape).join("")+"]","g"),unescape:new RegExp("("+M.keys(m.unescape).join("|")+")","g")};M.each(["escape","unescape"],function(N){M[N]=function(O){if(O==null){return"";}return(""+O).replace(K[N],function(P){return m[N][P];});};});M.result=function(N,P){if(N==null){return void 0;}var O=N[P];return M.isFunction(O)?O.call(N):O;};M.mixin=function(N){I(M.functions(N),function(O){var P=M[O]=N[O];M.prototype[O]=function(){var Q=[this._wrapped];H.apply(Q,arguments);return s.call(this,P.apply(M,Q));};});};var z=0;M.uniqueId=function(N){var O=++z+"";return N?N+O:O;};M.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var v=/(.)^/;var h={"'":"'","\\":"\\","\r":"r","\n":"n","\t":"t","\u2028":"u2028","\u2029":"u2029"};var i=/\\|'|\r|\n|\t|\u2028|\u2029/g;M.template=function(V,Q,P){var O;P=M.defaults({},P,M.templateSettings);var R=new RegExp([(P.escape||v).source,(P.interpolate||v).source,(P.evaluate||v).source].join("|")+"|$","g");var S=0;var N="__p+='";V.replace(R,function(X,Y,W,aa,Z){N+=V.slice(S,Z).replace(i,function(ab){return"\\"+h[ab];});if(Y){N+="'+\n((__t=("+Y+"))==null?'':_.escape(__t))+\n'";}if(W){N+="'+\n((__t=("+W+"))==null?'':__t)+\n'";}if(aa){N+="';\n"+aa+"\n__p+='";}S=Z+X.length;return X;});N+="';\n";if(!P.variable){N="with(obj||{}){\n"+N+"}\n";}N="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+N+"return __p;\n";try{O=new Function(P.variable||"obj","_",N);}catch(T){T.source=N;throw T;}if(Q){return O(Q,M);}var U=function(W){return O.call(this,W,M);};U.source="function("+(P.variable||"obj")+"){\n"+N+"}";return U;};M.chain=function(N){return M(N).chain();};var s=function(N){return this._chain?M(N).chain():N;};M.mixin(M);I(["pop","push","reverse","shift","sort","splice","unshift"],function(N){var O=C[N];M.prototype[N]=function(){var P=this._wrapped;O.apply(P,arguments);if((N=="shift"||N=="splice")&&P.length===0){delete P[0];}return s.call(this,P);};});I(["concat","join","slice"],function(N){var O=C[N];M.prototype[N]=function(){return s.call(this,O.apply(this._wrapped,arguments));};});M.extend(M.prototype,{chain:function(){this._chain=true;return this;},value:function(){return this._wrapped;}});}).call(this);
/*
 * jQuery JavaScript Library v1.10.2
 * http://jquery.com/
 *
 * Includes Sizzle.js
 * http://sizzlejs.com/
 *
 * Copyright 2005, 2013 jQuery Foundation, Inc. and other contributors
 * Released under the MIT license
 * http://jquery.org/license
 *
 * Date: 2013-07-03T13:48Z
 */
(function(a1,aE){var ag,w,aA=typeof aE,aJ=a1.location,l=a1.document,bV=l.documentElement,bh=a1.jQuery,G=a1.$,Y={},a5=[],s="1.10.2",aG=a5.concat,am=a5.push,a3=a5.slice,aK=a5.indexOf,y=Y.toString,T=Y.hasOwnProperty,aO=s.trim,bI=function(e,b3){return new bI.fn.init(e,b3,w);},bz=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,aa=/\S+/g,B=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,bq=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]*))$/,a=/^<(\w+)\s*\/?>(?:<\/\1>|)$/,bg=/^[\],:{}\s]*$/,bj=/(?:^|:|,)(?:\s*\[)+/g,bF=/\\(?:["\\\/bfnrt]|u[\da-fA-F]{4})/g,aX=/"[^"\\\r\n]*"|true|false|null|-?(?:\d+\.|)\d+(?:[eE][+-]?\d+|)/g,bR=/^-ms-/,aT=/-([\da-z])/gi,K=function(e,b3){return b3.toUpperCase();},bW=function(e){if(l.addEventListener||e.type==="load"||l.readyState==="complete"){bk();bI.ready();}},bk=function(){if(l.addEventListener){l.removeEventListener("DOMContentLoaded",bW,false);a1.removeEventListener("load",bW,false);}else{l.detachEvent("onreadystatechange",bW);a1.detachEvent("onload",bW);}};bI.fn=bI.prototype={jquery:s,constructor:bI,init:function(e,b5,b4){var b3,b6;if(!e){return this;}if(typeof e==="string"){if(e.charAt(0)==="<"&&e.charAt(e.length-1)===">"&&e.length>=3){b3=[null,e,null];}else{b3=bq.exec(e);}if(b3&&(b3[1]||!b5)){if(b3[1]){b5=b5 instanceof bI?b5[0]:b5;bI.merge(this,bI.parseHTML(b3[1],b5&&b5.nodeType?b5.ownerDocument||b5:l,true));if(a.test(b3[1])&&bI.isPlainObject(b5)){for(b3 in b5){if(bI.isFunction(this[b3])){this[b3](b5[b3]);}else{this.attr(b3,b5[b3]);}}}return this;}else{b6=l.getElementById(b3[2]);if(b6&&b6.parentNode){if(b6.id!==b3[2]){return b4.find(e);}this.length=1;this[0]=b6;}this.context=l;this.selector=e;return this;}}else{if(!b5||b5.jquery){return(b5||b4).find(e);}else{return this.constructor(b5).find(e);}}}else{if(e.nodeType){this.context=this[0]=e;this.length=1;return this;}else{if(bI.isFunction(e)){return b4.ready(e);}}}if(e.selector!==aE){this.selector=e.selector;this.context=e.context;}return bI.makeArray(e,this);},selector:"",length:0,toArray:function(){return a3.call(this);},get:function(e){return e==null?this.toArray():(e<0?this[this.length+e]:this[e]);},pushStack:function(e){var b3=bI.merge(this.constructor(),e);b3.prevObject=this;b3.context=this.context;return b3;},each:function(b3,e){return bI.each(this,b3,e);},ready:function(e){bI.ready.promise().done(e);return this;},slice:function(){return this.pushStack(a3.apply(this,arguments));},first:function(){return this.eq(0);},last:function(){return this.eq(-1);},eq:function(b4){var e=this.length,b3=+b4+(b4<0?e:0);return this.pushStack(b3>=0&&b3<e?[this[b3]]:[]);},map:function(e){return this.pushStack(bI.map(this,function(b4,b3){return e.call(b4,b3,b4);}));},end:function(){return this.prevObject||this.constructor(null);},push:am,sort:[].sort,splice:[].splice};bI.fn.init.prototype=bI.fn;bI.extend=bI.fn.extend=function(){var e,b8,b3,b4,cb,b9,b7=arguments[0]||{},b6=1,b5=arguments.length,ca=false;if(typeof b7==="boolean"){ca=b7;b7=arguments[1]||{};b6=2;}if(typeof b7!=="object"&&!bI.isFunction(b7)){b7={};}if(b5===b6){b7=this;--b6;}for(;b6<b5;b6++){if((cb=arguments[b6])!=null){for(b4 in cb){e=b7[b4];b3=cb[b4];if(b7===b3){continue;}if(ca&&b3&&(bI.isPlainObject(b3)||(b8=bI.isArray(b3)))){if(b8){b8=false;b9=e&&bI.isArray(e)?e:[];}else{b9=e&&bI.isPlainObject(e)?e:{};}b7[b4]=bI.extend(ca,b9,b3);}else{if(b3!==aE){b7[b4]=b3;}}}}}return b7;};bI.extend({expando:"jQuery"+(s+Math.random()).replace(/\D/g,""),noConflict:function(e){if(a1.$===bI){a1.$=G;}if(e&&a1.jQuery===bI){a1.jQuery=bh;}return bI;},isReady:false,readyWait:1,holdReady:function(e){if(e){bI.readyWait++;}else{bI.ready(true);}},ready:function(e){if(e===true?--bI.readyWait:bI.isReady){return;}if(!l.body){return setTimeout(bI.ready);}bI.isReady=true;if(e!==true&&--bI.readyWait>0){return;}ag.resolveWith(l,[bI]);if(bI.fn.trigger){bI(l).trigger("ready").off("ready");}},isFunction:function(e){return bI.type(e)==="function";},isArray:Array.isArray||function(e){return bI.type(e)==="array";},isWindow:function(e){return e!=null&&e==e.window;},isNumeric:function(e){return !isNaN(parseFloat(e))&&isFinite(e);},type:function(e){if(e==null){return String(e);}return typeof e==="object"||typeof e==="function"?Y[y.call(e)]||"object":typeof e;},isPlainObject:function(b5){var b3;if(!b5||bI.type(b5)!=="object"||b5.nodeType||bI.isWindow(b5)){return false;}try{if(b5.constructor&&!T.call(b5,"constructor")&&!T.call(b5.constructor.prototype,"isPrototypeOf")){return false;}}catch(b4){return false;}if(bI.support.ownLast){for(b3 in b5){return T.call(b5,b3);}}for(b3 in b5){}return b3===aE||T.call(b5,b3);},isEmptyObject:function(b3){var e;for(e in b3){return false;}return true;},error:function(e){throw new Error(e);},parseHTML:function(b6,b4,b5){if(!b6||typeof b6!=="string"){return null;}if(typeof b4==="boolean"){b5=b4;b4=false;}b4=b4||l;var b3=a.exec(b6),e=!b5&&[];if(b3){return[b4.createElement(b3[1])];}b3=bI.buildFragment([b6],b4,e);if(e){bI(e).remove();}return bI.merge([],b3.childNodes);},parseJSON:function(e){if(a1.JSON&&a1.JSON.parse){return a1.JSON.parse(e);}if(e===null){return e;}if(typeof e==="string"){e=bI.trim(e);if(e){if(bg.test(e.replace(bF,"@").replace(aX,"]").replace(bj,""))){return(new Function("return "+e))();}}}bI.error("Invalid JSON: "+e);},parseXML:function(b5){var b3,b4;if(!b5||typeof b5!=="string"){return null;}try{if(a1.DOMParser){b4=new DOMParser();b3=b4.parseFromString(b5,"text/xml");}else{b3=new ActiveXObject("Microsoft.XMLDOM");b3.async="false";b3.loadXML(b5);}}catch(b6){b3=aE;}if(!b3||!b3.documentElement||b3.getElementsByTagName("parsererror").length){bI.error("Invalid XML: "+b5);}return b3;},noop:function(){},globalEval:function(e){if(e&&bI.trim(e)){(a1.execScript||function(b3){a1["eval"].call(a1,b3);})(e);}},camelCase:function(e){return e.replace(bR,"ms-").replace(aT,K);},nodeName:function(b3,e){return b3.nodeName&&b3.nodeName.toLowerCase()===e.toLowerCase();},each:function(b7,b8,b3){var b6,b4=0,b5=b7.length,e=Z(b7);if(b3){if(e){for(;b4<b5;b4++){b6=b8.apply(b7[b4],b3);if(b6===false){break;}}}else{for(b4 in b7){b6=b8.apply(b7[b4],b3);if(b6===false){break;}}}}else{if(e){for(;b4<b5;b4++){b6=b8.call(b7[b4],b4,b7[b4]);if(b6===false){break;}}}else{for(b4 in b7){b6=b8.call(b7[b4],b4,b7[b4]);if(b6===false){break;}}}}return b7;},trim:aO&&!aO.call("\uFEFF\xA0")?function(e){return e==null?"":aO.call(e);}:function(e){return e==null?"":(e+"").replace(B,"");},makeArray:function(e,b4){var b3=b4||[];if(e!=null){if(Z(Object(e))){bI.merge(b3,typeof e==="string"?[e]:e);}else{am.call(b3,e);}}return b3;},inArray:function(b5,b3,b4){var e;if(b3){if(aK){return aK.call(b3,b5,b4);}e=b3.length;b4=b4?b4<0?Math.max(0,e+b4):b4:0;for(;b4<e;b4++){if(b4 in b3&&b3[b4]===b5){return b4;}}}return -1;},merge:function(b6,b4){var e=b4.length,b5=b6.length,b3=0;if(typeof e==="number"){for(;b3<e;b3++){b6[b5++]=b4[b3];}}else{while(b4[b3]!==aE){b6[b5++]=b4[b3++];}}b6.length=b5;return b6;},grep:function(b3,b8,e){var b7,b4=[],b5=0,b6=b3.length;e=!!e;for(;b5<b6;b5++){b7=!!b8(b3[b5],b5);if(e!==b7){b4.push(b3[b5]);}}return b4;},map:function(b4,b9,e){var b8,b6=0,b7=b4.length,b3=Z(b4),b5=[];if(b3){for(;b6<b7;b6++){b8=b9(b4[b6],b6,e);if(b8!=null){b5[b5.length]=b8;}}}else{for(b6 in b4){b8=b9(b4[b6],b6,e);if(b8!=null){b5[b5.length]=b8;}}}return aG.apply([],b5);},guid:1,proxy:function(b6,b5){var e,b4,b3;if(typeof b5==="string"){b3=b6[b5];b5=b6;b6=b3;}if(!bI.isFunction(b6)){return aE;}e=a3.call(arguments,2);b4=function(){return b6.apply(b5||this,e.concat(a3.call(arguments)));};b4.guid=b6.guid=b6.guid||bI.guid++;return b4;},access:function(e,b7,b9,b8,b5,cb,ca){var b4=0,b3=e.length,b6=b9==null;if(bI.type(b9)==="object"){b5=true;for(b4 in b9){bI.access(e,b7,b4,b9[b4],true,cb,ca);}}else{if(b8!==aE){b5=true;if(!bI.isFunction(b8)){ca=true;}if(b6){if(ca){b7.call(e,b8);b7=null;}else{b6=b7;b7=function(cd,cc,ce){return b6.call(bI(cd),ce);};}}if(b7){for(;b4<b3;b4++){b7(e[b4],b9,ca?b8:b8.call(e[b4],b4,b7(e[b4],b9)));}}}}return b5?e:b6?b7.call(e):b3?b7(e[0],b9):cb;},now:function(){return(new Date()).getTime();},swap:function(b7,b6,b8,b5){var b4,b3,e={};for(b3 in b6){e[b3]=b7.style[b3];b7.style[b3]=b6[b3];}b4=b8.apply(b7,b5||[]);for(b3 in b6){b7.style[b3]=e[b3];}return b4;}});bI.ready.promise=function(b6){if(!ag){ag=bI.Deferred();if(l.readyState==="complete"){setTimeout(bI.ready);}else{if(l.addEventListener){l.addEventListener("DOMContentLoaded",bW,false);a1.addEventListener("load",bW,false);}else{l.attachEvent("onreadystatechange",bW);a1.attachEvent("onload",bW);var b5=false;try{b5=a1.frameElement==null&&l.documentElement;}catch(b4){}if(b5&&b5.doScroll){(function b3(){if(!bI.isReady){try{b5.doScroll("left");}catch(b7){return setTimeout(b3,50);}bk();bI.ready();}})();}}}}return ag.promise(b6);};bI.each("Boolean Number String Function Array Date RegExp Object Error".split(" "),function(b3,e){Y["[object "+e+"]"]=e.toLowerCase();});function Z(b4){var b3=b4.length,e=bI.type(b4);if(bI.isWindow(b4)){return false;}if(b4.nodeType===1&&b3){return true;}return e==="array"||e!=="function"&&(b3===0||typeof b3==="number"&&b3>0&&(b3-1) in b4);}w=bI(l);
/*
 * Sizzle CSS Selector Engine v1.10.2
 * http://sizzlejs.com/
 *
 * Copyright 2013 jQuery Foundation, Inc. and other contributors
 * Released under the MIT license
 * http://jquery.org/license
 *
 * Date: 2013-07-03
 */
(function(dc,ch){var cw,df,cc,cm,cF,cI,cT,dj,cG,cW,cA,cn,c5,c0,dd,cb,cD,c7="sizzle"+-(new Date()),cH=dc.document,dg=0,c1=0,b6=cy(),c6=cy(),cE=cy(),cU=false,cC=function(dk,e){if(dk===e){cU=true;return 0;}return 0;},db=typeof ch,cO=1<<31,cM=({}).hasOwnProperty,c9=[],da=c9.pop,cK=c9.push,b4=c9.push,cl=c9.slice,ca=c9.indexOf||function(dl){var dk=0,e=this.length;for(;dk<e;dk++){if(this[dk]===dl){return dk;}}return -1;},b5="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",co="[\\x20\\t\\r\\n\\f]",b3="(?:\\\\.|[\\w-]|[^\\x00-\\xa0])+",cJ=b3.replace("w","w#"),c3="\\["+co+"*("+b3+")"+co+"*(?:([*^$|!~]?=)"+co+"*(?:(['\"])((?:\\\\.|[^\\\\])*?)\\3|("+cJ+")|)|)"+co+"*\\]",cj=":("+b3+")(?:\\(((['\"])((?:\\\\.|[^\\\\])*?)\\3|((?:\\\\.|[^\\\\()[\\]]|"+c3.replace(3,8)+")*)|.*)\\)|)",cq=new RegExp("^"+co+"+|((?:^|[^\\\\])(?:\\\\.)*)"+co+"+$","g"),ct=new RegExp("^"+co+"*,"+co+"*"),cz=new RegExp("^"+co+"*([>+~]|"+co+")"+co+"*"),cY=new RegExp(co+"*[+~]"),cs=new RegExp("="+co+"*([^\\]'\"]*)"+co+"*\\]","g"),cQ=new RegExp(cj),cR=new RegExp("^"+cJ+"$"),cZ={ID:new RegExp("^#("+b3+")"),CLASS:new RegExp("^\\.("+b3+")"),TAG:new RegExp("^("+b3.replace("w","w*")+")"),ATTR:new RegExp("^"+c3),PSEUDO:new RegExp("^"+cj),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+co+"*(even|odd|(([+-]|)(\\d*)n|)"+co+"*(?:([+-]|)"+co+"*(\\d+)|))"+co+"*\\)|)","i"),bool:new RegExp("^(?:"+b5+")$","i"),needsContext:new RegExp("^"+co+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+co+"*((?:-\\d)?\\d*)"+co+"*\\)|)(?=[^-]|$)","i")},cN=/^[^{]+\{\s*\[native \w/,cP=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,b9=/^(?:input|select|textarea|button)$/i,ck=/^h\d$/i,cL=/'|\\/g,cr=new RegExp("\\\\([\\da-f]{1,6}"+co+"?|("+co+")|.)","ig"),c2=function(e,dm,dk){var dl="0x"+dm-65536;return dl!==dl||dk?dm:dl<0?String.fromCharCode(dl+65536):String.fromCharCode(dl>>10|55296,dl&1023|56320);};try{b4.apply((c9=cl.call(cH.childNodes)),cH.childNodes);c9[cH.childNodes.length].nodeType;}catch(cB){b4={apply:c9.length?function(dk,e){cK.apply(dk,cl.call(e));}:function(dm,dl){var e=dm.length,dk=0;while((dm[e++]=dl[dk++])){}dm.length=e-1;}};}function cu(ds,dk,dw,dy){var dx,dp,dq,du,dv,dn,dm,e,dl,dt;if((dk?dk.ownerDocument||dk:cH)!==cA){cW(dk);}dk=dk||cA;dw=dw||[];if(!ds||typeof ds!=="string"){return dw;}if((du=dk.nodeType)!==1&&du!==9){return[];}if(c5&&!dy){if((dx=cP.exec(ds))){if((dq=dx[1])){if(du===9){dp=dk.getElementById(dq);if(dp&&dp.parentNode){if(dp.id===dq){dw.push(dp);return dw;}}else{return dw;}}else{if(dk.ownerDocument&&(dp=dk.ownerDocument.getElementById(dq))&&cD(dk,dp)&&dp.id===dq){dw.push(dp);return dw;}}}else{if(dx[2]){b4.apply(dw,dk.getElementsByTagName(ds));return dw;}else{if((dq=dx[3])&&df.getElementsByClassName&&dk.getElementsByClassName){b4.apply(dw,dk.getElementsByClassName(dq));return dw;}}}}if(df.qsa&&(!c0||!c0.test(ds))){e=dm=c7;dl=dk;dt=du===9&&ds;if(du===1&&dk.nodeName.toLowerCase()!=="object"){dn=cf(ds);if((dm=dk.getAttribute("id"))){e=dm.replace(cL,"\\$&");}else{dk.setAttribute("id",e);}e="[id='"+e+"'] ";dv=dn.length;while(dv--){dn[dv]=e+cg(dn[dv]);}dl=cY.test(ds)&&dk.parentNode||dk;dt=dn.join(",");}if(dt){try{b4.apply(dw,dl.querySelectorAll(dt));return dw;}catch(dr){}finally{if(!dm){dk.removeAttribute("id");}}}}}return de(ds.replace(cq,"$1"),dk,dw,dy);}function cy(){var dk=[];function e(dl,dm){if(dk.push(dl+=" ")>cm.cacheLength){delete e[dk.shift()];}return(e[dl]=dm);}return e;}function ci(e){e[c7]=true;return e;}function cd(dk){var dm=cA.createElement("div");try{return !!dk(dm);}catch(dl){return false;}finally{if(dm.parentNode){dm.parentNode.removeChild(dm);}dm=null;}}function dh(dk,dm){var e=dk.split("|"),dl=dk.length;while(dl--){cm.attrHandle[e[dl]]=dm;}}function b7(dk,e){var dm=e&&dk,dl=dm&&dk.nodeType===1&&e.nodeType===1&&(~e.sourceIndex||cO)-(~dk.sourceIndex||cO);if(dl){return dl;}if(dm){while((dm=dm.nextSibling)){if(dm===e){return -1;}}}return dk?1:-1;}function cv(e){return function(dl){var dk=dl.nodeName.toLowerCase();return dk==="input"&&dl.type===e;};}function b8(e){return function(dl){var dk=dl.nodeName.toLowerCase();return(dk==="input"||dk==="button")&&dl.type===e;};}function c4(e){return ci(function(dk){dk=+dk;return ci(function(dl,dq){var dn,dm=e([],dl.length,dk),dp=dm.length;while(dp--){if(dl[(dn=dm[dp])]){dl[dn]=!(dq[dn]=dl[dn]);}}});});}cI=cu.isXML=function(e){var dk=e&&(e.ownerDocument||e).documentElement;return dk?dk.nodeName!=="HTML":false;};df=cu.support={};cW=cu.setDocument=function(dk){var dl=dk?dk.ownerDocument||dk:cH,e=dl.defaultView;if(dl===cA||dl.nodeType!==9||!dl.documentElement){return cA;}cA=dl;cn=dl.documentElement;c5=!cI(dl);if(e&&e.attachEvent&&e!==e.top){e.attachEvent("onbeforeunload",function(){cW();});}df.attributes=cd(function(dm){dm.className="i";return !dm.getAttribute("className");});df.getElementsByTagName=cd(function(dm){dm.appendChild(dl.createComment(""));return !dm.getElementsByTagName("*").length;});df.getElementsByClassName=cd(function(dm){dm.innerHTML="<div class='a'></div><div class='a i'></div>";dm.firstChild.className="i";return dm.getElementsByClassName("i").length===2;});df.getById=cd(function(dm){cn.appendChild(dm).id=c7;return !dl.getElementsByName||!dl.getElementsByName(c7).length;});if(df.getById){cm.find.ID=function(dp,dn){if(typeof dn.getElementById!==db&&c5){var dm=dn.getElementById(dp);return dm&&dm.parentNode?[dm]:[];}};cm.filter.ID=function(dn){var dm=dn.replace(cr,c2);return function(dp){return dp.getAttribute("id")===dm;};};}else{delete cm.find.ID;cm.filter.ID=function(dn){var dm=dn.replace(cr,c2);return function(dq){var dp=typeof dq.getAttributeNode!==db&&dq.getAttributeNode("id");return dp&&dp.value===dm;};};}cm.find.TAG=df.getElementsByTagName?function(dm,dn){if(typeof dn.getElementsByTagName!==db){return dn.getElementsByTagName(dm);}}:function(dm,dr){var ds,dq=[],dp=0,dn=dr.getElementsByTagName(dm);if(dm==="*"){while((ds=dn[dp++])){if(ds.nodeType===1){dq.push(ds);}}return dq;}return dn;};cm.find.CLASS=df.getElementsByClassName&&function(dn,dm){if(typeof dm.getElementsByClassName!==db&&c5){return dm.getElementsByClassName(dn);}};dd=[];c0=[];if((df.qsa=cN.test(dl.querySelectorAll))){cd(function(dm){dm.innerHTML="<select><option selected=''></option></select>";if(!dm.querySelectorAll("[selected]").length){c0.push("\\["+co+"*(?:value|"+b5+")");}if(!dm.querySelectorAll(":checked").length){c0.push(":checked");}});cd(function(dn){var dm=dl.createElement("input");dm.setAttribute("type","hidden");dn.appendChild(dm).setAttribute("t","");if(dn.querySelectorAll("[t^='']").length){c0.push("[*^$]="+co+"*(?:''|\"\")");}if(!dn.querySelectorAll(":enabled").length){c0.push(":enabled",":disabled");}dn.querySelectorAll("*,:x");c0.push(",.*:");});}if((df.matchesSelector=cN.test((cb=cn.webkitMatchesSelector||cn.mozMatchesSelector||cn.oMatchesSelector||cn.msMatchesSelector)))){cd(function(dm){df.disconnectedMatch=cb.call(dm,"div");cb.call(dm,"[s!='']:x");dd.push("!=",cj);});}c0=c0.length&&new RegExp(c0.join("|"));dd=dd.length&&new RegExp(dd.join("|"));cD=cN.test(cn.contains)||cn.compareDocumentPosition?function(dn,dm){var dq=dn.nodeType===9?dn.documentElement:dn,dp=dm&&dm.parentNode;return dn===dp||!!(dp&&dp.nodeType===1&&(dq.contains?dq.contains(dp):dn.compareDocumentPosition&&dn.compareDocumentPosition(dp)&16));}:function(dn,dm){if(dm){while((dm=dm.parentNode)){if(dm===dn){return true;}}}return false;};cC=cn.compareDocumentPosition?function(dn,dm){if(dn===dm){cU=true;return 0;}var dp=dm.compareDocumentPosition&&dn.compareDocumentPosition&&dn.compareDocumentPosition(dm);if(dp){if(dp&1||(!df.sortDetached&&dm.compareDocumentPosition(dn)===dp)){if(dn===dl||cD(cH,dn)){return -1;}if(dm===dl||cD(cH,dm)){return 1;}return cG?(ca.call(cG,dn)-ca.call(cG,dm)):0;}return dp&4?-1:1;}return dn.compareDocumentPosition?-1:1;}:function(dn,dm){var du,dr=0,dt=dn.parentNode,dq=dm.parentNode,dp=[dn],ds=[dm];if(dn===dm){cU=true;return 0;}else{if(!dt||!dq){return dn===dl?-1:dm===dl?1:dt?-1:dq?1:cG?(ca.call(cG,dn)-ca.call(cG,dm)):0;}else{if(dt===dq){return b7(dn,dm);}}}du=dn;while((du=du.parentNode)){dp.unshift(du);}du=dm;while((du=du.parentNode)){ds.unshift(du);}while(dp[dr]===ds[dr]){dr++;}return dr?b7(dp[dr],ds[dr]):dp[dr]===cH?-1:ds[dr]===cH?1:0;};return dl;};cu.matches=function(dk,e){return cu(dk,null,null,e);};cu.matchesSelector=function(dl,dn){if((dl.ownerDocument||dl)!==cA){cW(dl);}dn=dn.replace(cs,"='$1']");if(df.matchesSelector&&c5&&(!dd||!dd.test(dn))&&(!c0||!c0.test(dn))){try{var dk=cb.call(dl,dn);if(dk||df.disconnectedMatch||dl.document&&dl.document.nodeType!==11){return dk;}}catch(dm){}}return cu(dn,cA,null,[dl]).length>0;};cu.contains=function(e,dk){if((e.ownerDocument||e)!==cA){cW(e);}return cD(e,dk);};cu.attr=function(dl,e){if((dl.ownerDocument||dl)!==cA){cW(dl);}var dk=cm.attrHandle[e.toLowerCase()],dm=dk&&cM.call(cm.attrHandle,e.toLowerCase())?dk(dl,e,!c5):ch;return dm===ch?df.attributes||!c5?dl.getAttribute(e):(dm=dl.getAttributeNode(e))&&dm.specified?dm.value:null:dm;};cu.error=function(e){throw new Error("Syntax error, unrecognized expression: "+e);};cu.uniqueSort=function(dl){var dm,dn=[],e=0,dk=0;cU=!df.detectDuplicates;cG=!df.sortStable&&dl.slice(0);dl.sort(cC);if(cU){while((dm=dl[dk++])){if(dm===dl[dk]){e=dn.push(dk);}}while(e--){dl.splice(dn[e],1);}}return dl;};cF=cu.getText=function(dn){var dm,dk="",dl=0,e=dn.nodeType;if(!e){for(;(dm=dn[dl]);dl++){dk+=cF(dm);}}else{if(e===1||e===9||e===11){if(typeof dn.textContent==="string"){return dn.textContent;}else{for(dn=dn.firstChild;dn;dn=dn.nextSibling){dk+=cF(dn);}}}else{if(e===3||e===4){return dn.nodeValue;}}}return dk;};cm=cu.selectors={cacheLength:50,createPseudo:ci,match:cZ,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:true}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:true},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(e){e[1]=e[1].replace(cr,c2);e[3]=(e[4]||e[5]||"").replace(cr,c2);if(e[2]==="~="){e[3]=" "+e[3]+" ";}return e.slice(0,4);},CHILD:function(e){e[1]=e[1].toLowerCase();if(e[1].slice(0,3)==="nth"){if(!e[3]){cu.error(e[0]);}e[4]=+(e[4]?e[5]+(e[6]||1):2*(e[3]==="even"||e[3]==="odd"));e[5]=+((e[7]+e[8])||e[3]==="odd");}else{if(e[3]){cu.error(e[0]);}}return e;},PSEUDO:function(dk){var e,dl=!dk[5]&&dk[2];if(cZ.CHILD.test(dk[0])){return null;}if(dk[3]&&dk[4]!==ch){dk[2]=dk[4];}else{if(dl&&cQ.test(dl)&&(e=cf(dl,true))&&(e=dl.indexOf(")",dl.length-e)-dl.length)){dk[0]=dk[0].slice(0,e);dk[2]=dl.slice(0,e);}}return dk.slice(0,3);}},filter:{TAG:function(dk){var e=dk.replace(cr,c2).toLowerCase();return dk==="*"?function(){return true;}:function(dl){return dl.nodeName&&dl.nodeName.toLowerCase()===e;};},CLASS:function(e){var dk=b6[e+" "];return dk||(dk=new RegExp("(^|"+co+")"+e+"("+co+"|$)"))&&b6(e,function(dl){return dk.test(typeof dl.className==="string"&&dl.className||typeof dl.getAttribute!==db&&dl.getAttribute("class")||"");});},ATTR:function(dl,dk,e){return function(dn){var dm=cu.attr(dn,dl);if(dm==null){return dk==="!=";}if(!dk){return true;}dm+="";return dk==="="?dm===e:dk==="!="?dm!==e:dk==="^="?e&&dm.indexOf(e)===0:dk==="*="?e&&dm.indexOf(e)>-1:dk==="$="?e&&dm.slice(-e.length)===e:dk==="~="?(" "+dm+" ").indexOf(e)>-1:dk==="|="?dm===e||dm.slice(0,e.length+1)===e+"-":false;};},CHILD:function(dk,dn,dm,dp,dl){var dr=dk.slice(0,3)!=="nth",e=dk.slice(-4)!=="last",dq=dn==="of-type";return dp===1&&dl===0?function(ds){return !!ds.parentNode;}:function(dy,dw,dB){var ds,dE,dz,dD,dA,dv,dx=dr!==e?"nextSibling":"previousSibling",dC=dy.parentNode,du=dq&&dy.nodeName.toLowerCase(),dt=!dB&&!dq;if(dC){if(dr){while(dx){dz=dy;while((dz=dz[dx])){if(dq?dz.nodeName.toLowerCase()===du:dz.nodeType===1){return false;}}dv=dx=dk==="only"&&!dv&&"nextSibling";}return true;}dv=[e?dC.firstChild:dC.lastChild];if(e&&dt){dE=dC[c7]||(dC[c7]={});ds=dE[dk]||[];dA=ds[0]===dg&&ds[1];dD=ds[0]===dg&&ds[2];dz=dA&&dC.childNodes[dA];while((dz=++dA&&dz&&dz[dx]||(dD=dA=0)||dv.pop())){if(dz.nodeType===1&&++dD&&dz===dy){dE[dk]=[dg,dA,dD];break;}}}else{if(dt&&(ds=(dy[c7]||(dy[c7]={}))[dk])&&ds[0]===dg){dD=ds[1];}else{while((dz=++dA&&dz&&dz[dx]||(dD=dA=0)||dv.pop())){if((dq?dz.nodeName.toLowerCase()===du:dz.nodeType===1)&&++dD){if(dt){(dz[c7]||(dz[c7]={}))[dk]=[dg,dD];}if(dz===dy){break;}}}}}dD-=dl;return dD===dp||(dD%dp===0&&dD/dp>=0);}};},PSEUDO:function(dm,dl){var e,dk=cm.pseudos[dm]||cm.setFilters[dm.toLowerCase()]||cu.error("unsupported pseudo: "+dm);if(dk[c7]){return dk(dl);}if(dk.length>1){e=[dm,dm,"",dl];return cm.setFilters.hasOwnProperty(dm.toLowerCase())?ci(function(dq,ds){var dp,dn=dk(dq,dl),dr=dn.length;while(dr--){dp=ca.call(dq,dn[dr]);dq[dp]=!(ds[dp]=dn[dr]);}}):function(dn){return dk(dn,0,e);};}return dk;}},pseudos:{not:ci(function(e){var dk=[],dl=[],dm=cT(e.replace(cq,"$1"));return dm[c7]?ci(function(dp,du,ds,dq){var dt,dn=dm(dp,null,dq,[]),dr=dp.length;while(dr--){if((dt=dn[dr])){dp[dr]=!(du[dr]=dt);}}}):function(dq,dp,dn){dk[0]=dq;dm(dk,null,dn,dl);return !dl.pop();};}),has:ci(function(e){return function(dk){return cu(e,dk).length>0;};}),contains:ci(function(e){return function(dk){return(dk.textContent||dk.innerText||cF(dk)).indexOf(e)>-1;};}),lang:ci(function(e){if(!cR.test(e||"")){cu.error("unsupported lang: "+e);}e=e.replace(cr,c2).toLowerCase();return function(dl){var dk;do{if((dk=c5?dl.lang:dl.getAttribute("xml:lang")||dl.getAttribute("lang"))){dk=dk.toLowerCase();return dk===e||dk.indexOf(e+"-")===0;}}while((dl=dl.parentNode)&&dl.nodeType===1);return false;};}),target:function(e){var dk=dc.location&&dc.location.hash;return dk&&dk.slice(1)===e.id;},root:function(e){return e===cn;},focus:function(e){return e===cA.activeElement&&(!cA.hasFocus||cA.hasFocus())&&!!(e.type||e.href||~e.tabIndex);},enabled:function(e){return e.disabled===false;},disabled:function(e){return e.disabled===true;},checked:function(e){var dk=e.nodeName.toLowerCase();return(dk==="input"&&!!e.checked)||(dk==="option"&&!!e.selected);},selected:function(e){if(e.parentNode){e.parentNode.selectedIndex;}return e.selected===true;},empty:function(e){for(e=e.firstChild;e;e=e.nextSibling){if(e.nodeName>"@"||e.nodeType===3||e.nodeType===4){return false;}}return true;},parent:function(e){return !cm.pseudos.empty(e);},header:function(e){return ck.test(e.nodeName);},input:function(e){return b9.test(e.nodeName);},button:function(dk){var e=dk.nodeName.toLowerCase();return e==="input"&&dk.type==="button"||e==="button";},text:function(dk){var e;return dk.nodeName.toLowerCase()==="input"&&dk.type==="text"&&((e=dk.getAttribute("type"))==null||e.toLowerCase()===dk.type);},first:c4(function(){return[0];}),last:c4(function(e,dk){return[dk-1];}),eq:c4(function(e,dl,dk){return[dk<0?dk+dl:dk];}),even:c4(function(e,dl){var dk=0;for(;dk<dl;dk+=2){e.push(dk);}return e;}),odd:c4(function(e,dl){var dk=1;for(;dk<dl;dk+=2){e.push(dk);}return e;}),lt:c4(function(e,dm,dl){var dk=dl<0?dl+dm:dl;for(;--dk>=0;){e.push(dk);}return e;}),gt:c4(function(e,dm,dl){var dk=dl<0?dl+dm:dl;for(;++dk<dm;){e.push(dk);}return e;})}};cm.pseudos.nth=cm.pseudos.eq;for(cw in {radio:true,checkbox:true,file:true,password:true,image:true}){cm.pseudos[cw]=cv(cw);}for(cw in {submit:true,reset:true}){cm.pseudos[cw]=b8(cw);}function cS(){}cS.prototype=cm.filters=cm.pseudos;cm.setFilters=new cS();function cf(dn,dt){var dk,dp,dr,ds,dq,dl,e,dm=c6[dn+" "];if(dm){return dt?0:dm.slice(0);}dq=dn;dl=[];e=cm.preFilter;while(dq){if(!dk||(dp=ct.exec(dq))){if(dp){dq=dq.slice(dp[0].length)||dq;}dl.push(dr=[]);}dk=false;if((dp=cz.exec(dq))){dk=dp.shift();dr.push({value:dk,type:dp[0].replace(cq," ")});dq=dq.slice(dk.length);}for(ds in cm.filter){if((dp=cZ[ds].exec(dq))&&(!e[ds]||(dp=e[ds](dp)))){dk=dp.shift();dr.push({value:dk,type:ds,matches:dp});dq=dq.slice(dk.length);}}if(!dk){break;}}return dt?dq.length:dq?cu.error(dn):c6(dn,dl).slice(0);}function cg(dm){var dl=0,dk=dm.length,e="";for(;dl<dk;dl++){e+=dm[dl].value;}return e;}function cp(dn,dl,dm){var e=dl.dir,dp=dm&&e==="parentNode",dk=c1++;return dl.first?function(ds,dr,dq){while((ds=ds[e])){if(ds.nodeType===1||dp){return dn(ds,dr,dq);}}}:function(du,ds,dr){var dw,dq,dt,dv=dg+" "+dk;if(dr){while((du=du[e])){if(du.nodeType===1||dp){if(dn(du,ds,dr)){return true;}}}}else{while((du=du[e])){if(du.nodeType===1||dp){dt=du[c7]||(du[c7]={});if((dq=dt[e])&&dq[0]===dv){if((dw=dq[1])===true||dw===cc){return dw===true;}}else{dq=dt[e]=[dv];dq[1]=dn(du,ds,dr)||cc;if(dq[1]===true){return true;}}}}}};}function di(e){return e.length>1?function(dn,dm,dk){var dl=e.length;while(dl--){if(!e[dl](dn,dm,dk)){return false;}}return true;}:e[0];}function cX(e,dk,dl,dm,dq){var dn,dt=[],dp=0,dr=e.length,ds=dk!=null;for(;dp<dr;dp++){if((dn=e[dp])){if(!dl||dl(dn,dm,dq)){dt.push(dn);if(ds){dk.push(dp);}}}}return dt;}function ce(dl,dk,dn,dm,dp,e){if(dm&&!dm[c7]){dm=ce(dm);}if(dp&&!dp[c7]){dp=ce(dp,e);}return ci(function(dA,dx,ds,dz){var dC,dy,du,dt=[],dB=[],dr=dx.length,dq=dA||cx(dk||"*",ds.nodeType?[ds]:ds,[]),dv=dl&&(dA||!dk)?cX(dq,dt,dl,ds,dz):dq,dw=dn?dp||(dA?dl:dr||dm)?[]:dx:dv;if(dn){dn(dv,dw,ds,dz);}if(dm){dC=cX(dw,dB);dm(dC,[],ds,dz);dy=dC.length;while(dy--){if((du=dC[dy])){dw[dB[dy]]=!(dv[dB[dy]]=du);}}}if(dA){if(dp||dl){if(dp){dC=[];dy=dw.length;while(dy--){if((du=dw[dy])){dC.push((dv[dy]=du));}}dp(null,(dw=[]),dC,dz);}dy=dw.length;while(dy--){if((du=dw[dy])&&(dC=dp?ca.call(dA,du):dt[dy])>-1){dA[dC]=!(dx[dC]=du);}}}}else{dw=cX(dw===dx?dw.splice(dr,dw.length):dw);if(dp){dp(null,dx,dw,dz);}else{b4.apply(dx,dw);}}});}function c8(dq){var dk,dn,dl,dp=dq.length,dt=cm.relative[dq[0].type],du=dt||cm.relative[" "],dm=dt?1:0,dr=cp(function(dv){return dv===dk;},du,true),ds=cp(function(dv){return ca.call(dk,dv)>-1;},du,true),e=[function(dx,dw,dv){return(!dt&&(dv||dw!==dj))||((dk=dw).nodeType?dr(dx,dw,dv):ds(dx,dw,dv));}];for(;dm<dp;dm++){if((dn=cm.relative[dq[dm].type])){e=[cp(di(e),dn)];}else{dn=cm.filter[dq[dm].type].apply(null,dq[dm].matches);if(dn[c7]){dl=++dm;for(;dl<dp;dl++){if(cm.relative[dq[dl].type]){break;}}return ce(dm>1&&di(e),dm>1&&cg(dq.slice(0,dm-1).concat({value:dq[dm-2].type===" "?"*":""})).replace(cq,"$1"),dn,dm<dl&&c8(dq.slice(dm,dl)),dl<dp&&c8((dq=dq.slice(dl))),dl<dp&&cg(dq));}e.push(dn);}}return di(e);}function cV(dm,dl){var dp=0,e=dl.length>0,dn=dm.length>0,dk=function(dz,dt,dy,dx,dF){var du,dv,dA,dE=[],dD=0,dw="0",dq=dz&&[],dB=dF!=null,dC=dj,ds=dz||dn&&cm.find.TAG("*",dF&&dt.parentNode||dt),dr=(dg+=dC==null?1:Math.random()||0.1);if(dB){dj=dt!==cA&&dt;cc=dp;}for(;(du=ds[dw])!=null;dw++){if(dn&&du){dv=0;while((dA=dm[dv++])){if(dA(du,dt,dy)){dx.push(du);break;}}if(dB){dg=dr;cc=++dp;}}if(e){if((du=!dA&&du)){dD--;}if(dz){dq.push(du);}}}dD+=dw;if(e&&dw!==dD){dv=0;while((dA=dl[dv++])){dA(dq,dE,dt,dy);}if(dz){if(dD>0){while(dw--){if(!(dq[dw]||dE[dw])){dE[dw]=da.call(dx);}}}dE=cX(dE);}b4.apply(dx,dE);if(dB&&!dz&&dE.length>0&&(dD+dl.length)>1){cu.uniqueSort(dx);}}if(dB){dg=dr;dj=dC;}return dq;};return e?ci(dk):dk;}cT=cu.compile=function(e,dp){var dl,dk=[],dn=[],dm=cE[e+" "];if(!dm){if(!dp){dp=cf(e);}dl=dp.length;while(dl--){dm=c8(dp[dl]);if(dm[c7]){dk.push(dm);}else{dn.push(dm);}}dm=cE(e,cV(dn,dk));}return dm;};function cx(dk,dn,dm){var dl=0,e=dn.length;for(;dl<e;dl++){cu(dk,dn[dl],dm);}return dm;}function de(dl,e,dm,dq){var dn,ds,dk,dt,dr,dp=cf(dl);if(!dq){if(dp.length===1){ds=dp[0]=dp[0].slice(0);if(ds.length>2&&(dk=ds[0]).type==="ID"&&df.getById&&e.nodeType===9&&c5&&cm.relative[ds[1].type]){e=(cm.find.ID(dk.matches[0].replace(cr,c2),e)||[])[0];if(!e){return dm;}dl=dl.slice(ds.shift().value.length);}dn=cZ.needsContext.test(dl)?0:ds.length;while(dn--){dk=ds[dn];if(cm.relative[(dt=dk.type)]){break;}if((dr=cm.find[dt])){if((dq=dr(dk.matches[0].replace(cr,c2),cY.test(ds[0].type)&&e.parentNode||e))){ds.splice(dn,1);dl=dq.length&&cg(ds);if(!dl){b4.apply(dm,dq);return dm;}break;}}}}}cT(dl,dp)(dq,e,!c5,dm,cY.test(dl));return dm;}df.sortStable=c7.split("").sort(cC).join("")===c7;df.detectDuplicates=cU;cW();df.sortDetached=cd(function(e){return e.compareDocumentPosition(cA.createElement("div"))&1;});if(!cd(function(e){e.innerHTML="<a href='#'></a>";return e.firstChild.getAttribute("href")==="#";})){dh("type|href|height|width",function(dk,e,dl){if(!dl){return dk.getAttribute(e,e.toLowerCase()==="type"?1:2);}});}if(!df.attributes||!cd(function(e){e.innerHTML="<input/>";e.firstChild.setAttribute("value","");return e.firstChild.getAttribute("value")==="";})){dh("value",function(dk,e,dl){if(!dl&&dk.nodeName.toLowerCase()==="input"){return dk.defaultValue;}});}if(!cd(function(e){return e.getAttribute("disabled")==null;})){dh(b5,function(dk,e,dm){var dl;if(!dm){return(dl=dk.getAttributeNode(e))&&dl.specified?dl.value:dk[e]===true?e.toLowerCase():null;}});}bI.find=cu;bI.expr=cu.selectors;bI.expr[":"]=bI.expr.pseudos;bI.unique=cu.uniqueSort;bI.text=cu.getText;bI.isXMLDoc=cu.isXML;bI.contains=cu.contains;})(a1);var bY={};function ac(b3){var e=bY[b3]={};bI.each(b3.match(aa)||[],function(b5,b4){e[b4]=true;});return e;}bI.Callbacks=function(cc){cc=typeof cc==="string"?(bY[cc]||ac(cc)):bI.extend({},cc);var b6,b5,e,b7,b8,b4,b9=[],ca=!cc.once&&[],b3=function(cd){b5=cc.memory&&cd;e=true;b8=b4||0;b4=0;b7=b9.length;b6=true;for(;b9&&b8<b7;b8++){if(b9[b8].apply(cd[0],cd[1])===false&&cc.stopOnFalse){b5=false;break;}}b6=false;if(b9){if(ca){if(ca.length){b3(ca.shift());}}else{if(b5){b9=[];}else{cb.disable();}}}},cb={add:function(){if(b9){var ce=b9.length;(function cd(cf){bI.each(cf,function(ch,cg){var ci=bI.type(cg);if(ci==="function"){if(!cc.unique||!cb.has(cg)){b9.push(cg);}}else{if(cg&&cg.length&&ci!=="string"){cd(cg);}}});})(arguments);if(b6){b7=b9.length;}else{if(b5){b4=ce;b3(b5);}}}return this;},remove:function(){if(b9){bI.each(arguments,function(cf,cd){var ce;while((ce=bI.inArray(cd,b9,ce))>-1){b9.splice(ce,1);if(b6){if(ce<=b7){b7--;}if(ce<=b8){b8--;}}}});}return this;},has:function(cd){return cd?bI.inArray(cd,b9)>-1:!!(b9&&b9.length);},empty:function(){b9=[];b7=0;return this;},disable:function(){b9=ca=b5=aE;return this;},disabled:function(){return !b9;},lock:function(){ca=aE;if(!b5){cb.disable();}return this;},locked:function(){return !ca;},fireWith:function(ce,cd){if(b9&&(!e||ca)){cd=cd||[];cd=[ce,cd.slice?cd.slice():cd];if(b6){ca.push(cd);}else{b3(cd);}}return this;},fire:function(){cb.fireWith(this,arguments);return this;},fired:function(){return !!e;}};return cb;};bI.extend({Deferred:function(b4){var b3=[["resolve","done",bI.Callbacks("once memory"),"resolved"],["reject","fail",bI.Callbacks("once memory"),"rejected"],["notify","progress",bI.Callbacks("memory")]],b5="pending",b6={state:function(){return b5;},always:function(){e.done(arguments).fail(arguments);return this;},then:function(){var b7=arguments;return bI.Deferred(function(b8){bI.each(b3,function(ca,b9){var cc=b9[0],cb=bI.isFunction(b7[ca])&&b7[ca];e[b9[1]](function(){var cd=cb&&cb.apply(this,arguments);if(cd&&bI.isFunction(cd.promise)){cd.promise().done(b8.resolve).fail(b8.reject).progress(b8.notify);}else{b8[cc+"With"](this===b6?b8.promise():this,cb?[cd]:arguments);}});});b7=null;}).promise();},promise:function(b7){return b7!=null?bI.extend(b7,b6):b6;}},e={};b6.pipe=b6.then;bI.each(b3,function(b8,b7){var ca=b7[2],b9=b7[3];b6[b7[1]]=ca.add;if(b9){ca.add(function(){b5=b9;},b3[b8^1][2].disable,b3[2][2].lock);}e[b7[0]]=function(){e[b7[0]+"With"](this===e?b6:this,arguments);return this;};e[b7[0]+"With"]=ca.fireWith;});b6.promise(e);if(b4){b4.call(e,e);}return e;},when:function(b6){var b4=0,b8=a3.call(arguments),e=b8.length,b3=e!==1||(b6&&bI.isFunction(b6.promise))?e:0,cb=b3===1?b6:bI.Deferred(),b5=function(cd,ce,cc){return function(cf){ce[cd]=this;cc[cd]=arguments.length>1?a3.call(arguments):cf;if(cc===ca){cb.notifyWith(ce,cc);}else{if(!(--b3)){cb.resolveWith(ce,cc);}}};},ca,b7,b9;if(e>1){ca=new Array(e);b7=new Array(e);b9=new Array(e);for(;b4<e;b4++){if(b8[b4]&&bI.isFunction(b8[b4].promise)){b8[b4].promise().done(b5(b4,b9,b8)).fail(cb.reject).progress(b5(b4,b7,ca));}else{--b3;}}}if(!b3){cb.resolveWith(b9,b8);}return cb.promise();}});bI.support=(function(ce){var cd,cb,ca,cc,b9,b5,b7,b4,b6,b3=l.createElement("div");b3.setAttribute("className","t");b3.innerHTML="  <link/><table></table><a href='/a'>a</a><input type='checkbox'/>";cd=b3.getElementsByTagName("*")||[];cb=b3.getElementsByTagName("a")[0];if(!cb||!cb.style||!cd.length){return ce;}cc=l.createElement("select");b5=cc.appendChild(l.createElement("option"));ca=b3.getElementsByTagName("input")[0];cb.style.cssText="top:1px;float:left;opacity:.5";ce.getSetAttribute=b3.className!=="t";ce.leadingWhitespace=b3.firstChild.nodeType===3;ce.tbody=!b3.getElementsByTagName("tbody").length;ce.htmlSerialize=!!b3.getElementsByTagName("link").length;ce.style=/top/.test(cb.getAttribute("style"));ce.hrefNormalized=cb.getAttribute("href")==="/a";ce.opacity=/^0.5/.test(cb.style.opacity);ce.cssFloat=!!cb.style.cssFloat;ce.checkOn=!!ca.value;ce.optSelected=b5.selected;ce.enctype=!!l.createElement("form").enctype;ce.html5Clone=l.createElement("nav").cloneNode(true).outerHTML!=="<:nav></:nav>";ce.inlineBlockNeedsLayout=false;ce.shrinkWrapBlocks=false;ce.pixelPosition=false;ce.deleteExpando=true;ce.noCloneEvent=true;ce.reliableMarginRight=true;ce.boxSizingReliable=true;ca.checked=true;ce.noCloneChecked=ca.cloneNode(true).checked;cc.disabled=true;ce.optDisabled=!b5.disabled;try{delete b3.test;}catch(b8){ce.deleteExpando=false;}ca=l.createElement("input");ca.setAttribute("value","");ce.input=ca.getAttribute("value")==="";ca.value="t";ca.setAttribute("type","radio");ce.radioValue=ca.value==="t";ca.setAttribute("checked","t");ca.setAttribute("name","t");b9=l.createDocumentFragment();b9.appendChild(ca);ce.appendChecked=ca.checked;ce.checkClone=b9.cloneNode(true).cloneNode(true).lastChild.checked;if(b3.attachEvent){b3.attachEvent("onclick",function(){ce.noCloneEvent=false;});b3.cloneNode(true).click();}for(b6 in {submit:true,change:true,focusin:true}){b3.setAttribute(b7="on"+b6,"t");ce[b6+"Bubbles"]=b7 in a1||b3.attributes[b7].expando===false;}b3.style.backgroundClip="content-box";b3.cloneNode(true).style.backgroundClip="";ce.clearCloneStyle=b3.style.backgroundClip==="content-box";for(b6 in bI(ce)){break;}ce.ownLast=b6!=="0";bI(function(){var cf,ci,ch,cg="padding:0;margin:0;border:0;display:block;box-sizing:content-box;-moz-box-sizing:content-box;-webkit-box-sizing:content-box;",e=l.getElementsByTagName("body")[0];if(!e){return;}cf=l.createElement("div");cf.style.cssText="border:0;width:0;height:0;position:absolute;top:0;left:-9999px;margin-top:1px";e.appendChild(cf).appendChild(b3);b3.innerHTML="<table><tr><td></td><td>t</td></tr></table>";ch=b3.getElementsByTagName("td");ch[0].style.cssText="padding:0;margin:0;border:0;display:none";b4=(ch[0].offsetHeight===0);ch[0].style.display="";ch[1].style.display="none";ce.reliableHiddenOffsets=b4&&(ch[0].offsetHeight===0);b3.innerHTML="";b3.style.cssText="box-sizing:border-box;-moz-box-sizing:border-box;-webkit-box-sizing:border-box;padding:1px;border:1px;display:block;width:4px;margin-top:1%;position:absolute;top:1%;";bI.swap(e,e.style.zoom!=null?{zoom:1}:{},function(){ce.boxSizing=b3.offsetWidth===4;});if(a1.getComputedStyle){ce.pixelPosition=(a1.getComputedStyle(b3,null)||{}).top!=="1%";ce.boxSizingReliable=(a1.getComputedStyle(b3,null)||{width:"4px"}).width==="4px";ci=b3.appendChild(l.createElement("div"));ci.style.cssText=b3.style.cssText=cg;ci.style.marginRight=ci.style.width="0";b3.style.width="1px";ce.reliableMarginRight=!parseFloat((a1.getComputedStyle(ci,null)||{}).marginRight);}if(typeof b3.style.zoom!==aA){b3.innerHTML="";b3.style.cssText=cg+"width:1px;padding:1px;display:inline;zoom:1";ce.inlineBlockNeedsLayout=(b3.offsetWidth===3);b3.style.display="block";b3.innerHTML="<div></div>";b3.firstChild.style.width="5px";ce.shrinkWrapBlocks=(b3.offsetWidth!==3);if(ce.inlineBlockNeedsLayout){e.style.zoom=1;}}e.removeChild(cf);cf=b3=ch=ci=null;});cd=cc=b9=b5=cb=ca=null;return ce;})({});var bv=/(?:\{[\s\S]*\}|\[[\s\S]*\])$/,aL=/([A-Z])/g;function a9(b5,b3,b7,b6){if(!bI.acceptData(b5)){return;}var b9,b8,ca=bI.expando,cb=b5.nodeType,e=cb?bI.cache:b5,b4=cb?b5[ca]:b5[ca]&&ca;if((!b4||!e[b4]||(!b6&&!e[b4].data))&&b7===aE&&typeof b3==="string"){return;}if(!b4){if(cb){b4=b5[ca]=a5.pop()||bI.guid++;}else{b4=ca;}}if(!e[b4]){e[b4]=cb?{}:{toJSON:bI.noop};}if(typeof b3==="object"||typeof b3==="function"){if(b6){e[b4]=bI.extend(e[b4],b3);}else{e[b4].data=bI.extend(e[b4].data,b3);}}b8=e[b4];if(!b6){if(!b8.data){b8.data={};}b8=b8.data;}if(b7!==aE){b8[bI.camelCase(b3)]=b7;}if(typeof b3==="string"){b9=b8[b3];if(b9==null){b9=b8[bI.camelCase(b3)];}}else{b9=b8;}return b9;}function X(b6,b4,e){if(!bI.acceptData(b6)){return;}var b8,b5,b7=b6.nodeType,b3=b7?bI.cache:b6,b9=b7?b6[bI.expando]:bI.expando;if(!b3[b9]){return;}if(b4){b8=e?b3[b9]:b3[b9].data;if(b8){if(!bI.isArray(b4)){if(b4 in b8){b4=[b4];}else{b4=bI.camelCase(b4);if(b4 in b8){b4=[b4];}else{b4=b4.split(" ");}}}else{b4=b4.concat(bI.map(b4,bI.camelCase));}b5=b4.length;while(b5--){delete b8[b4[b5]];}if(e?!L(b8):!bI.isEmptyObject(b8)){return;}}}if(!e){delete b3[b9].data;if(!L(b3[b9])){return;}}if(b7){bI.cleanData([b6],true);}else{if(bI.support.deleteExpando||b3!=b3.window){delete b3[b9];}else{b3[b9]=null;}}}bI.extend({cache:{},noData:{applet:true,embed:true,object:"clsid:D27CDB6E-AE6D-11cf-96B8-444553540000"},hasData:function(e){e=e.nodeType?bI.cache[e[bI.expando]]:e[bI.expando];return !!e&&!L(e);},data:function(b3,e,b4){return a9(b3,e,b4);},removeData:function(b3,e){return X(b3,e);},_data:function(b3,e,b4){return a9(b3,e,b4,true);},_removeData:function(b3,e){return X(b3,e,true);},acceptData:function(b3){if(b3.nodeType&&b3.nodeType!==1&&b3.nodeType!==9){return false;}var e=b3.nodeName&&bI.noData[b3.nodeName.toLowerCase()];return !e||e!==true&&b3.getAttribute("classid")===e;}});bI.fn.extend({data:function(b5,b8){var b3,e,b7=null,b4=0,b6=this[0];if(b5===aE){if(this.length){b7=bI.data(b6);if(b6.nodeType===1&&!bI._data(b6,"parsedAttrs")){b3=b6.attributes;for(;b4<b3.length;b4++){e=b3[b4].name;if(e.indexOf("data-")===0){e=bI.camelCase(e.slice(5));bx(b6,e,b7[e]);}}bI._data(b6,"parsedAttrs",true);}}return b7;}if(typeof b5==="object"){return this.each(function(){bI.data(this,b5);});}return arguments.length>1?this.each(function(){bI.data(this,b5,b8);}):b6?bx(b6,b5,bI.data(b6,b5)):null;},removeData:function(e){return this.each(function(){bI.removeData(this,e);});}});function bx(b5,b4,b6){if(b6===aE&&b5.nodeType===1){var b3="data-"+b4.replace(aL,"-$1").toLowerCase();b6=b5.getAttribute(b3);if(typeof b6==="string"){try{b6=b6==="true"?true:b6==="false"?false:b6==="null"?null:+b6+""===b6?+b6:bv.test(b6)?bI.parseJSON(b6):b6;}catch(b7){}bI.data(b5,b4,b6);}else{b6=aE;}}return b6;}function L(b3){var e;for(e in b3){if(e==="data"&&bI.isEmptyObject(b3[e])){continue;}if(e!=="toJSON"){return false;}}return true;}bI.extend({queue:function(b4,b3,b5){var e;if(b4){b3=(b3||"fx")+"queue";e=bI._data(b4,b3);if(b5){if(!e||bI.isArray(b5)){e=bI._data(b4,b3,bI.makeArray(b5));}else{e.push(b5);}}return e||[];}},dequeue:function(b7,b6){b6=b6||"fx";var b3=bI.queue(b7,b6),b8=b3.length,b5=b3.shift(),e=bI._queueHooks(b7,b6),b4=function(){bI.dequeue(b7,b6);};if(b5==="inprogress"){b5=b3.shift();b8--;}if(b5){if(b6==="fx"){b3.unshift("inprogress");}delete e.stop;b5.call(b7,b4,e);}if(!b8&&e){e.empty.fire();}},_queueHooks:function(b4,b3){var e=b3+"queueHooks";return bI._data(b4,e)||bI._data(b4,e,{empty:bI.Callbacks("once memory").add(function(){bI._removeData(b4,b3+"queue");bI._removeData(b4,e);})});}});bI.fn.extend({queue:function(e,b3){var b4=2;if(typeof e!=="string"){b3=e;e="fx";b4--;}if(arguments.length<b4){return bI.queue(this[0],e);}return b3===aE?this:this.each(function(){var b5=bI.queue(this,e,b3);bI._queueHooks(this,e);if(e==="fx"&&b5[0]!=="inprogress"){bI.dequeue(this,e);}});},dequeue:function(e){return this.each(function(){bI.dequeue(this,e);});},delay:function(b3,e){b3=bI.fx?bI.fx.speeds[b3]||b3:b3;e=e||"fx";return this.queue(e,function(b5,b4){var b6=setTimeout(b5,b3);b4.stop=function(){clearTimeout(b6);};});},clearQueue:function(e){return this.queue(e||"fx",[]);},promise:function(b4,b8){var b3,b5=1,b9=bI.Deferred(),b7=this,e=this.length,b6=function(){if(!(--b5)){b9.resolveWith(b7,[b7]);}};if(typeof b4!=="string"){b8=b4;b4=aE;}b4=b4||"fx";while(e--){b3=bI._data(b7[e],b4+"queueHooks");if(b3&&b3.empty){b5++;b3.empty.add(b6);}}b6();return b9.promise(b8);}});var a7,bZ,bL=/[\t\r\n\f]/g,ah=/\r/g,aD=/^(?:input|select|textarea|button|object)$/i,C=/^(?:a|area)$/i,ao=/^(?:checked|selected)$/i,bO=bI.support.getSetAttribute,bE=bI.support.input;bI.fn.extend({attr:function(e,b3){return bI.access(this,bI.attr,e,b3,arguments.length>1);},removeAttr:function(e){return this.each(function(){bI.removeAttr(this,e);});},prop:function(e,b3){return bI.access(this,bI.prop,e,b3,arguments.length>1);},removeProp:function(e){e=bI.propFix[e]||e;return this.each(function(){try{this[e]=aE;delete this[e];}catch(b3){}});},addClass:function(b9){var b3,e,ca,b6,b4,b5=0,b7=this.length,b8=typeof b9==="string"&&b9;if(bI.isFunction(b9)){return this.each(function(cb){bI(this).addClass(b9.call(this,cb,this.className));});}if(b8){b3=(b9||"").match(aa)||[];for(;b5<b7;b5++){e=this[b5];ca=e.nodeType===1&&(e.className?(" "+e.className+" ").replace(bL," "):" ");if(ca){b4=0;while((b6=b3[b4++])){if(ca.indexOf(" "+b6+" ")<0){ca+=b6+" ";}}e.className=bI.trim(ca);}}}return this;},removeClass:function(b9){var b3,e,ca,b6,b4,b5=0,b7=this.length,b8=arguments.length===0||typeof b9==="string"&&b9;if(bI.isFunction(b9)){return this.each(function(cb){bI(this).removeClass(b9.call(this,cb,this.className));});}if(b8){b3=(b9||"").match(aa)||[];for(;b5<b7;b5++){e=this[b5];ca=e.nodeType===1&&(e.className?(" "+e.className+" ").replace(bL," "):"");if(ca){b4=0;while((b6=b3[b4++])){while(ca.indexOf(" "+b6+" ")>=0){ca=ca.replace(" "+b6+" "," ");}}e.className=b9?bI.trim(ca):"";}}}return this;},toggleClass:function(b4,e){var b3=typeof b4;if(typeof e==="boolean"&&b3==="string"){return e?this.addClass(b4):this.removeClass(b4);}if(bI.isFunction(b4)){return this.each(function(b5){bI(this).toggleClass(b4.call(this,b5,this.className,e),e);});}return this.each(function(){if(b3==="string"){var b7,b6=0,b5=bI(this),b8=b4.match(aa)||[];while((b7=b8[b6++])){if(b5.hasClass(b7)){b5.removeClass(b7);}else{b5.addClass(b7);}}}else{if(b3===aA||b3==="boolean"){if(this.className){bI._data(this,"__className__",this.className);}this.className=this.className||b4===false?"":bI._data(this,"__className__")||"";}}});},hasClass:function(e){var b5=" "+e+" ",b4=0,b3=this.length;for(;b4<b3;b4++){if(this[b4].nodeType===1&&(" "+this[b4].className+" ").replace(bL," ").indexOf(b5)>=0){return true;}}return false;},val:function(b5){var b3,e,b6,b4=this[0];if(!arguments.length){if(b4){e=bI.valHooks[b4.type]||bI.valHooks[b4.nodeName.toLowerCase()];if(e&&"get" in e&&(b3=e.get(b4,"value"))!==aE){return b3;}b3=b4.value;return typeof b3==="string"?b3.replace(ah,""):b3==null?"":b3;}return;}b6=bI.isFunction(b5);return this.each(function(b7){var b8;if(this.nodeType!==1){return;}if(b6){b8=b5.call(this,b7,bI(this).val());}else{b8=b5;}if(b8==null){b8="";}else{if(typeof b8==="number"){b8+="";}else{if(bI.isArray(b8)){b8=bI.map(b8,function(b9){return b9==null?"":b9+"";});}}}e=bI.valHooks[this.type]||bI.valHooks[this.nodeName.toLowerCase()];if(!e||!("set" in e)||e.set(this,b8,"value")===aE){this.value=b8;}});}});bI.extend({valHooks:{option:{get:function(e){var b3=bI.find.attr(e,"value");return b3!=null?b3:e.text;}},select:{get:function(e){var b8,b4,ca=e.options,b6=e.selectedIndex,b5=e.type==="select-one"||b6<0,b9=b5?null:[],b7=b5?b6+1:ca.length,b3=b6<0?b7:b5?b6:0;for(;b3<b7;b3++){b4=ca[b3];if((b4.selected||b3===b6)&&(bI.support.optDisabled?!b4.disabled:b4.getAttribute("disabled")===null)&&(!b4.parentNode.disabled||!bI.nodeName(b4.parentNode,"optgroup"))){b8=bI(b4).val();if(b5){return b8;}b9.push(b8);}}return b9;},set:function(b6,b7){var b8,b5,b3=b6.options,e=bI.makeArray(b7),b4=b3.length;while(b4--){b5=b3[b4];if((b5.selected=bI.inArray(bI(b5).val(),e)>=0)){b8=true;}}if(!b8){b6.selectedIndex=-1;}return e;}}},attr:function(b6,b5,b7){var e,b4,b3=b6.nodeType;if(!b6||b3===3||b3===8||b3===2){return;}if(typeof b6.getAttribute===aA){return bI.prop(b6,b5,b7);}if(b3!==1||!bI.isXMLDoc(b6)){b5=b5.toLowerCase();e=bI.attrHooks[b5]||(bI.expr.match.bool.test(b5)?bZ:a7);}if(b7!==aE){if(b7===null){bI.removeAttr(b6,b5);}else{if(e&&"set" in e&&(b4=e.set(b6,b7,b5))!==aE){return b4;}else{b6.setAttribute(b5,b7+"");return b7;}}}else{if(e&&"get" in e&&(b4=e.get(b6,b5))!==null){return b4;}else{b4=bI.find.attr(b6,b5);return b4==null?aE:b4;}}},removeAttr:function(b4,b6){var e,b5,b3=0,b7=b6&&b6.match(aa);if(b7&&b4.nodeType===1){while((e=b7[b3++])){b5=bI.propFix[e]||e;if(bI.expr.match.bool.test(e)){if(bE&&bO||!ao.test(e)){b4[b5]=false;}else{b4[bI.camelCase("default-"+e)]=b4[b5]=false;}}else{bI.attr(b4,e,"");}b4.removeAttribute(bO?e:b5);}}},attrHooks:{type:{set:function(e,b3){if(!bI.support.radioValue&&b3==="radio"&&bI.nodeName(e,"input")){var b4=e.value;e.setAttribute("type",b3);if(b4){e.value=b4;}return b3;}}}},propFix:{"for":"htmlFor","class":"className"},prop:function(b7,b5,b8){var b4,e,b6,b3=b7.nodeType;if(!b7||b3===3||b3===8||b3===2){return;}b6=b3!==1||!bI.isXMLDoc(b7);if(b6){b5=bI.propFix[b5]||b5;e=bI.propHooks[b5];}if(b8!==aE){return e&&"set" in e&&(b4=e.set(b7,b8,b5))!==aE?b4:(b7[b5]=b8);}else{return e&&"get" in e&&(b4=e.get(b7,b5))!==null?b4:b7[b5];}},propHooks:{tabIndex:{get:function(b3){var e=bI.find.attr(b3,"tabindex");return e?parseInt(e,10):aD.test(b3.nodeName)||C.test(b3.nodeName)&&b3.href?0:-1;}}}});bZ={set:function(b3,b4,e){if(b4===false){bI.removeAttr(b3,e);}else{if(bE&&bO||!ao.test(e)){b3.setAttribute(!bO&&bI.propFix[e]||e,e);}else{b3[bI.camelCase("default-"+e)]=b3[e]=true;}}return e;}};bI.each(bI.expr.match.bool.source.match(/\w+/g),function(b4,b3){var e=bI.expr.attrHandle[b3]||bI.find.attr;bI.expr.attrHandle[b3]=bE&&bO||!ao.test(b3)?function(b8,b6,b9){var b7=bI.expr.attrHandle[b6],b5=b9?aE:(bI.expr.attrHandle[b6]=aE)!=e(b8,b6,b9)?b6.toLowerCase():null;bI.expr.attrHandle[b6]=b7;return b5;}:function(b6,b5,b7){return b7?aE:b6[bI.camelCase("default-"+b5)]?b5.toLowerCase():null;};});if(!bE||!bO){bI.attrHooks.value={set:function(b3,b4,e){if(bI.nodeName(b3,"input")){b3.defaultValue=b4;}else{return a7&&a7.set(b3,b4,e);}}};}if(!bO){a7={set:function(b4,b5,b3){var e=b4.getAttributeNode(b3);if(!e){b4.setAttributeNode((e=b4.ownerDocument.createAttribute(b3)));}e.value=b5+="";return b3==="value"||b5===b4.getAttribute(b3)?b5:aE;}};bI.expr.attrHandle.id=bI.expr.attrHandle.name=bI.expr.attrHandle.coords=function(b4,b3,b5){var e;return b5?aE:(e=b4.getAttributeNode(b3))&&e.value!==""?e.value:null;};bI.valHooks.button={get:function(b4,b3){var e=b4.getAttributeNode(b3);return e&&e.specified?e.value:aE;},set:a7.set};bI.attrHooks.contenteditable={set:function(b3,b4,e){a7.set(b3,b4===""?false:b4,e);}};bI.each(["width","height"],function(b3,e){bI.attrHooks[e]={set:function(b4,b5){if(b5===""){b4.setAttribute(e,"auto");return b5;}}};});}if(!bI.support.hrefNormalized){bI.each(["href","src"],function(b3,e){bI.propHooks[e]={get:function(b4){return b4.getAttribute(e,4);}};});}if(!bI.support.style){bI.attrHooks.style={get:function(e){return e.style.cssText||aE;},set:function(e,b3){return(e.style.cssText=b3+"");}};}if(!bI.support.optSelected){bI.propHooks.selected={get:function(b3){var e=b3.parentNode;if(e){e.selectedIndex;if(e.parentNode){e.parentNode.selectedIndex;}}return null;}};}bI.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],function(){bI.propFix[this.toLowerCase()]=this;});if(!bI.support.enctype){bI.propFix.enctype="encoding";}bI.each(["radio","checkbox"],function(){bI.valHooks[this]={set:function(e,b3){if(bI.isArray(b3)){return(e.checked=bI.inArray(bI(e).val(),b3)>=0);}}};if(!bI.support.checkOn){bI.valHooks[this].get=function(e){return e.getAttribute("value")===null?"on":e.value;};}});var bG=/^(?:input|select|textarea)$/i,a2=/^key/,bM=/^(?:mouse|contextmenu)|click/,bA=/^(?:focusinfocus|focusoutblur)$/,bt=/^([^.]*)(?:\.(.+)|)$/;function P(){return true;}function V(){return false;}function ai(){try{return l.activeElement;}catch(e){}}bI.event={global:{},add:function(b6,cb,cg,b8,b7){var b9,ch,ci,b4,cd,ca,cf,b5,ce,e,b3,cc=bI._data(b6);if(!cc){return;}if(cg.handler){b4=cg;cg=b4.handler;b7=b4.selector;}if(!cg.guid){cg.guid=bI.guid++;}if(!(ch=cc.events)){ch=cc.events={};}if(!(ca=cc.handle)){ca=cc.handle=function(cj){return typeof bI!==aA&&(!cj||bI.event.triggered!==cj.type)?bI.event.dispatch.apply(ca.elem,arguments):aE;};ca.elem=b6;}cb=(cb||"").match(aa)||[""];ci=cb.length;while(ci--){b9=bt.exec(cb[ci])||[];ce=b3=b9[1];e=(b9[2]||"").split(".").sort();if(!ce){continue;}cd=bI.event.special[ce]||{};ce=(b7?cd.delegateType:cd.bindType)||ce;cd=bI.event.special[ce]||{};cf=bI.extend({type:ce,origType:b3,data:b8,handler:cg,guid:cg.guid,selector:b7,needsContext:b7&&bI.expr.match.needsContext.test(b7),namespace:e.join(".")},b4);if(!(b5=ch[ce])){b5=ch[ce]=[];b5.delegateCount=0;if(!cd.setup||cd.setup.call(b6,b8,e,ca)===false){if(b6.addEventListener){b6.addEventListener(ce,ca,false);}else{if(b6.attachEvent){b6.attachEvent("on"+ce,ca);}}}}if(cd.add){cd.add.call(b6,cf);if(!cf.handler.guid){cf.handler.guid=cg.guid;}}if(b7){b5.splice(b5.delegateCount++,0,cf);}else{b5.push(cf);}bI.event.global[ce]=true;}b6=null;},remove:function(b5,cb,ci,b6,ca){var b8,cf,b9,b7,ch,cg,cd,b4,ce,e,b3,cc=bI.hasData(b5)&&bI._data(b5);if(!cc||!(cg=cc.events)){return;}cb=(cb||"").match(aa)||[""];ch=cb.length;while(ch--){b9=bt.exec(cb[ch])||[];ce=b3=b9[1];e=(b9[2]||"").split(".").sort();if(!ce){for(ce in cg){bI.event.remove(b5,ce+cb[ch],ci,b6,true);}continue;}cd=bI.event.special[ce]||{};ce=(b6?cd.delegateType:cd.bindType)||ce;b4=cg[ce]||[];b9=b9[2]&&new RegExp("(^|\\.)"+e.join("\\.(?:.*\\.|)")+"(\\.|$)");b7=b8=b4.length;while(b8--){cf=b4[b8];if((ca||b3===cf.origType)&&(!ci||ci.guid===cf.guid)&&(!b9||b9.test(cf.namespace))&&(!b6||b6===cf.selector||b6==="**"&&cf.selector)){b4.splice(b8,1);if(cf.selector){b4.delegateCount--;}if(cd.remove){cd.remove.call(b5,cf);}}}if(b7&&!b4.length){if(!cd.teardown||cd.teardown.call(b5,e,cc.handle)===false){bI.removeEvent(b5,ce,cc.handle);}delete cg[ce];}}if(bI.isEmptyObject(cg)){delete cc.handle;bI._removeData(b5,"events");}},trigger:function(b3,ca,b6,ch){var cb,b5,cf,cg,cd,b9,b8,b7=[b6||l],ce=T.call(b3,"type")?b3.type:b3,b4=T.call(b3,"namespace")?b3.namespace.split("."):[];cf=b9=b6=b6||l;if(b6.nodeType===3||b6.nodeType===8){return;}if(bA.test(ce+bI.event.triggered)){return;}if(ce.indexOf(".")>=0){b4=ce.split(".");ce=b4.shift();b4.sort();}b5=ce.indexOf(":")<0&&"on"+ce;b3=b3[bI.expando]?b3:new bI.Event(ce,typeof b3==="object"&&b3);b3.isTrigger=ch?2:3;b3.namespace=b4.join(".");b3.namespace_re=b3.namespace?new RegExp("(^|\\.)"+b4.join("\\.(?:.*\\.|)")+"(\\.|$)"):null;b3.result=aE;if(!b3.target){b3.target=b6;}ca=ca==null?[b3]:bI.makeArray(ca,[b3]);cd=bI.event.special[ce]||{};if(!ch&&cd.trigger&&cd.trigger.apply(b6,ca)===false){return;}if(!ch&&!cd.noBubble&&!bI.isWindow(b6)){cg=cd.delegateType||ce;if(!bA.test(cg+ce)){cf=cf.parentNode;}for(;cf;cf=cf.parentNode){b7.push(cf);b9=cf;}if(b9===(b6.ownerDocument||l)){b7.push(b9.defaultView||b9.parentWindow||a1);}}b8=0;while((cf=b7[b8++])&&!b3.isPropagationStopped()){b3.type=b8>1?cg:cd.bindType||ce;cb=(bI._data(cf,"events")||{})[b3.type]&&bI._data(cf,"handle");if(cb){cb.apply(cf,ca);}cb=b5&&cf[b5];if(cb&&bI.acceptData(cf)&&cb.apply&&cb.apply(cf,ca)===false){b3.preventDefault();}}b3.type=ce;if(!ch&&!b3.isDefaultPrevented()){if((!cd._default||cd._default.apply(b7.pop(),ca)===false)&&bI.acceptData(b6)){if(b5&&b6[ce]&&!bI.isWindow(b6)){b9=b6[b5];if(b9){b6[b5]=null;}bI.event.triggered=ce;try{b6[ce]();}catch(cc){}bI.event.triggered=aE;if(b9){b6[b5]=b9;}}}}return b3.result;},dispatch:function(e){e=bI.event.fix(e);var b6,b7,cb,b3,b5,ca=[],b9=a3.call(arguments),b4=(bI._data(this,"events")||{})[e.type]||[],b8=bI.event.special[e.type]||{};b9[0]=e;e.delegateTarget=this;if(b8.preDispatch&&b8.preDispatch.call(this,e)===false){return;}ca=bI.event.handlers.call(this,e,b4);b6=0;while((b3=ca[b6++])&&!e.isPropagationStopped()){e.currentTarget=b3.elem;b5=0;while((cb=b3.handlers[b5++])&&!e.isImmediatePropagationStopped()){if(!e.namespace_re||e.namespace_re.test(cb.namespace)){e.handleObj=cb;e.data=cb.data;b7=((bI.event.special[cb.origType]||{}).handle||cb.handler).apply(b3.elem,b9);if(b7!==aE){if((e.result=b7)===false){e.preventDefault();e.stopPropagation();}}}}}if(b8.postDispatch){b8.postDispatch.call(this,e);}return e.result;},handlers:function(e,b4){var b3,b9,b7,b6,b8=[],b5=b4.delegateCount,ca=e.target;if(b5&&ca.nodeType&&(!e.button||e.type!=="click")){for(;ca!=this;ca=ca.parentNode||this){if(ca.nodeType===1&&(ca.disabled!==true||e.type!=="click")){b7=[];for(b6=0;b6<b5;b6++){b9=b4[b6];b3=b9.selector+" ";if(b7[b3]===aE){b7[b3]=b9.needsContext?bI(b3,this).index(ca)>=0:bI.find(b3,this,null,[ca]).length;}if(b7[b3]){b7.push(b9);}}if(b7.length){b8.push({elem:ca,handlers:b7});}}}}if(b5<b4.length){b8.push({elem:this,handlers:b4.slice(b5)});}return b8;},fix:function(b5){if(b5[bI.expando]){return b5;}var b3,b8,b7,b4=b5.type,e=b5,b6=this.fixHooks[b4];if(!b6){this.fixHooks[b4]=b6=bM.test(b4)?this.mouseHooks:a2.test(b4)?this.keyHooks:{};}b7=b6.props?this.props.concat(b6.props):this.props;b5=new bI.Event(e);b3=b7.length;while(b3--){b8=b7[b3];b5[b8]=e[b8];}if(!b5.target){b5.target=e.srcElement||l;}if(b5.target.nodeType===3){b5.target=b5.target.parentNode;}b5.metaKey=!!b5.metaKey;return b6.filter?b6.filter(b5,e):b5;},props:"altKey bubbles cancelable ctrlKey currentTarget eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),fixHooks:{},keyHooks:{props:"char charCode key keyCode".split(" "),filter:function(b3,e){if(b3.which==null){b3.which=e.charCode!=null?e.charCode:e.keyCode;}return b3;}},mouseHooks:{props:"button buttons clientX clientY fromElement offsetX offsetY pageX pageY screenX screenY toElement".split(" "),filter:function(b5,b4){var e,b6,b7,b3=b4.button,b8=b4.fromElement;if(b5.pageX==null&&b4.clientX!=null){b6=b5.target.ownerDocument||l;b7=b6.documentElement;e=b6.body;b5.pageX=b4.clientX+(b7&&b7.scrollLeft||e&&e.scrollLeft||0)-(b7&&b7.clientLeft||e&&e.clientLeft||0);b5.pageY=b4.clientY+(b7&&b7.scrollTop||e&&e.scrollTop||0)-(b7&&b7.clientTop||e&&e.clientTop||0);}if(!b5.relatedTarget&&b8){b5.relatedTarget=b8===b5.target?b4.toElement:b8;}if(!b5.which&&b3!==aE){b5.which=(b3&1?1:(b3&2?3:(b3&4?2:0)));}return b5;}},special:{load:{noBubble:true},focus:{trigger:function(){if(this!==ai()&&this.focus){try{this.focus();return false;}catch(b3){}}},delegateType:"focusin"},blur:{trigger:function(){if(this===ai()&&this.blur){this.blur();return false;}},delegateType:"focusout"},click:{trigger:function(){if(bI.nodeName(this,"input")&&this.type==="checkbox"&&this.click){this.click();return false;}},_default:function(e){return bI.nodeName(e.target,"a");}},beforeunload:{postDispatch:function(e){if(e.result!==aE){e.originalEvent.returnValue=e.result;}}}},simulate:function(b4,b6,b5,b3){var b7=bI.extend(new bI.Event(),b5,{type:b4,isSimulated:true,originalEvent:{}});if(b3){bI.event.trigger(b7,null,b6);}else{bI.event.dispatch.call(b6,b7);}if(b7.isDefaultPrevented()){b5.preventDefault();}}};bI.removeEvent=l.removeEventListener?function(b3,e,b4){if(b3.removeEventListener){b3.removeEventListener(e,b4,false);}}:function(b4,b3,b5){var e="on"+b3;if(b4.detachEvent){if(typeof b4[e]===aA){b4[e]=null;}b4.detachEvent(e,b5);}};bI.Event=function(b3,e){if(!(this instanceof bI.Event)){return new bI.Event(b3,e);}if(b3&&b3.type){this.originalEvent=b3;this.type=b3.type;this.isDefaultPrevented=(b3.defaultPrevented||b3.returnValue===false||b3.getPreventDefault&&b3.getPreventDefault())?P:V;}else{this.type=b3;}if(e){bI.extend(this,e);}this.timeStamp=b3&&b3.timeStamp||bI.now();this[bI.expando]=true;};bI.Event.prototype={isDefaultPrevented:V,isPropagationStopped:V,isImmediatePropagationStopped:V,preventDefault:function(){var b3=this.originalEvent;this.isDefaultPrevented=P;if(!b3){return;}if(b3.preventDefault){b3.preventDefault();}else{b3.returnValue=false;}},stopPropagation:function(){var b3=this.originalEvent;this.isPropagationStopped=P;if(!b3){return;}if(b3.stopPropagation){b3.stopPropagation();}b3.cancelBubble=true;},stopImmediatePropagation:function(){this.isImmediatePropagationStopped=P;this.stopPropagation();}};bI.each({mouseenter:"mouseover",mouseleave:"mouseout"},function(b3,e){bI.event.special[b3]={delegateType:e,bindType:e,handle:function(b6){var b4,b8=this,b7=b6.relatedTarget,b5=b6.handleObj;if(!b7||(b7!==b8&&!bI.contains(b8,b7))){b6.type=b5.origType;b4=b5.handler.apply(this,arguments);b6.type=e;}return b4;}};});if(!bI.support.submitBubbles){bI.event.special.submit={setup:function(){if(bI.nodeName(this,"form")){return false;}bI.event.add(this,"click._submit keypress._submit",function(b5){var b4=b5.target,b3=bI.nodeName(b4,"input")||bI.nodeName(b4,"button")?b4.form:aE;if(b3&&!bI._data(b3,"submitBubbles")){bI.event.add(b3,"submit._submit",function(e){e._submit_bubble=true;});bI._data(b3,"submitBubbles",true);}});},postDispatch:function(e){if(e._submit_bubble){delete e._submit_bubble;if(this.parentNode&&!e.isTrigger){bI.event.simulate("submit",this.parentNode,e,true);}}},teardown:function(){if(bI.nodeName(this,"form")){return false;}bI.event.remove(this,"._submit");}};}if(!bI.support.changeBubbles){bI.event.special.change={setup:function(){if(bG.test(this.nodeName)){if(this.type==="checkbox"||this.type==="radio"){bI.event.add(this,"propertychange._change",function(e){if(e.originalEvent.propertyName==="checked"){this._just_changed=true;}});bI.event.add(this,"click._change",function(e){if(this._just_changed&&!e.isTrigger){this._just_changed=false;}bI.event.simulate("change",this,e,true);});}return false;}bI.event.add(this,"beforeactivate._change",function(b4){var b3=b4.target;if(bG.test(b3.nodeName)&&!bI._data(b3,"changeBubbles")){bI.event.add(b3,"change._change",function(e){if(this.parentNode&&!e.isSimulated&&!e.isTrigger){bI.event.simulate("change",this.parentNode,e,true);}});bI._data(b3,"changeBubbles",true);}});},handle:function(b3){var e=b3.target;if(this!==e||b3.isSimulated||b3.isTrigger||(e.type!=="radio"&&e.type!=="checkbox")){return b3.handleObj.handler.apply(this,arguments);}},teardown:function(){bI.event.remove(this,"._change");return !bG.test(this.nodeName);}};}if(!bI.support.focusinBubbles){bI.each({focus:"focusin",blur:"focusout"},function(b5,e){var b3=0,b4=function(b6){bI.event.simulate(e,b6.target,bI.event.fix(b6),true);};bI.event.special[e]={setup:function(){if(b3++===0){l.addEventListener(b5,b4,true);}},teardown:function(){if(--b3===0){l.removeEventListener(b5,b4,true);}}};});}bI.fn.extend({on:function(b4,e,b7,b6,b3){var b5,b8;if(typeof b4==="object"){if(typeof e!=="string"){b7=b7||e;e=aE;}for(b5 in b4){this.on(b5,e,b7,b4[b5],b3);}return this;}if(b7==null&&b6==null){b6=e;b7=e=aE;}else{if(b6==null){if(typeof e==="string"){b6=b7;b7=aE;}else{b6=b7;b7=e;e=aE;}}}if(b6===false){b6=V;}else{if(!b6){return this;}}if(b3===1){b8=b6;b6=function(b9){bI().off(b9);return b8.apply(this,arguments);};b6.guid=b8.guid||(b8.guid=bI.guid++);}return this.each(function(){bI.event.add(this,b4,b6,b7,e);});},one:function(b3,e,b5,b4){return this.on(b3,e,b5,b4,1);},off:function(b4,e,b6){var b3,b5;if(b4&&b4.preventDefault&&b4.handleObj){b3=b4.handleObj;bI(b4.delegateTarget).off(b3.namespace?b3.origType+"."+b3.namespace:b3.origType,b3.selector,b3.handler);return this;}if(typeof b4==="object"){for(b5 in b4){this.off(b5,e,b4[b5]);}return this;}if(e===false||typeof e==="function"){b6=e;e=aE;}if(b6===false){b6=V;}return this.each(function(){bI.event.remove(this,b4,b6,e);});},trigger:function(e,b3){return this.each(function(){bI.event.trigger(e,b3,this);});},triggerHandler:function(e,b4){var b3=this[0];if(b3){return bI.event.trigger(e,b4,b3,true);}}});var al=/^.[^:#\[\.,]*$/,bs=/^(?:parents|prev(?:Until|All))/,x=bI.expr.match.needsContext,bw={children:true,contents:true,next:true,prev:true};bI.fn.extend({find:function(b3){var b6,b5=[],b4=this,e=b4.length;if(typeof b3!=="string"){return this.pushStack(bI(b3).filter(function(){for(b6=0;b6<e;b6++){if(bI.contains(b4[b6],this)){return true;}}}));}for(b6=0;b6<e;b6++){bI.find(b3,b4[b6],b5);}b5=this.pushStack(e>1?bI.unique(b5):b5);b5.selector=this.selector?this.selector+" "+b3:b3;return b5;},has:function(b5){var b4,b3=bI(b5,this),e=b3.length;return this.filter(function(){for(b4=0;b4<e;b4++){if(bI.contains(this,b3[b4])){return true;}}});},not:function(e){return this.pushStack(aM(this,e||[],true));},filter:function(e){return this.pushStack(aM(this,e||[],false));},is:function(e){return !!aM(this,typeof e==="string"&&x.test(e)?bI(e):e||[],false).length;},closest:function(b6,b5){var b7,b4=0,e=this.length,b3=[],b8=x.test(b6)||typeof b6!=="string"?bI(b6,b5||this.context):0;for(;b4<e;b4++){for(b7=this[b4];b7&&b7!==b5;b7=b7.parentNode){if(b7.nodeType<11&&(b8?b8.index(b7)>-1:b7.nodeType===1&&bI.find.matchesSelector(b7,b6))){b7=b3.push(b7);break;}}}return this.pushStack(b3.length>1?bI.unique(b3):b3);},index:function(e){if(!e){return(this[0]&&this[0].parentNode)?this.first().prevAll().length:-1;}if(typeof e==="string"){return bI.inArray(this[0],bI(e));}return bI.inArray(e.jquery?e[0]:e,this);},add:function(e,b3){var b5=typeof e==="string"?bI(e,b3):bI.makeArray(e&&e.nodeType?[e]:e),b4=bI.merge(this.get(),b5);return this.pushStack(bI.unique(b4));},addBack:function(e){return this.add(e==null?this.prevObject:this.prevObject.filter(e));}});function aV(b3,e){do{b3=b3[e];}while(b3&&b3.nodeType!==1);return b3;}bI.each({parent:function(b3){var e=b3.parentNode;return e&&e.nodeType!==11?e:null;},parents:function(e){return bI.dir(e,"parentNode");},parentsUntil:function(b3,e,b4){return bI.dir(b3,"parentNode",b4);},next:function(e){return aV(e,"nextSibling");},prev:function(e){return aV(e,"previousSibling");},nextAll:function(e){return bI.dir(e,"nextSibling");},prevAll:function(e){return bI.dir(e,"previousSibling");},nextUntil:function(b3,e,b4){return bI.dir(b3,"nextSibling",b4);},prevUntil:function(b3,e,b4){return bI.dir(b3,"previousSibling",b4);},siblings:function(e){return bI.sibling((e.parentNode||{}).firstChild,e);},children:function(e){return bI.sibling(e.firstChild);},contents:function(e){return bI.nodeName(e,"iframe")?e.contentDocument||e.contentWindow.document:bI.merge([],e.childNodes);}},function(e,b3){bI.fn[e]=function(b6,b4){var b5=bI.map(this,b3,b6);if(e.slice(-5)!=="Until"){b4=b6;}if(b4&&typeof b4==="string"){b5=bI.filter(b4,b5);}if(this.length>1){if(!bw[e]){b5=bI.unique(b5);}if(bs.test(e)){b5=b5.reverse();}}return this.pushStack(b5);};});bI.extend({filter:function(b5,e,b4){var b3=e[0];if(b4){b5=":not("+b5+")";}return e.length===1&&b3.nodeType===1?bI.find.matchesSelector(b3,b5)?[b3]:[]:bI.find.matches(b5,bI.grep(e,function(b6){return b6.nodeType===1;}));},dir:function(b4,b3,b6){var e=[],b5=b4[b3];while(b5&&b5.nodeType!==9&&(b6===aE||b5.nodeType!==1||!bI(b5).is(b6))){if(b5.nodeType===1){e.push(b5);}b5=b5[b3];}return e;},sibling:function(b4,b3){var e=[];for(;b4;b4=b4.nextSibling){if(b4.nodeType===1&&b4!==b3){e.push(b4);}}return e;}});function aM(b4,e,b3){if(bI.isFunction(e)){return bI.grep(b4,function(b6,b5){return !!e.call(b6,b5,b6)!==b3;});}if(e.nodeType){return bI.grep(b4,function(b5){return(b5===e)!==b3;});}if(typeof e==="string"){if(al.test(e)){return bI.filter(e,b4,b3);}e=bI.filter(e,b4);}return bI.grep(b4,function(b5){return(bI.inArray(b5,e)>=0)!==b3;});}function z(e){var b4=d.split("|"),b3=e.createDocumentFragment();if(b3.createElement){while(b4.length){b3.createElement(b4.pop());}}return b3;}var d="abbr|article|aside|audio|bdi|canvas|data|datalist|details|figcaption|figure|footer|header|hgroup|mark|meter|nav|output|progress|section|summary|time|video",ay=/ jQuery\d+="(?:null|\d+)"/g,I=new RegExp("<(?:"+d+")[\\s/>]","i"),b2=/^\s+/,aB=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,m=/<([\w:]+)/,bX=/<tbody/i,H=/<|&#?\w+;/,aj=/<(?:script|style|link)/i,q=/^(?:checkbox|radio)$/i,bT=/checked\s*(?:[^=]|=\s*.checked.)/i,by=/^$|\/(?:java|ecma)script/i,ap=/^true\/(.*)/,aI=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g,R={option:[1,"<select multiple='multiple'>","</select>"],legend:[1,"<fieldset>","</fieldset>"],area:[1,"<map>","</map>"],param:[1,"<object>","</object>"],thead:[1,"<table>","</table>"],tr:[2,"<table><tbody>","</tbody></table>"],col:[2,"<table><tbody></tbody><colgroup>","</colgroup></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:bI.support.htmlSerialize?[0,"",""]:[1,"X<div>","</div>"]},aQ=z(l),j=aQ.appendChild(l.createElement("div"));R.optgroup=R.option;R.tbody=R.tfoot=R.colgroup=R.caption=R.thead;R.th=R.td;bI.fn.extend({text:function(e){return bI.access(this,function(b3){return b3===aE?bI.text(this):this.empty().append((this[0]&&this[0].ownerDocument||l).createTextNode(b3));},null,e,arguments.length);},append:function(){return this.domManip(arguments,function(e){if(this.nodeType===1||this.nodeType===11||this.nodeType===9){var b3=aZ(this,e);b3.appendChild(e);}});},prepend:function(){return this.domManip(arguments,function(e){if(this.nodeType===1||this.nodeType===11||this.nodeType===9){var b3=aZ(this,e);b3.insertBefore(e,b3.firstChild);}});},before:function(){return this.domManip(arguments,function(e){if(this.parentNode){this.parentNode.insertBefore(e,this);}});},after:function(){return this.domManip(arguments,function(e){if(this.parentNode){this.parentNode.insertBefore(e,this.nextSibling);}});},remove:function(e,b6){var b5,b3=e?bI.filter(e,this):this,b4=0;for(;(b5=b3[b4])!=null;b4++){if(!b6&&b5.nodeType===1){bI.cleanData(k(b5));}if(b5.parentNode){if(b6&&bI.contains(b5.ownerDocument,b5)){br(k(b5,"script"));}b5.parentNode.removeChild(b5);}}return this;},empty:function(){var b3,e=0;for(;(b3=this[e])!=null;e++){if(b3.nodeType===1){bI.cleanData(k(b3,false));}while(b3.firstChild){b3.removeChild(b3.firstChild);}if(b3.options&&bI.nodeName(b3,"select")){b3.options.length=0;}}return this;},clone:function(b3,e){b3=b3==null?false:b3;e=e==null?b3:e;return this.map(function(){return bI.clone(this,b3,e);});},html:function(e){return bI.access(this,function(b6){var b5=this[0]||{},b4=0,b3=this.length;if(b6===aE){return b5.nodeType===1?b5.innerHTML.replace(ay,""):aE;}if(typeof b6==="string"&&!aj.test(b6)&&(bI.support.htmlSerialize||!I.test(b6))&&(bI.support.leadingWhitespace||!b2.test(b6))&&!R[(m.exec(b6)||["",""])[1].toLowerCase()]){b6=b6.replace(aB,"<$1></$2>");try{for(;b4<b3;b4++){b5=this[b4]||{};if(b5.nodeType===1){bI.cleanData(k(b5,false));b5.innerHTML=b6;}}b5=0;}catch(b7){}}if(b5){this.empty().append(b6);}},null,e,arguments.length);},replaceWith:function(){var e=bI.map(this,function(b4){return[b4.nextSibling,b4.parentNode];}),b3=0;this.domManip(arguments,function(b6){var b5=e[b3++],b4=e[b3++];if(b4){if(b5&&b5.parentNode!==b4){b5=this.nextSibling;}bI(this).remove();b4.insertBefore(b6,b5);}},true);return b3?this:this.remove();},detach:function(e){return this.remove(e,true);},domManip:function(cb,cg,b4){cb=aG.apply([],cb);var b9,b5,e,b7,ce,ca,b8=0,b6=this.length,cd=this,cf=b6-1,cc=cb[0],b3=bI.isFunction(cc);if(b3||!(b6<=1||typeof cc!=="string"||bI.support.checkClone||!bT.test(cc))){return this.each(function(ci){var ch=cd.eq(ci);if(b3){cb[0]=cc.call(this,ci,ch.html());}ch.domManip(cb,cg,b4);});}if(b6){ca=bI.buildFragment(cb,this[0].ownerDocument,false,!b4&&this);b9=ca.firstChild;if(ca.childNodes.length===1){ca=b9;}if(b9){b7=bI.map(k(ca,"script"),t);e=b7.length;for(;b8<b6;b8++){b5=ca;if(b8!==cf){b5=bI.clone(b5,true,true);if(e){bI.merge(b7,k(b5,"script"));}}cg.call(this[b8],b5,b8);}if(e){ce=b7[b7.length-1].ownerDocument;bI.map(b7,bc);for(b8=0;b8<e;b8++){b5=b7[b8];if(by.test(b5.type||"")&&!bI._data(b5,"globalEval")&&bI.contains(ce,b5)){if(b5.src){bI._evalUrl(b5.src);}else{bI.globalEval((b5.text||b5.textContent||b5.innerHTML||"").replace(aI,""));}}}}ca=b9=null;}}return this;}});function aZ(b3,e){return bI.nodeName(b3,"table")&&bI.nodeName(e.nodeType===1?e:e.firstChild,"tr")?b3.getElementsByTagName("tbody")[0]||b3.appendChild(b3.ownerDocument.createElement("tbody")):b3;}function t(e){e.type=(bI.find.attr(e,"type")!==null)+"/"+e.type;return e;}function bc(b3){var e=ap.exec(b3.type);if(e){b3.type=e[1];}else{b3.removeAttribute("type");}return b3;}function br(e,b4){var b5,b3=0;for(;(b5=e[b3])!=null;b3++){bI._data(b5,"globalEval",!b4||bI._data(b4[b3],"globalEval"));}}function aq(b9,b3){if(b3.nodeType!==1||!bI.hasData(b9)){return;}var b6,b5,e,b8=bI._data(b9),b7=bI._data(b3,b8),b4=b8.events;if(b4){delete b7.handle;b7.events={};for(b6 in b4){for(b5=0,e=b4[b6].length;b5<e;b5++){bI.event.add(b3,b6,b4[b6][b5]);}}}if(b7.data){b7.data=bI.extend({},b7.data);}}function O(b6,b3){var b7,b5,b4;if(b3.nodeType!==1){return;}b7=b3.nodeName.toLowerCase();if(!bI.support.noCloneEvent&&b3[bI.expando]){b4=bI._data(b3);for(b5 in b4.events){bI.removeEvent(b3,b5,b4.handle);}b3.removeAttribute(bI.expando);}if(b7==="script"&&b3.text!==b6.text){t(b3).text=b6.text;bc(b3);}else{if(b7==="object"){if(b3.parentNode){b3.outerHTML=b6.outerHTML;}if(bI.support.html5Clone&&(b6.innerHTML&&!bI.trim(b3.innerHTML))){b3.innerHTML=b6.innerHTML;}}else{if(b7==="input"&&q.test(b6.type)){b3.defaultChecked=b3.checked=b6.checked;if(b3.value!==b6.value){b3.value=b6.value;}}else{if(b7==="option"){b3.defaultSelected=b3.selected=b6.defaultSelected;}else{if(b7==="input"||b7==="textarea"){b3.defaultValue=b6.defaultValue;}}}}}}bI.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(e,b3){bI.fn[e]=function(b4){var b5,b7=0,b6=[],b9=bI(b4),b8=b9.length-1;for(;b7<=b8;b7++){b5=b7===b8?this:this.clone(true);bI(b9[b7])[b3](b5);am.apply(b6,b5.get());}return this.pushStack(b6);};});function k(b5,e){var b3,b6,b4=0,b7=typeof b5.getElementsByTagName!==aA?b5.getElementsByTagName(e||"*"):typeof b5.querySelectorAll!==aA?b5.querySelectorAll(e||"*"):aE;if(!b7){for(b7=[],b3=b5.childNodes||b5;(b6=b3[b4])!=null;b4++){if(!e||bI.nodeName(b6,e)){b7.push(b6);}else{bI.merge(b7,k(b6,e));}}}return e===aE||e&&bI.nodeName(b5,e)?bI.merge([b5],b7):b7;}function bU(e){if(q.test(e.type)){e.defaultChecked=e.checked;}}bI.extend({clone:function(b3,b5,e){var b7,b4,ca,b6,b8,b9=bI.contains(b3.ownerDocument,b3);if(bI.support.html5Clone||bI.isXMLDoc(b3)||!I.test("<"+b3.nodeName+">")){ca=b3.cloneNode(true);}else{j.innerHTML=b3.outerHTML;j.removeChild(ca=j.firstChild);}if((!bI.support.noCloneEvent||!bI.support.noCloneChecked)&&(b3.nodeType===1||b3.nodeType===11)&&!bI.isXMLDoc(b3)){b7=k(ca);b8=k(b3);for(b6=0;(b4=b8[b6])!=null;++b6){if(b7[b6]){O(b4,b7[b6]);}}}if(b5){if(e){b8=b8||k(b3);b7=b7||k(ca);for(b6=0;(b4=b8[b6])!=null;b6++){aq(b4,b7[b6]);}}else{aq(b3,ca);}}b7=k(ca,"script");if(b7.length>0){br(b7,!b9&&k(b3,"script"));}b7=b8=b4=null;return ca;},buildFragment:function(b3,b5,ca,cf){var cb,b7,b9,ce,cg,cd,b4,b8=b3.length,b6=z(b5),e=[],cc=0;for(;cc<b8;cc++){b7=b3[cc];if(b7||b7===0){if(bI.type(b7)==="object"){bI.merge(e,b7.nodeType?[b7]:b7);}else{if(!H.test(b7)){e.push(b5.createTextNode(b7));}else{ce=ce||b6.appendChild(b5.createElement("div"));cg=(m.exec(b7)||["",""])[1].toLowerCase();b4=R[cg]||R._default;ce.innerHTML=b4[1]+b7.replace(aB,"<$1></$2>")+b4[2];cb=b4[0];while(cb--){ce=ce.lastChild;}if(!bI.support.leadingWhitespace&&b2.test(b7)){e.push(b5.createTextNode(b2.exec(b7)[0]));}if(!bI.support.tbody){b7=cg==="table"&&!bX.test(b7)?ce.firstChild:b4[1]==="<table>"&&!bX.test(b7)?ce:0;cb=b7&&b7.childNodes.length;while(cb--){if(bI.nodeName((cd=b7.childNodes[cb]),"tbody")&&!cd.childNodes.length){b7.removeChild(cd);}}}bI.merge(e,ce.childNodes);ce.textContent="";while(ce.firstChild){ce.removeChild(ce.firstChild);}ce=b6.lastChild;}}}}if(ce){b6.removeChild(ce);}if(!bI.support.appendChecked){bI.grep(k(e,"input"),bU);}cc=0;while((b7=e[cc++])){if(cf&&bI.inArray(b7,cf)!==-1){continue;}b9=bI.contains(b7.ownerDocument,b7);ce=k(b6.appendChild(b7),"script");if(b9){br(ce);}if(ca){cb=0;while((b7=ce[cb++])){if(by.test(b7.type||"")){ca.push(b7);}}}}ce=null;return b6;},cleanData:function(b3,cb){var b5,ca,b4,b6,b7=0,cc=bI.expando,e=bI.cache,b8=bI.support.deleteExpando,b9=bI.event.special;for(;(b5=b3[b7])!=null;b7++){if(cb||bI.acceptData(b5)){b4=b5[cc];b6=b4&&e[b4];if(b6){if(b6.events){for(ca in b6.events){if(b9[ca]){bI.event.remove(b5,ca);}else{bI.removeEvent(b5,ca,b6.handle);}}}if(e[b4]){delete e[b4];if(b8){delete b5[cc];}else{if(typeof b5.removeAttribute!==aA){b5.removeAttribute(cc);}else{b5[cc]=null;}}a5.push(b4);}}}}},_evalUrl:function(e){return bI.ajax({url:e,type:"GET",dataType:"script",async:false,global:false,"throws":true});}});bI.fn.extend({wrapAll:function(e){if(bI.isFunction(e)){return this.each(function(b4){bI(this).wrapAll(e.call(this,b4));});}if(this[0]){var b3=bI(e,this[0].ownerDocument).eq(0).clone(true);if(this[0].parentNode){b3.insertBefore(this[0]);}b3.map(function(){var b4=this;while(b4.firstChild&&b4.firstChild.nodeType===1){b4=b4.firstChild;}return b4;}).append(this);}return this;},wrapInner:function(e){if(bI.isFunction(e)){return this.each(function(b3){bI(this).wrapInner(e.call(this,b3));});}return this.each(function(){var b3=bI(this),b4=b3.contents();if(b4.length){b4.wrapAll(e);}else{b3.append(e);}});},wrap:function(e){var b3=bI.isFunction(e);return this.each(function(b4){bI(this).wrapAll(b3?e.call(this,b4):e);});},unwrap:function(){return this.parent().each(function(){if(!bI.nodeName(this,"body")){bI(this).replaceWith(this.childNodes);}}).end();}});var aC,bn,D,bf=/alpha\([^)]*\)/i,aR=/opacity\s*=\s*([^)]*)/,bm=/^(top|right|bottom|left)$/,E=/^(none|table(?!-c[ea]).+)/,aW=/^margin/,a8=new RegExp("^("+bz+")(.*)$","i"),U=new RegExp("^("+bz+")(?!px)[a-z%]+$","i"),Q=new RegExp("^([+-])=("+bz+")","i"),bi={BODY:"block"},bb={position:"absolute",visibility:"hidden",display:"block"},bB={letterSpacing:0,fontWeight:400},bS=["Top","Right","Bottom","Left"],at=["Webkit","O","Moz","ms"];function b(b5,b3){if(b3 in b5){return b3;}var b6=b3.charAt(0).toUpperCase()+b3.slice(1),e=b3,b4=at.length;while(b4--){b3=at[b4]+b6;if(b3 in b5){return b3;}}return e;}function N(b3,e){b3=e||b3;return bI.css(b3,"display")==="none"||!bI.contains(b3.ownerDocument,b3);}function p(b8,e){var b9,b6,b7,b3=[],b4=0,b5=b8.length;for(;b4<b5;b4++){b6=b8[b4];if(!b6.style){continue;}b3[b4]=bI._data(b6,"olddisplay");b9=b6.style.display;if(e){if(!b3[b4]&&b9==="none"){b6.style.display="";}if(b6.style.display===""&&N(b6)){b3[b4]=bI._data(b6,"olddisplay",bD(b6.nodeName));}}else{if(!b3[b4]){b7=N(b6);if(b9&&b9!=="none"||!b7){bI._data(b6,"olddisplay",b7?b9:bI.css(b6,"display"));}}}}for(b4=0;b4<b5;b4++){b6=b8[b4];if(!b6.style){continue;}if(!e||b6.style.display==="none"||b6.style.display===""){b6.style.display=e?b3[b4]||"":"none";}}return b8;}bI.fn.extend({css:function(e,b3){return bI.access(this,function(b8,b5,b9){var b4,b7,ca={},b6=0;if(bI.isArray(b5)){b7=bn(b8);b4=b5.length;for(;b6<b4;b6++){ca[b5[b6]]=bI.css(b8,b5[b6],false,b7);}return ca;}return b9!==aE?bI.style(b8,b5,b9):bI.css(b8,b5);},e,b3,arguments.length>1);},show:function(){return p(this,true);},hide:function(){return p(this);},toggle:function(e){if(typeof e==="boolean"){return e?this.show():this.hide();}return this.each(function(){if(N(this)){bI(this).show();}else{bI(this).hide();}});}});bI.extend({cssHooks:{opacity:{get:function(b4,b3){if(b3){var e=D(b4,"opacity");return e===""?"1":e;}}}},cssNumber:{columnCount:true,fillOpacity:true,fontWeight:true,lineHeight:true,opacity:true,order:true,orphans:true,widows:true,zIndex:true,zoom:true},cssProps:{"float":bI.support.cssFloat?"cssFloat":"styleFloat"},style:function(b5,b4,cb,b6){if(!b5||b5.nodeType===3||b5.nodeType===8||!b5.style){return;}var b9,ca,cc,b7=bI.camelCase(b4),b3=b5.style;b4=bI.cssProps[b7]||(bI.cssProps[b7]=b(b3,b7));cc=bI.cssHooks[b4]||bI.cssHooks[b7];if(cb!==aE){ca=typeof cb;if(ca==="string"&&(b9=Q.exec(cb))){cb=(b9[1]+1)*b9[2]+parseFloat(bI.css(b5,b4));ca="number";}if(cb==null||ca==="number"&&isNaN(cb)){return;}if(ca==="number"&&!bI.cssNumber[b7]){cb+="px";}if(!bI.support.clearCloneStyle&&cb===""&&b4.indexOf("background")===0){b3[b4]="inherit";}if(!cc||!("set" in cc)||(cb=cc.set(b5,cb,b6))!==aE){try{b3[b4]=cb;}catch(b8){}}}else{if(cc&&"get" in cc&&(b9=cc.get(b5,false,b6))!==aE){return b9;}return b3[b4];}},css:function(b8,b6,b3,b7){var b5,b9,e,b4=bI.camelCase(b6);b6=bI.cssProps[b4]||(bI.cssProps[b4]=b(b8.style,b4));e=bI.cssHooks[b6]||bI.cssHooks[b4];if(e&&"get" in e){b9=e.get(b8,true,b3);}if(b9===aE){b9=D(b8,b6,b7);}if(b9==="normal"&&b6 in bB){b9=bB[b6];}if(b3===""||b3){b5=parseFloat(b9);return b3===true||bI.isNumeric(b5)?b5||0:b9;}return b9;}});if(a1.getComputedStyle){bn=function(e){return a1.getComputedStyle(e,null);};D=function(b6,b4,b8){var b5,b3,ca,b7=b8||bn(b6),b9=b7?b7.getPropertyValue(b4)||b7[b4]:aE,e=b6.style;if(b7){if(b9===""&&!bI.contains(b6.ownerDocument,b6)){b9=bI.style(b6,b4);}if(U.test(b9)&&aW.test(b4)){b5=e.width;b3=e.minWidth;ca=e.maxWidth;e.minWidth=e.maxWidth=e.width=b9;b9=b7.width;e.width=b5;e.minWidth=b3;e.maxWidth=ca;}}return b9;};}else{if(l.documentElement.currentStyle){bn=function(e){return e.currentStyle;};D=function(b5,b3,b8){var b4,b7,b9,b6=b8||bn(b5),ca=b6?b6[b3]:aE,e=b5.style;if(ca==null&&e&&e[b3]){ca=e[b3];}if(U.test(ca)&&!bm.test(b3)){b4=e.left;b7=b5.runtimeStyle;b9=b7&&b7.left;if(b9){b7.left=b5.currentStyle.left;}e.left=b3==="fontSize"?"1em":ca;ca=e.pixelLeft+"px";e.left=b4;if(b9){b7.left=b9;}}return ca===""?"auto":ca;};}}function aH(e,b4,b5){var b3=a8.exec(b4);return b3?Math.max(0,b3[1]-(b5||0))+(b3[2]||"px"):b4;}function au(b6,b3,e,b8,b5){var b4=e===(b8?"border":"content")?4:b3==="width"?1:0,b7=0;for(;b4<4;b4+=2){if(e==="margin"){b7+=bI.css(b6,e+bS[b4],true,b5);}if(b8){if(e==="content"){b7-=bI.css(b6,"padding"+bS[b4],true,b5);}if(e!=="margin"){b7-=bI.css(b6,"border"+bS[b4]+"Width",true,b5);}}else{b7+=bI.css(b6,"padding"+bS[b4],true,b5);if(e!=="padding"){b7+=bI.css(b6,"border"+bS[b4]+"Width",true,b5);}}}return b7;}function u(b6,b3,e){var b5=true,b7=b3==="width"?b6.offsetWidth:b6.offsetHeight,b4=bn(b6),b8=bI.support.boxSizing&&bI.css(b6,"boxSizing",false,b4)==="border-box";if(b7<=0||b7==null){b7=D(b6,b3,b4);if(b7<0||b7==null){b7=b6.style[b3];}if(U.test(b7)){return b7;}b5=b8&&(bI.support.boxSizingReliable||b7===b6.style[b3]);b7=parseFloat(b7)||0;}return(b7+au(b6,b3,e||(b8?"border":"content"),b5,b4))+"px";}function bD(b4){var b3=l,e=bi[b4];if(!e){e=a0(b4,b3);if(e==="none"||!e){aC=(aC||bI("<iframe frameborder='0' width='0' height='0'/>").css("cssText","display:block !important")).appendTo(b3.documentElement);b3=(aC[0].contentWindow||aC[0].contentDocument).document;b3.write("<!doctype html><html><body>");b3.close();e=a0(b4,b3);aC.detach();}bi[b4]=e;}return e;}function a0(e,b5){var b3=bI(b5.createElement(e)).appendTo(b5.body),b4=bI.css(b3[0],"display");b3.remove();return b4;}bI.each(["height","width"],function(b3,e){bI.cssHooks[e]={get:function(b6,b5,b4){if(b5){return b6.offsetWidth===0&&E.test(bI.css(b6,"display"))?bI.swap(b6,bb,function(){return u(b6,e,b4);}):u(b6,e,b4);}},set:function(b6,b7,b4){var b5=b4&&bn(b6);return aH(b6,b7,b4?au(b6,e,b4,bI.support.boxSizing&&bI.css(b6,"boxSizing",false,b5)==="border-box",b5):0);}};});if(!bI.support.opacity){bI.cssHooks.opacity={get:function(b3,e){return aR.test((e&&b3.currentStyle?b3.currentStyle.filter:b3.style.filter)||"")?(0.01*parseFloat(RegExp.$1))+"":e?"1":"";},set:function(b6,b7){var b5=b6.style,b3=b6.currentStyle,e=bI.isNumeric(b7)?"alpha(opacity="+b7*100+")":"",b4=b3&&b3.filter||b5.filter||"";b5.zoom=1;if((b7>=1||b7==="")&&bI.trim(b4.replace(bf,""))===""&&b5.removeAttribute){b5.removeAttribute("filter");if(b7===""||b3&&!b3.filter){return;}}b5.filter=bf.test(b4)?b4.replace(bf,e):b4+" "+e;}};}bI(function(){if(!bI.support.reliableMarginRight){bI.cssHooks.marginRight={get:function(b3,e){if(e){return bI.swap(b3,{display:"inline-block"},D,[b3,"marginRight"]);}}};}if(!bI.support.pixelPosition&&bI.fn.position){bI.each(["top","left"],function(e,b3){bI.cssHooks[b3]={get:function(b5,b4){if(b4){b4=D(b5,b3);return U.test(b4)?bI(b5).position()[b3]+"px":b4;}}};});}});if(bI.expr&&bI.expr.filters){bI.expr.filters.hidden=function(e){return e.offsetWidth<=0&&e.offsetHeight<=0||(!bI.support.reliableHiddenOffsets&&((e.style&&e.style.display)||bI.css(e,"display"))==="none");};bI.expr.filters.visible=function(e){return !bI.expr.filters.hidden(e);};}bI.each({margin:"",padding:"",border:"Width"},function(e,b3){bI.cssHooks[e+b3]={expand:function(b6){var b5=0,b4={},b7=typeof b6==="string"?b6.split(" "):[b6];for(;b5<4;b5++){b4[e+bS[b5]+b3]=b7[b5]||b7[b5-2]||b7[0];}return b4;}};if(!aW.test(e)){bI.cssHooks[e+b3].set=aH;}});var bu=/%20/g,aP=/\[\]$/,S=/\r?\n/g,c=/^(?:submit|button|image|reset|file)$/i,ar=/^(?:input|select|textarea|keygen)/i;bI.fn.extend({serialize:function(){return bI.param(this.serializeArray());},serializeArray:function(){return this.map(function(){var e=bI.prop(this,"elements");return e?bI.makeArray(e):this;}).filter(function(){var e=this.type;return this.name&&!bI(this).is(":disabled")&&ar.test(this.nodeName)&&!c.test(e)&&(this.checked||!q.test(e));}).map(function(e,b3){var b4=bI(this).val();return b4==null?null:bI.isArray(b4)?bI.map(b4,function(b5){return{name:b3.name,value:b5.replace(S,"\r\n")};}):{name:b3.name,value:b4.replace(S,"\r\n")};}).get();}});bI.param=function(e,b4){var b5,b3=[],b6=function(b7,b8){b8=bI.isFunction(b8)?b8():(b8==null?"":b8);b3[b3.length]=encodeURIComponent(b7)+"="+encodeURIComponent(b8);};if(b4===aE){b4=bI.ajaxSettings&&bI.ajaxSettings.traditional;}if(bI.isArray(e)||(e.jquery&&!bI.isPlainObject(e))){bI.each(e,function(){b6(this.name,this.value);});}else{for(b5 in e){i(b5,e[b5],b4,b6);}}return b3.join("&").replace(bu,"+");};function i(b4,b6,b3,b5){var e;if(bI.isArray(b6)){bI.each(b6,function(b8,b7){if(b3||aP.test(b4)){b5(b4,b7);}else{i(b4+"["+(typeof b7==="object"?b8:"")+"]",b7,b3,b5);}});}else{if(!b3&&bI.type(b6)==="object"){for(e in b6){i(b4+"["+e+"]",b6[e],b3,b5);}}else{b5(b4,b6);}}}bI.each(("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error contextmenu").split(" "),function(b3,e){bI.fn[e]=function(b5,b4){return arguments.length>0?this.on(e,null,b5,b4):this.trigger(e);};});bI.fn.extend({hover:function(e,b3){return this.mouseenter(e).mouseleave(b3||e);},bind:function(e,b4,b3){return this.on(e,null,b4,b3);},unbind:function(e,b3){return this.off(e,null,b3);},delegate:function(e,b3,b5,b4){return this.on(b3,e,b5,b4);},undelegate:function(e,b3,b4){return arguments.length===1?this.off(e,"**"):this.off(b3,e||"**",b4);}});var b1,W,bN=bI.now(),ax=/\?/,an=/#.*$/,M=/([?&])_=[^&]*/,ae=/^(.*?):[ \t]*([^\r\n]*)\r?$/mg,A=/^(?:about|app|app-storage|.+-extension|file|res|widget):$/,o=/^(?:GET|HEAD)$/,aF=/^\/\//,aS=/^([\w.+-]+:)(?:\/\/([^\/?#:]*)(?::(\d+)|)|)/,b0=bI.fn.load,v={},a6={},aU="*/".concat("*");try{W=aJ.href;}catch(be){W=l.createElement("a");W.href="";W=W.href;}b1=aS.exec(W.toLowerCase())||[];function bK(e){return function(b6,b7){if(typeof b6!=="string"){b7=b6;b6="*";}var b3,b4=0,b5=b6.toLowerCase().match(aa)||[];if(bI.isFunction(b7)){while((b3=b5[b4++])){if(b3[0]==="+"){b3=b3.slice(1)||"*";(e[b3]=e[b3]||[]).unshift(b7);}else{(e[b3]=e[b3]||[]).push(b7);}}}};}function n(e,b4,b8,b5){var b3={},b6=(e===a6);function b7(b9){var ca;b3[b9]=true;bI.each(e[b9]||[],function(cc,cb){var cd=cb(b4,b8,b5);if(typeof cd==="string"&&!b6&&!b3[cd]){b4.dataTypes.unshift(cd);b7(cd);return false;}else{if(b6){return !(ca=cd);}}});return ca;}return b7(b4.dataTypes[0])||!b3["*"]&&b7("*");}function r(b4,b5){var e,b3,b6=bI.ajaxSettings.flatOptions||{};for(b3 in b5){if(b5[b3]!==aE){(b6[b3]?b4:(e||(e={})))[b3]=b5[b3];}}if(e){bI.extend(true,b4,e);}return b4;}bI.fn.load=function(b5,b8,b9){if(typeof b5!=="string"&&b0){return b0.apply(this,arguments);}var e,b4,b6,b3=this,b7=b5.indexOf(" ");if(b7>=0){e=b5.slice(b7,b5.length);b5=b5.slice(0,b7);}if(bI.isFunction(b8)){b9=b8;b8=aE;}else{if(b8&&typeof b8==="object"){b6="POST";}}if(b3.length>0){bI.ajax({url:b5,type:b6,dataType:"html",data:b8}).done(function(ca){b4=arguments;b3.html(e?bI("<div>").append(bI.parseHTML(ca)).find(e):ca);}).complete(b9&&function(cb,ca){b3.each(b9,b4||[cb.responseText,ca,cb]);});}return this;};bI.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],function(e,b3){bI.fn[b3]=function(b4){return this.on(b3,b4);};});bI.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:W,type:"GET",isLocal:A.test(b1[1]),global:true,processData:true,async:true,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":aU,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/xml/,html:/html/,json:/json/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":true,"text json":bI.parseJSON,"text xml":bI.parseXML},flatOptions:{url:true,context:true}},ajaxSetup:function(b3,e){return e?r(r(b3,bI.ajaxSettings),e):r(bI.ajaxSettings,b3);},ajaxPrefilter:bK(v),ajaxTransport:bK(a6),ajax:function(b7,b4){if(typeof b7==="object"){b4=b7;b7=aE;}b4=b4||{};var cg,ci,b8,cn,cc,b3,cj,b5,cb=bI.ajaxSetup({},b4),cp=cb.context||cb,ce=cb.context&&(cp.nodeType||cp.jquery)?bI(cp):bI.event,co=bI.Deferred(),cl=bI.Callbacks("once memory"),b9=cb.statusCode||{},cf={},cm={},b6=0,ca="canceled",ch={readyState:0,getResponseHeader:function(cq){var e;if(b6===2){if(!b5){b5={};while((e=ae.exec(cn))){b5[e[1].toLowerCase()]=e[2];}}e=b5[cq.toLowerCase()];}return e==null?null:e;},getAllResponseHeaders:function(){return b6===2?cn:null;},setRequestHeader:function(cq,cr){var e=cq.toLowerCase();if(!b6){cq=cm[e]=cm[e]||cq;cf[cq]=cr;}return this;},overrideMimeType:function(e){if(!b6){cb.mimeType=e;}return this;},statusCode:function(cq){var e;if(cq){if(b6<2){for(e in cq){b9[e]=[b9[e],cq[e]];}}else{ch.always(cq[ch.status]);}}return this;},abort:function(cq){var e=cq||ca;if(cj){cj.abort(e);}cd(0,e);return this;}};co.promise(ch).complete=cl.add;ch.success=ch.done;ch.error=ch.fail;cb.url=((b7||cb.url||W)+"").replace(an,"").replace(aF,b1[1]+"//");cb.type=b4.method||b4.type||cb.method||cb.type;cb.dataTypes=bI.trim(cb.dataType||"*").toLowerCase().match(aa)||[""];if(cb.crossDomain==null){cg=aS.exec(cb.url.toLowerCase());cb.crossDomain=!!(cg&&(cg[1]!==b1[1]||cg[2]!==b1[2]||(cg[3]||(cg[1]==="http:"?"80":"443"))!==(b1[3]||(b1[1]==="http:"?"80":"443"))));}if(cb.data&&cb.processData&&typeof cb.data!=="string"){cb.data=bI.param(cb.data,cb.traditional);}n(v,cb,b4,ch);if(b6===2){return ch;}b3=cb.global;if(b3&&bI.active++===0){bI.event.trigger("ajaxStart");}cb.type=cb.type.toUpperCase();cb.hasContent=!o.test(cb.type);b8=cb.url;if(!cb.hasContent){if(cb.data){b8=(cb.url+=(ax.test(b8)?"&":"?")+cb.data);delete cb.data;}if(cb.cache===false){cb.url=M.test(b8)?b8.replace(M,"$1_="+bN++):b8+(ax.test(b8)?"&":"?")+"_="+bN++;}}if(cb.ifModified){if(bI.lastModified[b8]){ch.setRequestHeader("If-Modified-Since",bI.lastModified[b8]);}if(bI.etag[b8]){ch.setRequestHeader("If-None-Match",bI.etag[b8]);}}if(cb.data&&cb.hasContent&&cb.contentType!==false||b4.contentType){ch.setRequestHeader("Content-Type",cb.contentType);}ch.setRequestHeader("Accept",cb.dataTypes[0]&&cb.accepts[cb.dataTypes[0]]?cb.accepts[cb.dataTypes[0]]+(cb.dataTypes[0]!=="*"?", "+aU+"; q=0.01":""):cb.accepts["*"]);for(ci in cb.headers){ch.setRequestHeader(ci,cb.headers[ci]);}if(cb.beforeSend&&(cb.beforeSend.call(cp,ch,cb)===false||b6===2)){return ch.abort();}ca="abort";for(ci in {success:1,error:1,complete:1}){ch[ci](cb[ci]);}cj=n(a6,cb,b4,ch);if(!cj){cd(-1,"No Transport");}else{ch.readyState=1;if(b3){ce.trigger("ajaxSend",[ch,cb]);}if(cb.async&&cb.timeout>0){cc=setTimeout(function(){ch.abort("timeout");},cb.timeout);}try{b6=1;cj.send(cf,cd);}catch(ck){if(b6<2){cd(-1,ck);}else{throw ck;}}}function cd(cu,cq,cv,cs){var e,cy,cw,ct,cx,cr=cq;if(b6===2){return;}b6=2;if(cc){clearTimeout(cc);}cj=aE;cn=cs||"";ch.readyState=cu>0?4:0;cu=ch.getResponseHeader("Custom-Header-Status")||cu;e=cu>=200&&cu<300||cu===304;if(cv){ct=g(cb,ch,cv);}ct=ad(cb,ct,ch,e);if(e){if(cb.ifModified){cx=ch.getResponseHeader("Last-Modified");if(cx){bI.lastModified[b8]=cx;}cx=ch.getResponseHeader("etag");if(cx){bI.etag[b8]=cx;}}if(cu===204||cb.type==="HEAD"){cr="nocontent";}else{if(cu===304){cr="notmodified";}else{cr=ct.state;cy=ct.data;cw=ct.error;e=!cw;}}}else{cw=cr;if(cu||!cr){cr="error";if(cu<0){cu=0;}}}ch.status=cu;ch.statusText=(cq||cr)+"";if(e){co.resolveWith(cp,[cy,cr,ch]);}else{co.rejectWith(cp,[ch,cr,cw]);}ch.statusCode(b9);b9=aE;if(b3){ce.trigger(e?"ajaxSuccess":"ajaxError",[ch,cb,e?cy:cw]);}cl.fireWith(cp,[ch,cr]);if(b3){ce.trigger("ajaxComplete",[ch,cb]);if(!(--bI.active)){bI.event.trigger("ajaxStop");}}}return ch;},getJSON:function(e,b3,b4){return bI.get(e,b3,b4,"json");},getScript:function(e,b3){return bI.get(e,aE,b3,"script");}});bI.each(["get","post"],function(e,b3){bI[b3]=function(b4,b6,b7,b5){if(bI.isFunction(b6)){b5=b5||b7;b7=b6;b6=aE;}return bI.ajax({url:b4,type:b3,dataType:b5,data:b6,success:b7});};});function g(ca,b9,b6){var e,b5,b4,b7,b3=ca.contents,b8=ca.dataTypes;while(b8[0]==="*"){b8.shift();if(b5===aE){b5=ca.mimeType||b9.getResponseHeader("Content-Type");}}if(b5){for(b7 in b3){if(b3[b7]&&b3[b7].test(b5)){b8.unshift(b7);break;}}}if(b8[0] in b6){b4=b8[0];}else{for(b7 in b6){if(!b8[0]||ca.converters[b7+" "+b8[0]]){b4=b7;break;}if(!e){e=b7;}}b4=b4||e;}if(b4){if(b4!==b8[0]){b8.unshift(b4);}return b6[b4];}}function ad(ce,b6,cb,b4){var b3,b9,cc,b7,b5,cd={},ca=ce.dataTypes.slice();if(ca[1]){for(cc in ce.converters){cd[cc.toLowerCase()]=ce.converters[cc];}}b9=ca.shift();while(b9){if(ce.responseFields[b9]){cb[ce.responseFields[b9]]=b6;}if(!b5&&b4&&ce.dataFilter){b6=ce.dataFilter(b6,ce.dataType);}b5=b9;b9=ca.shift();if(b9){if(b9==="*"){b9=b5;}else{if(b5!=="*"&&b5!==b9){cc=cd[b5+" "+b9]||cd["* "+b9];if(!cc){for(b3 in cd){b7=b3.split(" ");if(b7[1]===b9){cc=cd[b5+" "+b7[0]]||cd["* "+b7[0]];if(cc){if(cc===true){cc=cd[b3];}else{if(cd[b3]!==true){b9=b7[0];ca.unshift(b7[1]);}}break;}}}}if(cc!==true){if(cc&&ce["throws"]){b6=cc(b6);}else{try{b6=cc(b6);}catch(b8){return{state:"parsererror",error:cc?b8:"No conversion from "+b5+" to "+b9};}}}}}}}return{state:"success",data:b6};}bI.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/(?:java|ecma)script/},converters:{"text script":function(e){bI.globalEval(e);return e;}}});bI.ajaxPrefilter("script",function(e){if(e.cache===aE){e.cache=false;}if(e.crossDomain){e.type="GET";e.global=false;}});bI.ajaxTransport("script",function(b4){if(b4.crossDomain){var e,b3=l.head||bI("head")[0]||l.documentElement;return{send:function(b5,b6){e=l.createElement("script");e.async=true;if(b4.scriptCharset){e.charset=b4.scriptCharset;}e.src=b4.url;e.onload=e.onreadystatechange=function(b8,b7){if(b7||!e.readyState||/loaded|complete/.test(e.readyState)){e.onload=e.onreadystatechange=null;if(e.parentNode){e.parentNode.removeChild(e);}e=null;if(!b7){b6(200,"success");}}};b3.insertBefore(e,b3.firstChild);},abort:function(){if(e){e.onload(aE,true);}}};}});var bp=[],a4=/(=)\?(?=&|$)|\?\?/;bI.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var e=bp.pop()||(bI.expando+"_"+(bN++));this[e]=true;return e;}});bI.ajaxPrefilter("json jsonp",function(b5,e,b6){var b8,b3,b4,b7=b5.jsonp!==false&&(a4.test(b5.url)?"url":typeof b5.data==="string"&&!(b5.contentType||"").indexOf("application/x-www-form-urlencoded")&&a4.test(b5.data)&&"data");if(b7||b5.dataTypes[0]==="jsonp"){b8=b5.jsonpCallback=bI.isFunction(b5.jsonpCallback)?b5.jsonpCallback():b5.jsonpCallback;if(b7){b5[b7]=b5[b7].replace(a4,"$1"+b8);}else{if(b5.jsonp!==false){b5.url+=(ax.test(b5.url)?"&":"?")+b5.jsonp+"="+b8;}}b5.converters["script json"]=function(){if(!b4){bI.error(b8+" was not called");}return b4[0];};b5.dataTypes[0]="json";b3=a1[b8];a1[b8]=function(){b4=arguments;};b6.always(function(){a1[b8]=b3;if(b5[b8]){b5.jsonpCallback=e.jsonpCallback;bp.push(b8);}if(b4&&bI.isFunction(b3)){b3(b4[0]);}b4=b3=aE;});return"script";}});var af,av,aw=0,aN=a1.ActiveXObject&&function(){var e;for(e in af){af[e](aE,true);}};function bC(){try{return new a1.XMLHttpRequest();}catch(b3){}}function bd(){try{return new a1.ActiveXObject("Microsoft.XMLHTTP");}catch(b3){}}bI.ajaxSettings.xhr=a1.ActiveXObject?function(){return !this.isLocal&&bC()||bd();}:bC;av=bI.ajaxSettings.xhr();bI.support.cors=!!av&&("withCredentials" in av);av=bI.support.ajax=!!av;if(av){bI.ajaxTransport(function(e){if(!e.crossDomain||bI.support.cors){var b3;return{send:function(b9,b4){var b7,b5,b8=e.xhr();if(e.username){b8.open(e.type,e.url,e.async,e.username,e.password);}else{b8.open(e.type,e.url,e.async);}if(e.xhrFields){for(b5 in e.xhrFields){b8[b5]=e.xhrFields[b5];}}if(e.mimeType&&b8.overrideMimeType){b8.overrideMimeType(e.mimeType);}if(!e.crossDomain&&!b9["X-Requested-With"]){b9["X-Requested-With"]="XMLHttpRequest";}try{for(b5 in b9){b8.setRequestHeader(b5,b9[b5]);}}catch(b6){}b8.send((e.hasContent&&e.data)||null);b3=function(cc,cb){var ca,cd,cg,ce;try{if(b3&&(cb||b8.readyState===4)){b3=aE;if(b7){b8.onreadystatechange=bI.noop;if(aN){delete af[b7];}}if(cb){if(b8.readyState!==4){b8.abort();}}else{ce={};ca=b8.status;cd=b8.getAllResponseHeaders();if(typeof b8.responseText==="string"){ce.text=b8.responseText;}try{cg=b8.statusText;}catch(cf){cg="";}if(!ca&&e.isLocal&&!e.crossDomain){ca=ce.text?200:404;}else{if(ca===1223){ca=204;}}}}}catch(ch){if(!cb){b4(-1,ch);}}if(ce){b4(ca,cg,ce,cd);}};if(!e.async){b3();}else{if(b8.readyState===4){setTimeout(b3);}else{b7=++aw;if(aN){if(!af){af={};bI(a1).unload(aN);}af[b7]=b3;}b8.onreadystatechange=b3;}}},abort:function(){if(b3){b3(aE,true);}}};}});}var J,ab,bQ=/^(?:toggle|show|hide)$/,bJ=new RegExp("^(?:([+-])=|)("+bz+")([a-z%]*)$","i"),bP=/queueHooks$/,az=[h],aY={"*":[function(e,b8){var ca=this.createTween(e,b8),b6=ca.cur(),b5=bJ.exec(b8),b9=b5&&b5[3]||(bI.cssNumber[e]?"":"px"),b3=(bI.cssNumber[e]||b9!=="px"&&+b6)&&bJ.exec(bI.css(ca.elem,e)),b4=1,b7=20;if(b3&&b3[3]!==b9){b9=b9||b3[3];b5=b5||[];b3=+b6||1;do{b4=b4||".5";b3=b3/b4;bI.style(ca.elem,e,b3+b9);}while(b4!==(b4=ca.cur()/b6)&&b4!==1&&--b7);}if(b5){b3=ca.start=+b3||+b6||0;ca.unit=b9;ca.end=b5[1]?b3+(b5[1]+1)*b5[2]:+b5[2];}return ca;}]};function bl(){setTimeout(function(){J=aE;});return(J=bI.now());}function ba(b6,b8,b5){var b3,b7=(aY[b8]||[]).concat(aY["*"]),e=0,b4=b7.length;for(;e<b4;e++){if((b3=b7[e].call(b5,b8,b6))){return b3;}}}function f(b4,b8,cb){var cc,e,b7=0,b3=az.length,ca=bI.Deferred().always(function(){delete b6.elem;}),b6=function(){if(e){return false;}var ci=J||bl(),cf=Math.max(0,b5.startTime+b5.duration-ci),cd=cf/b5.duration||0,ch=1-cd,ce=0,cg=b5.tweens.length;for(;ce<cg;ce++){b5.tweens[ce].run(ch);}ca.notifyWith(b4,[b5,ch,cf]);if(ch<1&&cg){return cf;}else{ca.resolveWith(b4,[b5]);return false;}},b5=ca.promise({elem:b4,props:bI.extend({},b8),opts:bI.extend(true,{specialEasing:{}},cb),originalProperties:b8,originalOptions:cb,startTime:J||bl(),duration:cb.duration,tweens:[],createTween:function(cf,cd){var ce=bI.Tween(b4,b5.opts,cf,cd,b5.opts.specialEasing[cf]||b5.opts.easing);b5.tweens.push(ce);return ce;},stop:function(ce){var cd=0,cf=ce?b5.tweens.length:0;if(e){return this;}e=true;for(;cd<cf;cd++){b5.tweens[cd].run(1);}if(ce){ca.resolveWith(b4,[b5,ce]);}else{ca.rejectWith(b4,[b5,ce]);}return this;}}),b9=b5.props;ak(b9,b5.opts.specialEasing);for(;b7<b3;b7++){cc=az[b7].call(b5,b4,b9,b5.opts);if(cc){return cc;}}bI.map(b9,ba,b5);if(bI.isFunction(b5.opts.start)){b5.opts.start.call(b4,b5);}bI.fx.timer(bI.extend(b6,{elem:b4,anim:b5,queue:b5.opts.queue}));return b5.progress(b5.opts.progress).done(b5.opts.done,b5.opts.complete).fail(b5.opts.fail).always(b5.opts.always);}function ak(b5,b7){var b4,b3,b8,b6,e;for(b4 in b5){b3=bI.camelCase(b4);b8=b7[b3];b6=b5[b4];if(bI.isArray(b6)){b8=b6[1];b6=b5[b4]=b6[0];}if(b4!==b3){b5[b3]=b6;delete b5[b4];}e=bI.cssHooks[b3];if(e&&"expand" in e){b6=e.expand(b6);delete b5[b3];for(b4 in b6){if(!(b4 in b5)){b5[b4]=b6[b4];b7[b4]=b8;}}}else{b7[b3]=b8;}}}bI.Animation=bI.extend(f,{tweener:function(b3,b6){if(bI.isFunction(b3)){b6=b3;b3=["*"];}else{b3=b3.split(" ");}var b5,e=0,b4=b3.length;for(;e<b4;e++){b5=b3[e];aY[b5]=aY[b5]||[];aY[b5].unshift(b6);}},prefilter:function(b3,e){if(e){az.unshift(b3);}else{az.push(b3);}}});function h(b5,b9,e){var b4,cb,b7,ce,cf,cc,b6=this,ca={},b3=b5.style,b8=b5.nodeType&&N(b5),cd=bI._data(b5,"fxshow");if(!e.queue){cf=bI._queueHooks(b5,"fx");if(cf.unqueued==null){cf.unqueued=0;cc=cf.empty.fire;cf.empty.fire=function(){if(!cf.unqueued){cc();}};}cf.unqueued++;b6.always(function(){b6.always(function(){cf.unqueued--;if(!bI.queue(b5,"fx").length){cf.empty.fire();}});});}if(b5.nodeType===1&&("height" in b9||"width" in b9)){e.overflow=[b3.overflow,b3.overflowX,b3.overflowY];if(bI.css(b5,"display")==="inline"&&bI.css(b5,"float")==="none"){if(!bI.support.inlineBlockNeedsLayout||bD(b5.nodeName)==="inline"){b3.display="inline-block";}else{b3.zoom=1;}}}if(e.overflow){b3.overflow="hidden";if(!bI.support.shrinkWrapBlocks){b6.always(function(){b3.overflow=e.overflow[0];b3.overflowX=e.overflow[1];b3.overflowY=e.overflow[2];});}}for(b4 in b9){cb=b9[b4];if(bQ.exec(cb)){delete b9[b4];b7=b7||cb==="toggle";if(cb===(b8?"hide":"show")){continue;}ca[b4]=cd&&cd[b4]||bI.style(b5,b4);}}if(!bI.isEmptyObject(ca)){if(cd){if("hidden" in cd){b8=cd.hidden;}}else{cd=bI._data(b5,"fxshow",{});}if(b7){cd.hidden=!b8;}if(b8){bI(b5).show();}else{b6.done(function(){bI(b5).hide();});}b6.done(function(){var cg;bI._removeData(b5,"fxshow");for(cg in ca){bI.style(b5,cg,ca[cg]);}});for(b4 in ca){ce=ba(b8?cd[b4]:0,b4,b6);if(!(b4 in cd)){cd[b4]=ce.start;if(b8){ce.end=ce.start;ce.start=b4==="width"||b4==="height"?1:0;}}}}}function F(b4,b3,b6,e,b5){return new F.prototype.init(b4,b3,b6,e,b5);}bI.Tween=F;F.prototype={constructor:F,init:function(b5,b3,b7,e,b6,b4){this.elem=b5;this.prop=b7;this.easing=b6||"swing";this.options=b3;this.start=this.now=this.cur();this.end=e;this.unit=b4||(bI.cssNumber[b7]?"":"px");},cur:function(){var e=F.propHooks[this.prop];return e&&e.get?e.get(this):F.propHooks._default.get(this);},run:function(b4){var b3,e=F.propHooks[this.prop];if(this.options.duration){this.pos=b3=bI.easing[this.easing](b4,this.options.duration*b4,0,1,this.options.duration);}else{this.pos=b3=b4;}this.now=(this.end-this.start)*b3+this.start;if(this.options.step){this.options.step.call(this.elem,this.now,this);}if(e&&e.set){e.set(this);}else{F.propHooks._default.set(this);}return this;}};F.prototype.init.prototype=F.prototype;F.propHooks={_default:{get:function(b3){var e;if(b3.elem[b3.prop]!=null&&(!b3.elem.style||b3.elem.style[b3.prop]==null)){return b3.elem[b3.prop];}e=bI.css(b3.elem,b3.prop,"");return !e||e==="auto"?0:e;},set:function(e){if(bI.fx.step[e.prop]){bI.fx.step[e.prop](e);}else{if(e.elem.style&&(e.elem.style[bI.cssProps[e.prop]]!=null||bI.cssHooks[e.prop])){bI.style(e.elem,e.prop,e.now+e.unit);}else{e.elem[e.prop]=e.now;}}}}};F.propHooks.scrollTop=F.propHooks.scrollLeft={set:function(e){if(e.elem.nodeType&&e.elem.parentNode){e.elem[e.prop]=e.now;}}};bI.each(["toggle","show","hide"],function(b3,e){var b4=bI.fn[e];bI.fn[e]=function(b5,b7,b6){return b5==null||typeof b5==="boolean"?b4.apply(this,arguments):this.animate(bH(e,true),b5,b7,b6);};});bI.fn.extend({fadeTo:function(e,b5,b4,b3){return this.filter(N).css("opacity",0).show().end().animate({opacity:b5},e,b4,b3);},animate:function(b8,b5,b7,b6){var b4=bI.isEmptyObject(b8),e=bI.speed(b5,b7,b6),b3=function(){var b9=f(this,bI.extend({},b8),e);if(b4||bI._data(this,"finish")){b9.stop(true);}};b3.finish=b3;return b4||e.queue===false?this.each(b3):this.queue(e.queue,b3);},stop:function(b4,b3,e){var b5=function(b6){var b7=b6.stop;delete b6.stop;b7(e);};if(typeof b4!=="string"){e=b3;b3=b4;b4=aE;}if(b3&&b4!==false){this.queue(b4||"fx",[]);}return this.each(function(){var b9=true,b6=b4!=null&&b4+"queueHooks",b8=bI.timers,b7=bI._data(this);if(b6){if(b7[b6]&&b7[b6].stop){b5(b7[b6]);}}else{for(b6 in b7){if(b7[b6]&&b7[b6].stop&&bP.test(b6)){b5(b7[b6]);}}}for(b6=b8.length;b6--;){if(b8[b6].elem===this&&(b4==null||b8[b6].queue===b4)){b8[b6].anim.stop(e);b9=false;b8.splice(b6,1);}}if(b9||!e){bI.dequeue(this,b4);}});},finish:function(e){if(e!==false){e=e||"fx";}return this.each(function(){var b5,b8=bI._data(this),b4=b8[e+"queue"],b3=b8[e+"queueHooks"],b7=bI.timers,b6=b4?b4.length:0;b8.finish=true;bI.queue(this,e,[]);if(b3&&b3.stop){b3.stop.call(this,true);}for(b5=b7.length;b5--;){if(b7[b5].elem===this&&b7[b5].queue===e){b7[b5].anim.stop(true);b7.splice(b5,1);}}for(b5=0;b5<b6;b5++){if(b4[b5]&&b4[b5].finish){b4[b5].finish.call(this);}}delete b8.finish;});}});function bH(b4,b6){var b5,e={height:b4},b3=0;b6=b6?1:0;for(;b3<4;b3+=2-b6){b5=bS[b3];e["margin"+b5]=e["padding"+b5]=b4;}if(b6){e.opacity=e.width=b4;}return e;}bI.each({slideDown:bH("show"),slideUp:bH("hide"),slideToggle:bH("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(e,b3){bI.fn[e]=function(b4,b6,b5){return this.animate(b3,b4,b6,b5);};});bI.speed=function(b4,b5,b3){var e=b4&&typeof b4==="object"?bI.extend({},b4):{complete:b3||!b3&&b5||bI.isFunction(b4)&&b4,duration:b4,easing:b3&&b5||b5&&!bI.isFunction(b5)&&b5};e.duration=bI.fx.off?0:typeof e.duration==="number"?e.duration:e.duration in bI.fx.speeds?bI.fx.speeds[e.duration]:bI.fx.speeds._default;if(e.queue==null||e.queue===true){e.queue="fx";}e.old=e.complete;e.complete=function(){if(bI.isFunction(e.old)){e.old.call(this);}if(e.queue){bI.dequeue(this,e.queue);}};return e;};bI.easing={linear:function(e){return e;},swing:function(e){return 0.5-Math.cos(e*Math.PI)/2;}};bI.timers=[];bI.fx=F.prototype.init;bI.fx.tick=function(){var b4,b3=bI.timers,e=0;J=bI.now();for(;e<b3.length;e++){b4=b3[e];if(!b4()&&b3[e]===b4){b3.splice(e--,1);}}if(!b3.length){bI.fx.stop();}J=aE;};bI.fx.timer=function(e){if(e()&&bI.timers.push(e)){bI.fx.start();}};bI.fx.interval=13;bI.fx.start=function(){if(!ab){ab=setInterval(bI.fx.tick,bI.fx.interval);}};bI.fx.stop=function(){clearInterval(ab);ab=null;};bI.fx.speeds={slow:600,fast:200,_default:400};bI.fx.step={};if(bI.expr&&bI.expr.filters){bI.expr.filters.animated=function(e){return bI.grep(bI.timers,function(b3){return e===b3.elem;}).length;};}bI.fn.offset=function(b3){if(arguments.length){return b3===aE?this:this.each(function(b8){bI.offset.setOffset(this,b3,b8);});}var e,b7,b5={top:0,left:0},b4=this[0],b6=b4&&b4.ownerDocument;if(!b6){return;}e=b6.documentElement;if(!bI.contains(e,b4)){return b5;}if(typeof b4.getBoundingClientRect!==aA){b5=b4.getBoundingClientRect();}b7=bo(b6);return{top:b5.top+(b7.pageYOffset||e.scrollTop)-(e.clientTop||0),left:b5.left+(b7.pageXOffset||e.scrollLeft)-(e.clientLeft||0)};};bI.offset={setOffset:function(b5,ce,b8){var b9=bI.css(b5,"position");if(b9==="static"){b5.style.position="relative";}var b7=bI(b5),b3=b7.offset(),e=bI.css(b5,"top"),cc=bI.css(b5,"left"),cd=(b9==="absolute"||b9==="fixed")&&bI.inArray("auto",[e,cc])>-1,cb={},ca={},b4,b6;if(cd){ca=b7.position();b4=ca.top;b6=ca.left;}else{b4=parseFloat(e)||0;b6=parseFloat(cc)||0;}if(bI.isFunction(ce)){ce=ce.call(b5,b8,b3);}if(ce.top!=null){cb.top=(ce.top-b3.top)+b4;}if(ce.left!=null){cb.left=(ce.left-b3.left)+b6;}if("using" in ce){ce.using.call(b5,cb);}else{b7.css(cb);}}};bI.fn.extend({position:function(){if(!this[0]){return;}var b4,b5,e={top:0,left:0},b3=this[0];if(bI.css(b3,"position")==="fixed"){b5=b3.getBoundingClientRect();}else{b4=this.offsetParent();b5=this.offset();if(!bI.nodeName(b4[0],"html")){e=b4.offset();}e.top+=bI.css(b4[0],"borderTopWidth",true);e.left+=bI.css(b4[0],"borderLeftWidth",true);}return{top:b5.top-e.top-bI.css(b3,"marginTop",true),left:b5.left-e.left-bI.css(b3,"marginLeft",true)};},offsetParent:function(){return this.map(function(){var e=this.offsetParent||bV;while(e&&(!bI.nodeName(e,"html")&&bI.css(e,"position")==="static")){e=e.offsetParent;}return e||bV;});}});bI.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(b4,b3){var e=/Y/.test(b3);bI.fn[b4]=function(b5){return bI.access(this,function(b6,b9,b8){var b7=bo(b6);if(b8===aE){return b7?(b3 in b7)?b7[b3]:b7.document.documentElement[b9]:b6[b9];}if(b7){b7.scrollTo(!e?b8:bI(b7).scrollLeft(),e?b8:bI(b7).scrollTop());}else{b6[b9]=b8;}},b4,b5,arguments.length,null);};});function bo(e){return bI.isWindow(e)?e:e.nodeType===9?e.defaultView||e.parentWindow:false;}bI.each({Height:"height",Width:"width"},function(e,b3){bI.each({padding:"inner"+e,content:b3,"":"outer"+e},function(b4,b5){bI.fn[b5]=function(b9,b8){var b7=arguments.length&&(b4||typeof b9!=="boolean"),b6=b4||(b9===true||b8===true?"margin":"border");return bI.access(this,function(cb,ca,cc){var cd;if(bI.isWindow(cb)){return cb.document.documentElement["client"+e];}if(cb.nodeType===9){cd=cb.documentElement;return Math.max(cb.body["scroll"+e],cd["scroll"+e],cb.body["offset"+e],cd["offset"+e],cd["client"+e]);}return cc===aE?bI.css(cb,ca,b6):bI.style(cb,ca,cc,b6);},b3,b7?b9:aE,b7,null);};});});bI.fn.size=function(){return this.length;};bI.fn.andSelf=bI.fn.addBack;if(typeof module==="object"&&module&&typeof module.exports==="object"){module.exports=bI;}else{a1.jQuery=a1.$=bI;if(typeof define==="function"&&define.amd){define("jquery",[],function(){return bI;});}}})(window);
/*
 * Backbone.js 1.0.0

 * (c) 2010-2013 Jeremy Ashkenas, DocumentCloud Inc.
 * Backbone may be freely distributed under the MIT license.
 * For all details and documentation:
 * http://backbonejs.org
 */
(function(){var u=this;var B=u.Backbone;var g=[];var D=g.push;var n=g.slice;var t=g.splice;var z;if(typeof exports!=="undefined"){z=exports;}else{z=u.Backbone={};}z.VERSION="1.0.0";var L=u._;if(!L&&(typeof require!=="undefined")){L=require("underscore");}z.$=u.jQuery||u.Zepto||u.ender||u.$;z.noConflict=function(){u.Backbone=B;return this;};z.emulateHTTP=false;z.emulateJSON=false;var J=z.Events={on:function(M,P,O){if(!x(this,"on",M,[P,O])||!P){return this;}this._events||(this._events={});var N=this._events[M]||(this._events[M]=[]);N.push({callback:P,context:O,ctx:O||this});return this;},once:function(N,Q,O){if(!x(this,"once",N,[Q,O])||!Q){return this;}var M=this;var P=L.once(function(){M.off(N,P);Q.apply(this,arguments);});P._callback=Q;return this.on(N,P,O);},off:function(M,V,N){var T,U,W,S,R,O,Q,P;if(!this._events||!x(this,"off",M,[V,N])){return this;}if(!M&&!V&&!N){this._events={};return this;}S=M?[M]:L.keys(this._events);for(R=0,O=S.length;R<O;R++){M=S[R];if(W=this._events[M]){this._events[M]=T=[];if(V||N){for(Q=0,P=W.length;Q<P;Q++){U=W[Q];if((V&&V!==U.callback&&V!==U.callback._callback)||(N&&N!==U.context)){T.push(U);}}}if(!T.length){delete this._events[M];}}}return this;},trigger:function(O){if(!this._events){return this;}var N=n.call(arguments,1);if(!x(this,"trigger",O,N)){return this;}var P=this._events[O];var M=this._events.all;if(P){b(P,N);}if(M){b(M,arguments);}return this;},stopListening:function(P,M,R){var N=this._listeners;if(!N){return this;}var O=!M&&!R;if(typeof M==="object"){R=this;}if(P){(N={})[P._listenerId]=P;}for(var Q in N){N[Q].off(M,R,this);if(O){delete this._listeners[Q];}}return this;}};var w=/\s+/;var x=function(T,R,N,Q){if(!N){return true;}if(typeof N==="object"){for(var P in N){T[R].apply(T,[P,N[P]].concat(Q));}return false;}if(w.test(N)){var S=N.split(w);for(var O=0,M=S.length;O<M;O++){T[R].apply(T,[S[O]].concat(Q));}return false;}return true;};var b=function(R,P){var S,Q=-1,O=R.length,N=P[0],M=P[1],T=P[2];switch(P.length){case 0:while(++Q<O){(S=R[Q]).callback.call(S.ctx);}return;case 1:while(++Q<O){(S=R[Q]).callback.call(S.ctx,N);}return;case 2:while(++Q<O){(S=R[Q]).callback.call(S.ctx,N,M);}return;case 3:while(++Q<O){(S=R[Q]).callback.call(S.ctx,N,M,T);}return;default:while(++Q<O){(S=R[Q]).callback.apply(S.ctx,P);}}};var C={listenTo:"on",listenToOnce:"once"};L.each(C,function(M,N){J[N]=function(Q,O,S){var P=this._listeners||(this._listeners={});var R=Q._listenerId||(Q._listenerId=L.uniqueId("l"));P[R]=Q;if(typeof O==="object"){S=this;}Q[M](O,S,this);return this;};});J.bind=J.on;J.unbind=J.off;L.extend(z,J);var E=z.Model=function(M,O){var P;var N=M||{};O||(O={});this.cid=L.uniqueId("c");this.attributes={};L.extend(this,L.pick(O,F));if(O.parse){N=this.parse(N,O)||{};}if(P=L.result(this,"defaults")){N=L.defaults({},N,P);}this.set(N,O);this.changed={};this.initialize.apply(this,arguments);};var F=["url","urlRoot","collection"];L.extend(E.prototype,J,{changed:null,validationError:null,idAttribute:"id",initialize:function(){},toJSON:function(M){return L.clone(this.attributes);},sync:function(){return z.sync.apply(this,arguments);},get:function(M){return this.attributes[M];},escape:function(M){return L.escape(this.get(M));},has:function(M){return this.get(M)!=null;},set:function(U,M,Y){var S,V,W,T,R,X,O,Q;if(U==null){return this;}if(typeof U==="object"){V=U;Y=M;}else{(V={})[U]=M;}Y||(Y={});if(!this._validate(V,Y)){return false;}W=Y.unset;R=Y.silent;T=[];X=this._changing;this._changing=true;if(!X){this._previousAttributes=L.clone(this.attributes);this.changed={};}Q=this.attributes,O=this._previousAttributes;if(this.idAttribute in V){this.id=V[this.idAttribute];}for(S in V){M=V[S];if(!L.isEqual(Q[S],M)){T.push(S);}if(!L.isEqual(O[S],M)){this.changed[S]=M;}else{delete this.changed[S];}W?delete Q[S]:Q[S]=M;}if(!R){if(T.length){this._pending=true;}for(var P=0,N=T.length;P<N;P++){this.trigger("change:"+T[P],this,Q[T[P]],Y);}}if(X){return this;}if(!R){while(this._pending){this._pending=false;this.trigger("change",this,Y);}}this._pending=false;this._changing=false;return this;},unset:function(M,N){return this.set(M,void 0,L.extend({},N,{unset:true}));},clear:function(N){var M={};for(var O in this.attributes){M[O]=void 0;}return this.set(M,L.extend({},N,{unset:true}));},hasChanged:function(M){if(M==null){return !L.isEmpty(this.changed);}return L.has(this.changed,M);},changedAttributes:function(O){if(!O){return this.hasChanged()?L.clone(this.changed):false;}var Q,P=false;var N=this._changing?this._previousAttributes:this.attributes;for(var M in O){if(L.isEqual(N[M],(Q=O[M]))){continue;}(P||(P={}))[M]=Q;}return P;},previous:function(M){if(M==null||!this._previousAttributes){return null;}return this._previousAttributes[M];},previousAttributes:function(){return L.clone(this._previousAttributes);},fetch:function(N){N=N?L.clone(N):{};if(N.parse===void 0){N.parse=true;}var M=this;var O=N.success;N.success=function(P){if(!M.set(M.parse(P,N),N)){return false;}if(O){O(M,P,N);}M.trigger("sync",M,P,N);};H(this,N);return this.sync("read",this,N);},save:function(Q,N,U){var R,M,T,O=this.attributes;if(Q==null||typeof Q==="object"){R=Q;U=N;}else{(R={})[Q]=N;}if(R&&(!U||!U.wait)&&!this.set(R,U)){return false;}U=L.extend({validate:true},U);if(!this._validate(R,U)){return false;}if(R&&U.wait){this.attributes=L.extend({},O,R);}if(U.parse===void 0){U.parse=true;}var P=this;var S=U.success;U.success=function(W){P.attributes=O;var V=P.parse(W,U);if(U.wait){V=L.extend(R||{},V);}if(L.isObject(V)&&!P.set(V,U)){return false;}if(S){S(P,W,U);}P.trigger("sync",P,W,U);};H(this,U);M=this.isNew()?"create":(U.patch?"patch":"update");if(M==="patch"){U.attrs=R;}T=this.sync(M,this,U);if(R&&U.wait){this.attributes=O;}return T;},destroy:function(N){N=N?L.clone(N):{};var M=this;var Q=N.success;var O=function(){M.trigger("destroy",M,M.collection,N);};N.success=function(R){if(N.wait||M.isNew()){O();}if(Q){Q(M,R,N);}if(!M.isNew()){M.trigger("sync",M,R,N);}};if(this.isNew()){N.success();return false;}H(this,N);var P=this.sync("delete",this,N);if(!N.wait){O();}return P;},url:function(){var M=L.result(this,"urlRoot")||L.result(this.collection,"url")||r();if(this.isNew()){return M;}return M+(M.charAt(M.length-1)==="/"?"":"/")+encodeURIComponent(this.id);},parse:function(N,M){return N;},clone:function(){return new this.constructor(this.attributes);},isNew:function(){return this.id==null;},isValid:function(M){return this._validate({},L.extend(M||{},{validate:true}));},_validate:function(O,N){if(!N.validate||!this.validate){return true;}O=L.extend({},this.attributes,O);var M=this.validationError=this.validate(O,N)||null;if(!M){return true;}this.trigger("invalid",this,M,L.extend(N||{},{validationError:M}));return false;}});var a=["keys","values","pairs","invert","pick","omit"];L.each(a,function(M){E.prototype[M]=function(){var N=n.call(arguments);N.unshift(this.attributes);return L[M].apply(L,N);};});var c=z.Collection=function(N,M){M||(M={});if(M.url){this.url=M.url;}if(M.model){this.model=M.model;}if(M.comparator!==void 0){this.comparator=M.comparator;}this._reset();this.initialize.apply(this,arguments);if(N){this.reset(N,L.extend({silent:true},M));}};var o={add:true,remove:true,merge:true};var K={add:true,merge:false,remove:false};L.extend(c.prototype,J,{model:E,initialize:function(){},toJSON:function(M){return this.map(function(N){return N.toJSON(M);});},sync:function(){return z.sync.apply(this,arguments);},add:function(N,M){return this.set(N,L.defaults(M||{},K));},remove:function(R,P){R=L.isArray(R)?R.slice():[R];P||(P={});var Q,M,O,N;for(Q=0,M=R.length;Q<M;Q++){N=this.get(R[Q]);if(!N){continue;}delete this._byId[N.id];delete this._byId[N.cid];O=this.indexOf(N);this.models.splice(O,1);this.length--;if(!P.silent){P.index=O;N.trigger("remove",N,this,P);}this._removeReference(N);}return this;},set:function(N,Z){Z=L.defaults(Z||{},o);if(Z.parse){N=this.parse(N,Z);}if(!L.isArray(N)){N=N?[N]:[];}var U,Q,W,X,O,V;var P=Z.at;var T=this.comparator&&(P==null)&&Z.sort!==false;var R=L.isString(this.comparator)?this.comparator:null;var Y=[],M=[],S={};for(U=0,Q=N.length;U<Q;U++){if(!(W=this._prepareModel(N[U],Z))){continue;}if(O=this.get(W)){if(Z.remove){S[O.cid]=true;}if(Z.merge){O.set(W.attributes,Z);if(T&&!V&&O.hasChanged(R)){V=true;}}}else{if(Z.add){Y.push(W);W.on("all",this._onModelEvent,this);this._byId[W.cid]=W;if(W.id!=null){this._byId[W.id]=W;}}}}if(Z.remove){for(U=0,Q=this.length;U<Q;++U){if(!S[(W=this.models[U]).cid]){M.push(W);}}if(M.length){this.remove(M,Z);}}if(Y.length){if(T){V=true;}this.length+=Y.length;if(P!=null){t.apply(this.models,[P,0].concat(Y));}else{D.apply(this.models,Y);}}if(V){this.sort({silent:true});}if(Z.silent){return this;}for(U=0,Q=Y.length;U<Q;U++){(W=Y[U]).trigger("add",W,this,Z);}if(V){this.trigger("sort",this,Z);}return this;},reset:function(P,N){N||(N={});for(var O=0,M=this.models.length;O<M;O++){this._removeReference(this.models[O]);}N.previousModels=this.models;this._reset();this.add(P,L.extend({silent:true},N));if(!N.silent){this.trigger("reset",this,N);}return this;},push:function(N,M){N=this._prepareModel(N,M);this.add(N,L.extend({at:this.length},M));return N;},pop:function(N){var M=this.at(this.length-1);this.remove(M,N);return M;},unshift:function(N,M){N=this._prepareModel(N,M);this.add(N,L.extend({at:0},M));return N;},shift:function(N){var M=this.at(0);this.remove(M,N);return M;},slice:function(N,M){return this.models.slice(N,M);},get:function(M){if(M==null){return void 0;}return this._byId[M.id!=null?M.id:M.cid||M];},at:function(M){return this.models[M];},where:function(M,N){if(L.isEmpty(M)){return N?void 0:[];}return this[N?"find":"filter"](function(O){for(var P in M){if(M[P]!==O.get(P)){return false;}}return true;});},findWhere:function(M){return this.where(M,true);},sort:function(M){if(!this.comparator){throw new Error("Cannot sort a set without a comparator");}M||(M={});if(L.isString(this.comparator)||this.comparator.length===1){this.models=this.sortBy(this.comparator,this);}else{this.models.sort(L.bind(this.comparator,this));}if(!M.silent){this.trigger("sort",this,M);}return this;},sortedIndex:function(M,P,N){P||(P=this.comparator);var O=L.isFunction(P)?P:function(Q){return Q.get(P);};return L.sortedIndex(this.models,M,O,N);},pluck:function(M){return L.invoke(this.models,"get",M);},fetch:function(M){M=M?L.clone(M):{};if(M.parse===void 0){M.parse=true;}var O=M.success;var N=this;M.success=function(P){var Q=M.reset?"reset":"set";N[Q](P,M);if(O){O(N,P,M);}N.trigger("sync",N,P,M);};H(this,M);return this.sync("read",this,M);},create:function(N,M){M=M?L.clone(M):{};if(!(N=this._prepareModel(N,M))){return false;}if(!M.wait){this.add(N,M);}var P=this;var O=M.success;M.success=function(Q){if(M.wait){P.add(N,M);}if(O){O(N,Q,M);}};N.save(null,M);return N;},parse:function(N,M){return N;},clone:function(){return new this.constructor(this.models);},_reset:function(){this.length=0;this.models=[];this._byId={};},_prepareModel:function(O,N){if(O instanceof E){if(!O.collection){O.collection=this;}return O;}N||(N={});N.collection=this;var M=new this.model(O,N);if(!M._validate(O,N)){this.trigger("invalid",this,O,N);return false;}return M;},_removeReference:function(M){if(this===M.collection){delete M.collection;}M.off("all",this._onModelEvent,this);},_onModelEvent:function(O,N,P,M){if((O==="add"||O==="remove")&&P!==this){return;}if(O==="destroy"){this.remove(N,M);}if(N&&O==="change:"+N.idAttribute){delete this._byId[N.previous(N.idAttribute)];if(N.id!=null){this._byId[N.id]=N;}}this.trigger.apply(this,arguments);}});var y=["forEach","each","map","collect","reduce","foldl","inject","reduceRight","foldr","find","detect","filter","select","reject","every","all","some","any","include","contains","invoke","max","min","toArray","size","first","head","take","initial","rest","tail","drop","last","without","indexOf","shuffle","lastIndexOf","isEmpty","chain"];L.each(y,function(M){c.prototype[M]=function(){var N=n.call(arguments);N.unshift(this.models);return L[M].apply(L,N);};});var k=["groupBy","countBy","sortBy"];L.each(k,function(M){c.prototype[M]=function(P,N){var O=L.isFunction(P)?P:function(Q){return Q.get(P);};return L[M](this.models,O,N);};});var G=z.View=function(M){this.cid=L.uniqueId("view");this._configure(M||{});this._ensureElement();this.initialize.apply(this,arguments);this.delegateEvents();};var v=/^(\S+)\s*(.*)$/;var e=["model","collection","el","id","attributes","className","tagName","events"];L.extend(G.prototype,J,{tagName:"div",$:function(M){return this.$el.find(M);},initialize:function(){},render:function(){return this;},remove:function(){this.$el.remove();this.stopListening();return this;},setElement:function(M,N){if(this.$el){this.undelegateEvents();}this.$el=M instanceof z.$?M:z.$(M);this.el=this.$el[0];if(N!==false){this.delegateEvents();}return this;},delegateEvents:function(Q){if(!(Q||(Q=L.result(this,"events")))){return this;}this.undelegateEvents();for(var P in Q){var R=Q[P];if(!L.isFunction(R)){R=this[Q[P]];}if(!R){continue;}var O=P.match(v);var N=O[1],M=O[2];R=L.bind(R,this);N+=".delegateEvents"+this.cid;if(M===""){this.$el.on(N,R);}else{this.$el.on(N,M,R);}}return this;},undelegateEvents:function(){this.$el.off(".delegateEvents"+this.cid);return this;},_configure:function(M){if(this.options){M=L.extend({},L.result(this,"options"),M);}L.extend(this,L.pick(M,e));this.options=M;},_ensureElement:function(){if(!this.el){var M=L.extend({},L.result(this,"attributes"));if(this.id){M.id=L.result(this,"id");}if(this.className){M["class"]=L.result(this,"className");}var N=z.$("<"+L.result(this,"tagName")+">").attr(M);this.setElement(N,false);}else{this.setElement(L.result(this,"el"),false);}}});z.sync=function(S,N,M){var P=j[S];L.defaults(M||(M={}),{emulateHTTP:z.emulateHTTP,emulateJSON:z.emulateJSON});var R={type:P,dataType:"json"};if(!M.url){R.url=L.result(N,"url")||r();}if(M.data==null&&N&&(S==="create"||S==="update"||S==="patch")){R.contentType="application/json";R.data=JSON.stringify(M.attrs||N.toJSON(M));}if(M.emulateJSON){R.contentType="application/x-www-form-urlencoded";R.data=R.data?{model:R.data}:{};}if(M.emulateHTTP&&(P==="PUT"||P==="DELETE"||P==="PATCH")){R.type="POST";if(M.emulateJSON){R.data._method=P;}var O=M.beforeSend;M.beforeSend=function(T){T.setRequestHeader("X-HTTP-Method-Override",P);if(O){return O.apply(this,arguments);}};}if(R.type!=="GET"&&!M.emulateJSON){R.processData=false;}if(R.type==="PATCH"&&window.ActiveXObject&&!(window.external&&window.external.msActiveXFilteringEnabled)){R.xhr=function(){return new ActiveXObject("Microsoft.XMLHTTP");};}var Q=M.xhr=z.ajax(L.extend(R,M));N.trigger("request",N,Q,M);return Q;};var j={create:"POST",update:"PUT",patch:"PATCH","delete":"DELETE",read:"GET"};z.ajax=function(){return z.$.ajax.apply(z.$,arguments);};var p=z.Router=function(M){M||(M={});if(M.routes){this.routes=M.routes;}this._bindRoutes();this.initialize.apply(this,arguments);};var q=/\((.*?)\)/g;var s=/(\(\?)?:\w+/g;var d=/\*\w+/g;var h=/[\-{}\[\]+?.,\\\^$|#\s]/g;L.extend(p.prototype,J,{initialize:function(){},route:function(N,O,P){if(!L.isRegExp(N)){N=this._routeToRegExp(N);}if(L.isFunction(O)){P=O;O="";}if(!P){P=this[O];}var M=this;z.history.route(N,function(R){var Q=M._extractParameters(N,R);P&&P.apply(M,Q);M.trigger.apply(M,["route:"+O].concat(Q));M.trigger("route",O,Q);z.history.trigger("route",M,O,Q);});return this;},navigate:function(N,M){z.history.navigate(N,M);return this;},_bindRoutes:function(){if(!this.routes){return;}this.routes=L.result(this,"routes");var N,M=L.keys(this.routes);while((N=M.pop())!=null){this.route(N,this.routes[N]);}},_routeToRegExp:function(M){M=M.replace(h,"\\$&").replace(q,"(?:$1)?").replace(s,function(O,N){return N?O:"([^/]+)";}).replace(d,"(.*?)");return new RegExp("^"+M+"$");},_extractParameters:function(M,N){var O=M.exec(N).slice(1);return L.map(O,function(P){return P?decodeURIComponent(P):null;});}});var i=z.History=function(){this.handlers=[];L.bindAll(this,"checkUrl");if(typeof window!=="undefined"){this.location=window.location;this.history=window.history;}};var A=/^[#\/]|\s+$/g;var f=/^\/+|\/+$/g;var I=/msie [\w.]+/;var m=/\/$/;i.started=false;L.extend(i.prototype,J,{interval:50,getHash:function(N){var M=(N||this).location.href.match(/#(.*)$/);return M?M[1]:"";},getFragment:function(O,N){if(O==null){if(this._hasPushState||!this._wantsHashChange||N){O=this.location.pathname;var M=this.root.replace(m,"");if(!O.indexOf(M)){O=O.substr(M.length);}}else{O=this.getHash();}}return O.replace(A,"");},start:function(O){if(i.started){throw new Error("Backbone.history has already been started");}i.started=true;this.options=L.extend({},{root:"/"},this.options,O);this.root=this.options.root;this._wantsHashChange=this.options.hashChange!==false;this._wantsPushState=!!this.options.pushState;this._hasPushState=!!(this.options.pushState&&this.history&&this.history.pushState);var N=this.getFragment();var M=document.documentMode;var Q=(I.exec(navigator.userAgent.toLowerCase())&&(!M||M<=7));this.root=("/"+this.root+"/").replace(f,"/");if(Q&&this._wantsHashChange){this.iframe=z.$('<iframe src="javascript:0" tabindex="-1" />').hide().appendTo("body")[0].contentWindow;this.navigate(N);}if(this._hasPushState){z.$(window).on("popstate",this.checkUrl);}else{if(this._wantsHashChange&&("onhashchange" in window)&&!Q){z.$(window).on("hashchange",this.checkUrl);}else{if(this._wantsHashChange){this._checkUrlInterval=setInterval(this.checkUrl,this.interval);}}}this.fragment=N;var R=this.location;var P=R.pathname.replace(/[^\/]$/,"$&/")===this.root;if(this._wantsHashChange&&this._wantsPushState&&!this._hasPushState&&!P){this.fragment=this.getFragment(null,true);this.location.replace(this.root+this.location.search+"#"+this.fragment);return true;}else{if(this._wantsPushState&&this._hasPushState&&P&&R.hash){this.fragment=this.getHash().replace(A,"");this.history.replaceState({},document.title,this.root+this.fragment+R.search);}}if(!this.options.silent){return this.loadUrl();}},stop:function(){z.$(window).off("popstate",this.checkUrl).off("hashchange",this.checkUrl);clearInterval(this._checkUrlInterval);i.started=false;},route:function(M,N){this.handlers.unshift({route:M,callback:N});},checkUrl:function(N){var M=this.getFragment();if(M===this.fragment&&this.iframe){M=this.getFragment(this.getHash(this.iframe));}if(M===this.fragment){return false;}if(this.iframe){this.navigate(M);}this.loadUrl()||this.loadUrl(this.getHash());},loadUrl:function(O){var N=this.fragment=this.getFragment(O);var M=L.any(this.handlers,function(P){if(P.route.test(N)){P.callback(N);return true;}});return M;},navigate:function(O,N){if(!i.started){return false;}if(!N||N===true){N={trigger:N};}O=this.getFragment(O||"");if(this.fragment===O){return;}this.fragment=O;var M=this.root+O;if(this._hasPushState){this.history[N.replace?"replaceState":"pushState"]({},document.title,M);}else{if(this._wantsHashChange){this._updateHash(this.location,O,N.replace);if(this.iframe&&(O!==this.getFragment(this.getHash(this.iframe)))){if(!N.replace){this.iframe.document.open().close();}this._updateHash(this.iframe.location,O,N.replace);}}else{return this.location.assign(M);}}if(N.trigger){this.loadUrl(O);}},_updateHash:function(M,O,P){if(P){var N=M.href.replace(/(javascript:|#).*$/,"");M.replace(N+"#"+O);}else{M.hash="#"+O;}}});z.history=new i;var l=function(M,O){var N=this;var Q;if(M&&L.has(M,"constructor")){Q=M.constructor;}else{Q=function(){return N.apply(this,arguments);};}L.extend(Q,N,O);var P=function(){this.constructor=Q;};P.prototype=N.prototype;Q.prototype=new P;if(M){L.extend(Q.prototype,M);}Q.__super__=N.prototype;return Q;};E.extend=c.extend=p.extend=G.extend=i.extend=l;var r=function(){throw new Error('A "url" property or function must be specified');};var H=function(O,N){var M=N.error;N.error=function(P){if(M){M(O,P,N);}O.trigger("error",O,P,N);};};}).call(this);Backbone.Validation=(function(j){var d={forceUpdate:false,selector:"name",labelFormatter:"sentenceCase",valid:Function.prototype,invalid:Function.prototype};var e={formatLabel:function(l,k){return g[d.labelFormatter](l,k);},format:function(){var k=Array.prototype.slice.call(arguments),l=k.shift();return l.replace(/\{(\d+)\}/g,function(m,n){return typeof k[n]!=="undefined"?k[n]:m;});}};var a=function(m,k,l){k=k||{};l=l||"";j.each(m,function(o,n){if(m.hasOwnProperty(n)){if(o&&typeof o==="object"&&!(o instanceof Date||o instanceof RegExp||o instanceof Backbone.Model||o instanceof Backbone.Collection)){a(o,k,l+n+".");}else{k[l+n]=o;}}});return k;};var b=(function(){var k=function(t){return j.reduce(j.keys(t.validation||{}),function(u,v){u[v]=void 0;return u;},{});};var p=function(u,t){var v=u.validation?u.validation[t]||{}:{};if(j.isFunction(v)||j.isString(v)){v={fn:v};}if(!j.isArray(v)){v=[v];}return j.reduce(v,function(w,x){j.each(j.without(j.keys(x),"msg"),function(y){w.push({fn:i[y],val:x[y],msg:x.msg});});return w;},[]);};var n=function(u,t,w,v){return j.reduce(p(u,t),function(z,A){var y=j.extend({},e,i),x=A.fn.call(y,w,t,A.val,u,v);if(x===false||z===false){return false;}if(x&&!z){return A.msg||x;}return z;},"");};var s=function(v,u){var t,y={},z=true,x=j.clone(u),w=a(u);j.each(w,function(B,A){t=n(v,A,B,x);if(t){y[A]=t;z=false;}});return{invalidAttrs:y,isValid:z};};var r=function(t,u){return{preValidate:function(v,w){return n(this,v,w,j.extend({},this.attributes));},isValid:function(w){var v=a(this.attributes);if(j.isString(w)){return !n(this,w,v[w],j.extend({},this.attributes));}if(j.isArray(w)){return j.reduce(w,function(y,x){return y&&!n(this,x,v[x],j.extend({},this.attributes));},true,this);}if(w===true){this.validate();}return this.validation?this._isValid:true;},validate:function(C,A){var x=this,w=!C,v=j.extend({},u,A),z=k(x),B=j.extend({},z,x.attributes,C),y=a(C||B),D=s(x,B);x._isValid=D.isValid;j.each(z,function(G,E){var F=D.invalidAttrs.hasOwnProperty(E);if(!F){v.valid(t,E,v.selector);}});j.each(z,function(H,E){var F=D.invalidAttrs.hasOwnProperty(E),G=y.hasOwnProperty(E);if(F&&(G||w)){v.invalid(t,E,D.invalidAttrs[E],v.selector);}});j.defer(function(){x.trigger("validated",x._isValid,x,D.invalidAttrs);x.trigger("validated:"+(x._isValid?"valid":"invalid"),x,D.invalidAttrs);});if(!v.forceUpdate&&j.intersection(j.keys(D.invalidAttrs),j.keys(y)).length>0){return D.invalidAttrs;}}};};var m=function(t,v,u){j.extend(v,r(t,u));};var o=function(t){delete t.validate;delete t.preValidate;delete t.isValid;};var q=function(t){m(this.view,t,this.options);};var l=function(t){o(t);};return{version:"0.8.0",configure:function(t){j.extend(d,t);},bind:function(t,v){var u=t.model,w=t.collection;v=j.extend({},d,c,v);if(typeof u==="undefined"&&typeof w==="undefined"){throw"Before you execute the binding your view must have a model or a collection.\nSee http://thedersen.com/projects/backbone-validation/#using-form-model-validation for more information.";}if(u){m(t,u,v);}else{if(w){w.each(function(x){m(t,x,v);});w.bind("add",q,{view:t,options:v});w.bind("remove",l);}}},unbind:function(t){var u=t.model,v=t.collection;if(u){o(t.model);}if(v){v.each(function(w){o(w);});v.unbind("add",q);v.unbind("remove",l);}},mixin:r(null,d)};}());var c=b.callbacks={valid:function(m,l,k){m.$("["+k+'~="'+l+'"]').removeClass("invalid").removeAttr("data-error");},invalid:function(m,l,n,k){m.$("["+k+'~="'+l+'"]').addClass("invalid").attr("data-error",n);}};var f=b.patterns={digits:/^\d+$/,number:/^-?(?:\d+|\d{1,3}(?:,\d{3})+)(?:\.\d+)?$/,email:/^((([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+(\.([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+)*)|((\x22)((((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(([\x01-\x08\x0b\x0c\x0e-\x1f\x7f]|\x21|[\x23-\x5b]|[\x5d-\x7e]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(\\([\x01-\x09\x0b\x0c\x0d-\x7f]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]))))*(((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(\x22)))@((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))$/i,url:/^(https?|ftp):\/\/(((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:)*@)?(((\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5]))|((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?)(:\d*)?)(\/((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)+(\/(([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)*)*)?)?(\?((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|[\uE000-\uF8FF]|\/|\?)*)?(\#((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|\/|\?)*)?$/i};var h=b.messages={required:"{0} is required",acceptance:"{0} must be accepted",min:"{0} must be greater than or equal to {1}",max:"{0} must be less than or equal to {1}",range:"{0} must be between {1} and {2}",length:"{0} must be {1} characters",minLength:"{0} must be at least {1} characters",maxLength:"{0} must be at most {1} characters",rangeLength:"{0} must be between {1} and {2} characters",oneOf:"{0} must be one of: {1}",equalTo:"{0} must be the same as {1}",pattern:"{0} must be a valid {1}"};var g=b.labelFormatters={none:function(k){return k;},sentenceCase:function(k){return k.replace(/(?:^\w|[A-Z]|\b\w)/g,function(m,l){return l===0?m.toUpperCase():" "+m.toLowerCase();}).replace("_"," ");},label:function(l,k){return(k.labels&&k.labels[l])||g.sentenceCase(l,k);}};var i=b.validators=(function(){var k=String.prototype.trim?function(n){return n===null?"":String.prototype.trim.call(n);}:function(p){var o=/^\s+/,n=/\s+$/;return p===null?"":p.toString().replace(o,"").replace(n,"");};var l=function(n){return j.isNumber(n)||(j.isString(n)&&n.match(f.number));};var m=function(n){return !(j.isNull(n)||j.isUndefined(n)||(j.isString(n)&&k(n)===""));};return{fn:function(r,n,p,o,q){if(j.isString(p)){p=o[p];}return p.call(o,r,n,q);},required:function(r,n,s,o,p){var q=j.isFunction(s)?s.call(o,r,n,p):s;if(!q&&!m(r)){return false;}if(q&&!m(r)){return this.format(h.required,this.formatLabel(n,o));}},acceptance:function(q,n,p,o){if(q!=="true"&&(!j.isBoolean(q)||q===false)){return this.format(h.acceptance,this.formatLabel(n,o));}},min:function(q,n,p,o){if(!l(q)||q<p){return this.format(h.min,this.formatLabel(n,o),p);}},max:function(p,n,q,o){if(!l(p)||p>q){return this.format(h.max,this.formatLabel(n,o),q);}},range:function(q,n,o,p){if(!l(q)||q<o[0]||q>o[1]){return this.format(h.range,this.formatLabel(n,p),o[0],o[1]);}},length:function(q,n,p,o){if(!m(q)||k(q).length!==p){return this.format(h.length,this.formatLabel(n,o),p);}},minLength:function(q,n,o,p){if(!m(q)||k(q).length<o){return this.format(h.minLength,this.formatLabel(n,p),o);}},maxLength:function(q,n,o,p){if(!m(q)||k(q).length>o){return this.format(h.maxLength,this.formatLabel(n,p),o);}},rangeLength:function(q,n,o,p){if(!m(q)||k(q).length<o[0]||k(q).length>o[1]){return this.format(h.rangeLength,this.formatLabel(n,p),o[0],o[1]);}},oneOf:function(q,n,o,p){if(!j.include(o,q)){return this.format(h.oneOf,this.formatLabel(n,p),o.join(", "));}},equalTo:function(r,n,o,p,q){if(r!==q[o]){return this.format(h.equalTo,this.formatLabel(n,p),this.formatLabel(o,p));}},pattern:function(q,n,p,o){if(!m(q)||!q.toString().match(f[p]||p)){return this.format(h.pattern,this.formatLabel(n,o),p);}}};}());return b;}(_));
/*
 * ===================================================
 * bootstrap-transition.js v2.3.1
 * http://twitter.github.com/bootstrap/javascript.html#transitions
 * ===================================================
 * Copyright 2012 Twitter, Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * ========================================================== */
!function(a){a(function(){a.support.transition=(function(){var b=(function(){var e=document.createElement("bootstrap"),d={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd otransitionend",transition:"transitionend"},c;for(c in d){if(e.style[c]!==undefined){return d[c];}}}());return b&&{end:b};})();});}(window.jQuery);!function(d){var c='[data-dismiss="alert"]',b=function(e){d(e).on("click",c,this.close);};b.prototype.close=function(j){var i=d(this),g=i.attr("data-target"),h;if(!g){g=i.attr("href");g=g&&g.replace(/.*(?=#[^\s]*$)/,"");}h=d(g);j&&j.preventDefault();h.length||(h=i.hasClass("alert")?i:i.parent());h.trigger(j=d.Event("close"));if(j.isDefaultPrevented()){return;}h.removeClass("in");function f(){h.trigger("closed").remove();}d.support.transition&&h.hasClass("fade")?h.on(d.support.transition.end,f):f();};var a=d.fn.alert;d.fn.alert=function(e){return this.each(function(){var g=d(this),f=g.data("alert");if(!f){g.data("alert",(f=new b(this)));}if(typeof e=="string"){f[e].call(g);}});};d.fn.alert.Constructor=b;d.fn.alert.noConflict=function(){d.fn.alert=a;return this;};d(document).on("click.alert.data-api",c,b.prototype.close);}(window.jQuery);!function(c){var b=function(e,d){this.$element=c(e);this.options=c.extend({},c.fn.button.defaults,d);};b.prototype.setState=function(g){var i="disabled",e=this.$element,f=e.data(),h=e.is("input")?"val":"html";g=g+"Text";f.resetText||e.data("resetText",e[h]());e[h](f[g]||this.options[g]);setTimeout(function(){g=="loadingText"?e.addClass(i).attr(i,i):e.removeClass(i).removeAttr(i);},0);};b.prototype.toggle=function(){var d=this.$element.closest('[data-toggle="buttons-radio"]');d&&d.find(".active").removeClass("active");this.$element.toggleClass("active");};var a=c.fn.button;c.fn.button=function(d){return this.each(function(){var g=c(this),f=g.data("button"),e=typeof d=="object"&&d;if(!f){g.data("button",(f=new b(this,e)));}if(d=="toggle"){f.toggle();}else{if(d){f.setState(d);}}});};c.fn.button.defaults={loadingText:"loading..."};c.fn.button.Constructor=b;c.fn.button.noConflict=function(){c.fn.button=a;return this;};c(document).on("click.button.data-api","[data-toggle^=button]",function(f){var d=c(f.target);if(!d.hasClass("btn")){d=d.closest(".btn");}d.button("toggle");});}(window.jQuery);!function(b){var c=function(e,d){this.$element=b(e);this.$indicators=this.$element.find(".carousel-indicators");this.options=d;this.options.pause=="hover"&&this.$element.on("mouseenter",b.proxy(this.pause,this)).on("mouseleave",b.proxy(this.cycle,this));};c.prototype={cycle:function(d){if(!d){this.paused=false;}if(this.interval){clearInterval(this.interval);}this.options.interval&&!this.paused&&(this.interval=setInterval(b.proxy(this.next,this),this.options.interval));return this;},getActiveIndex:function(){this.$active=this.$element.find(".item.active");this.$items=this.$active.parent().children();return this.$items.index(this.$active);},to:function(f){var d=this.getActiveIndex(),e=this;if(f>(this.$items.length-1)||f<0){return;}if(this.sliding){return this.$element.one("slid",function(){e.to(f);});}if(d==f){return this.pause().cycle();}return this.slide(f>d?"next":"prev",b(this.$items[f]));},pause:function(d){if(!d){this.paused=true;}if(this.$element.find(".next, .prev").length&&b.support.transition.end){this.$element.trigger(b.support.transition.end);this.cycle(true);}clearInterval(this.interval);this.interval=null;return this;},next:function(){if(this.sliding){return;}return this.slide("next");},prev:function(){if(this.sliding){return;}return this.slide("prev");},slide:function(k,f){var m=this.$element.find(".item.active"),d=f||m[k](),j=this.interval,l=k=="next"?"left":"right",g=k=="next"?"first":"last",h=this,i;this.sliding=true;j&&this.pause();d=d.length?d:this.$element.find(".item")[g]();i=b.Event("slide",{relatedTarget:d[0],direction:l});if(d.hasClass("active")){return;}if(this.$indicators.length){this.$indicators.find(".active").removeClass("active");this.$element.one("slid",function(){var e=b(h.$indicators.children()[h.getActiveIndex()]);e&&e.addClass("active");});}if(b.support.transition&&this.$element.hasClass("slide")){this.$element.trigger(i);if(i.isDefaultPrevented()){return;}d.addClass(k);d[0].offsetWidth;m.addClass(l);d.addClass(l);this.$element.one(b.support.transition.end,function(){d.removeClass([k,l].join(" ")).addClass("active");m.removeClass(["active",l].join(" "));h.sliding=false;setTimeout(function(){h.$element.trigger("slid");},0);});}else{this.$element.trigger(i);if(i.isDefaultPrevented()){return;}m.removeClass("active");d.addClass("active");this.sliding=false;this.$element.trigger("slid");}j&&this.cycle();return this;}};var a=b.fn.carousel;b.fn.carousel=function(d){return this.each(function(){var h=b(this),g=h.data("carousel"),e=b.extend({},b.fn.carousel.defaults,typeof d=="object"&&d),f=typeof d=="string"?d:e.slide;if(!g){h.data("carousel",(g=new c(this,e)));}if(typeof d=="number"){g.to(d);}else{if(f){g[f]();}else{if(e.interval){g.pause().cycle();}}}});};b.fn.carousel.defaults={interval:5000,pause:"hover"};b.fn.carousel.Constructor=c;b.fn.carousel.noConflict=function(){b.fn.carousel=a;return this;};b(document).on("click.carousel.data-api","[data-slide], [data-slide-to]",function(j){var i=b(this),f,d=b(i.attr("data-target")||(f=i.attr("href"))&&f.replace(/.*(?=#[^\s]+$)/,"")),g=b.extend({},d.data(),i.data()),h;d.carousel(g);if(h=i.attr("data-slide-to")){d.data("carousel").pause().to(h).cycle();}j.preventDefault();});}(window.jQuery);!function(b){var c=function(e,d){this.$element=b(e);this.options=b.extend({},b.fn.collapse.defaults,d);if(this.options.parent){this.$parent=b(this.options.parent);}this.options.toggle&&this.toggle();};c.prototype={constructor:c,dimension:function(){var d=this.$element.hasClass("width");return d?"width":"height";},show:function(){var g,d,f,e;if(this.transitioning||this.$element.hasClass("in")){return;}g=this.dimension();d=b.camelCase(["scroll",g].join("-"));f=this.$parent&&this.$parent.find("> .accordion-group > .in");if(f&&f.length){e=f.data("collapse");if(e&&e.transitioning){return;}f.collapse("hide");e||f.data("collapse",null);}this.$element[g](0);this.transition("addClass",b.Event("show"),"shown");b.support.transition&&this.$element[g](this.$element[0][d]);},hide:function(){var d;if(this.transitioning||!this.$element.hasClass("in")){return;}d=this.dimension();this.reset(this.$element[d]());this.transition("removeClass",b.Event("hide"),"hidden");this.$element[d](0);},reset:function(d){var e=this.dimension();this.$element.removeClass("collapse")[e](d||"auto")[0].offsetWidth;this.$element[d!==null?"addClass":"removeClass"]("collapse");return this;},transition:function(h,e,f){var g=this,d=function(){if(e.type=="show"){g.reset();}g.transitioning=0;g.$element.trigger(f);};this.$element.trigger(e);if(e.isDefaultPrevented()){return;}this.transitioning=1;this.$element[h]("in");b.support.transition&&this.$element.hasClass("collapse")?this.$element.one(b.support.transition.end,d):d();},toggle:function(){this[this.$element.hasClass("in")?"hide":"show"]();}};var a=b.fn.collapse;b.fn.collapse=function(d){return this.each(function(){var g=b(this),f=g.data("collapse"),e=b.extend({},b.fn.collapse.defaults,g.data(),typeof d=="object"&&d);if(!f){g.data("collapse",(f=new c(this,e)));}if(typeof d=="string"){f[d]();}});};b.fn.collapse.defaults={toggle:true};b.fn.collapse.Constructor=c;b.fn.collapse.noConflict=function(){b.fn.collapse=a;return this;};b(document).on("click.collapse.data-api","[data-toggle=collapse]",function(i){var h=b(this),d,g=h.attr("data-target")||i.preventDefault()||(d=h.attr("href"))&&d.replace(/.*(?=#[^\s]+$)/,""),f=b(g).data("collapse")?"toggle":h.data();h[b(g).hasClass("in")?"addClass":"removeClass"]("collapsed");b(g).collapse(f);});}(window.jQuery);!function(f){var b="[data-toggle=dropdown]",a=function(h){var g=f(h).on("click.dropdown.data-api",this.toggle);f("html").on("click.dropdown.data-api",function(){g.parent().removeClass("open");});};a.prototype={constructor:a,toggle:function(j){var i=f(this),h,g;if(i.is(".disabled, :disabled")){return;}h=e(i);g=h.hasClass("open");d();if(!g){h.toggleClass("open");}i.focus();return false;},keydown:function(l){var k,m,g,j,i,h;if(!/(38|40|27)/.test(l.keyCode)){return;}k=f(this);l.preventDefault();l.stopPropagation();if(k.is(".disabled, :disabled")){return;}j=e(k);i=j.hasClass("open");if(!i||(i&&l.keyCode==27)){if(l.which==27){j.find(b).focus();}return k.click();}m=f("[role=menu] li:not(.divider):visible a",j);if(!m.length){return;}h=m.index(m.filter(":focus"));if(l.keyCode==38&&h>0){h--;}if(l.keyCode==40&&h<m.length-1){h++;}if(!~h){h=0;}m.eq(h).focus();}};function d(){f(b).each(function(){e(f(this)).removeClass("open");});}function e(i){var g=i.attr("data-target"),h;if(!g){g=i.attr("href");g=g&&/#/.test(g)&&g.replace(/.*(?=#[^\s]*$)/,"");}h=g&&f(g);if(!h||!h.length){h=i.parent();}return h;}var c=f.fn.dropdown;f.fn.dropdown=function(g){return this.each(function(){var i=f(this),h=i.data("dropdown");if(!h){i.data("dropdown",(h=new a(this)));}if(typeof g=="string"){h[g].call(i);}});};f.fn.dropdown.Constructor=a;f.fn.dropdown.noConflict=function(){f.fn.dropdown=c;return this;};f(document).on("click.dropdown.data-api",d).on("click.dropdown.data-api",".dropdown form",function(g){g.stopPropagation();}).on("click.dropdown-menu",function(g){g.stopPropagation();}).on("click.dropdown.data-api",b,a.prototype.toggle).on("keydown.dropdown.data-api",b+", [role=menu]",a.prototype.keydown);}(window.jQuery);!function(c){var b=function(e,d){this.init("tooltip",e,d);};b.prototype={constructor:b,init:function(k,h,f){var l,d,j,e,g;this.type=k;this.$element=c(h);this.options=this.getOptions(f);this.enabled=true;j=this.options.trigger.split(" ");for(g=j.length;g--;){e=j[g];if(e=="click"){this.$element.on("click."+this.type,this.options.selector,c.proxy(this.toggle,this));}else{if(e!="manual"){l=e=="hover"?"mouseenter":"focus";d=e=="hover"?"mouseleave":"blur";this.$element.on(l+"."+this.type,this.options.selector,c.proxy(this.enter,this));this.$element.on(d+"."+this.type,this.options.selector,c.proxy(this.leave,this));}}}this.options.selector?(this._options=c.extend({},this.options,{trigger:"manual",selector:""})):this.fixTitle();},getOptions:function(d){d=c.extend({},c.fn[this.type].defaults,this.$element.data(),d);if(d.delay&&typeof d.delay=="number"){d.delay={show:d.delay,hide:d.delay};}return d;},enter:function(h){var g=c.fn[this.type].defaults,f={},d;this._options&&c.each(this._options,function(e,i){if(g[e]!=i){f[e]=i;}},this);d=c(h.currentTarget)[this.type](f).data(this.type);if(!d.options.delay||!d.options.delay.show){return d.show();}clearTimeout(this.timeout);d.hoverState="in";this.timeout=setTimeout(function(){if(d.hoverState=="in"){d.show();}},d.options.delay.show);},leave:function(f){var d=c(f.currentTarget)[this.type](this._options).data(this.type);if(this.timeout){clearTimeout(this.timeout);}if(!d.options.delay||!d.options.delay.hide){return d.hide();}d.hoverState="out";this.timeout=setTimeout(function(){if(d.hoverState=="out"){d.hide();}},d.options.delay.hide);},show:function(){var i,k,g,j,d,h,f=c.Event("show");if(this.hasContent()&&this.enabled){this.$element.trigger(f);if(f.isDefaultPrevented()){return;}i=this.tip();this.setContent();if(this.options.animation){i.addClass("fade");}d=typeof this.options.placement=="function"?this.options.placement.call(this,i[0],this.$element[0]):this.options.placement;i.detach().css({top:0,left:0,display:"block"});this.options.container?i.appendTo(this.options.container):i.insertAfter(this.$element);k=this.getPosition();g=i[0].offsetWidth;j=i[0].offsetHeight;switch(d){case"bottom":h={top:k.top+k.height,left:k.left+k.width/2-g/2};break;case"top":h={top:k.top-j,left:k.left+k.width/2-g/2};break;case"left":h={top:k.top+k.height/2-j/2,left:k.left-g};break;case"right":h={top:k.top+k.height/2-j/2,left:k.left+k.width};break;}this.applyPlacement(h,d);this.$element.trigger("shown");}},applyPlacement:function(g,h){var i=this.tip(),e=i[0].offsetWidth,l=i[0].offsetHeight,d,j,k,f;i.offset(g).addClass(h).addClass("in");d=i[0].offsetWidth;j=i[0].offsetHeight;if(h=="top"&&j!=l){g.top=g.top+l-j;f=true;}if(h=="bottom"||h=="top"){k=0;if(g.left<0){k=g.left*-2;g.left=0;i.offset(g);d=i[0].offsetWidth;j=i[0].offsetHeight;}this.replaceArrow(k-e+d,d,"left");}else{this.replaceArrow(j-l,j,"top");}if(f){i.offset(g);}},replaceArrow:function(f,e,d){this.arrow().css(d,f?(50*(1-f/e)+"%"):"");},setContent:function(){var e=this.tip(),d=this.getTitle();e.find(".tooltip-inner")[this.options.html?"html":"text"](d);e.removeClass("fade in top bottom left right");},hide:function(){var d=this,g=this.tip(),f=c.Event("hide");this.$element.trigger(f);if(f.isDefaultPrevented()){return;}g.removeClass("in");function h(){var e=setTimeout(function(){g.off(c.support.transition.end).detach();},500);g.one(c.support.transition.end,function(){clearTimeout(e);g.detach();});}c.support.transition&&this.$tip.hasClass("fade")?h():g.detach();this.$element.trigger("hidden");return this;},fixTitle:function(){var d=this.$element;if(d.attr("title")||typeof(d.attr("data-original-title"))!="string"){d.attr("data-original-title",d.attr("title")||"").attr("title","");}},hasContent:function(){return this.getTitle();},getPosition:function(){var d=this.$element[0];return c.extend({},(typeof d.getBoundingClientRect=="function")?d.getBoundingClientRect():{width:d.offsetWidth,height:d.offsetHeight},this.$element.offset());},getTitle:function(){var f,d=this.$element,e=this.options;f=d.attr("data-original-title")||(typeof e.title=="function"?e.title.call(d[0]):e.title);return f;},tip:function(){return this.$tip=this.$tip||c(this.options.template);},arrow:function(){return this.$arrow=this.$arrow||this.tip().find(".tooltip-arrow");},validate:function(){if(!this.$element[0].parentNode){this.hide();this.$element=null;this.options=null;}},enable:function(){this.enabled=true;},disable:function(){this.enabled=false;},toggleEnabled:function(){this.enabled=!this.enabled;},toggle:function(f){var d=f?c(f.currentTarget)[this.type](this._options).data(this.type):this;d.tip().hasClass("in")?d.hide():d.show();},destroy:function(){this.hide().$element.off("."+this.type).removeData(this.type);}};var a=c.fn.tooltip;c.fn.tooltip=function(d){return this.each(function(){var g=c(this),f=g.data("tooltip"),e=typeof d=="object"&&d;if(!f){g.data("tooltip",(f=new b(this,e)));}if(typeof d=="string"){f[d]();}});};c.fn.tooltip.Constructor=b;c.fn.tooltip.defaults={animation:true,placement:"top",selector:false,template:'<div class="tooltip"><div class="tooltip-arrow"></div><div class="tooltip-inner"></div></div>',trigger:"hover focus",title:"",delay:0,html:false,container:false};c.fn.tooltip.noConflict=function(){c.fn.tooltip=a;return this;};}(window.jQuery);!function(c){var b=function(e,d){this.init("popover",e,d);};b.prototype=c.extend({},c.fn.tooltip.Constructor.prototype,{constructor:b,setContent:function(){var f=this.tip(),e=this.getTitle(),d=this.getContent();f.find(".popover-title")[this.options.html?"html":"text"](e);f.find(".popover-content")[this.options.html?"html":"text"](d);f.removeClass("fade top bottom left right in");},hasContent:function(){return this.getTitle()||this.getContent();},getContent:function(){var e,d=this.$element,f=this.options;e=(typeof f.content=="function"?f.content.call(d[0]):f.content)||d.attr("data-content");return e;},tip:function(){if(!this.$tip){this.$tip=c(this.options.template);}return this.$tip;},destroy:function(){this.hide().$element.off("."+this.type).removeData(this.type);}});var a=c.fn.popover;c.fn.popover=function(d){return this.each(function(){var g=c(this),f=g.data("popover"),e=typeof d=="object"&&d;if(!f){g.data("popover",(f=new b(this,e)));}if(typeof d=="string"){f[d]();}});};c.fn.popover.Constructor=b;c.fn.popover.defaults=c.extend({},c.fn.tooltip.defaults,{placement:"right",trigger:"click",content:"",template:'<div class="popover"><div class="arrow"></div><h3 class="popover-title"></h3><div class="popover-content"></div></div>'});c.fn.popover.noConflict=function(){c.fn.popover=a;return this;};}(window.jQuery);!function(c){function b(g,f){var h=c.proxy(this.process,this),d=c(g).is("body")?c(window):c(g),e;this.options=c.extend({},c.fn.scrollspy.defaults,f);this.$scrollElement=d.on("scroll.scroll-spy.data-api",h);this.selector=(this.options.target||((e=c(g).attr("href"))&&e.replace(/.*(?=#[^\s]+$)/,""))||"")+" .nav li > a";this.$body=c("body");this.refresh();this.process();}b.prototype={constructor:b,refresh:function(){var d=this,e;this.offsets=c([]);this.targets=c([]);e=this.$body.find(this.selector).map(function(){var g=c(this),f=g.data("target")||g.attr("href"),h=/^#\w/.test(f)&&c(f);return(h&&h.length&&[[h.position().top+(!c.isWindow(d.$scrollElement.get(0))&&d.$scrollElement.scrollTop()),f]])||null;}).sort(function(g,f){return g[0]-f[0];}).each(function(){d.offsets.push(this[0]);d.targets.push(this[1]);});},process:function(){var j=this.$scrollElement.scrollTop()+this.options.offset,f=this.$scrollElement[0].scrollHeight||this.$body[0].scrollHeight,h=f-this.$scrollElement.height(),g=this.offsets,d=this.targets,k=this.activeTarget,e;if(j>=h){return k!=(e=d.last()[0])&&this.activate(e);}for(e=g.length;e--;){k!=d[e]&&j>=g[e]&&(!g[e+1]||j<=g[e+1])&&this.activate(d[e]);}},activate:function(f){var e,d;this.activeTarget=f;c(this.selector).parent(".active").removeClass("active");d=this.selector+'[data-target="'+f+'"],'+this.selector+'[href="'+f+'"]';e=c(d).parent("li").addClass("active");if(e.parent(".dropdown-menu").length){e=e.closest("li.dropdown").addClass("active");}e.trigger("activate");}};var a=c.fn.scrollspy;c.fn.scrollspy=function(d){return this.each(function(){var g=c(this),f=g.data("scrollspy"),e=typeof d=="object"&&d;if(!f){g.data("scrollspy",(f=new b(this,e)));}if(typeof d=="string"){f[d]();}});};c.fn.scrollspy.Constructor=b;c.fn.scrollspy.defaults={offset:10};c.fn.scrollspy.noConflict=function(){c.fn.scrollspy=a;return this;};c(window).on("load",function(){c('[data-spy="scroll"]').each(function(){var d=c(this);d.scrollspy(d.data());});});}(window.jQuery);!function(c){var b=function(d){this.element=c(d);};b.prototype={constructor:b,show:function(){var j=this.element,g=j.closest("ul:not(.dropdown-menu)"),f=j.attr("data-target"),h,d,i;if(!f){f=j.attr("href");f=f&&f.replace(/.*(?=#[^\s]*$)/,"");}if(j.parent("li").hasClass("active")){return;}h=g.find(".active:last a")[0];i=c.Event("show",{relatedTarget:h});j.trigger(i);if(i.isDefaultPrevented()){return;}d=c(f);this.activate(j.parent("li"),g);this.activate(d,d.parent(),function(){j.trigger({type:"shown",relatedTarget:h});});},activate:function(f,e,i){var d=e.find("> .active"),h=i&&c.support.transition&&d.hasClass("fade");function g(){d.removeClass("active").find("> .dropdown-menu > .active").removeClass("active");f.addClass("active");if(h){f[0].offsetWidth;f.addClass("in");}else{f.removeClass("fade");}if(f.parent(".dropdown-menu")){f.closest("li.dropdown").addClass("active");}i&&i();}h?d.one(c.support.transition.end,g):g();d.removeClass("in");}};var a=c.fn.tab;c.fn.tab=function(d){return this.each(function(){var f=c(this),e=f.data("tab");if(!e){f.data("tab",(e=new b(this)));}if(typeof d=="string"){e[d]();}});};c.fn.tab.Constructor=b;c.fn.tab.noConflict=function(){c.fn.tab=a;return this;};c(document).on("click.tab.data-api",'[data-toggle="tab"], [data-toggle="pill"]',function(d){d.preventDefault();c(this).tab("show");});}(window.jQuery);!function(b){var c=function(e,d){this.$element=b(e);this.options=b.extend({},b.fn.typeahead.defaults,d);this.matcher=this.options.matcher||this.matcher;this.sorter=this.options.sorter||this.sorter;this.highlighter=this.options.highlighter||this.highlighter;this.updater=this.options.updater||this.updater;this.source=this.options.source;this.$menu=b(this.options.menu);this.shown=false;this.listen();};c.prototype={constructor:c,select:function(){var d=this.$menu.find(".active").attr("data-value");this.$element.val(this.updater(d)).change();return this.hide();},updater:function(d){return d;},show:function(){var d=b.extend({},this.$element.position(),{height:this.$element[0].offsetHeight});this.$menu.insertAfter(this.$element).css({top:d.top+d.height,left:d.left}).show();this.shown=true;return this;},hide:function(){this.$menu.hide();this.shown=false;return this;},lookup:function(e){var d;this.query=this.$element.val();if(!this.query||this.query.length<this.options.minLength){return this.shown?this.hide():this;}d=b.isFunction(this.source)?this.source(this.query,b.proxy(this.process,this)):this.source;return d?this.process(d):this;},process:function(d){var e=this;d=b.grep(d,function(f){return e.matcher(f);});d=this.sorter(d);if(!d.length){return this.shown?this.hide():this;}return this.render(d.slice(0,this.options.items)).show();},matcher:function(d){return ~d.toLowerCase().indexOf(this.query.toLowerCase());},sorter:function(f){var g=[],e=[],d=[],h;while(h=f.shift()){if(!h.toLowerCase().indexOf(this.query.toLowerCase())){g.push(h);}else{if(~h.indexOf(this.query)){e.push(h);}else{d.push(h);}}}return g.concat(e,d);},highlighter:function(d){var e=this.query.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&");return d.replace(new RegExp("("+e+")","ig"),function(f,g){return"<strong>"+g+"</strong>";});},render:function(d){var e=this;d=b(d).map(function(f,g){f=b(e.options.item).attr("data-value",g);f.find("a").html(e.highlighter(g));return f[0];});d.first().addClass("active");this.$menu.html(d);return this;},next:function(e){var f=this.$menu.find(".active").removeClass("active"),d=f.next();if(!d.length){d=b(this.$menu.find("li")[0]);}d.addClass("active");},prev:function(e){var f=this.$menu.find(".active").removeClass("active"),d=f.prev();if(!d.length){d=this.$menu.find("li").last();}d.addClass("active");},listen:function(){this.$element.on("focus",b.proxy(this.focus,this)).on("blur",b.proxy(this.blur,this)).on("keypress",b.proxy(this.keypress,this)).on("keyup",b.proxy(this.keyup,this));if(this.eventSupported("keydown")){this.$element.on("keydown",b.proxy(this.keydown,this));}this.$menu.on("click",b.proxy(this.click,this)).on("mouseenter","li",b.proxy(this.mouseenter,this)).on("mouseleave","li",b.proxy(this.mouseleave,this));},eventSupported:function(d){var e=d in this.$element;if(!e){this.$element.setAttribute(d,"return;");e=typeof this.$element[d]==="function";}return e;},move:function(d){if(!this.shown){return;}switch(d.keyCode){case 13:break;case 9:case 27:d.preventDefault();break;case 38:d.preventDefault();this.prev();break;case 40:d.preventDefault();this.next();break;}d.stopPropagation();},keydown:function(d){this.suppressKeyPressRepeat=~b.inArray(d.keyCode,[40,38,9,13,27]);this.move(d);},keypress:function(d){if(this.suppressKeyPressRepeat){return;}this.move(d);},keyup:function(d){switch(d.keyCode){case 40:case 38:case 16:case 17:case 18:break;case 9:case 13:if(!this.shown){return;}this.select();break;case 27:if(!this.shown){return;}this.hide();break;default:this.lookup();}d.stopPropagation();d.preventDefault();},focus:function(d){this.focused=true;},blur:function(d){this.focused=false;if(!this.mousedover&&this.shown){this.hide();}},click:function(d){d.stopPropagation();d.preventDefault();this.select();this.$element.focus();},mouseenter:function(d){this.mousedover=true;this.$menu.find(".active").removeClass("active");b(d.currentTarget).addClass("active");},mouseleave:function(d){this.mousedover=false;if(!this.focused&&this.shown){this.hide();}}};var a=b.fn.typeahead;b.fn.typeahead=function(d){return this.each(function(){var g=b(this),f=g.data("typeahead"),e=typeof d=="object"&&d;if(!f){g.data("typeahead",(f=new c(this,e)));}if(typeof d=="string"){f[d]();}});};b.fn.typeahead.defaults={source:[],items:8,menu:'<ul class="typeahead dropdown-menu"></ul>',item:'<li><a href="#"></a></li>',minLength:1};b.fn.typeahead.Constructor=c;b.fn.typeahead.noConflict=function(){b.fn.typeahead=a;return this;};b(document).on("focus.typeahead.data-api",'[data-provide="typeahead"]',function(f){var d=b(this);if(d.data("typeahead")){return;}d.typeahead(d.data());});}(window.jQuery);!function(c){var b=function(e,d){this.options=c.extend({},c.fn.affix.defaults,d);this.$window=c(window).on("scroll.affix.data-api",c.proxy(this.checkPosition,this)).on("click.affix.data-api",c.proxy(function(){setTimeout(c.proxy(this.checkPosition,this),1);},this));this.$element=c(e);this.checkPosition();};b.prototype.checkPosition=function(){if(!this.$element.is(":visible")){return;}var h=c(document).height(),j=this.$window.scrollTop(),d=this.$element.offset(),k=this.options.offset,f=k.bottom,g=k.top,i="affix affix-top affix-bottom",e;if(typeof k!="object"){f=g=k;}if(typeof g=="function"){g=k.top();}if(typeof f=="function"){f=k.bottom();}e=this.unpin!=null&&(j+this.unpin<=d.top)?false:f!=null&&(d.top+this.$element.height()>=h-f)?"bottom":g!=null&&j<=g?"top":false;if(this.affixed===e){return;}this.affixed=e;this.unpin=e=="bottom"?d.top-j:null;this.$element.removeClass(i).addClass("affix"+(e?"-"+e:""));};var a=c.fn.affix;c.fn.affix=function(d){return this.each(function(){var g=c(this),f=g.data("affix"),e=typeof d=="object"&&d;if(!f){g.data("affix",(f=new b(this,e)));}if(typeof d=="string"){f[d]();}});};c.fn.affix.Constructor=b;c.fn.affix.defaults={offset:0};c.fn.affix.noConflict=function(){c.fn.affix=a;return this;};c(window).on("load",function(){c('[data-spy="affix"]').each(function(){var e=c(this),d=e.data();d.offset=d.offset||{};d.offsetBottom&&(d.offset.bottom=d.offsetBottom);d.offsetTop&&(d.offset.top=d.offsetTop);e.affix(d);});});}(window.jQuery);+function(b){function a(){var e=document.createElement("bootstrap");var d={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd otransitionend",transition:"transitionend"};for(var c in d){if(e.style[c]!==undefined){return{end:d[c]};}}}b.fn.emulateTransitionEnd=function(e){var d=false,c=this;b(this).one(b.support.transition.end,function(){d=true;});var f=function(){if(!d){b(c).trigger(b.support.transition.end);}};setTimeout(f,e);return this;};b(function(){b.support.transition=a();});}(window.jQuery);+function(c){var b=function(e,d){this.options=d;this.$element=c(e).on("click.dismiss.modal",'[data-dismiss="modal"]',c.proxy(this.hide,this));this.$backdrop=this.isShown=null;if(this.options.remote){this.$element.load(this.options.remote);}};b.DEFAULTS={backdrop:true,keyboard:true,show:true};b.prototype.toggle=function(d){return this[!this.isShown?"show":"hide"](d);};b.prototype.show=function(g){var d=this;var f=c.Event("show.bs.modal",{relatedTarget:g});this.$element.trigger(f);if(this.isShown||f.isDefaultPrevented()){return;}this.isShown=true;this.escape();this.backdrop(function(){var i=c.support.transition&&d.$element.hasClass("fade");if(!d.$element.parent().length){d.$element.appendTo(document.body);}d.$element.show();if(i){d.$element[0].offsetWidth;}d.$element.addClass("in").attr("aria-hidden",false);d.enforceFocus();var h=c.Event("shown.bs.modal",{relatedTarget:g});i?d.$element.one(c.support.transition.end,function(){d.$element.focus().trigger(h);}).emulateTransitionEnd(300):d.$element.focus().trigger(h);});};b.prototype.hide=function(d){if(d){d.preventDefault();}d=c.Event("hide.bs.modal");this.$element.trigger(d);if(!this.isShown||d.isDefaultPrevented()){return;}this.isShown=false;this.escape();c(document).off("focusin.bs.modal");this.$element.removeClass("in").attr("aria-hidden",true).off("click.dismiss.modal");c.support.transition&&this.$element.hasClass("fade")?this.$element.one(c.support.transition.end,c.proxy(this.hideModal,this)).emulateTransitionEnd(300):this.hideModal();};b.prototype.enforceFocus=function(){c(document).off("focusin.bs.modal").on("focusin.bs.modal",c.proxy(function(d){if(this.$element[0]!==d.target&&!this.$element.has(d.target).length){this.$element.focus();}},this));};b.prototype.escape=function(){if(this.isShown&&this.options.keyboard){this.$element.on("keyup.dismiss.bs.modal",c.proxy(function(d){d.which==27&&this.hide();},this));}else{if(!this.isShown){this.$element.off("keyup.dismiss.bs.modal");}}};b.prototype.hideModal=function(){var d=this;this.$element.hide();this.backdrop(function(){d.removeBackdrop();d.$element.trigger("hidden.bs.modal");});};b.prototype.removeBackdrop=function(){this.$backdrop&&this.$backdrop.remove();this.$backdrop=null;};b.prototype.backdrop=function(g){var f=this;var e=this.$element.hasClass("fade")?"fade":"";if(this.isShown&&this.options.backdrop){var d=c.support.transition&&e;this.$backdrop=c('<div class="modal-backdrop '+e+'" />').appendTo(document.body);this.$element.on("click.dismiss.modal",c.proxy(function(h){if(h.target!==h.currentTarget){return;}this.options.backdrop=="static"?this.$element[0].focus.call(this.$element[0]):this.hide.call(this);},this));if(d){this.$backdrop[0].offsetWidth;}this.$backdrop.addClass("in");if(!g){return;}d?this.$backdrop.one(c.support.transition.end,g).emulateTransitionEnd(150):g();}else{if(!this.isShown&&this.$backdrop){this.$backdrop.removeClass("in");c.support.transition&&this.$element.hasClass("fade")?this.$backdrop.one(c.support.transition.end,g).emulateTransitionEnd(150):g();}else{if(g){g();}}}};var a=c.fn.modal;c.fn.modal=function(d,e){return this.each(function(){var h=c(this);var g=h.data("bs.modal");var f=c.extend({},b.DEFAULTS,h.data(),typeof d=="object"&&d);if(!g){h.data("bs.modal",(g=new b(this,f)));}if(typeof d=="string"){g[d](e);}else{if(f.show){g.show(e);}}});};c.fn.modal.Constructor=b;c.fn.modal.noConflict=function(){c.fn.modal=a;return this;};c(document).on("click.bs.modal.data-api",'[data-toggle="modal"]',function(i){var h=c(this);var f=h.attr("href");var d=c(h.attr("data-target")||(f&&f.replace(/.*(?=#[^\s]+$)/,"")));var g=d.data("modal")?"toggle":c.extend({remote:!/#/.test(f)&&f},d.data(),h.data());i.preventDefault();d.modal(g,this).one("hide",function(){h.is(":visible")&&h.focus();});});c(document).on("shown.bs.modal",".modal",function(){c(document.body).addClass("modal-open");}).on("hidden.bs.modal",".modal",function(){c(document.body).removeClass("modal-open");});}(window.jQuery);(function(){var a=window.SC=_.extend(window.SC||{},Backbone.Events);jQuery.noConflict();a._applications={};a.Application=function(b){a._applications[b]=a._applications[b]||new a.ApplicationSkeleton(b);return a._applications[b];};a.Singleton={getInstance:function(){var b=this;this.instance=this.instance||new b();return this.instance;}};a.template=jQuery.noop;})();(function(){function E(L,R){var Q=L.search(/[A-Za-z#]/),P=~Q?" "+L.substring(Q):"",M=~Q?" "+L.substring(0,Q):L;R=R||SC.ENVIRONMENT.siteSettings.phoneformat;if(/^[0-9()-.\s]+$/.test(M)&&R){var O={},N=M.replace(/[()-.\s]/g,"");switch(R){case"(123) 456-7890":O={c:" ",ab:"(",aa:") ",d:"-"};break;case"123 456 7890":O={c:" ",ab:"",aa:" ",d:" "};break;case"123-456-7890":O={c:" ",ab:"",aa:"-",d:"-"};break;case"123.456.7890":O={c:" ",ab:"",aa:".",d:"."};break;default:return L;}switch(N.length){case 7:return N.substring(0,3)+O.d+N.substring(3)+P;case 10:return O.ab+N.substring(0,3)+O.aa+N.substring(3,6)+O.d+N.substring(6)+P;case 11:return N.substring(0,1)+O.c+O.ab+N.substring(1,4)+O.aa+N.substring(4,7)+O.d+N.substring(7)+P;default:return L;}}return L;}function I(M){var N=""+(M.getMonth()+1),L=""+M.getDate();if(N.length===1){N="0"+N;}if(L.length===1){L="0"+L;}return M.getFullYear()+"-"+N+"-"+L;}function x(M,V){V=_.extend({format:"YYYY-MM-dd",plusMonth:-1,dateSplitCharacter:"-"},V||{});var O=M?M.split(V.dateSplitCharacter):[],N=V.format?V.format.split("-"):[],Q=_.indexOf(N,"YYYY")>=0?_.indexOf(N,"YYYY"):2,T=_.indexOf(N,"MM")>=0?_.indexOf(N,"MM"):1,L=_.indexOf(N,"dd")>=0?_.indexOf(N,"dd"):0,R=parseInt(O[Q],10),P=parseInt(O[T],10)+(V.plusMonth||0),S=parseInt(O[L],10),U=new Date(R,P,S);if(!(U.getMonth()!==P||S!==U.getDate()||U.getFullYear()!==R)){return U;}}function i(L){if(Object.prototype.toString.call(L)==="[object Date]"){if(isNaN(L.getTime())){return false;}else{var Q=L.getDate(),O=L.getMonth()+1,N=L.getFullYear(),P=/^\d{4}$/;if(!P.test(N)){return false;}else{if(O<1||O>12){return false;}else{if(Q<1||Q>31){return false;}else{if((O===4||O===6||O===9||O===11)&&Q===31){return false;}else{if(O===2){var M=(N%4===0&&(N%100!==0||N%400===0));if(Q>29||(Q===29&&!M)){return false;}}}}}}return true;}}else{return false;}}function d(M){var O={VISA:/^4[0-9]{12}(?:[0-9]{3})?$/,"Master Card":/^5[1-5][0-9]{14}$/,"American Express":/^3[47][0-9]{13}$/,Discover:/^6(?:011|5[0-9]{2})[0-9]{12}$/,Maestro:/^(?:5[0678]\d\d|6304|6390|67\d\d)\d{8,15}$/},N;_.each(O,function(Q,P){if(Q.test(M)){N=P;}});var L=N&&_.findWhere(SC.ENVIRONMENT.siteSettings.paymentmethods,{name:N.toString()});return L&&L.internalid;}function F(L){var M=jQuery.trim(L);if(!M){return _("Security Number is required").translate();}if(!(Backbone.Validation.patterns.number.test(M)&&(M.length===3||M.length===4))){return _("Security Number is invalid").translate();}}function u(L){var M=7;if(_.isNumber(L)){if(L<Math.pow(10,M-1)){return _("Phone Number is invalid").translate();}}else{if(L){var N=L.replace(/[()-.\s]/g,"");while(N.length&&N.substring(0,1)==="0"){N=N.substring(1,N.length);}if(parseInt(N,10).toString()!==N||N.length<M){return _("Phone Number is invalid").translate();}}else{return _("Phone is required").translate();}}}function o(O,N,M){var L=SC.ENVIRONMENT.siteSettings.countries||{};if(L[M.country]&&L[M.country].states&&O===""){return _("State is required").translate();}}function b(O,N,M){var L=SC.ENVIRONMENT.siteSettings.countries||{};if(!O&&(!M.country||L[M.country]&&L[M.country].isziprequired==="T")){return _("Zip Code is required").translate();}}function c(N){if(!N){return"";}N=N.toString();var M=Array.prototype.slice.call(arguments),L=SC.Translations&&SC.Translations[N]?SC.Translations[N]:N;if(M.length&&L){L=L.format.apply(L,M.slice(1));}return L;}function q(L){var N=[],O,M;while(L.parentNode){if(L.id){N.unshift("#"+L.id);break;}else{if(L===document.body){N.unshift("HTML > BODY");break;}else{if(L===(document.head||document.getElementsByTagName("head")[0])){N.unshift("HTML > HEAD");break;}else{if(L===L.ownerDocument.documentElement){N.unshift(L.tagName);break;}else{M=L;for(O=1;M.previousElementSibling;O++){M=M.previousElementSibling;}N.unshift(L.tagName+":nth-child("+O+")");L=L.parentNode;}}}}}return N.join(" > ");}function g(V,O){var W=parseFloat(V);if(isNaN(W)){return V;}var P=W<0;W=Math.abs(W);W=parseInt((W+0.005)*100,10)/100;var L=W.toString(),X=",",T=".",M="(",R=")",N=SC&&SC.ENVIRONMENT&&SC.ENVIRONMENT.siteSettings?SC.ENVIRONMENT.siteSettings:{};if(Object.prototype.hasOwnProperty.call(window,"groupseparator")){X=window.groupseparator;}else{if(Object.prototype.hasOwnProperty.call(N,"groupseparator")){X=N.groupseparator;}}if(Object.prototype.hasOwnProperty.call(window,"decimalseparator")){T=window.decimalseparator;}else{if(Object.prototype.hasOwnProperty.call(N,"decimalseparator")){T=N.decimalseparator;}}if(Object.prototype.hasOwnProperty.call(window,"negativeprefix")){M=window.negativeprefix;}else{if(Object.prototype.hasOwnProperty.call(N,"negativeprefix")){M=N.negativeprefix;}}if(Object.prototype.hasOwnProperty.call(window,"negativesuffix")){R=window.negativesuffix;}else{if(Object.prototype.hasOwnProperty.call(N,"negativesuffix")){R=N.negativesuffix;}}L=L.replace(".",T);var U=L.indexOf(T);if(!~U){L+=T+"00";U=L.indexOf(T);}else{if(L.indexOf(T)===(L.length-2)){L+="0";}}var S="";for(var Q=L.length-1;Q>=0;Q--){S=(Q>0&&Q<U&&(((U-Q)%3)===0)?X:"")+L[Q]+S;}if(!O){if(typeof session!=="undefined"&&session.getShopperCurrency){O=session.getShopperCurrency().symbol;}else{if(N.shopperCurrency){O=N.shopperCurrency.symbol;}else{if(SC.getSessionInfo("currentCurrency")){O=SC.getSessionInfo("currentCurrency").symbol;}}}if(!O){O="$";}}L=O+S;return P?(M+L+R):L;}function z(N){var L=[],O=(""+N).split("."),P=O[0].split("").reverse();for(var M=0;M<P.length;M++){if(M>0&&(M%3===0)){L.unshift(",");}L.unshift(P[M]);}if(O.length>1){L.push(".");L.push(O[1]);}return L.join("");}function H(M,L){M=M||"";if(!L){return M;}L=jQuery.trim(L).replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&");return M.replace(new RegExp("("+L+")","ig"),function(N,O){return"<strong>"+O+"</strong>";});}function J(M,L){M=M||"";return M.replace(/\{(\w+)\}/g,function(N,O){return typeof L[O]!=="undefined"?L[O]:N;});}function v(M){var L=[];_.each(M.collection,function(N){L.push(M.getValue(N));});return L.join(M.joinWith);}function K(L,O){if(O&&_.keys(O).length){var N=jQuery.param(O),M=~L.indexOf("?")?"&":"?";return L+M+N;}else{return L;}}function m(M){M=M||"";if(~M.indexOf("?")){M=_.last(M.split("?"));}if(~M.indexOf("#")){M=_.first(M.split("#"));}var N={};if(M.length>0){var O=M.split(/\&/g),L;while(O.length>0){L=O.shift().split(/\=/g);if(L[0].length===0){continue;}N[L[0]]=decodeURIComponent(L[1]);}}return N;}function C(L){return _.reduce(L,function(M,O,N){return M+=N+":"+O+";";},"");}function e(L){return L.replace(/[\W]/g,"-");}function y(M,L){L=L?L+"-":"";return _.reduce(M,function(N,P,O){if(O!=="text"&&O!=="categories"){N+=" "+L;if(O.toLowerCase()==="css"||O.toLowerCase()==="style"){O="style";P=C(P);}if(_.isObject(P)){return N+=y(P,O);}N+=O;if(P){N+='="'+P+'"';}}return N;},"");}function k(O,M,N){var L=_.where(O,{name:N})[0];if(!!L){return M+(~M.indexOf("?")?"&":"?")+L.urlsuffix;}return M;}function a(L){var N=SC.ENVIRONMENT.baseUrl,M=L?L:"";return N?N.replace("{{file}}",M):L;}function G(M){M=M||{};M.n=SC.ENVIRONMENT.siteSettings.siteid;var L=window.location.origin?window.location.origin:(window.location.protocol+"//"+window.location.hostname+(window.location.port?(":"+window.location.port):""));return _.addParamsToUrl(L+_.getAbsoluteUrl("download.ssp"),M);}function A(L){jQuery(L).on("click",function(M){M.preventDefault();});}function r(){return window;}function t(L){var M=jQuery('<form id="do-post" method="POST" action="'+L+'"></form>').hide();var N=jQuery("#do-post");if(N&&N[0]){N[0].action=L;N[0].method="POST";}else{jQuery("html").append(M);N=jQuery("#do-post");}N[0].submit();}function D(M,P,L){if(!P){return M;}else{if(M){var O=P.split("."),N=M,Q=0;while(!_.isUndefined(N)&&Q<O.length){N=N[O[Q++]];}if(!_.isUndefined(N)){return N;}}}return L;}function j(M,R,P){if(!R){return;}else{if(!M){return;}}var Q=R.split("."),N=M;for(var O=0;O<Q.length-1;++O){var L=Q[O];if(_.isUndefined(N[L])){N[L]={};}N=N[L];}N[_.last(Q)]=P;}function w(N){var L=_(N.get("_url")+N.getQueryStringWithQuantity(1)).fixUrl(),M="";if(L){M={href:L};if(SC.ENVIRONMENT.siteType==="ADVANCED"){_.extend(M,{data:{touchpoint:"home",hashtag:"#"+L}});}}return _.objectToAtrributes(M);}function s(L){if(!jQuery(L).data("ellipsis")){var M=["",".","..","...","..","."],O=0,P=null,N=jQuery(L);N.data("ellipsis",true);N.css("visibility","hidden");N.html("...");N.css("width",N.css("width"));N.css("display","inline-block");N.html("");N.css("visibility","visible");P=setInterval(function(){if(jQuery(L).length){N.html(M[O%M.length]);O++;}else{clearInterval(P);N=null;}},250);}}function B(L){var M=[],N=L.split("?");if(N.length>1){M=N[1].split("&");return N[0]+"?"+M.sort().join("&");}return N[0];}function l(N){var O={},L=_.getParameterByName(N,"ck"),M=_.getParameterByName(N,"cktime");if(L&&M){O.ck=L;O.cktime=M;}return O;}function p(L,O){O=O.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var N=new RegExp("[\\?&]"+O+"=([^&#]*)"),M=N.exec(L);return M===null?"":decodeURIComponent(M[1].replace(/\+/g," "));}function f(L,M){return M.get("lines").find(function(Q){var N=L.get("internalid"),R=L.getSelectedMatrixChilds();Q=Q.get("item");if(R&&R.length===1){N=R[0].get("internalid");}if((L.get("internalid")===Q.get("internalid")||N===Q.get("internalid"))&&_.size(L.itemOptions)===_.size(Q.itemOptions)){var P=_.keys(Q.itemOptions);for(var O=0;O<P.length;O++){if(!L.itemOptions[P[O]]||L.itemOptions[P[O]].internalid!==Q.itemOptions[P[O]].internalid){return;}}return Q;}});}function h(M){var N=new Array("po","po box","p.o. box","p.o box","pobox","p.o.","p.o.box","post office");if(M){var L=M.toLowerCase();var O=L.match(/po box|p.o. box|p.o box|pobox|post box|p.o.|p.o.box|po\W|\Wpo\W|post office/);if(O!==null&&O.length>0){error_flag=true;}else{error_flag=false;}if(error_flag){return _("We do not ship to PO Boxes. Please correct address.").translate();}}}function n(M){var N=new Array("po","po box","p.o. box","p.o box","pobox","p.o.","p.o.box","post office");if(M){var L=M.toLowerCase();var O=L.match(/po box|p.o. box|p.o box|pobox|post box|p.o.|p.o.box|po\W|\Wpo\W|post office/);if(O!==null&&O.length>0){error_flag=true;}else{error_flag=false;}if(error_flag){return _("We do not ship to PO Boxes. Please correct address.").translate();}}else{return _("Address1 is required").translate();}}SC.Utils={translate:c,substitute:J,paymenthodIdCreditCart:d,formatPhone:E,dateToString:I,isDateValid:i,stringToDate:x,validatePhone:u,validateState:o,validateZipCode:b,validateSecurityCode:F,formatCurrency:g,formatQuantity:z,highlightKeyword:H,getFullPathForElement:q,collectionToString:v,addParamsToUrl:K,parseUrlOptions:m,objectToAtrributes:y,resizeImage:k,hyphenate:e,getAbsoluteUrl:a,preventAnchorNavigation:A,getWindow:r,getDownloadPdfUrl:G,doPost:t,getPathFromObject:D,setPathFromObject:j,getItemLinkAttributes:w,ellipsis:s,reorderUrlParams:B,getSessionParams:l,findItemInCart:f,getParameterByName:p,validateAddressSec:h,validateAddressFirst:n};_.mixin(SC.Utils);})();(function(){function b(e){if(!(this instanceof b)){return new b();}this.Configuration={};this.name=e;}b.prototype.resizeImage=function(e,f){var g=this.getConfig("imageSizeMapping."+f,f);return SC.Utils.resizeImage(this.getConfig("siteSettings.imagesizes",[]),e,g);};b.prototype.Layout=Backbone.View.extend({template:"layout",container_element:"#main",content_element:"#content",key_elements:{},events:{},initialize:function(f){this.events={'click [data-type="post-to-touchpoint"]':"touchpointPost",'click [data-action="items-expander"]':"itemsExpander",'click [data-action="dropdown-expander"]':"dropdownExpander"};this.application=f;this.afterAppendViewPromise=jQuery.Deferred();var e=this;this.once("afterAppendView",function(){e.afterAppendViewPromise.resolve();});},render:function(){this.trigger("beforeRender",this);Backbone.View.prototype.render.call(this);this.updateUI();this.trigger("afterRender",this);},updateHeader:function(){if(this.application.getConfig("siteSettings.sitetype")==="ADVANCED"){this.$(".site-header").html(SC.macros.header(this));this.updateUI();}},updateFooter:function(){if(this.application.getConfig("siteSettings.sitetype")==="ADVANCED"){this.$(".site-footer").html(SC.macros.footer(this));this.updateUI();}},updateUI:function(){var e=this;_.each(this.key_elements,function(f,g){e["$"+g]=e.$(f);});this.$content=this.$(this.content_element);this.trigger("afterRender",this);},appendToDom:function(){var e=this;this.afterAppendViewPromise.done(function(){var f=_.result(SC,"isPageGenerator");e.trigger("beforeAppendToDom",e);if(f&&!SC.blurInitialHTML){jQuery("<noscript></noscript>").append(e.$el).appendTo(jQuery(e.container_element));}else{jQuery(e.container_element).html(e.$el);}if(!f){jQuery(e.container_element).removeClass("blurred").removeClass("ie").css("filter","");}e.trigger("afterAppendToDom",e);});},getApplication:function(){return this.application;},touchpointPost:function(h){var j=this.$(h.target).data("post-touchpoint"),i=SC.getSessionInfo("touchpoints"),g=(i?i[j]:"")||"",f=_.fixUrl(g);_.doPost(f);},itemsExpander:function(f){f.preventDefault();jQuery(f.currentTarget).parent().find('[data-action="items-expander"] a i').toggleClass("icon-minus").end().find('[data-content="items-body"]').stop().slideToggle();},dropdownExpander:function(f){f.preventDefault();jQuery(f.currentTarget).parent().find('[data-action="dropdown-expander"] a i').toggleClass("icon-chevron-up").end().find('[data-content="items-body"]').stop().slideToggle();},showContent:jQuery.noop,showInModal:jQuery.noop,showError:jQuery.noop,showSuccess:jQuery.noop});b.prototype.getLayout=function c(){this._layoutInstance=this._layoutInstance||new this.Layout(this);return this._layoutInstance;};b.prototype.getConfig=function a(f,e){return _.getPathFromObject(this.Configuration,f,e);};b.prototype.UserModel=Backbone.Model.extend({});b.prototype.getUser=function(){if(!this.user_instance){this.user_instance=new this.UserModel();}return this.user_instance;};b.prototype.getUserPromise=function(){var e=this;if(!SC.PROFILE_PROMISE){SC.PROFILE_PROMISE=jQuery.Deferred().done(function(f){e.getUser().set(f);});}if(SC.ENVIRONMENT.PROFILE&&SC.PROFILE_PROMISE.state()!=="resolved"){SC.PROFILE_PROMISE.resolve(SC.ENVIRONMENT.PROFILE);}return SC.PROFILE_PROMISE;};b.prototype.start=function d(f){this.trigger("beforeStart",g);var g=this,h={},e=_.map(g.getConfig("modules",[]),function(i){if(_.isString(i)){return i;}else{if(_.isArray(i)){h[i[0]]=i.slice(1);return i[0];}}});require(e,function(){g.modules=_.object(e,arguments);g.modulesMountToAppResult={};_.each(g.modules,function(j,k){var i=_.union([g],h[k]||[]);if(j&&_.isFunction(j.mountToApp)){g.modulesMountToAppResult[k]=j.mountToApp.apply(j,i);}});if(!Backbone.history){throw new Error("No Backbone.Router has been initialized (Hint: Are your modules properly set?).");}g.trigger("afterModulesLoaded",g);f&&_.isFunction(f)&&f(g);g.trigger("afterStart",g);});};_.extend(b.prototype,Backbone.Events);SC.ApplicationSkeleton=b;})();(function(){SC.ApplicationSkeleton.prototype.Layout.prototype.showContent=function a(c,b){var f=this.application.getUserPromise();if(f.state()!=="resolved"){var e=this;f.done(function(){e.render();Backbone.history.loadUrl(Backbone.history.fragment);});if(this.application.getConfig("performance.waitForUserProfile")){return jQuery.Deferred();}}var d=this.currentView;jQuery(".modal").modal("hide");if(c.inModal){return c.showInModal();}if(!this.rendered){this.render();this.rendered=true;}if(d&&d!==c){d.destroy();if(d.bodyClass){this.$el.removeClass(d.bodyClass);}}this.currentView=c;this.$content.empty();c.render();if(c.bodyClass){this.$el.addClass(c.bodyClass);}document.title=c.title||"";this.trigger("beforeAppendView",c);this.$content.append(c.$el);this.trigger("afterAppendView",c);c.isRenderedInLayout=true;if(!b){jQuery(document).scrollTop(0);}return jQuery.Deferred().resolveWith(this,[c]);};})();(function(){var a;_.extend(SC.ApplicationSkeleton.prototype.Layout.prototype,{wrapModalView:function(b){var c=b.$containerModal.find(".modal-body");if(b.$(".modal-body").length&&c.length){c.remove();c=[];}else{if(!c.length){b.$el=b.$el.wrap('<div class="modal-body"/>').parent();}}if(c.length){c.append(b.$el);}else{b.$containerModal.find(".modal-content").append(b.$el);}return this;},prefixViewIds:function(b,c){if(typeof b==="string"){c=b;b=this.currentView;}if(b instanceof Backbone.View){c=c||"";b.$("[id]").each(function(){var d=jQuery(this);if(d.parents("svg").length>0){return;}d.attr("id",function(f,e){return c+e;});});b.$("[for]").each(function(){jQuery(this).attr("for",function(e,d){return c+d;});});}},addModalListeners:function(b){var c=this;b.$containerModal.on("hidden.bs.modal",function(){b.$containerModal.closest(".modal-container").remove();b.$containerModal=null;c.$containerModal=null;c.modalCurrentView=null;a=false;b.destroy();document.title=c.currentView&&c.currentView.getTitle()||"";});b.$containerModal.on("shown.bs.modal",function(){if(!(window.matchMedia||window.msMatchMedia)){if(jQuery(window).width()>=768){var d={left:"50%",right:"auto",width:"600px",paddingTop:"30px",paddingBottom:"30px"};b.$containerModal.find(".modal-dialog").first().css(d);}}c.trigger("afterAppendView",b);});},showInModal:function(c,d){d=jQuery.extend({modalOptions:{}},d);c.inModal=true;if(!c.hasRenderedInModal){var b=c.$el.attr("id");this.$containerModal=c.$containerModal=jQuery(SC.macros.modal(c.page_header||c.title||"")).closest("div");this.$containerModal.addClass(c.modalClass||b?("modal-"+b):"").attr("id",c.modalId||b?("modal-"+b):"");this.modalCurrentView=c;c.options.layout=this;}this.trigger("beforeAppendView",c);c.render();this.wrapModalView(c).prefixViewIds(c,"in-modal-");if(!c.hasRenderedInModal){a&&a.modal("hide");a=c.$containerModal;this.addModalListeners(c);c.$containerModal.appendTo(this.el).wrap('<div class="modal-container"/>');c.$containerModal.modal(d.modalOptions);}if(d.className){c.$containerModal.addClass(d.className);}c.hasRenderedInModal=true;return jQuery.Deferred().resolveWith(this,[c]);}});})();(function(){var a=SC.ApplicationSkeleton.prototype,b=a.Layout.prototype;_.extend(a,{trackers:[],track:function(e){var c=this,d=Array.prototype.slice.call(arguments,1);_.each(this.trackers,function(f){f[e]&&f[e].apply(c,d);});return this;},trackPageview:function(c){return this.track("trackPageview",c);},trackEvent:function(d){var e=null,c=false;this.track("trackEvent",d);if(d.callback){e=require("GoogleUniversalAnalytics");c=_.find(this.trackers,function(f){return f===e;});!c&&d.callback();}return this;},trackTransaction:function(c){return this.track("trackTransaction",c);},addCrossDomainParameters:function(c){_.each(this.trackers,function(d){if(d.addCrossDomainParameters){c=d.addCrossDomainParameters(c);}});return c;}});_.extend(b,{showContent:_.wrap(b.showContent,function(e,c){var d=c.application||c.options.application,f=d.name!=="Shopping"?"/"+d.name.toLowerCase():"";d.trackPageview(f+"/"+Backbone.history.fragment);return e.apply(this,_.toArray(arguments).slice(1));})});})();(function(){Backbone.localCache={};Backbone.cacheSize=100;function b(){var d=_.keys(Backbone.localCache),e=d.length;if(e>Backbone.cacheSize){delete Backbone.localCache[d[0]];}}Backbone.cachedSync=function(h,e,g){if(h==="read"){var f=_.result(this,"url");if(g&&g.data){f+=((~f.indexOf("?"))?"&":"?")+jQuery.param(g.data);}var d=jQuery.Deferred();d.error=d.fail;d.success=d.done;d.success(g.success);d.error(g.error);delete g.success;delete g.error;g.cache=true;Backbone.localCache[f]=Backbone.localCache[f]||Backbone.sync.apply(this,arguments);Backbone.localCache[f].then(function(j,i,k){j=(k.responseText)?JSON.parse(k.responseText):j;d.resolveWith(Backbone.localCache[f],[j,i,k]);b();},function(){delete Backbone.localCache[f];d.rejectWith(Backbone.localCache[f],arguments);},function(){d.notifyWith(Backbone.localCache[f],arguments);});return d;}return Backbone.sync.apply(this,arguments);};function a(f,g){var e=_.result(this,"url");e+=((~e.indexOf("?"))?"&":"?")+jQuery.param(g||{});var d=jQuery.Deferred();d.resolveWith(this,[f,"success",{response:f,status:"success",statusCode:"200",readyState:4,statusText:"OK",responseText:false}]);Backbone.localCache[e]=d;}function c(e){var d=_.result(this,"url");if(e){d+=((~d.indexOf("?"))?"&":"?")+jQuery.param(e);}return !!Backbone.localCache[d];}Backbone.CachedCollection=Backbone.Collection.extend({sync:Backbone.cachedSync,addToCache:a,isCached:c});Backbone.CachedModel=Backbone.Model.extend({sync:Backbone.cachedSync,addToCache:a,isCached:c});})();(function(){_.extend(Backbone.Model.prototype,{url:function(){var a=_.result(this,"urlRoot")||_.result(this.collection,"url");if(this.isNew()){return a;}return a+"?internalid="+encodeURIComponent(this.id);},idAttribute:"internalid"});})();(function(){Backbone.sync=_.wrap(Backbone.sync,function(d,e,c,b){var a=b.url||_.result(c,"url");if(a){b=b||{};b.url=a+(~a.indexOf("?")?"&":"?")+jQuery.param({c:SC.ENVIRONMENT.companyId,n:SC.ENVIRONMENT.siteSettings.siteid});}return d.apply(this,[e,c,b]);});})();(function(){_.extend(Backbone.Validation.callbacks,{control_group_selector:".control-group, .form-group",error_state_class:"error has-error",valid:function(c,b,a){var e=c.$el.find("["+a+'="'+b+'"]'),d=e.parents(this.control_group_selector).removeClass(this.error_state_class);return d.find(".backbone-validation").remove().end();},invalid:function(d,c,e,b){var a,g=d.$el.find("["+b+'="'+c+'"]'),f=g.parents(this.control_group_selector).addClass(this.error_state_class);d.$('[data-type="alert-placeholder"]').html(SC.macros.message(_(" Sorry, the information you provided is either incomplete or needs to be corrected.").translate(),"error",true));if(!d.$savingForm){d.$savingForm=g.closest("form");}d.$savingForm.find("*[type=submit], *[type=reset]").attr("disabled",false);d.$savingForm.find('input[type="reset"], button[type="reset"]').show();if(g.data("error-style")==="inline"){if(!f.find(".help-inline").length){f.find(".controls").append('<span class="help-inline backbone-validation"></span>');}a=f.find(".help-inline");}else{if(!f.find(".help-block").length){f.find(".controls").append('<p class="help-block backbone-validation"></p>');}a=f.find(".help-block");}return a.text(e);}});})();(function(){_.extend(Backbone.View.prototype,{errorMessage:"Sorry, the information you provided is either incomplete or needs to be corrected.",showContent:function(a){return this.options.application&&this.options.application.getLayout().showContent(this,a);},showInModal:function(a){return this.options.application&&this.options.application.getLayout().showInModal(this,a);},getMetaDescription:function(){return this.metaDescription;},getMetaKeywords:function(){return this.metaKeywords;},getMetaTags:function(){return jQuery("<head/>").html(this.metaTags||"").children("meta");},getTitle:function(){return this.title;},getCanonical:function(){var a=window.location.protocol+"//"+window.location.hostname+"/"+Backbone.history.fragment,b=a.indexOf("?");return !~b?a:a.substring(0,b);},getRelPrev:jQuery.noop,getRelNext:jQuery.noop,_destroy:function(){this.undelegateEvents();this.model&&this.model.off(null,null,this);this.collection&&this.collection.off(null,null,this);},destroy:function(){this._destroy();},showConfirmationMessage:function(c){var b=jQuery(SC.macros.message(c,"success",true)),a=jQuery("[data-confirm-message]");b.find(".close").click(function(){a.hide();});a.show().empty().append(b);setTimeout(function(){a.fadeOut(3000);},5000);},showWarningMessage:function(b){var a=jQuery(SC.macros.message(b,"warning",true));this.$("[data-confirm-message]").empty().append(a);},disableElementsOnPromise:function(c,b){var a=this.$(b);if(a.length===0){return;}a.attr("disabled",true);c.always(function(){a.attr("disabled",false);});}});})();(function(){_.extend(Backbone.View.prototype,{_render:function(){this.undelegateEvents();(this.model||this.collection)&&Backbone.Validation.bind(this);var b=SC.template(this.template+"_tmpl",{view:this});var a=/msie [\w.]+/,c=document.documentMode,d=(a.exec(navigator.userAgent.toLowerCase())&&(!c||c<=7));if(d){b=b.replace(/href="(.+?)(?=")/g,'$&" data-href="$1');}var e=this.applyPermissions(b);this.$el.empty();this.trigger("beforeViewRender",this);if(SC.ENVIRONMENT.jsEnvironment==="server"){this.$el[0].innerHTML=e[0].innerHTML;}else{this.$el.append(e);}this.$('[data-toggle="tooltip"]').tooltip({html:true});this.trigger("afterViewRender",this);this.delegateEvents();return this;},applyPermissions:function(a){var b=SC.ENVIRONMENT.jsEnvironment==="server"?jQuery("<div/>").append(a):jQuery(a),c=b.find("[data-permissions]");c.each(function(){var g=jQuery(this),i=g.data("permissions"),f=i.split(/[\s,]+/),e=g.data("permissions-operator")||"AND",d,h=e!=="OR";_.each(f,function(j){var k=j.split(".");d=!(k.length===3&&k[2]<5&&SC.ENVIRONMENT.permissions&&SC.ENVIRONMENT.permissions[k[0]]&&SC.ENVIRONMENT.permissions[k[0]][k[1]]<k[2]);if(e==="OR"){h=h||d;}else{h=h&&d;}});if(!h){g.remove();}});return b;},render:function(){return this._render();}});})();(function(){_.extend(Backbone.View.prototype,{saveForm:function(d,b,c){d.preventDefault();b=b||this.model;this.$savingForm=jQuery(d.target).closest("form");if(this.$savingForm.length){this.$savingForm.find('input[type="submit"], button[type="submit"]').attr("disabled",true);this.$savingForm.find('input[type="reset"], button[type="reset"]').hide();}this.hideError();var a=this;return b.save(c||this.$savingForm.serializeObject(),{wait:true,success:function(f,e){if(a.inModal&&a.$containerModal){a.$containerModal.modal("hide");}if(a.$savingForm.length){a.hideError(a.$savingForm);a.$savingForm.find('[type="submit"], [type="reset"]').attr("disabled",false);f.trigger("save",f,e);}},error:function(f,e){a.$savingForm.find("*[type=submit], *[type=reset]").attr("disabled",false);if(e.responseText){f.trigger("error",jQuery.parseJSON(e.responseText));}}});}});})();(function(){_.extend(Backbone.View.prototype,{toggleReset:_.debounce(function(g){var b=jQuery(g.target).closest("form"),c=this.model,d,f,a=_.filter(b.serializeObject(),function(h,e){d=c.get(e);f=jQuery.trim(h);return d?d!==f:!!f;});b.find('[data-action="reset"]')[a.length?"removeClass":"addClass"]("hide");return this;},300)});})();(function(){var a={top:0,left:0};jQuery(document).ready(function(){var c=jQuery(document.body),d=jQuery("#loadingIndicator");if(!d.length&&!SC.ENVIRONMENT.isTouchEnabled){d=jQuery("<img/>",{id:"loadingIndicator","class":"global-loading-indicator",src:_.getAbsoluteUrl("img/ajax-loader.gif"),css:{zIndex:9999,position:"absolute"}}).hide();if(!_.result(SC,"isPageGenerator")){d.appendTo(c);}}SC.$loadingIndicator=d;var e=16,b=16;c.on({mousemove:_.throttle(function(f){a={top:Math.min(c.innerHeight()-e,f.pageY+b),left:Math.min(c.innerWidth()-b,f.pageX+e)};d.filter(":visible").css(a);},50),resize:_.throttle(function(){var f=d.offset();if(!f){return;}a={top:Math.min(c.innerHeight()-e,f.top),left:Math.min(c.innerWidth()-b,f.left)};d.filter(":visible").css(a);},50)});});SC.loadingIndicatorShow=function(){SC.$loadingIndicator&&SC.$loadingIndicator.css(a).show();};SC.loadingIndicatorHide=function(){SC.$loadingIndicator&&SC.$loadingIndicator.hide();};jQuery(document).ajaxStart(SC.loadingIndicatorShow).ajaxStop(SC.loadingIndicatorHide);jQuery.ajaxSetup({beforeSend:function(c,b){if(!~b.contentType.indexOf("charset")){c.setRequestHeader("Content-Type",b.contentType+"; charset=UTF-8");}}});})();(function(){jQuery.fn.serializeObject=function(){var c={},b=this.serializeArray();this.find("input[type=checkbox]:not(:checked)[data-unchecked-value]").each(function(){var a=jQuery(this);b.push({name:a.prop("name"),value:a.data("unchecked-value")});});jQuery.each(b,function(){if(c[this.name]!==undefined){if(!c[this.name].push){c[this.name]=[c[this.name]];}c[this.name].push(this.value||"");}else{c[this.name]=this.value||"";}});return c;};})();!function(a){var b=function(d,c){this.id=a(d).data("id");this.element=d;this.init(d,c);};b.prototype={init:function(e,c){var d=a(e);a('[data-type="sub-menu"]',d).hide();a("div.expandable",d).click(function(g){if(!g.target.href||g.target.href===""){var f=a(this),h=f.next();if((h.is("ul"))&&(h.is(":visible"))){h.slideUp("normal");h.removeClass("tree-expanded");f.find("i").removeClass("icon-menu-down").addClass("icon-menu-up");f.removeClass("is-last-item");return false;}if((h.is("ul"))&&(!h.is(":visible"))){h.slideDown("normal");h.addClass("tree-expanded");f.find("i").removeClass("icon-menu-up").addClass("icon-menu-down");f.addClass("is-last-item");return false;}}});a("li > a",d).click(function(){a("li",a('[data-toggle="tree"]')).removeClass("tree-active");a('[data-toggle="tree"]').removeClass("active");d.addClass("active");a(this).closest("li").addClass("tree-active");a(this).parentsUntil(d,"ul").closest("li").addClass("tree-active");});if(c){this.updateUI(c);}},updateUI:function(c){var d=a(this.element);a(c.expanded).each(function(){a('[data-id="'+this+'"] ul:first()',d.parent()).slideDown("normal");a('[data-id="'+this+'"] ul:first()',d.parent()).addClass("tree-expanded");a('[data-id="'+this+'"] i:first()',d.parent()).removeClass("icon-menu-up").addClass("icon-menu-down");});if(c.active&&c.active.length>0){a(".tree-active",d).removeClass("tree-active");d.addClass("active");a(c.active).each(function(){a('[data-id="'+this+'"]',d.parent()).addClass("tree-active");});}},getExpanded:function(){var d=a(this.element);var c=_(a(".tree-expanded",d).closest("li")).map(function(e){return a(e).data("id");});return c;},getActive:function(){var d=a(this.element);var c=_(a(".tree-active",d).closest("li")).map(function(e){return a(e).data("id");});return c;}};a.fn.tree=function(c){return this.each(function(){var e=a(this),d=e.data("tree");if(!d){e.data("tree",(d=new b(this,c)));}});};a.fn.tree.Constructor=b;}(window.jQuery);(function(){String.prototype.format=function(){var a=arguments;return this.replace(/\$\((\d+)\)/g,function(b,c){return typeof a[c]!=="undefined"?a[c]:b;});};})();(function(){SC.handleMacroError=function(l,k){console.error("Error in macro: "+k+"\n"+l+"\n "+l.stack);};var j=function(){return SC.isPageGenerator?SC.isPageGenerator():false;};SC.compileMacros=function f(l){SC.macros={};var k={registerMacro:function(o,p){var s=p.toString(),r=j()?"":"\\n\\n<!-- MACRO STARTS: "+o+" -->\\n",n=j()?"":"\\n<!-- MACRO ENDS: "+o+" -->\\n",m=';try{var __p="'+r+'";'+s.replace(/^function[^\{]+\{/i,"").replace(/\}[^\}]*$/i,"")+';__p+="'+n+'";return __p;}catch(e){SC.handleMacroError(e,"'+o+'")}'||[],q=s.slice(s.indexOf("(")+1,s.indexOf(")")).match(/([^\s,]+)/g)||[];q.push(m);SC.macros[o]=_.wrap(Function.apply(null,q),function(u){var t=u.apply(this,_.toArray(arguments).slice(1));t=b(t);t=i(t);return t;});}};_.each(l,function(m){try{_.template(m,k);}catch(n){SC.handleMacroError(n,m.substring(m.indexOf("(")+2,m.indexOf(",")-1));}});};var d={};function g(k,o){if(!SC.templates[k]){throw new Error("Template '"+k+"' is not present in the template hash.");}try{d[k]=d[k]||_.template(SC.templates[k]||"");var n=j()?"":"\n\n<!-- TEMPLATE STARTS: "+k+"-->\n",l=j()?"":"\n<!-- TEMPLATE ENDS: "+k+" -->\n";return n+d[k](_.extend({},SC.macros,o))+l;}catch(m){m.message="Error in template "+k+": "+m.message;throw m;}}SC.template=g;function c(){d={};}SC.resetTemplates=c;var h=/<\s*script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi,i=function(k){if(j()&&k){k=k.replace(/(<!--[\s\S]*?-->)/g," $1 ");while(h.test(k)){k=k.replace(h,"");}}return k||"";},b=function(k){if(j()&&k){k=k.replace(/\>\s+</g,"><").replace(/<!--[\s\S]*?-->/g,"").replace(/\s+/g," ");if(SC.blurInitialHTML){k=k.replace(/(<img\s+[^>]*>\s*<\/img>|<img\s+[^>]*\/>|(?:<img\s+[^>]*>)(?!\s*<\/img>))(?!\s*<\s*\/noscript\s*>)/gmi,"<noscript>$1</noscript>");}}if(!j()&&window.fixImagesForLoader){k=window.fixImagesForLoader(k);}return k||"";};if(j()){var a=jQuery.fn.html;jQuery.fn.html=function(k){if(typeof k==="string"){k=b(k);k=i(k);}return a.apply(this,[k]);};var e=jQuery.fn.append;jQuery.fn.append=function(k){if(typeof k==="string"){k=b(k);k=i(k);}return e.apply(this,[k]);};}_.template_original=_.template;_.template=_.wrap(_.template,function(l){var k=l.apply(this,Array.prototype.slice.call(arguments,1));if(typeof k==="function"){return _.wrap(k,function(n){var m=n.apply(this,Array.prototype.slice.call(arguments,1));m=b(m);m=i(m);return m;});}else{k=b(k);k=i(k);return k;}});})();
/*
* Description: SuiteCommerce Reference My Account
*
* @copyright (c) 2000-2013, NetSuite Inc.
* @version 1.0
*/
(function(c){var d=c.Layout.prototype.showContent,b=c.Layout.prototype.initialize,a=c.Layout.prototype.render;c.Layout=c.Layout.extend({key_elements:{sidebar:"#sidebar",breadcrumb:"#breadcrumb"},initialize:function(){this.fixedMenuItems=this.getFixedMenuItems();b.apply(this,arguments);},showContent:function(f,h,g,e){d.call(this,f,e);this.updateCrumbtrail(g);this.updateSidebar(h);return jQuery.Deferred().resolveWith(this,[f]);},updateCrumbtrail:function(e){if(!_.isArray(e)){e=[e];}e.unshift({href:"#","data-touchpoint":"home","data-hashtag":"#",text:_("Home").translate()},{href:"#","data-touchpoint":"customercenter","data-hashtag":"#overview",text:_("My Account").translate()});this.$breadcrumb.empty().append(SC.macros.breadcrumb(e));},hideBreadcrumb:function(){this.$breadcrumb.empty();},updateSidebar:function(f){var i=this.$sidebar.children().removeClass("active").filter(function(){return jQuery(this).data("label")===f;});if(i&&i.length>0){i.addClass("active");}else{jQuery('[data-type="tree"] li',this.$sidebar).removeClass("tree-active");var g=this.$sidebar.find('[data-label="'+f+'"]');g.addClass("tree-active");var e=g.parentsUntil(this.$sidebar,"ul");var h=e.closest("li");h.addClass("tree-active");h.first().addClass("active");h.find("i").removeClass("icon-menu-up").addClass("icon-menu-down");e.slideDown("normal");e.addClass("tree-expanded");}},render:function(){this.fixedMenuItems=this.getFixedMenuItems();var e=[];if(this.trees){this.trees.each(function(){var f=jQuery(this).data("tree");if(f){e.push({id:f.id,expanded:f.getExpanded(),active:f.getActive()});}});}a.apply(this,arguments);this.trees=this.$('[data-toggle="tree"]').each(function(){var f=_.findWhere(e,{id:jQuery(this).data("id")});jQuery(this).tree(f);});},menuItems:[],getFixedMenuItems:function(){var e=this,h=null,g=null,i=[],f=[];_.each(this.menuItems,function(j){h=j&&e.fixMenuItems(j);if(h){i.push(h);if(h.parent){f.push(h);}}});_.each(f,function(j){g=_.findWhere(i,{id:j.parent});if(g){if(!_.findWhere(g.children,{id:j.id})){g.children.push(j);}i=_.without(i,j);}});return this.sortMenuItems(i);},getMenuItems:function(){return this.fixedMenuItems;},sortMenuItems:function(e){return e.sort(function(g,f){if(g.index!==f.index){return g.index-f.index;}else{return g.name>f.name?1:-1;}});},addMenuItem:function(f){var e=this;f=_.isArray(f)?f:[f];_.each(f,function(g){e.menuItems.push(g);});},fixMenuItems:function(e){var f=this,g=f.fixMenuItem(e);if(g&&_.isArray(g.children)){_.each(g.children,function(h){f.fixMenuItems(h);});}return g;},menuItemValue:function(e){return _.isFunction(e)?e.apply(this,[this.application]):e;},fixMenuItem:function(e){var f=null;e=this.menuItemValue(e);if(!e){return undefined;}f=_.clone(e);f.parent=this.menuItemValue(f.parent);f.name=this.menuItemValue(f.name);f.index=this.menuItemValue(f.index);f.url=this.menuItemValue(f.url);f.id=this.menuItemValue(f.id);f.children=this.menuItemValue(f.children)||[];return f;},removeMenuItem:function(e){this.menuItems=_.reject(this.menuItems,function(f){return f.id===e;});},updateMenuItemsUI:function(){this.render();var e=this.currentView;if(e){e.getViewLabel?e.showContent(e.getViewLabel()):e.showContent();jQuery(".modal-backdrop").remove();jQuery("body").removeClass("modal-open");}},replaceMenuItem:function(g,e){for(var f=0;f<this.menuItems.length;f++){if(g(this.fixMenuItem(this.menuItems[f]))){this.menuItems[f]=e;}}}});c.start=_.wrap(c.start,function(f){var e=_(this.getConfig("paymentWizardSteps")).chain().pluck("steps").flatten().pluck("modules").flatten().value();e=_.uniq(e);this.Configuration.modules=_.union(this.getConfig("modules"),e);f.apply(this,_.toArray(arguments).slice(1));});c.on("afterModulesLoaded",function(e){_.each(c.modules,function(f){if(f){if(f.MenuItems){e.getLayout().addMenuItem(f.MenuItems);}}});});jQuery.ajaxSetup({cache:false});Backbone.history.on("all",function(){jQuery(".main-nav.in").collapse("hide");});})(SC.Application("MyAccount"));(function(b){b.Configuration={};_.extend(b.Configuration,{logoUrl:"",currentTouchpoint:"customercenter",modules:[["ItemDetails",{startRouter:false}],"Profile",["Cart",{startRouter:false}],["Address",{startRouter:SC.ENVIRONMENT.siteSettings.is_logged_in}],"Content",["CreditCard",{startRouter:SC.ENVIRONMENT.siteSettings.is_logged_in}],"BackToTop","Facets.Model","MultiCurrencySupport","MultiHostSupport","OrderHistory","ReturnAuthorization","OrderItem","GoogleAnalytics","GoogleUniversalAnalytics","Receipt","NavigationHelper","Responsive","SiteSearch","AjaxRequestsKiller","ErrorManagement","Merchandising","Balance","Invoice","CreditMemo","Deposit","DepositApplication","CustomerPayment","LivePayment","PaymentWizard","TransactionHistory","ProductList","PrintStatement","Quote","Case"],paymentWizardSteps:[{name:_("SELECT INVOICES TO PAY").translate(),steps:[{url:"make-a-payment",hideBackButton:true,hideContinueButton:true,modules:["PaymentWizard.Module.Invoice",["PaymentWizard.Module.Summary",{container:"#wizard-step-content-right",show_estimated_as_invoices_total:true}]],save:function(){return jQuery.Deferred().resolve();}}]},{name:_("PAYMENT REVIEW").translate(),steps:[{url:"review-payment",hideBackButton:true,hideContinueButton:true,modules:["PaymentWizard.Module.ShowInvoices",["PaymentWizard.Module.CreditTransaction",{transaction_type:"deposit"}],["PaymentWizard.Module.CreditTransaction",{transaction_type:"credit"}],"PaymentWizard.Module.ShowTotal",["PaymentWizard.Module.PaymentMethod.Creditcard",{title:_("Credit Card").translate()}],["PaymentWizard.Module.Addresses",{title:_("Billing Address").translate()}],["PaymentWizard.Module.Summary",{container:"#wizard-step-content-right",total_label:_("Payment Total").translate(),submit:true}]],save:function(){return this.wizard.model.save();}}]},{name:_("Payment Confirmation").translate(),steps:[{url:"payment-confirmation",hideBackButton:true,hideBreadcrumb:true,hideContinueButton:true,modules:["PaymentWizard.Module.Confirmation","PaymentWizard.Module.ShowInvoices",["PaymentWizard.Module.ShowCreditTransaction",{transaction_type:"deposit"}],["PaymentWizard.Module.ShowCreditTransaction",{transaction_type:"credit"}],"PaymentWizard.Module.ShowTotal","PaymentWizard.Module.ShowPayments",["PaymentWizard.Module.ConfirmationNavigation",{container:"#wizard-step-content-right",submit:true}]]}]}],customerSupportURL:"",macros:{itemOptions:{selectorByType:{select:"itemDetailsOptionTile","default":"itemDetailsOptionText"},selectedByType:{"default":"shoppingCartOptionDefault"}},merchandisingZone:"merchandisingZone"},returnPolicyURL:"",homeBanners:[],defaultSearchUrl:"search",searchPrefs:{maxLength:40,keywordsFormatter:function(e){var c=/[\(\)\[\]\{\}\!\"\:]{1}/g,f=/^[\*\-\+\~]{1}/g,d="";return e.replace(c,d).replace(f,d);}},navigationTabs:[{text:_("Home").translate(),href:"/",data:{touchpoint:"home",hashtag:"#/"}},{text:_("Shop").translate(),href:"/search",data:{touchpoint:"home",hashtag:"#/search"}}],searchApiMasterOptions:{Facets:{fieldset:"search"},typeAhead:{fieldset:"typeahead"}},tracking:{googleUniversalAnalytics:{propertyID:"",domainName:""},google:{propertyID:"",domainName:""}},typeahead:{minLength:3,maxResults:8,macro:"typeahead",sort:"relevance:asc"},isSearchGlobal:true,imageNotAvailable:_.getAbsoluteUrl("img/no_image.png"),imageSizeMapping:{thumbnail:"thumbnail",main:"main",tinythumb:"tinythumb",zoom:"zoom",fullscreen:"fullscreen"},profileMacro:"headerProfile",languagesEnabled:true,homeTemplate:"home_tmpl",creditCardIcons:{VISA:"img/visa.png",Discover:"img/discover.png","Master Card":"img/master.png",Maestro:"img/maestro.png","American Express":"img/american.png"},showCreditCardHelp:true,creditCardHelpTitle:_("Where to find your Security Code").translate(),imageCvvAllCards:_.getAbsoluteUrl("img/cvv_all_cards.jpg"),imageCvvAmericanCard:_.getAbsoluteUrl("img/cvv_american_card.jpg"),defaultPaginationSettings:{showPageList:true,pagesToShow:9,showPageIndicator:false},facetDelimiters:{betweenFacetNameAndValue:"/",betweenDifferentFacets:"/",betweenDifferentFacetsValues:",",betweenRangeFacetsValues:"to",betweenFacetsAndOptions:"?",betweenOptionNameAndValue:"=",betweenDifferentOptions:"&"},collapseElements:false,notShowCurrencySelector:true,filterRangeQuantityDays:30,homeRecentOrdersQuantity:3,productReviews:{maxRate:5},returnAuthorization:{reasons:[_("Wrong Item Shipped").translate(),_("Not as pictured on the Website").translate(),_("Damaged during shipping").translate(),_("Changed my mind").translate(),_("Item was defective").translate(),_("Arrived too late").translate()]}});var a=(window.screen)?window.screen.availWidth:window.outerWidth||window.innerWidth;if(a<768){_.extend(b.Configuration,{defaultPaginationSettings:{showPageList:false,showPageIndicator:true},collapseElements:true});}else{if(a>=768&&a<=978){_.extend(b.Configuration,{defaultPaginationSettings:{showPageList:true,pagesToShow:4,showPageIndicator:false},collapseElements:true});}else{_.extend(b.Configuration,{});}}})(SC.Application("MyAccount"));(function(){function c(d){if("url" in d&&"altimagetext" in d){return[d];}return _.flatten(_.map(d,function(e){if(_.isArray(e)){return e;}return c(e);}));}function b(d){return{_id:"internalid",_sku:function(e){var f=e.getSelectedMatrixChilds(),g=e.get("itemid")||"";if(f&&f.length===1){g=f[0].get("itemid")||g;}return g;},_name:function(e){if(e.get("_matrixParent").get("internalid")){return e.get("_matrixParent").get("storedisplayname2")||e.get("_matrixParent").get("displayname");}return e.get("storedisplayname2")||e.get("displayname");},_pageTitle:["pagetitle","storedisplayname2","displayname"],_pageHeader:["storedisplayname2","displayname"],_keywords:"searchkeywords",_metaTags:"metataghtml",_breadcrumb:function(e){var f=[{href:"/",text:_("Home").translate()}];f.push({href:e.get("_url"),text:e.get("_name")});return f;},_url:function(e){if(e.get("_matrixParent")&&e.get("_matrixParent").get("internalid")){return e.get("_matrixParent").get("_url");}else{if(SC.ENVIRONMENT.siteType&&SC.ENVIRONMENT.siteType==="STANDARD"){return e.get("canonicalurl");}}return e.get("urlcomponent")?"/"+e.get("urlcomponent"):"/product/"+e.get("internalid");},_editUrl:function(f){var e=(f.get("_matrixParent").get("_id"))?f.get("_matrixParent").get("_url"):f.get("_url");e+=f.getQueryString();if(f.get("line_id")){e+="&cartitemid="+f.get("line_id");}return e;},_thumbnail:function(g){var f=g.get("itemimages_detail")||{};if(f.thumbnail){if(_.isArray(f.thumbnail.urls)&&f.thumbnail.urls.length){return f.thumbnail.urls[0];}return f.thumbnail;}if(SC.ENVIRONMENT.siteType&&SC.ENVIRONMENT.siteType==="STANDARD"&&g.get("storedisplaythumbnail")){return{url:g.get("storedisplaythumbnail"),altimagetext:g.get("_name")};}var h=g.get("_matrixParent");if(h&&h.get("internalid")){return h.get("_thumbnail");}var e=c(f);if(e.length){return e[0];}return{url:d.Configuration.imageNotAvailable,altimagetext:g.get("_name")};},_images:function(i){var e=[],f=i.itemOptions,g=i.get("itemimages_detail")||{},h=f&&f[d.getConfig("multiImageOption")]||null;g=g.media||g;if(h&&g[h.label]){e=c(g[h.label]);}else{e=c(g);}return e.length?e:[{url:d.Configuration.imageNotAvailable,altimagetext:i.get("_name")}];},_matrixParent:"matrix_parent",_matrixChilds:"matrixchilditems_detail",_optionsDetails:"itemoptions_detail",_relatedItems:"related_items",_relatedItemsDetail:"relateditems_detail",_correlatedItemsDetail:"correlateditems_detail",_priceDetails:"onlinecustomerprice_detail",_price:function(e){return(e.get("onlinecustomerprice_detail")&&e.get("onlinecustomerprice_detail").onlinecustomerprice)||"";},_price_formatted:function(e){return(e.get("onlinecustomerprice_detail")&&e.get("onlinecustomerprice_detail").onlinecustomerprice_formatted)||"";},_comparePriceAgainst:"pricelevel1",_comparePriceAgainstFormated:"pricelevel1_formatted",_itemType:"itemtype",_stock:"quantityavailable",_minimumQuantity:function(e){var f=e.getSelectedMatrixChilds();if(f&&f.length===1){return f[0].get("minimumquantity")||1;}return e.get("minimumquantity")||1;},_isReturnable:function(f){var e=f.get("itemtype");return e==="InvtPart"||e==="NonInvtPart"||e==="Kit";},_isInStock:"isinstock",_isPurchasable:"ispurchasable",_isBackorderable:"isbackorderable",_showOutOfStockMessage:"showoutofstockmessage",_showInStockMessage:function(){return false;},_showStockDescription:function(){return true;},_stockDescription:"stockdescription",_stockDescriptionClass:function(e){return"stock-description-"+(e.get("_stockDescription")||"").toLowerCase().replace(/[\W\"]+/g,"-").replace(/\-+/g,"-");},_outOfStockMessage:function(e){return e.get("outofstockmessage2")||e.get("outofstockmessage");},_inStockMessage:function(){return _("In Stock").translate();},_rating:function(e){return Math.round(e.get("custitem_ns_pr_rating")*10)/10||0;},_ratingsCount:function(e){return e.get("custitem_ns_pr_count")||0;},_attributesToRateOn:function(f){var e=f.get("custitem_ns_pr_item_attributes")||"";return _.reject(e.split(", "),function(g){return !g||g==="&nbsp;";});},_attributesRating:function(e){return JSON.parse(e.get("custitem_ns_pr_attributes_rating"));},_ratingsCountsByRate:function(e){return e.get("custitem_ns_pr_rating_by_rate")&&JSON.parse(e.get("custitem_ns_pr_rating_by_rate"))||{};}};}function a(){_.each(SC._applications,function(d){d.Configuration=d.Configuration||{};d.Configuration.itemKeyMapping=_.defaults(d.Configuration.itemKeyMapping||{},b(d));});}if(typeof require!=="undefined"){define("ItemsKeyMapping",[],function(){return{getKeyMapping:b,mapAllApplications:a};});}a();})();define("Address.Collection",["Address.Model"],function(a){return Backbone.Collection.extend({model:a,url:"services/address.ss"});});define("Address",["Address.Views","Address.Model","Address.Router","Address.Collection"],function(c,d,a,b){return{Views:c,Model:d,Router:a,Collection:b,MenuItems:{parent:"settings",id:"addressbook",name:_("Address Book").translate(),url:"addressbook",index:3},mountToApp:function(f,e){if(e&&e.startRouter){return new a(f);}}};});define("Address.Model",function(){function a(){return SC.ENVIRONMENT.siteSettings&&SC.ENVIRONMENT.siteSettings.registration&&SC.ENVIRONMENT.siteSettings.registration.companyfieldmandatory==="T";}return Backbone.Model.extend({urlRoot:"services/address.ss",validation:{addressee:{required:true,msg:_("Addressee is required").translate()},addr1:{fn:_.validateAddressFirst},addr2:{fn:_.validateAddressSec},company:{required:a(),msg:_("Company is required").translate()},country:{required:true,msg:_("Country is required").translate()},state:{fn:_.validateState},city:{required:true,msg:_("City is required").translate()},zip:{fn:_.validateZipCode},phone:{fn:_.validatePhone}},getInvalidAttributes:function(){var c=_.keys(this.validation),d,b=[];this.get("isvalid")!=="T"&&this.isValid(true)&&_.extend(this,Backbone.Validation.mixin);_.each(c,function(e){if(!this.isValid(e)){switch(e){case"fullname":d=_("Full Name").translate();break;case"addr1":d=_("Address").translate();break;case"addr2":d=_("Address2").translate();break;case"city":d=_("City").translate();break;case"zip":d=_("Zip Code").translate();break;case"country":d=_("Country").translate();break;case"phone":d=_("Phone Number").translate();break;}b.push(d);}},this);return b;}});});define("Address.Router",["Address.Views","Address.Model"],function(a,b){return Backbone.Router.extend({routes:{addressbook:"addressBook","addressbook/new":"newAddress","addressbook/:id":"addressDetailed"},initialize:function(c){this.application=c;},addressBook:function(){if(this.application.getUser().get("isLoggedIn")!=="T"){return this.application.getLayout().notFound();}var d=this.application.getUser().get("addresses");if(d.length){var c=new a.List({application:this.application,collection:d});d.off(null,null,this);d.on("reset destroy change add",function(){var e=this.application.getLayout().currentView;if(e instanceof a.List||e instanceof a.Details){this.addressBook();}},this);c.showContent("addressbook");}else{Backbone.history.navigate("#addressbook/new",{trigger:true});}},addressDetailed:function(f){if(this.application.getUser().get("isLoggedIn")!=="T"){return this.application.getLayout().notFound();}var e=this.application.getUser().get("addresses"),d=e.get(f),c=new a.Details({application:this.application,collection:e,model:d});c.model.on("reset destroy change add",function(){if(c.inModal&&c.$containerModal){c.$containerModal.modal("hide");c.destroy();}else{Backbone.history.navigate("#addressbook",{trigger:true});}},c);c.showContent("addressbook");},newAddress:function(){if(this.application.getUser().get("isLoggedIn")!=="T"){return this.application.getLayout().notFound();}var d=this.application.getUser().get("addresses"),c=new a.Details({application:this.application,collection:d,model:new b()});d.on("add",function(){if(c.inModal&&c.$containerModal){c.$containerModal.modal("hide");c.destroy();}else{Backbone.history.navigate("#addressbook",{trigger:true});}},c);c.model.on("change",function(e){d.add(e);},this);c.showContent("addressbook");}});});define("Address.Views",function(){var a={};a.Details=Backbone.View.extend({template:"address",attributes:{"class":"AddressDetailsView"},events:{"submit form":"saveForm",'change form:has([data-action="reset"])':"toggleReset",'click [data-action="reset"]':"resetForm",'change select[data-type="country"]':"updateStates",'change select[data-type="state"]':"eraseZip",'change input[data-type="state"]':"eraseZip",'blur input[data-type="phone"]':"formatPhone"},initialize:function(b){this.manage=b.manage;this.application=b.application;this.title=this.model.isNew()?_("Add New Address").translate():_("Update Address").translate();this.page_header=this.title;},showContent:function(c,b){b=b||c;this.application.getLayout().showContent(this,b,{text:this.title,href:"/"+c});this.$('[rel="tooltip"]').tooltip({placement:"right"}).on("hide",function(d){d.preventDefault();jQuery(d.target).next(".tooltip").hide();});},resetForm:function(b){b.preventDefault();this.showContent("addressbook");},formatPhone:function(c){var b=jQuery(c.target);b.val(_(b.val()).formatPhone());},eraseZip:function(){var c=this.$('[name="country"]').val(),b=this.application.getConfig("siteSettings.countries",{}),d=this.$('[data-input="zip"]'),e=this.$('input[name="zip"]',d);e.val("");if(b[c]&&b[c].isziprequired==="F"){d.hide();}else{d.show();}},updateStates:function(b){this.$('[data-type="state"]').closest(".control-group").empty().append(SC.macros.statesDropdown({countries:this.application.getConfig("siteSettings.countries"),selectedCountry:this.$(b.target).val(),manage:this.manage?this.manage+"-":""}));this.eraseZip(b);}});a.List=Backbone.View.extend({template:"address_book",page_header:_("Address Book").translate(),title:_("Address Book").translate(),attributes:{"class":"AddressListView"},events:{'click [data-action="remove"]':"remove"},initialize:function(){this.options.showDefaults=this.options.application.getConfig("currentTouchpoint")==="customercenter";},showContent:function(c,b){b=b||c;this.options.application.getLayout().showContent(this,b,{text:this.title,href:"/"+c});},remove:function(b){b.preventDefault();if(confirm(_("Are you sure you want to delete this address?").translate())){this.removeAddressModel(jQuery(b.target).data("id"));}},removeAddressModel:function(b){this.collection.get(b).destroy({wait:true});}});return a;});define("AjaxRequestsKiller",function(){return{mountToApp:function(a){a.killerId=_.uniqueId("ajax_killer_");a.lambsToBeKilled=[];jQuery.ajaxSettings.beforeSend=_.wrap(jQuery.ajaxSettings.beforeSend,function(d,c,b){if(b.killerId){c.killerId=b.killerId;a.lambsToBeKilled.push(c);}d.apply(this,_.toArray(arguments).slice(1));});a.on("afterStart",function(){Backbone.history.on("all",function(){_.each(a.lambsToBeKilled,function(b){if(a.killerId&&a.killerId!==b.killerId){if(b.readyState!==4){b.preventDefault=true;b.abort();}a.lambsToBeKilled=_.without(a.lambsToBeKilled,b);}});a.killerId=_.uniqueId("ajax_killer_");});});}};});define("BackToTop",function(){return{mountToApp:function(b){var a=b.getLayout();_.extend(a,{backToTop:function(){jQuery("html, body").animate({scrollTop:"0px"},300);}});_.extend(a.events,{'click [data-action="back-to-top"]':"backToTop"});}};});define("Cart",["LiveOrder.Model","Cart.Views","Cart.Router"],function(c,b,a){return{Views:b,Router:a,mountToApp:function(f,e){var g=f.getLayout();f.getCart=function(){if(!f.cartInstance){f.cartInstance=new c({internalid:"cart"});f.cartInstance.application=f;f.cartInstance.bootstraped=SC.ENVIRONMENT.CART_BOOTSTRAPED;f.cartInstance.isLoading=!SC.ENVIRONMENT.CART_BOOTSTRAPED;}return f.cartInstance;};f.loadCart=function(){if(SC.isPageGenerator()){return jQuery.Deferred().resolve();}var h=this;if(this.cartLoad){if(f.cartInstance.isLoading){f.cartInstance.isLoading=false;g.updateMiniCart();}return this.cartLoad;}else{this.cartLoad=jQuery.Deferred();f.getUserPromise().done(function(){h.getCart().fetch().done(function(){h.cartLoad.resolve.apply(this,arguments);}).fail(function(){h.cartLoad.reject.apply(this,arguments);}).always(function(){if(f.cartInstance.isLoading){f.cartInstance.isLoading=false;g.updateMiniCart();}});});}return this.cartLoad;};_.extend(g.key_elements,{miniCart:"#mini-cart-container",miniCartSummary:".mini-cart-summary"});g.updateMiniCart=function(){if(f.getConfig("siteSettings.sitetype")==="ADVANCED"){var h=f.getCart();this.$miniCart.html(SC.macros.miniCart(h,f));this.$miniCartSummary.html(SC.macros.miniCartSummary(h.getTotalItemCount(),f.cartInstance.isLoading));}};g.showMiniCart=function(){jQuery(document).scrollTop(0);g.$containerModal&&g.$containerModal.length&&g.$containerModal.modal("hide");this.$(g.key_elements.miniCart+" .dropdown-toggle").parent().addClass("open");};g.showCartConfirmationModal=function(){this.showInModal(new b.Confirmation({layout:this,application:f,model:f.getCart()}));};g.goToCart=function(){Backbone.history.navigate("cart",{trigger:true});};g.showCartConfirmation=function(){g[f.getConfig("addToCartBehavior")]();};g.on("afterRender",function(){f.getCart().on("change",function(){g.updateMiniCart();});});var d=f.getCart().bootstraped;if(!d){f.loadCart();}if(e&&e.startRouter){return new a(f,e.saveForLater);}}};});define("Cart.Router",["Cart.Views"],function(a){return Backbone.Router.extend({routes:{cart:"showCart","cart?*options":"showCart"},initialize:function(c,b){this.isSaveForLater=b;this.application=c;},showCart:function(){if(this.application.ProductListModule&&this.application.ProductListModule.isProductListEnabled()&&this.isSaveForLater){var b=this;require(["Cart.SaveForLater.View"],function(c){b.renderView(c);});}else{this.renderView(a);}},renderView:function(e){var b=this,d=b.application.getCart().optimistic&&b.application.getCart().optimistic.promise,c=b.application.loadCart();jQuery.when(d||jQuery.Deferred().resolve(),c).done(function(){var f=new e.Detailed({model:b.application.getCart(),application:b.application});f.showContent();});}});});define("Cart.Views",["ErrorManagement"],function(a){var b={},c={};b.Detailed=Backbone.View.extend({template:"shopping_cart",title:_("Shopping Cart").translate(),page_header:_("Shopping Cart").translate(),attributes:{id:"shopping-cart","class":"view shopping-cart"},events:{'change [name="quantity"]':"updateItemQuantity",'keyup [name="quantity"]':"updateItemQuantity",'blur [name="quantity"]':"updateItemQuantityBlur",'submit [data-action="update-quantity"]':"updateItemQuantityFormSubmit",'click [data-action="remove-item"]':"removeItem",'submit form[data-action="apply-promocode"]':"applyPromocode",'click [data-action="remove-promocode"]':"removePromocode",'submit form[data-action="estimate-tax-ship"]':"estimateTaxShip",'click [data-action="remove-shipping-address"]':"removeShippingAddress",'change [data-action="estimate-tax-ship-country"]':"changeCountry"},initialize:function(d){this.application=d.application;},showContent:function(){var d=this;return this.application.getLayout().showContent(this,true).done(function(e){d.renderRelatedAndCorrelatedItemsHelper(e);});},renderRelatedAndCorrelatedItemsHelper:function(d){var f=d.$('[data-type="related-items-placeholder"]'),e=this.application;if(f.length){e.showRelatedItems&&e.showRelatedItems(d.model.getItemsIds(),f);}var g=d.$('[data-type="correlated-items-placeholder"]');if(g.length){e.showRelatedItems&&e.showCorrelatedItems(d.model.getItemsIds(),g);}},hideError:function(d){var e=(d)?d.find('[data-type="alert-placeholder"]'):this.$('[data-type="alert-placeholder"]');e.empty();},showError:function(g,d,f){var h;this.hideError();if(d){if(f&&f.status==="LINE_ROLLBACK"){var e=f.newLineId;d.attr("id",e);d.find('[name="internalid"]').attr({id:"update-internalid-"+e,value:e});}h=d.find('[data-type="alert-placeholder"]');this.hideError(d);}else{h=this.$('[data-type="alert-placeholder"]');this.hideError();}if(!h.length){h=jQuery("<div/>",{"data-type":"alert-placeholder"});this.$el.prepend(h);}h.append(SC.macros.message(g,"error",true));if(d){d.find(":disabled").attr("disabled",false);}else{this.$(":disabled").attr("disabled",false);}},updateItemQuantityBlur:function(j){j.preventDefault();var g=jQuery(j.target).closest("form"),h=g.serializeObject(),d=h.internalid,f=this.model.get("lines").get(d),k=g.find('[name="quantity"]'),i=this.validInputValue(k[0]);if(!k.prop("disabled")&&i&&!h.quantity){k.val(parseInt(f.get("quantity"),10));}else{this.updateItemQuantity(j);}},validInputValue:function(d){if((d.validity)&&(!d.validity.valid)){return false;}if(isNaN(d.value)){return false;}return true;},updateItemQuantity:_.debounce(function(j){j.preventDefault();var o=this,n=null,q=jQuery(j.target).closest("form"),p=q.serializeObject(),h=p.internalid,r=this.model.get("lines").get(h),l=q.find('[name="quantity"]'),f=this.validInputValue(l[0]);if(!r||this.isRemoving){return;}if(!f||p.quantity){var g=parseInt(p.quantity,10),d=parseInt(r.get("quantity"),10);g=(g>0)?g:d;l.val(g);this.storeColapsiblesState();if(g!==d){n=this.$("#"+h);l.val(g).prop("disabled",true);r.set("quantity",g);var k=r.validate();if(!k){var i=this.model.updateLine(r);this.disableElementsOnPromise(i,'article[id="'+h+'"] a, article[id="'+h+'"] button');i.done(function(){o.showContent().done(function(e){e.resetColapsiblesState();});}).fail(function(s){s.preventDefault=true;var e=JSON.parse(s.responseText);o.showError(e.errorMessage,n,e.errorDetails);r.set("quantity",d);}).always(function(){l.prop("disabled",false);});}else{var m=this.$("#"+h+' [data-type="alert-placeholder"]');m.empty();_.each(k,function(e){m.append(SC.macros.message(e,"error",true));});l.prop("disabled",false);r.set("quantity",d);}}}},400),updateItemQuantityFormSubmit:function(d){d.preventDefault();this.updateItemQuantity(d);},removeItem:function(i){this.storeColapsiblesState();var f=this,h=this.model.get("lines").get(jQuery(i.target).data("internalid")),g=this.model.removeLine(h),d=h.get("internalid");this.isRemoving=true;this.disableElementsOnPromise(g,'article[id="'+d+'"] a, article[id="'+d+'"] button');g.done(function(){f.showContent().done(function(e){e.resetColapsiblesState();});}).always(function(){f.isRemoving=false;});return g;},validateGiftCertificate:function(d){if(d.itemOptions&&d.itemOptions.GIFTCERTRECIPIENTEMAIL){if(!Backbone.Validation.patterns.email.test(d.itemOptions.GIFTCERTRECIPIENTEMAIL.label)){this.render();this.showError(_("Recipient email is invalid").translate());return false;}}return true;},applyPromocode:function(h){h.preventDefault();this.$("[data-type=promocode-error-placeholder]").empty();var f=this,d=jQuery(h.target),g=d.serializeObject();d.find("input, button").prop("disabled",true);this.model.save({promocode:{code:g.promocode}}).done(function(){f.showContent();}).fail(function(e){f.model.unset("promocode");e.preventDefault=true;var i=a.parseErrorMessage(e,f.options.application.getLayout().errorMessageKeys);f.$("[data-type=promocode-error-placeholder]").html(SC.macros.message(i,"error",true));d.find("input[name=promocode]").val("").focus();}).always(function(){d.find("input, button").prop("disabled",false);});},removePromocode:function(f){f.preventDefault();var d=this;this.model.save({promocode:null}).done(function(){d.showContent();});},estimateTaxShip:function(h){var f=this.model,d=jQuery(h.target).serializeObject(),g=d.zip+"-"+d.country+"-null";h.preventDefault();if(!d.zip){return this.showError(_("Zip code is required.").translate());}f.get("addresses").push({internalid:g,zip:d.zip,country:d.country});f.set("shipaddress",g);f.save().done(jQuery.proxy(this,"showContent"));},removeShippingAddress:function(f){f.preventDefault();var d=this;this.model.save({shipmethod:null,shipaddress:null}).done(function(){d.showContent();});},changeCountry:function(g){g.preventDefault();this.storeColapsiblesState();var d=jQuery(g.target).serializeObject();var f=this.model.get("addresses").model;this.model.get("addresses").add(new f({country:d.country,internalid:d.country}));this.model.set({shipaddress:d.country});this.showContent().done(function(e){e.resetColapsiblesState();});},resetColapsiblesState:function(){var d=this;_.each(c,function(f,e){d.$(e)[f?"addClass":"removeClass"]("in").css("height",f?"auto":"0");});},storeColapsiblesState:function(){this.storeColapsiblesStateCalled=true;this.$(".collapse").each(function(d,e){c[SC.Utils.getFullPathForElement(e)]=jQuery(e).hasClass("in");});}});b.Confirmation=Backbone.View.extend({template:"shopping_cart_confirmation_modal",title:_("Added to Cart").translate(),page_header:_("Added to Cart").translate(),attributes:{id:"shopping-cart","class":"cart-confirmation-modal shopping-cart"},events:{"click [data-trigger=go-to-cart]":"dismisAndGoToCart"},initialize:function(f){this.line=f.model.getLatestAddition();var d=this,e=this.options.application.getCart().optimistic;if(e&&e.promise&&e.promise.state()==="pending"){this.line=f.model.optimisticLine;delete f.model.optimisticLine;e.promise.done(function(){d.line=f.model.getLatestAddition();d.render();});}},dismisAndGoToCart:function(d){d.preventDefault();this.$containerModal.modal("hide");this.options.layout.goToCart();}});return b;});define("Content.DataModels",function(){var d={};d.Model=Backbone.CachedModel.extend({urlRoot:"../cds/services/page.ss"});d.Collection=Backbone.CachedCollection.extend({url:"../cds/services/page.ss",model:d.Model},SC.Singleton);var b={};b.Model=Backbone.Model.extend({urlRoot:"../cds/services/url.ss"});b.Collection=Backbone.Collection.extend({url:"../cds/services/url.ss",model:b.Model,initialize:function(){this.regExpGraphRoot=new b.Model({childs:[]});this.regExpGraphHelper=[];this.landingPages=[];this.exactMatchHash={};this.on("reset",this.reseter);},reseter:function(){this.regExpGraphRoot=new b.Model({childs:[]});this.regExpGraphHelper=[];this.landingPages=[];this.exactMatchHash={};var e=this;this.each(function(f){if(f.get("query")==="*"&&f.get("type")!=="1"){if(!b.Collection.defaultModel){b.Collection.defaultModel=f;}}else{if(~f.get("query").indexOf("*")&&f.get("type")!=="1"){var g=new RegExp("^"+_.map(f.get("query").split("*"),function(h){return h.replace(/\//ig,"\\/").replace(/\?/ig,"\\?");}).join("(.*?)")+"$");f.set({regexp:g,childs:[]});e.insertInGraph(f,e.regExpGraphRoot);_.each(e.regExpGraphHelper,function(h){if(!_.contains(f.get("childs"),h)&&f.get("regexp").test(h.get("query"))){f.get("childs").push(h);}});e.regExpGraphHelper.push(f);}else{e.exactMatchHash[f.get("query")]=f;if(f.get("type")==="1"){e.landingPages.push(f);}}}});},insertInGraph:function(h,e){var g=true,f=this;_.each(e.get("childs"),function(i){if(i.get("query")!==h.get("query")){if(i.get("regexp").test(h.get("query"))){g=false;f.insertInGraph(h,i);}else{if(h.get("regexp").test(i.get("query"))){h.get("childs").push(i);e.set("childs",_.without(e.get("childs"),i));}}}});if(g&&!~_.indexOf(e.get("childs"),h)){e.get("childs").push(h);}},findUrl:function(f){var g=this.exactMatchHash[f];if(g){return g;}else{this.candidates={};this.walkRegExpGraph(f,this.regExpGraphRoot,1);var e=_.max(_.pairs(this.candidates),function(h){return h[1];});return e&&typeof e==="object"?this.get(e[0]):false;}},walkRegExpGraph:function(f,h,g){var e=this;_.each(h.get("childs"),function(i){if(i.get("regexp").test(f)){e.candidates[i.cid]=(e.candidates[i.cid])?e.candidates[i.cid]+g:g;e.walkRegExpGraph(f,i,g+1);}});}},SC.Singleton);var c=[];function a(f,g){g=g||jQuery.noop;if(f){var e=b.Collection.getInstance().findUrl(f);if(e){var h=d.Collection.getInstance().get(e.get("pageid"));if(h){g(h);}else{new d.Model({internalid:e.get("pageid"),id:e.get("pageid")}).fetch({data:{cache:this.Application.getConfig("cache.contentPageCdn"),ttl:this.Application.getConfig("cache.contentPageTtl")},killerId:this.Application.killerId,reset:true}).done(function(j){var i=new Backbone.Model(j);d.Collection.getInstance().add(i);g(i);});}}else{g(false);}}else{g(false);}}return{Urls:b,Pages:d,currentRequests:c,loadPage:a};});define("Content.EnhancedViews",["Content.DataModels"],function(b){var a={previousPlaceholders:[]};_.extend(a,{overrideViewSettings:function(d,f){d.contentZones=d.contentZones||[];if(f){d.title=f.get("title")||d.getTitle();d.page_header=f.get("pageheader")||d.page_header;d.description=f.get("description")||d.description;d.metaDescription=f.get("metadescription")||d.getMetaDescription();d.metaKeywords=f.get("metakeywords")||d.getMetaKeywords();d.template=f.get("template")||d.template;d.metaextra=f.get("metaextra")||"";d.contentZones=_.union(d.contentZones,f.get("pagecontent"));}var c=b.Urls.Collection.defaultModel,e=c&&b.Pages.Collection.getInstance().get(c.get("pageid"));if(e){d.contentZones=_.union(d.contentZones,e.get("pagecontent"));}return d;},initalizeHead:function(){return jQuery("head").not(":has(title)").append("<title/>").end().not(':has(link[rel="canonical"])').append('<link rel="canonical"/>').end().not(':has(meta[name="keywords"])').append('<meta name="keywords"/>').end().not(':has(meta[name="description"])').append('<meta name="description"/>').end();},enhanceHead:function(c){var d=c.getTitle();if(d){document.title=d;}if(SC.ENVIRONMENT.jsEnvironment==="server"){this.$head.find("title").text(d);}return this.enhanceMetaTags(c).enhanceCanonicalLinks(c);},enhanceMetaTags:function(c){var d;this.$head.find('meta[name="description"]').attr("content",c.metaDescription||c.getMetaDescription()||"").end().find('meta[name="keywords"]').attr("content",c.metaKeywords||c.getMetaKeywords()||"").end().append(c.getMetaTags().not('[name="description"]').not('[name="keywords"]'));d=/\<\!\-\- EnhanceMetaTags:STARTS[^]+EnhanceMetaTags:ENDS \-\-\>/;if(document.head.innerHTML.match(d)){document.head.innerHTML=document.head.innerHTML.replace(d,"");}if(c.metaextra){jQuery("<!-- EnhanceMetaTags:STARTS -->"+c.metaextra+"<!-- EnhanceMetaTags:ENDS -->").appendTo(this.$head);}return this;},enhanceCanonicalLinks:function(c){this.$head.find('link[rel="canonical"]').attr("href",c.getCanonical()).end().find('link[rel="next"], link[rel="prev"]').remove();this.setLinkRel("prev",c.getRelPrev());this.setLinkRel("next",c.getRelNext());return this;},setLinkRel:function(c,d){d&&jQuery("<link />",{rel:c,href:d}).appendTo(this.$head);},enhancePage:function(c,d){this.$head=this.$head||this.initalizeHead();this.enhanceHead(c);a.clearPlaceholders();_.each(c.contentZones||[],function(e){if(c.$(e.target).length===0){if(jQuery(e.target+":empty").length===0){return;}}d.trigger("renderEnhancedPageContent",c,e);});},renderHTMLContent:function(d,c){var e=c.target;if(d.$(e).length){d.$(e).html(c.content);a.previousPlaceholders.push(c.target);}else{d.options.application.getLayout().$(e).filter(":empty").each(function(f,g){jQuery(g).html(c.content);a.previousPlaceholders.push(c.target);});}},clearPlaceholders:function(){_.each(a.previousPlaceholders,function(c){jQuery(c).empty();});a.previousPlaceholders=[];}});return a;});define("Content",["Content.DataModels","Content.EnhancedViews","Content.LandingPages"],function(b,a,c){return{DataModels:b,EnhancedViews:a,LandingPages:c,mountToApp:function(f){b.Pages.Model.prototype.urlRoot=_.getAbsoluteUrl(b.Pages.Model.prototype.urlRoot);b.Urls.Model.prototype.urlRoot=_.getAbsoluteUrl(b.Urls.Model.prototype.urlRoot);b.Pages.Collection.prototype.url=_.getAbsoluteUrl(b.Pages.Collection.prototype.url);b.Urls.Collection.prototype.url=_.getAbsoluteUrl(b.Urls.Collection.prototype.url);b.Application=f;var e=f.getLayout(),d=function(i,g){var j=jQuery.Deferred();var h=arguments;b.loadPage("/"+Backbone.history.fragment,function(k){a.overrideViewSettings(g,k);i.apply(e,Array.prototype.slice.call(h,1)).done(function(){a.enhancePage(g,e);j.resolveWith(this,arguments);});});return j;};e.showContent=_.wrap(e.showContent,d);e.showInModal=_.wrap(e.showInModal,d);e.updateUI=_.wrap(e.updateUI,function(g){g.apply(e,[]);if(!Backbone.History.started){return;}b.loadPage("/"+(Backbone.history.fragment||""),function(i){var h=e;a.overrideViewSettings(h,i);a.enhancePage(h,e);});});e.on("renderEnhancedPageContent",function(h,g){if(g.contenttype==="html"){a.renderHTMLContent(h,g);}else{if(g.contenttype==="merchandising"){a.previousPlaceholders.push(g.target);}}});f.on("afterModulesLoaded",function(){var g="";_.each(b.Urls.Collection.getInstance().landingPages,function(h){g=h.get("query")[0]==="/"?h.get("query").substring(1):h.get("query");c.Router.prototype.routes[g+"?*options"]="displayLandingPage";c.Router.prototype.routes[g]="displayLandingPage";});return new c.Router(f);});f.on("afterStart",function(){Backbone.history&&Backbone.history.on("all",function(){b.loadPage("/"+Backbone.history.fragment);});Backbone.history&&b.loadPage("/"+Backbone.history.fragment);});}};});define("Content.LandingPages",["Content.DataModels","Content.EnhancedViews"],function(d,b){var g=false;try{g=require("Categories");}catch(c){}var f=Backbone.View.extend({template:"landing_page",title:"",page_header:"",attributes:{id:"landing-page","class":"landing-page"},events:{},initialize:function(){this.url=Backbone.history&&Backbone.history.fragment;},showContent:function(e){this.page_header=e.get("pageheader");this.page=e;this.options.layout.showContent(this);},getBreadcrumb:function(){var h=[{href:"/",text:_("Home").translate()}];if(this.url&&g){var e="";_.each(g.getBranchLineFromPath(this.url),function(i){e+="/"+i.id;h.push({href:e,text:i.title});});}h.push({href:this.url,text:this.page_header});return h;}});var a=Backbone.Router.extend({routes:{},initialize:function(e){this.Application=e;},displayLandingPage:function(j){var h=this,i=j?unescape(Backbone.history.fragment).replace("?"+j,""):Backbone.history.fragment,e=new f({application:this.Application,layout:this.Application.getLayout()});d.loadPage("/"+i,function(k){if(k){b.overrideViewSettings(e,k);e.showContent(k);}else{h.Application.getLayout().notFound();}});}});return{View:f,Router:a};});define("CookieWarningBanner",function(){return{mountToApp:function(c){var d="",g="",e=c.getLayout(),a=c.getConfig("cookieWarningBanner"),f=c.getConfig("siteSettings.cookiepolicy"),b=c.getConfig("siteSettings.showcookieconsentbanner")==="T";jQuery.cookie.json=true;if(b&&!(a.saveInCookie&&jQuery.cookie("isCookieWarningClosed"))){d=a.message;if(f){d+=' <a href="https://system.netsuite.com'+f+'" data-toggle="show-in-modal" data-page-header="'+a.anchorText+'">'+a.anchorText+"</a>";}g=jQuery(SC.macros.message(d,"cookie-banner no-margin-bottom",a.closable));e.on("afterRender",function(){e.$("[data-type=message-placeholder]").prepend(g);g.on("close",function(){if(a.saveInCookie){jQuery.cookie("isCookieWarningClosed",true);}});});}}};});define("CreditCard.Collection",["CreditCard.Model"],function(a){return Backbone.Collection.extend({model:a,url:"services/creditcard.ss"});});define("CreditCard",["CreditCard.Views","CreditCard.Model","CreditCard.Collection","CreditCard.Router"],function(c,d,b,a){return{Views:c,Model:d,Router:a,Collection:b,MenuItems:{parent:"settings",id:"creditcards",name:_("Credit Cards").translate(),url:"creditcards",index:4},mountToApp:function(f,e){if(e&&e.startRouter){return new a(f);}}};});define("CreditCard.Model",function(){function a(d,b,c){var e=new Date();if(!d||new Date(e.getFullYear(),e.getMonth()).getTime()>new Date(c.expyear,c.expmonth-1).getTime()){return _("Please select a date in the future").translate();}}return Backbone.Model.extend({urlRoot:"services/creditcard.ss",validation:{ccname:{fn:function(b){if(!b){return _("Name is required").translate();}else{if(b.length>26){return _("Name too long").translate();}}}},ccnumber:{fn:function(d,b,f){if(!d){return _("Card Number is required").translate();}if(_.isUndefined(f.internalid)&&(_.isUndefined(this.attributes.ccnumber)||d===this.attributes.ccnumber)){d=d.replace(/\s/g,"");var c=_(d.split("").reverse()).reduce(function(g,i,h){return g+_((+i*[1,2][h%2]).toString().split("")).reduce(function(j,k){return j+(+k);},0);},0)%10===0,e=_.paymenthodIdCreditCart(d);if(!e){return _("Credit Card type is not supported").translate();}else{if(!c){return _("Credit Card Number is invalid").translate();}}}}},expyear:{fn:a},expmonth:{fn:a}},initialize:function(b,c){this.options=c;delete this.validation.ccsecuritycode;}});});define("CreditCard.Router",["CreditCard.Views","CreditCard.Model"],function(a,b){return Backbone.Router.extend({routes:{creditcards:"creditCards","creditcards/new":"newCreditCard","creditcards/:id":"creditCardDetailed"},initialize:function(c){this.application=c;},creditCards:function(){if(this.application.getUser().get("isLoggedIn")!=="T"){return this.application.getLayout().notFound();}var d=this.application.getUser().get("creditcards");if(d.length){var c=new a.List({application:this.application,collection:d});d.once("reset destroy change add",function(){if(Backbone.history.fragment==="creditcards"){this.creditCards();}},this);c.showContent("creditcards");}else{Backbone.history.navigate("#creditcards/new",{trigger:true});}},creditCardDetailed:function(f){if(this.application.getUser().get("isLoggedIn")!=="T"){return this.application.getLayout().notFound();}var e=this.application.getUser().get("creditcards"),d=e.get(f),c=new a.Details({application:this.application,collection:e,model:d});d.on("reset destroy change add",function(){if(c.inModal&&c.$containerModal){c.$containerModal.modal("hide");c.destroy();}else{Backbone.history.navigate("#creditcards",{trigger:true});}},c);c.showContent("creditcards");},newCreditCard:function(){if(this.application.getUser().get("isLoggedIn")!=="T"){return this.application.getLayout().notFound();}var d=this.application.getUser().get("creditcards"),c=new a.Details({application:this.application,collection:d,model:new b()});d.on("add",function(){if(c.inModal&&c.$containerModal){c.$containerModal.modal("hide");c.destroy();}else{Backbone.history.navigate("#creditcards",{trigger:true});}},c);c.model.on("change",function(e){d.add(e,{merge:true});},this);c.showContent("creditcards");}});});define("CreditCard.Views",function(){var a={};a.Details=Backbone.View.extend({template:"creditcard",attributes:{"class":"CreditCardDetailsView"},events:{"submit form":"saveForm",'change form:has([data-action="reset"])':"toggleReset",'click [data-action="reset"]':"resetForm",'change form [name="ccnumber"]':"setPaymethodId"},initialize:function(){this.title=this.model.isNew()?_("Add Credit Card").translate():_("Edit Credit Card").translate();this.page_header=this.title;var d=this.model.get("expyear"),b=new Date().getFullYear(),c=_.range(new Date().getFullYear(),new Date().getFullYear()+25);if(d&&d<b){c=_.union([parseInt(d,10)],c);this.options.expyear=d;}if(!this.model.get("expmonth")){this.options.currentMonth=new Date().getMonth()+1;}this.options.months=_.range(1,13);this.options.years=c;this.options.showDefaults=this.options.application.getConfig("currentTouchpoint")==="customercenter";},setPaymethodId:function(f){var b=jQuery(f.target).val().replace(/\s/g,""),d=jQuery(f.target).closest("form"),c=_.paymenthodIdCreditCart(b);jQuery(f.target).val(b);if(c){d.find('[name="paymentmethod"]').val(c);d.find('[data-image="creditcard-icon"]').each(function(g,e){var h=jQuery(e);if(h.data("value").toString()===c){h.show();}else{h.hide();}});}else{d.find('[data-image="creditcard-icon"]').show();}},showContent:function(c,b){b=b||c;this.options.application.getLayout().showContent(this,b,{text:this.title,href:"/"+c});},saveForm:function(b){if(!jQuery(b.target).find('[name="paymentmethod"]').val()){jQuery(b.target).find('[name="ccnumber"]').change();}var d=this.options.application.getCart(),c=Backbone.View.prototype.saveForm.apply(this,arguments);return c&&c.done(function(e){d.get("paymentmethods").each(function(f){var g=f.get("creditcard");if(g&&e&&g.internalid===e.internalid){g.ccexpiredate=e.ccexpiredate;g.ccname=e.ccname;g.expmonth=e.expmonth;g.expyear=e.expyear;f.set("creditcard",g);d.get("paymentmethods").add(f,{merge:true});}});});},resetForm:function(b){b.preventDefault();this.showContent("creditcards");}});a.List=Backbone.View.extend({template:"creditcards",title:_("Credit Cards").translate(),page_header:_("Credit Cards").translate(),attributes:{"class":"CreditCardListView"},events:{'click [data-action="remove"]':"remove"},showContent:function(c,b){b=b||c;this.options.application.getLayout().showContent(this,b,{text:this.title,href:"/"+c});},remove:function(b){b.preventDefault();if(confirm(_("Are you sure you want to delete this Credit Card?").translate())){this.collection.get(jQuery(b.target).data("id")).destroy({wait:true});}}});return a;});define("ErrorManagement",["Session"],function(b){var c={};c.PageNotFound=Backbone.View.extend({template:"page_not_found",title:_("Page not found").translate(),page_header:_("Page not found").translate(),attributes:{id:"page-not-found","class":"page-not-found"},initialize:function(){if(SC.ENVIRONMENT.jsEnvironment==="server"){nsglobal.statusCode=404;}}});c.ForbiddenError=Backbone.View.extend({template:"forbidden_error",title:_("Forbidden Error").translate(),page_header:_("NOT ALLOWED").translate(),attributes:{id:"forbidden-error","class":"forbidden-error"},initialize:function(){if(SC.ENVIRONMENT.jsEnvironment==="server"){nsglobal.statusCode=403;}}});c.InternalError=Backbone.View.extend({template:"internal_error",title:_("Internal Error").translate(),page_header:_("Internal Error").translate(),attributes:{id:"internal-error","class":"internal-error"},initialize:function(d){if(d.page_header){this.page_header=d.page_header;}if(d.title){this.title=d.title;}if(SC.ENVIRONMENT.jsEnvironment==="server"){nsglobal.statusCode=500;}}});c.ExpiredLink=Backbone.View.extend({template:"expired_link",attributes:{id:"expired_link","class":"expired_link"},initialize:function(d){if(d.page_header){this.page_header=d.page_header;}if(d.title){this.title=d.title;}if(SC.ENVIRONMENT.jsEnvironment==="server"){nsglobal.statusCode=500;}}});c.LoggedOut=Backbone.View.extend({template:"logged_out",title:_("Logged out").translate(),initialize:function(){this.labels={title:"You have been logged out",explanation:"Your session expired or someone else logged in another device with your account. You must log in again to continue.",login:"Log in"};_.each(this.labels,function(e,d,f){f[d]=_(e).translate();});},showError:function(){}});_.extend(Backbone.View.prototype,{hideError:function(){this.$('[data-type="alert-placeholder"]').empty();},showError:function(e,d){this.hideError();var f=this.$('[data-type="alert-placeholder"]');if(!f.length){f=jQuery("<div/>",{"data-type":"alert-placeholder"});this.$el.prepend(f);}f.append(SC.macros.message(e,d?d:"error",true));this.$(":disabled").attr("disabled",false);if(this.application){_.result(this.application.getLayout(),"backToTop");}},showErrorInModal:function(e){jQuery(".modal").modal("hide");var d=new Backbone.View({application:this.application});d.title=_("Error").translate();d.render=function(){this.$el.append('<p class="error-message">'+e+"</p>");};d.showInModal();}});var a=function(g,f){var k=null,e,j;try{var d=JSON.parse(g.responseText);if(d){for(e=0;e<f.length;e++){j=f[e];if(d[j]){k=_.isArray(d[j])?d[j][0]:d[j];break;}}}}catch(h){}return k;};return{Views:c,parseErrorMessage:a,mountToApp:function(d){var e=d.getLayout();_.extend(e,{errorMessageKeys:["errorMessage","errors","error","message"],notFound:function(){var f=new c.PageNotFound({application:d});f.showContent();},internalError:function(h,g,i){var f=new c.InternalError({application:d,message:h,page_header:g,title:i});f.showContent();},expiredLink:function(g){var f=new c.ExpiredLink({application:d,page_header:g,title:g});f.showContent();},forbiddenError:function(){var f=new c.ForbiddenError({application:d});f.showContent();},unauthorizedError:function(){if(d.getConfig("currentTouchpoint")==="checkout"){d.getUser().set({isLoggedIn:"F",isGuest:"F"});d.Configuration.currentTouchpoint="login";Backbone.history.navigate("login-register",{trigger:true});}else{var f=b.get("touchpoints.login");if(d.getConfig("currentTouchpoint")){f+="&origin="+d.getConfig("currentTouchpoint");}if(f){window.location=f;}}}});jQuery(document).ajaxError(function(l,j,g,i){var h=parseInt(j.status,10);if(i==="abort"||h===0){return;}if(h===401){e.unauthorizedError(j);return;}if(!j.preventDefault){var k=a(j,e.errorMessageKeys);if(!k||_.isObject(k)){k=_("Theres been an internal error").translate();}if(g.type==="GET"&&g.killerId){if(h===403){e.forbiddenError();}else{if(h===404){e.notFound();}else{e.internalError(k);}}}else{if(e.currentView){if(h!==403){if(e.modalCurrentView){e.modalCurrentView.showError(k);}else{e.currentView.showError(k);}}else{var f=e.modalCurrentView||e.currentView;if(f&&_.isFunction(f.forbiddenError)){f.forbiddenError();}else{e.forbiddenError();}}}else{e.internalError();}}}});}};});define("Facets.Model",["ItemDetails.Collection","Session"],function(c,a){var b=Backbone.CachedModel.prototype.fetch;return Backbone.CachedModel.extend({url:function(){var d=_.addParamsToUrl("/api/items",_.extend({},this.searchApiMasterOptions,a.getSearchApiParams()));return d;},initialize:function(){this.on("change:items",function(e,d){if(!(d instanceof c)){e.set("items",new c(_.compact(d)));}});},fetch:function(d){d=d||{};d.cache=true;return b.apply(this,arguments);}},{mountToApp:function(d){this.prototype.searchApiMasterOptions=d.getConfig("searchApiMasterOptions.Facets",{});}});});define("Facets.Translator",function(){var d=false;try{d=require("Categories");}catch(c){}var b={fallbackUrl:"search",defaultShow:null,defaultOrder:null,defaultDisplay:null,facets:[],facetDelimiters:{betweenFacetNameAndValue:"/",betweenDifferentFacets:"/",betweenDifferentFacetsValues:",",betweenRangeFacetsValues:"to",betweenFacetsAndOptions:"?",betweenOptionNameAndValue:"=",betweenDifferentOptions:"&"}};function a(f,e,g){if(!(this instanceof a)){return new a(f,e,g);}this.facets=[];this.options={};this.configuration=g||b;if(f&&e){this.facets=f;this.options=e;}else{if(_.isString(f)){this.parseUrl(f);}else{if(f){this.parseOptions(f);}}}}_.extend(a.prototype,{defaultFacetConfig:{behavior:"single",max:5},parseUrl:function(e){e=(e[0]==="/")?e.substr(1):e;var k=e.split(this.configuration.facetDelimiters.betweenFacetsAndOptions),i=(k[0]&&k[0]!==this.configuration.fallbackUrl)?k[0]:"",m=k[1]||"";if(this.getFacetConfig("category")){var g=d&&d.getBranchLineFromPath(i)||[];if(g&&g.length){var f=_.pluck(g,"urlcomponent").join("/");this.parseFacet("category",f);i=i.replace(f,"");}i=(i[0]==="/")?i.substr(1):i;}var h=i.split(new RegExp("[\\"+this.configuration.facetDelimiters.betweenDifferentFacets+"\\"+this.configuration.facetDelimiters.betweenFacetNameAndValue+"]+","ig"));while(h.length>0){this.parseUrlFacet(h.shift(),h.shift());}var j=m.split(new RegExp("[\\"+this.configuration.facetDelimiters.betweenOptionNameAndValue+"\\"+this.configuration.facetDelimiters.betweenDifferentOptions+"]+","ig")),l={};while(j.length>0){l[j.shift()]=j.shift();}this.parseUrlOptions(l);},sanitizeValue:function(f,e){var h;switch(e){case"range":if(_.isString(f)){if(f.indexOf(this.configuration.facetDelimiters.betweenRangeFacetsValues)!==-1){var g=f.split(this.configuration.facetDelimiters.betweenRangeFacetsValues);h={from:g[0],to:g[1]};}else{h={from:"0",to:f};}}else{h=f;}break;case"multi":if(f.indexOf(this.configuration.facetDelimiters.betweenDifferentFacetsValues)!==-1){h=f.split(this.configuration.facetDelimiters.betweenDifferentFacetsValues);}else{h=[f];}break;default:h=f;}return h;},getUrlFacetValue:function(e){return(_.find(this.facets,function(f){return f.url===e;})||{}).value;},getFacetValue:function(e){return(_.find(this.facets,function(f){return f.id===e;})||{}).value;},getAllFacets:function(){return this.facets.slice(0);},getOptionValue:function(e){return this.options[e]||null;},parseUrlFacet:function(f,g){var e=this.getFacetConfig(f,"url");if(e.id==="category"||!f){return;}this.facets.push({config:e,id:e.id,url:e.url,value:this.sanitizeValue(g,e.behavior)});},parseFacet:function(f,g){var e=this.getFacetConfig(f,"id");this.facets.push({config:e,id:e.id,url:e.url,value:this.sanitizeValue(g,e.behavior)});},parseUrlOptions:function(e){this.options.show=e.show||this.configuration.defaultShow;this.options.order=e.order||this.configuration.defaultOrder;this.options.page=parseInt(e.page,10)||1;this.options.display=e.display||this.configuration.defaultDisplay;this.options.keywords=e.keywords?decodeURIComponent(e.keywords):this.configuration.defaultKeywords;},getFacetConfig:function(f,g){var e=_.find(this.configuration.facets,function(h){return h[g||"id"]===f;});return e||_.extend({id:f,name:f,url:f},this.defaultFacetConfig);},getUrl:function(){var e="",q=this;var r={};if(SC.ENVIRONMENT.jsEnvironment==="server"){r={numberOfFacetsGroups:this.configuration.facetsSeoLimits&&this.configuration.facetsSeoLimits.numberOfFacetsGroups||false,numberOfFacetsValues:this.configuration.facetsSeoLimits&&this.configuration.facetsSeoLimits.numberOfFacetsValues||false,options:this.configuration.facetsSeoLimits&&this.configuration.facetsSeoLimits.options||false};}if(r.numberOfFacetsGroups&&this.facets.length>r.numberOfFacetsGroups){return"#";}var j=this.getFacetValue("category");if(j){e=q.configuration.facetDelimiters.betweenDifferentFacets+j;}var o=_.sortBy(this.facets,"url");for(var l=0;l<o.length;l++){var h=o[l];if(h.id==="category"){break;}var f=h.url||h.id,n="";switch(h.config.behavior){case"range":h.value=(typeof h.value==="object")?h.value:{from:0,to:h.value};n=h.value.from+q.configuration.facetDelimiters.betweenRangeFacetsValues+h.value.to;break;case"multi":n=h.value.sort().join(q.configuration.facetDelimiters.betweenDifferentFacetsValues);if(r.numberOfFacetsValues&&h.value.length>r.numberOfFacetsValues){return"#";}break;default:n=h.value;}e+=q.configuration.facetDelimiters.betweenDifferentFacets+f+q.configuration.facetDelimiters.betweenFacetNameAndValue+n;}e=(e!=="")?e:"/"+this.configuration.fallbackUrl;var p={},m=this.configuration.facetDelimiters.betweenOptionNameAndValue;if(this.options.order&&this.options.order!==this.configuration.defaultOrder){p.order="order"+m+this.options.order;}if(this.options.page&&parseInt(this.options.page,10)!==1){p.page="page"+m+encodeURIComponent(this.options.page);}if(this.options.show&&parseInt(this.options.show,10)!==this.configuration.defaultShow){p.show="show"+m+encodeURIComponent(this.options.show);}if(this.options.display&&this.options.display!==this.configuration.defaultDisplay){p.display="display"+m+encodeURIComponent(this.options.display);}if(this.options.keywords&&this.options.keywords!==this.configuration.defaultKeywords){p.keywords="keywords"+m+encodeURIComponent(this.options.keywords);}var k=_.keys(p),g=_.values(p);if(r.options&&_.difference(k,r.options).length){return"#";}e+=(g.length)?this.configuration.facetDelimiters.betweenFacetsAndOptions+g.join(this.configuration.facetDelimiters.betweenDifferentOptions):"";return _(e).fixUrl();},getApiParams:function(){var e={};_.each(this.facets,function(g){switch(g.config.behavior){case"range":var f=(typeof g.value==="object")?g.value:{from:0,to:g.value};e[g.id+".from"]=f.from;e[g.id+".to"]=f.to;break;case"multi":e[g.id]=g.value.sort().join(",");break;default:e[g.id]=g.value;}});e.sort=this.options.order;e.limit=this.options.show;e.offset=(this.options.show*this.options.page)-this.options.show;e.q=this.options.keywords;return e;},cloneForFacetId:function(h,g){var j=_.toArray(jQuery.extend(true,{},this.facets)),f=jQuery.extend(true,{},this.options),i=_.find(j,function(k){return k.id===h;});if(i){if(i.config.behavior==="multi"){if(_.indexOf(i.value,g)===-1){i.value.push(g);}else{i.value=_.without(i.value,g);}if(i.value.length===0){j=_.without(j,i);}}else{if(!_.isEqual(i.value,g)){i.value=g;}else{j=_.without(j,i);}}}f.page=1;var e=new a(j,f,this.configuration);if(!i){e.parseFacet(h,g);}return e;},cloneWithoutFacetId:function(f){var g=_.toArray(jQuery.extend(true,{},this.facets)),e=jQuery.extend(true,{},this.options);g=_.without(g,_.find(g,function(h){return h.id===f;}));return new a(g,e,this.configuration);},cloneForFacetUrl:function(f,e){return this.cloneForFacetId(this.getFacetConfig(f,"url").id,e);},cloneWithoutFacetUrl:function(e){return this.cloneWithoutFacetId(this.getFacetConfig(e,"url").id);},cloneWithoutFacets:function(){var e=new a(this.facets,this.options,this.configuration);_.each(e.getAllFacets(),function(f){if(f.id!=="category"){e=e.cloneWithoutFacetId(f.id);}});return e;},cloneForOption:function(g,e){var h=_.toArray(jQuery.extend(true,{},this.facets)),f=jQuery.extend(true,{},this.options);f[g]=e;return new a(h,f,this.configuration);},cloneForOptions:function(f){var g=_.toArray(jQuery.extend(true,{},this.facets)),e=jQuery.extend(true,{},this.options,f);return new a(g,e,this.configuration);},cloneWithoutOption:function(f){var g=_.toArray(jQuery.extend(true,{},this.facets)),e=jQuery.extend(true,{},this.options);delete e[f];return new a(g,e,this.configuration);},resetAll:function(){return new a([],{},this.configuration);},getMergedCategoryTree:function(f,g){var e=this;g=g||d&&d.getTree()||{};_.each(f,function(h){var i=_.last(h.id.split("/"));if(g[i]){g[i].count=h.count;if(g[i].sub&&_.keys(g[i].sub).length&&h.values.length){g[i].sub=e.getMergedCategoryTree(h.values,g[i].sub);}}});return g;},setLabelsFromFacets:function(e){this.facetsLabels=e;},getLabelForValue:function(h,f){var g=_.where(this.facetsLabels||[],{id:h});if(g.length){var e=_.where(g[0].values||[],{name:f});if(!e.length){e=_.where(g[0].values||[],{url:f});}if(e.length){return e[0].label;}}return f;}});return a;});(function(b,a){b[a]=b[a]||[];define("GoogleAnalytics",function(){var c={trackPageview:function(d){if(_.isString(d)){b[a].push(["_trackPageview",d]);}return this;},trackEvent:function(d){if(d&&d.category&&d.action){b[a].push(["_trackEvent",d.category,d.action,d.label,d.value]);}return this;},addItem:function(d){if(d&&d.id&&d.name){b[a].push(["_addItem",d.id,d.sku,d.name,d.category,d.price,d.quantity]);}return this;},addTrans:function(d){if(d&&d.id){b[a].push(["_addTrans",d.id,d.affiliation,d.revenue,d.tax,d.shipping,d.city,d.state,d.country]);}return this;},trackTrans:function(){b[a].push(["_trackTrans"]);return this;},trackTransaction:function(d){if(d&&d.get("confirmation")){var h=d.get("addresses").get(d.get("shipaddress")),g=d.get("confirmation").confirmationnumber,e=d.get("summary"),f=null;c.addTrans({id:g,affiliation:SC.ENVIRONMENT.siteSettings.displayname,revenue:e.subtotal,tax:e.taxtotal,shipping:e.shippingcost+e.handlingcost,city:h.get("city"),state:h.get("state"),country:h.get("country")});d.get("lines").each(function(i){f=i.get("item");c.addItem({id:g,sku:f.get("_sku"),name:f.get("_name"),category:f.get("_category"),price:i.get("rate"),quantity:i.get("quantity")});});return c.trackTrans();}},setAccount:function(d){if(d&&_.isString(d.propertyID)&&_.isString(d.domainName)){b[a].push(["_setAccount",d.propertyID],["_setDomainName",d.domainName],["_setAllowLinker",true]);this.propertyID=d.propertyID;this.domainName=d.domainName;}return this;},addCrossDomainParameters:function(d){if(_.isString(d)&&!~d.indexOf(this.domainName)){b[a].push(function(){var e=_gat._getTrackerByName()._getLinkerUrl(d);if(typeof e==="string"){d=e;}});}return d;},loadScript:function(){return SC.ENVIRONMENT.jsEnvironment==="browser"&&jQuery.getScript(("https:"===document.location.protocol?"https://ssl":"http://www")+".google-analytics.com/ga.js");},mountToApp:function(d){var e=d.getConfig("tracking.google");if(e&&e.propertyID){c.setAccount(e);d.trackers&&d.trackers.push(c);d.getLayout().once("afterAppendView",jQuery.proxy(c,"loadScript"));}}};return c;});})(window,"_gaq");(function(b,a){b.GoogleAnalyticsObject=a;b[a]=b[a]||function(){(b[a].q=b[a].q||[]).push(arguments);};b[a].l=1*new Date();define("GoogleUniversalAnalytics",function(){var c={trackPageview:function(d){if(_.isString(d)){b[a]("send","pageview",d);}return this;},trackEvent:function(d){if(d&&d.category&&d.action){b[a]("send","event",d.category,d.action,d.label,parseFloat(d.value)||0,{hitCallback:d.callback});}return this;},addItem:function(d){if(d&&d.id&&d.name){b[a]("ecommerce:addItem",d);}return this;},addTrans:function(d){if(d&&d.id){b[a]("ecommerce:addTransaction",d);}return this;},trackTrans:function(){b[a]("ecommerce:send");return this;},trackTransaction:function(d){if(d&&d.get("confirmation")){var g=d.get("confirmation").confirmationnumber,e=d.get("summary"),f=null;c.addTrans({id:g,revenue:e.subtotal,shipping:e.shippingcost+e.handlingcost,tax:e.taxtotal,currency:SC.getSessionInfo("currency")?SC.getSessionInfo("currency").code:""});d.get("lines").each(function(h){f=h.get("item");c.addItem({id:g,affiliation:SC.ENVIRONMENT.siteSettings.displayname,sku:f.get("_sku"),name:f.get("_name"),category:f.get("_category"),price:h.get("rate"),quantity:h.get("quantity")});});return c.trackTrans();}},setAccount:function(d){if(d&&_.isString(d.propertyID)&&_.isString(d.domainName)){b[a]("create",d.propertyID,{cookieDomain:d.domainName,allowLinker:true});this.propertyID=d.propertyID;this.domainName=d.domainName;}return this;},addCrossDomainParameters:function(d){if(_.isString(d)&&!~d.indexOf(this.domainName)){b[a](function(e){b.linker=b.linker||new b.gaplugins.Linker(e);var f=b.linker.decorate(d);if(typeof f==="string"){d=f;}});}return d;},loadScript:function(){b[a]("require","ecommerce","ecommerce.js");return SC.ENVIRONMENT.jsEnvironment==="browser"&&jQuery.getScript("//www.google-analytics.com/analytics.js");},mountToApp:function(d){var e=d.getConfig("tracking.googleUniversalAnalytics");if(e&&e.propertyID){c.setAccount(e);d.trackers&&d.trackers.push(c);d.getLayout().once("afterAppendView",jQuery.proxy(c,"loadScript"));}}};return c;});})(window,"ga");define("ItemDetails.Collection",["ItemDetails.Model","Session"],function(b,a){return Backbone.CachedCollection.extend({url:function(){var c=_.addParamsToUrl("/api/items",_.extend({},this.searchApiMasterOptions,a.getSearchApiParams()));return c;},model:b,parse:function(c){return _.compact(c.items)||null;}});});define("ItemDetails",["ItemDetails.Model","ItemDetails.Collection","ItemDetails.View","ItemDetails.Router"],function(d,b,c,a){return{View:c,Model:d,Router:a,Collection:b,mountToApp:function(f,e){d.prototype.searchApiMasterOptions=f.getConfig("searchApiMasterOptions.itemDetails",{});d.prototype.keyMapping=f.getConfig("itemKeyMapping",{});d.prototype.itemOptionsConfig=f.getConfig("itemOptions",[]);d.prototype.itemOptionsDefaultMacros=f.getConfig("macros.itemOptions",{});if(e&&e.startRouter){return new a({application:f,model:d,view:c});}}};});define("ItemDetails.Model",["ItemOptionsHelper","Session"],function(c,b){var a=null;var d=Backbone.CachedModel.extend({url:function(){var e=_.addParamsToUrl("/api/items",_.extend({},this.searchApiMasterOptions,b.getSearchApiParams()));return e;},validation:{quantity:{fn:function(){var f=this;if(f.cartItemId){if(f.get("quantity")<f.get("_minimumQuantity",true)){return _("The minimum quantity for this item is $(0).").translate(f.get("_minimumQuantity",true));}}else{if(f.get("quantity")<f.get("_minimumQuantity",true)){if(f.application.loadCart().state()==="resolved"){var e=SC.Utils.findItemInCart(f,f.application.getCart()),g=e&&e.get("quantity")||0;if((g+f.get("quantity"))<f.get("_minimumQuantity",true)){return _("The minimum quantity for this item is $(0).").translate(f.get("_minimumQuantity",true));}}else{return _("Cart not loaded yet, please wait and try again.").translate();}}}}}},parse:function(e){var f=e.items&&e.items[0];if(f){f.facets=e.facets;}return f||e;},initialize:function(){this.itemOptions={};if(_.isArray(this.get("options"))){this.setOptionsArray(this.get("options"),true);}},getOption:function(e){return this.itemOptions[e];},setOptionsArray:function(f,g){var e=this;_.each(f,function(h){e.setOption(h.id,{internalid:h.value,label:h.displayvalue?h.displayvalue:h.value},g);});},setOption:function(h,g,f){if(h==="quantity"){this.set("quantity",parseInt(g,10)||1);}else{if(_.isNull(g)){delete this.itemOptions[h];}else{var e=this.getPosibleOptionByCartOptionId(h)||this.getPosibleOptionByCartOptionId(h.toLowerCase());if(e&&e.values){g=_.isObject(g)?g:_.where(e.values,{internalid:g.toString()})[0];}else{if(!_.isObject(g)){g={internalid:g,label:g};}}if(!f&&e.isMatrixDimension&&!_.contains(this.getValidOptionsFor(e.itemOptionId),g.label)){throw new RangeError("The combination you selected is invalid");}if(e&&e.cartOptionId){this.itemOptions[e.cartOptionId]=g;}}}return g;},getItemOptionsForCart:function(){var e={};_.each(this.itemOptions,function(g,f){e[f]=g.internalid;});return e;},get:function(e,f){var h=this.keyMapping||(this.collection&&this.collection.keyMapping);if(f||(h&&!this.attributes[e]&&h[e])){var j=h[e];if(_.isFunction(j)){this.attributes[e]=j(this);}else{if(_.isArray(j)){for(var g=0;g<j.length;g++){if(this.attributes[j[g]]){this.attributes[e]=this.attributes[j[g]];break;}}}else{this.attributes[e]=this.attributes[j];}}if(e==="_matrixChilds"||e==="_relatedItems"){a=a||require("ItemDetails.Collection");this.attributes[e]=new a(this.attributes[e]||[]);}else{if(e==="_matrixParent"){this.attributes[e]=new d(this.attributes[e]||{});}}}return this.attributes[e];},getPrice:function(){var p=this,h=this.get("_priceDetails")||{},f=this.getSelectedMatrixChilds(),r={price:h.onlinecustomerprice,price_formatted:h.onlinecustomerprice_formatted};if(h.priceschedule&&h.priceschedule.length){var g=this.get("quantity")||1,m,j,o;for(var k=0;k<h.priceschedule.length;k++){m=h.priceschedule[k];j=parseInt(m.minimumquantity,10);o=parseInt(m.maximumquantity,10);if((j<=g&&g<o)||(j<=g&&!o)){r={price:m.price,price_formatted:m.price_formatted};}}}if(f.length){var e=[];_.each(f,function(i){i.setOption("quantity",p.get("quantity"));e.push(i.getPrice());});if(e.length===1){r=e[0];}else{var l=_.pluck(e,"price"),q=_.min(l),n=_.max(l);if(q!==n){r.min=_.where(e,{price:q})[0];r.max=_.where(e,{price:n})[0];}else{r=e[0];}}}if(!r.compare_price&&this.get("_comparePriceAgainst")){r.compare_price=this.get("_comparePriceAgainst");r.compare_price_formatted=this.get("_comparePriceAgainstFormated");}return r;},getStockInfo:function(){var f=this.getSelectedMatrixChilds(),h=f.length===1?f[0]:this,i=this.get("_matrixParent"),e={stock:h.get("_stock"),isInStock:h.get("_isInStock"),outOfStockMessage:h.get("_outOfStockMessage")||this.get("_outOfStockMessage")||(i&&i.get("_outOfStockMessage"))||_("Out of Stock").translate(),showOutOfStockMessage:h.get("_showOutOfStockMessage")||this.get("_showOutOfStockMessage"),inStockMessage:h.get("_inStockMessage"),showInStockMessage:h.get("_showInStockMessage"),stockDescription:h.get("_stockDescription"),showStockDescription:h.get("_showStockDescription"),stockDescriptionClass:h.get("_stockDescriptionClass")},g=_(this.getMatrixOptionsSelection()).keys().length;if(g&&f.length>1){var j=[];_.each(f,function(k){j.push(k.getStockInfo());});_.each(e,function(l,k){var m=_.pluck(j,k);if(k==="stock"){e.stock=_.reduce(m,function(n,o){return n+o;},0);}else{if(k==="isInStock"){e.isInStock=_.contains(m,true);}else{m=_.uniq(m);if(m.length===1){e[k]=m[0];}}}});}return e;},isReadyForCart:function(){if(this.isSelectionComplete()){var e=this.get("_isPurchasable"),f=this.getSelectedMatrixChilds();if(f.length){e=f[0].get("_isPurchasable");}return e;}return false;}});d.prototype=_.extend(d.prototype,c);return d;});define("ItemDetails.Router",function(){return Backbone.Router.extend({routes:{":url":"productDetailsByUrl"},initialize:function(a){this.application=a.application;this.route(/^(.*?)$/,"productDetailsByUrl");this.Model=a.model;this.View=a.view;this.route("product/:id","productDetailsById");this.route("product/:id?:options","productDetailsById");},productDetailsByUrl:function(b){if(!b){return;}var a=null;if(~b.indexOf("?")){a=SC.Utils.parseUrlOptions(b);b=b.split("?")[0];}if(a){this.productDetails({url:b},b,a);}else{this.productDetails({url:b},b);}},productDetailsById:function(b,a){this.productDetails({id:b},"/product/"+b,SC.Utils.parseUrlOptions(a));},productDetails:function(b,f,e){_.each(e,function(h,g){e[g]=decodeURIComponent(h);});var d=this.application,c=new this.Model(),a=new this.View({model:c,baseUrl:f,application:this.application});c.application=this.application;c.fetch({data:b,killerId:this.application.killerId,pageGeneratorPreload:true}).then(function(g){if(!c.isNew()){c.parseQueryStringOptions(e);if(!(e&&e.quantity)){c.set("quantity",c.get("_minimumQuantity"));}if(b.id&&c.get("urlcomponent")&&SC.ENVIRONMENT.jsEnvironment==="server"){nsglobal.statusCode=301;nsglobal.location=c.get("_url")+c.getQueryString();}if(g.corrections&&g.corrections.length>0){if(c.get("urlcomponent")&&SC.ENVIRONMENT.jsEnvironment==="server"){nsglobal.statusCode=301;nsglobal.location="/"+g.corrections[0].url+c.getQueryString();}else{Backbone.history.navigate("#"+g.corrections[0].url+c.getQueryString(),{trigger:true});}}a.prepView();a.showContent(e);}else{d.getLayout().notFound();}},function(g,h){try{h.preventDefault=true;}catch(i){console.log(i.message);}d.getLayout().notFound();});}});});define("ItemDetails.View",["Facets.Translator","ItemDetails.Collection"],function(a){var b={};return Backbone.View.extend({title:"",page_header:"",template:"product_details",attributes:{id:"product-detail","class":"view product-detail"},events:{'blur [data-toggle="text-option"]':"setOption",'click [data-toggle="set-option"]':"setOption",'change [data-toggle="select-option"]':"setOption",'keydown [data-toggle="text-option"]':"tabNavigationFix",'focus [data-toggle="text-option"]':"tabNavigationFix",'change [name="quantity"]':"updateQuantity",'keypress [name="quantity"]':"submitOnEnter",'click [data-type="add-to-cart"]':"addToCart","shown .collapse":"storeColapsiblesState","hidden .collapse":"storeColapsiblesState",mouseup:"contentMouseUp",click:"contentClick"},initialize:function(c){this.application=c.application;this.counted_clicks={};if(!this.model){throw new Error("A model is needed");}},getBreadcrumb:function(){var c=this,e=[],d=new a(null,null,this.application.translatorConfig);_.each(this.application.getConfig("productDetailsBreadcrumbFacets"),function(f){var g=c.model.get(f.facetId);if(g){d=d.cloneForFacetId(f.facetId,g);e.push({href:d.getUrl(),text:f.translator?_(f.translator).translate(g):g});}});return e;},storeColapsiblesState:function(){this.storeColapsiblesStateCalled=true;this.$(".collapse").each(function(c,d){b[SC.Utils.getFullPathForElement(d)]=jQuery(d).hasClass("in");});},resetColapsiblesState:function(){var c=this;_.each(b,function(e,d){c.$(d)[e?"addClass":"removeClass"]("in").css("height",e?"auto":"0");});},updateQuantity:function(f){var d=parseInt(jQuery(f.target).val(),10),g=this.model.get("quantity"),c=this.application.getConfig("addToCartBehavior")==="showCartConfirmationModal";d=(d>0)?d:g;jQuery(f.target).val(d);if(d!==g){this.model.setOption("quantity",d);if(!this.$containerModal||!c){this.refreshInterface(f);}}if(this.$containerModal){this.application.getLayout().trigger("afterAppendView",this);}},submitOnEnter:function(c){if(c.keyCode===13){c.preventDefault();c.stopPropagation();this.addToCart(c);}},contentClick:function(c){this.counted_clicks[c.pageX+"|"+c.pageY]=true;if(this.$containerModal){c.stopPropagation();}},contentMouseUp:function(d){if(d.which!==2&&d.which!==3){var c=this;_.delay(function(){if(!c.counted_clicks[d.pageX+"|"+d.pageY]){jQuery(document.elementFromPoint(d.clientX,d.clientY)).click();}delete c.counted_clicks[d.pageX+"|"+d.pageY];},100);}},addToCart:function(j){j.preventDefault();var f=this.$('[name="quantity"]').val();this.model.setOption("quantity",f);if(this.model.isValid(true)&&this.model.isReadyForCart()){var l=this,h=this.application.getCart(),g=this.application.getLayout(),d,k=_("Sorry, there is a problem with this Item and can not be purchased at this time. Please check back later.").translate(),i=this.application.getConfig("addToCartBehavior")==="showCartConfirmationModal";if(this.model.itemOptions&&this.model.itemOptions.GIFTCERTRECIPIENTEMAIL){if(!Backbone.Validation.patterns.email.test(this.model.itemOptions.GIFTCERTRECIPIENTEMAIL.label)){l.showError(_("Recipient email is invalid").translate());return;}}if(i){h.optimistic={item:this.model,quantity:f};}if(this.model.cartItemId){d=h.updateItem(this.model.cartItemId,this.model).done(function(){if(h.getLatestAddition()){if(l.$containerModal){l.$containerModal.modal("hide");}if(g.currentView instanceof require("Cart").Views.Detailed){g.currentView.showContent();}}else{l.showError(k);}});}else{d=h.addItem(this.model).done(function(){if(h.getLatestAddition()){if(!i){g.showCartConfirmation();}}else{l.showError(k);}});if(i){h.optimistic.promise=d;g.showCartConfirmation();}}d.fail(function(o){var n=null;try{var e=JSON.parse(o.responseText);n=e.errorDetails;}finally{if(n&&n.status==="LINE_ROLLBACK"){var m=n.newLineId;l.model.cartItemId=m;}l.showError(_("We couldn't process your item").translate());if(i){l.showErrorInModal(_("We couldn't process your item").translate());}}});if(j&&j.target){var c=jQuery(j.target).attr("disabled",true);d.always(function(){c.attr("disabled",false);});}}},refreshInterface:function(){var c=this.$(":focus").get(0);this.focusedElement=c?SC.Utils.getFullPathForElement(c):null;if(!this.inModal){Backbone.history.navigate(this.options.baseUrl+this.model.getQueryString(),{replace:true});}setTimeout(jQuery.proxy(this,"showContent",{dontScroll:true}),1);},computeDetailsArea:function(){var c=this,d=[];_.each(this.application.getConfig("itemDetails",[]),function(e){var f="";if(e.macro){f=SC.macros[e.macro](c);}else{if(e.contentFromKey){f=c.model.get(e.contentFromKey);}}if(jQuery.trim(f)){d.push({name:e.name,opened:e.opened,content:f,itemprop:e.itemprop});}});this.details=d;},showInModal:function(c){this.template="quick_view";return this.application.getLayout().showInModal(this,c);},prepView:function(){this.title=this.model.get("_pageTitle");this.page_header=this.model.get("_pageHeader");this.computeDetailsArea();},getMetaKeywords:function(){return this.getMetaTags().filter('[name="keywords"]').attr("content")||"";},getMetaTags:function(){return jQuery("<head/>").html(jQuery.trim(this.model.get("_metaTags"))).children("meta");},getMetaDescription:function(){return this.getMetaTags().filter('[name="description"]').attr("content")||"";},renderOptions:function(){var c=this.model,d=c.getPosibleOptions();this.$('div[data-type="option"]').each(function(f,e){var i=jQuery(e).empty(),h=i.data("cart-option-id"),g=i.data("macro")||"";i.append(c.renderOptionSelector(h,g));});this.$('div[data-type="all-options"]').each(function(g,e){var i=jQuery(e).empty(),f=(i.data("exclude-options")||"").split(","),h="";f=_.map(f,function(j){return jQuery.trim(j);});_.each(d,function(k,j){if(!_.contains(f,k.cartOptionId)){h+=c.renderOptionSelector(k,null,j);}});i.append(h);});},tabNavigationFix:function(d){var c=this;this.hideError();if(!this.tabNavigationTimeout){this.tabNavigation=d.type==="keydown"&&d.which===9;this.tabNavigationUpsidedown=d.shiftKey;this.tabNavigationCurrent=SC.Utils.getFullPathForElement(d.target);if(this.tabNavigation){this.tabNavigationTimeout=setTimeout(function(){c.tabNavigationTimeout=null;this.tabNavigation=false;},5);}}},showContent:function(d){var c=this;this.application.getLayout().showContent(this,d&&d.dontScroll).done(function(g){c.afterAppend();var h=g.$('[data-type="related-items-placeholder"]');if(h.size()>0){this.application.showRelatedItems&&this.application.showRelatedItems(g.model.get("internalid"),h);}var j=g.$('[data-type="correlated-items-placeholder"]');if(j.size()>0){this.application.showCorrelatedItems&&this.application.showCorrelatedItems(g.model.get("internalid"),j);}var i=g.$('[data-type="product-lists-control"]');if(i.size()>0){this.application.ProductListModule.renderProductLists(g);}var e=g.$('[data-type="review-list-placeholder"]');var f=SC.ENVIRONMENT.REVIEWS_CONFIG&&SC.ENVIRONMENT.REVIEWS_CONFIG.enabled;if(f&&e.size()>0){this.application.showProductReviews(g.model,d,e);}});},afterAppend:function(){this.renderOptions();this.focusedElement&&this.$(this.focusedElement).focus();if(this.tabNavigation){var e=this.$(":input").index(this.$(this.tabNavigationCurrent).get(0)),d=this.tabNavigationUpsidedown?e-1:e+1;this.$(":input:eq("+d+")").focus();}this.storeColapsiblesStateCalled?this.resetColapsiblesState():this.storeColapsiblesState();this.application.getUser().addHistoryItem&&this.application.getUser().addHistoryItem(this.model);if(this.inModal){var c=this.$el.find('[data-name="view-full-details"]');c.mousedown();c.attr("href",c.attr("href")+this.model.getQueryString());}},setOption:function(i){var d=this,c=jQuery(i.target),h=c.val()||c.data("value")||null,g=c.closest('[data-type="option"]').data("cart-option-id");i.preventDefault();if(c.data("active")){h=null;}try{this.model.setOption(g,h);}catch(f){_.each(this.model.getPosibleOptions(),function(e){e.isMatrixDimension&&d.model.setOption(e.cartOptionId,null);});this.model.setOption(g,h);}this.refreshInterface(i);if(this.$containerModal){this.application.getLayout().trigger("afterAppendView",this);}}});});define("ItemOptionsHelper",function(){var a={renderOptionSelected:function(e,d){var c=_.isObject(e)?e:this.getPosibleOptionByCartOptionId(e),b=this.getOption(c.cartOptionId);d=d||c.macros.selected;if(!b){return"";}return SC.macros[d](c,b,this);},renderAllOptionSelected:function(c){var b=this;c=c||this.getPosibleOptions();return _.reduce(c,function(d,e){return d+b.renderOptionSelected(e);},"");},renderOptionSelector:function(g,e,b){var d=_.isObject(g)?g:this.getPosibleOptionByCartOptionId(g),c=this.getOption(d.cartOptionId);e=e||d.macros.selector;if(d.isMatrixDimension){var f=this.getValidOptionsFor(d.itemOptionId);_.each(d.values,function(h){h.isAvailable=_.contains(f,h.label);});}return SC.macros[e](d,c,this,b);},renderOptionsGridSelector:function(d,e){var c=d.horizontal,b=d.vertical,f=false;if(c.isMatrixDimension){f=this.getValidOptionsFor(c.itemOptionId);_.each(c.values,function(g){g.isAvailable=_.contains(f,g.label);});}if(b.isMatrixDimension){f=this.getValidOptionsFor(b.itemOptionId);_.each(b.values,function(g){g.isAvailable=_.contains(f,g.label);});}return SC.macros[e](c,b,this);},renderAllOptionSelector:function(c){var b=this;c=c||this.getPosibleOptions();return _.reduce(c,function(d,e){return d+b.renderOptionSelector(e);},"");},getValidOptionsFor:function(c){var b=this.getMatrixOptionsSelection();delete b[c];return _.uniq(_.map(this.getSelectedMatrixChilds(b),function(d){return d.get(c);}));},isSelectionComplete:function(){var d=this.getPosibleOptions(),b=false;for(var c=0;c<d.length;c++){var e=d[c];b=b||e.isMatrixDimension;if(e.isMandatory&&!this.getOption(e.cartOptionId)){return false;}}if(b&&this.getSelectedMatrixChilds().length!==1){return false;}return true;},getPosibleOptionByCartOptionId:function(b){return _.where(this.getPosibleOptions(),{cartOptionId:b})[0];},getPosibleOptionByUrl:function(b){return _.where(this.getPosibleOptions(),{url:b})[0];},getPosibleOptions:function(){if(this.cachedPosibleOptions){return this.cachedPosibleOptions;}var d=[];if(this.get("_optionsDetails")&&this.get("_optionsDetails").fields){var e=this,c={};_.each(this.itemOptionsConfig,function(f){if(f.cartOptionId){c[f.cartOptionId]=f;}});var b=this.get("_matrixParent").get("_id")?this.get("_matrixParent").get("_optionsDetails").fields:this.get("_optionsDetails").fields;_.each(b,function(g){var f={label:g.label,values:g.values,type:g.type,cartOptionId:g.internalid,itemOptionId:g.sourcefrom||"",isMatrixDimension:g.ismatrixdimension||false,isMandatory:g.ismandatory||false,macros:{}};_.each(f.values,function(i){i.isAvailable=true;});if(c[f.cartOptionId]){f=_.extend(f,c[f.cartOptionId]);}if(g.ismatrixdimension){var h=e.get("_matrixChilds").pluck(f.itemOptionId);f.values=_.filter(f.values,function(i){if(i.internalid){return _.contains(h,i.label);}else{return true;}});}if(e.itemOptionsDefaultMacros){if(!f.macros.selector){f.macros.selector=e.itemOptionsDefaultMacros.selectorByType[f.type]?e.itemOptionsDefaultMacros.selectorByType[f.type]:e.itemOptionsDefaultMacros.selectorByType["default"];}if(!f.macros.selected){f.macros.selected=e.itemOptionsDefaultMacros.selectedByType[f.type]?e.itemOptionsDefaultMacros.selectedByType[f.type]:e.itemOptionsDefaultMacros.selectedByType["default"];}}if(!f.url){f.url=f.cartOptionId;}d.push(f);});this.cachedPosibleOptions=d;}return d;},isCombinationAvailable:function(b){return _.findWhere(_.pluck(this.getSelectedMatrixChilds(),"attributes"),b);},isProperlyConfigured:function(){var b=this.getPosibleOptions(),d=null;if(b&&b.length){for(var c=0;c<b.length;c++){d=b[c];if(d.isMatrixDimension&&!d.itemOptionId){return false;}}}else{if(this.get("_matrixChilds")&&this.get("_matrixChilds").length){return false;}}return true;},getMatrixOptionsSelection:function(){var d=_.where(this.getPosibleOptions(),{isMatrixDimension:true}),b={},c=this;_.each(d,function(f){var e=c.getOption(f.cartOptionId);if(e&&e.label){b[f.itemOptionId]=e.label;}});return b;},getSelectedMatrixChilds:function(b){b=b||this.getMatrixOptionsSelection();var c=JSON.stringify(b);if(!this.matrixSelectionCache){this.matrixSelectionCache={};}if(!this.get("_matrixChilds")){return[];}if(!this.matrixSelectionCache[c]){this.matrixSelectionCache[c]=_.values(b).length?this.get("_matrixChilds").where(b):this.get("_matrixChilds").models;}return this.matrixSelectionCache[c];},getQueryString:function(){return this.getQueryStringWithQuantity(this.get("quantity"));},getQueryStringButMatrixOptions:function(){return this.getQueryStringWithQuantity(this.get("quantity"),true);},getQueryStringWithQuantity:function(e,d){var c=this,b=[];if(e>0&&e!==this.get("_minimumQuantity",true)){b.push("quantity="+(e||1));}_.each(this.getPosibleOptions(),function(f){if(d&&f.isMatrixDimension){return;}var g=c.getOption(f.cartOptionId);if(g){b.push(f.url+"="+encodeURIComponent(g.internalid));}});b=b.join("&");return b.length?"?"+b:"";},parseQueryStringOptions:function(c){var b=this;_.each(c,function(f,d){if(d==="quantity"){b.setOption("quantity",f);}else{if(d==="cartitemid"){b.cartItemId=f;}else{if(f&&d){f=decodeURIComponent(f);var e=b.getPosibleOptionByUrl(d);if(e){if(e.values){f=_.where(e.values,{label:f})[0]||_.where(e.values,{internalid:f})[0];b.setOption(e.cartOptionId,f);}else{b.setOption(e.cartOptionId,f);}}}}}});}};return a;});define("Merchandising.Context.DefaultHandlers",["Merchandising.Context","Facets.Views","ItemDetails.View","Cart.Views"],function(c,e,b,a){var d={mergeFilterValues:function(g,f){return _.union(_.reject(g,function(h){return h==="$current";}),f||[]);},parseValues:function(f,g){_.each(f,function(h,i){h=d.mergeFilterValues(h,g(h,i));if(h.length){_.each(h,function(j){c.appendFilterValue(f,i,j);});}else{delete f[i];}});return f;},includeFacetsToFilters:function(i,h){var g="",f=[];_.each(i,function(j){g=j.id;f=j.value;f=_.isArray(f)?f:[f];if(h.hasOwnProperty(g)){f=_.union(h[g],f);}h[g]=f;});return h;},itemListHandlers:{getFilters:function(f,h){var g=this.view.translator.facets;if(h){f=d.includeFacetsToFilters(g,f);}return d.parseValues(f,function(j,k){var i=[];if(_.contains(j,"$current")){var l=_.findWhere(g,{id:k});i=l&&l.value||[];if(!_.isArray(i)){i=[i];}}return i;});},getIdItemsToExclude:function(){return this.view.model.get("items").pluck("internalid");}},getItemValues:function(g,f){return _.pluck(_.findWhere(g,{id:f}).values,"url");},itemDetailsHandlers:{getFilters:function(f,h){var g=this.view.model.get("facets");return d.parseValues(f,function(i,j){if(h||_.contains(i,"$current")){return d.getItemValues(g,j);}});},getIdItemsToExclude:function(){return[this.view.model.get("internalid")];}},getCartLineItemValue:function(g,i){var h=g.get(i);if(!h){var f=_.findWhere(g.getPosibleOptions(),{itemOptionId:i});h=f?g.getOption(f.cartOptionId).label:null;}return h;},getCartItemValues:function(f,g){return _.compact(f.map(function(h){return c.escapeValue(d.getCartLineItemValue(h.get("item"),g));}));},cartDetailedHandlers:{getFilters:function(g,h){var f=this.view.model.get("lines");return d.parseValues(g,function(i,j){if(h||_.contains(i,"$current")){return d.getCartItemValues(f,j);}});},getIdItemsToExclude:function(){var f=null;return _.map(this.view.model.get("lines"),function(g){f=g.get("item");return f.get("_matrixParent").get("_id")||f.get("_id");});}},cartConfirmationHandlers:{getFilters:function(g,h){var f=this.view.line.get("item");return d.parseValues(g,function(i,j){if(h||_.contains(i,"$current")){return c.escapeValue(d.getCartLineItemValue(f,j));}});},getIdItemsToExclude:function(){var f=this.view.line.get("item");return[f.get("_matrixParent").get("_id")||f.get("_id")];}},mountToApp:function(){c.registerHandlers(e.Browse,this.itemListHandlers).registerHandlers(b,this.itemDetailsHandlers).registerHandlers(a.Detailed,this.cartDetailedHandlers).registerHandlers(a.Confirmation,this.cartConfirmationHandlers);return this;}};return d;});define("Merchandising.Context",function(){var a=function a(b){if(b.MerchandisingContext){return b.MerchandisingContext;}this.view=b;b.MerchandisingContext=this;};_.extend(a,{handlers:[],registerHandlers:function(c,b){if(c){var d=_.extend(a.removeHandler(c),b);d.viewConstructor=c;a.handlers.unshift(d);}return a;},removeHandler:function(b){var c={};a.handlers=_.reject(a.handlers,function(d){if(d.viewConstructor===b){c=d;return true;}});return c;},getHandlerForView:function(b){return _.find(a.handlers,function(c){return b instanceof c.viewConstructor;});},escapeValue:function(b){return b?b.toString().replace(/\s/g,"-"):"";},callHandler:function(b,c,e){var d=a.getHandlerForView(c.view);return d&&_.isFunction(d[b])&&d[b].apply(c,e);},appendFilterValue:function(d,c,e){if(_.isObject(e)&&("to" in e)&&("from" in e)){delete d[c];d[c+".to"]=e.to;d[c+".from"]=e.from;}else{if(_.isUndefined(d[c])){d[c]="";}var b="";if(d[c]){b=",";}d[c]+=b+e;}}});_.extend(a.prototype,{callHandler:function(b){return a.callHandler(b,this,_.toArray(arguments).slice(1));},getFilters:function(b,d){var c=this.callHandler("getFilters",b,d);if(!c){c={};_.each(b,function(e,f){e=_.without(e,"$current");if(e.length){_.each(e,function(g){a.appendFilterValue(c,f,g);});}});}return c;},getIdItemsToExclude:function(){return this.callHandler("getIdItemsToExclude")||[];}});return a;});define("Merchandising.ItemCollection",["ItemDetails.Collection","Session"],function(b,a){return b.extend({url:function(){return _.addParamsToUrl("/api/items",_.extend({},this.searchApiMasterOptions,a.getSearchApiParams()));}});});define("Merchandising.jQueryPlugin",["Merchandising.Zone"],function(a){jQuery.fn.merchandisingZone=function(b){return this.each(function(){new a(this,b);});};});define("Merchandising",["Merchandising.ItemCollection","Merchandising.Rule","Merchandising.Zone","Merchandising.Context","Merchandising.jQueryPlugin"],function(d,b,c,a){return{ItemCollection:d,Context:a,Rule:b,Zone:c,mountToApp:function(f){d.prototype.searchApiMasterOptions=f.getConfig("searchApiMasterOptions.merchandisingZone");f.getLayout().on("afterAppendView",function(){var g=this.modalCurrentView||this;g.$('[data-type="merchandising-zone"]').merchandisingZone({application:f});}).on("renderEnhancedPageContent",function(h,g){if(g.contenttype==="merchandising"){var j=g.target,k=h.$(j),i={application:f,id:g.content};if(k.length){k.merchandisingZone(i);}else{this.$(j).filter(":empty").merchandisingZone(i);}}});f.getMerchandisingRules=function e(){return b.Collection.getInstance();};}};});define("Merchandising.Rule",function(){var a={};a.Model=Backbone.Model.extend({});a.Collection=Backbone.CachedCollection.extend({url:"/dls/services/merchandising.ss",model:a.Model},SC.Singleton);return a;});define("Merchandising.Zone",["Merchandising.ItemCollection","Merchandising.Rule","Merchandising.Context"],function(d,c,b){var a=function a(g,f){var e=f&&f.application,h=e&&e.getLayout&&e.getLayout();if(!g||!h){return;}this.$element=jQuery(g).empty();this.model=c.Collection.getInstance().get(f.id||this.$element.data("id"));if(this.model&&this.$element.length&&!this.$element.hasClass(this.loadingClassNames)){this.options=f;this.application=e;this.items=new d();this.context=new b(h.modalCurrentView||h.currentView||h);this.initialize();}};_.extend(a.prototype,{initialize:function(){this.addLoadingClass();this.addListeners();this.items.fetch({cache:true,data:this.getApiParams()});},addListeners:function(){var e=jQuery.proxy;this.items.on({sync:e(this.excludeItems,this),excluded:e(this.appendItems,this),appended:e(this.removeLoadingClass,this),error:e(this.handleRequestError,this)});},getApiParams:function(){var e=this.parseApiFilterOptions(),f=this.parseApiSortingOptions();if(f.length){e.sort=f.join(",");}return _.extend({limit:this.getLimit(),fieldset:this.model.get("fieldset")},e);},parseApiFilterOptions:function(){var e={};_.each(this.model.get("filter"),function(f){e[f.field_id]=f.field_value;});return this.context.getFilters(e,this.model.get("within"));},parseApiSortingOptions:function(){return _.map(this.model.get("sort"),function(e){return e.field_id+":"+e.dir;});},getLimit:function(){var g=this.model,e=g.get("show"),f=g.get("exclude");if(f.length){if(_.contains(f,"$cart")){e+=this.application.getCart().get("lines").length;}if(_.contains(f,"$current")){e+=this.context.getIdItemsToExclude().length;}}return e<=100?e:100;},excludeItems:function(){var e=this;_.each(this.model.get("exclude"),function(f){e.applyFilterToItems(f);});this.items.trigger("excluded");return this;},applyFilterToItems:function(f){var e=this.items;switch(f){case"$cart":var g=null;this.application.getCart().get("lines").each(function(h){g=h.get("item");e.remove(e.get(g.get("_matrixParent").get("_id")||g.get("_id")));});break;case"$current":_.each(this.context.getIdItemsToExclude(),function(h){e.remove(e.get(h));});break;}return this;},appendItems:function(){var e=this.items;if(e.length){var g=this.model,f=this.application,h=SC.macros[g.get("template")]||SC.macros[f.getConfig("macros.merchandisingZone")];this.$element.append(h({application:f,title:g.get("title"),description:g.get("description"),items:_.first(e.models,g.get("show"))}));}e.trigger("appended");this.options&&this.options.application&&this.options.application.getLayout().trigger("afterRender");return this;},loadingClassNames:"loading loading-merchandising-zone",addLoadingClass:function(){this.$element.addClass(this.loadingClassNames);},removeLoadingClass:function(){this.$element.removeClass(this.loadingClassNames);},handleRequestError:function(){this.removeLoadingClass();console.error("Merchandising Zone - Request Error",arguments);}});return a;});define("MultiCurrencySupport",function(){return{mountToApp:function(a){var b=a.getLayout();_.extend(b.events,{'change select[data-toggle="currency-selector"]':"setCurrency"});_.extend(b,{setCurrency:function(g){var d=jQuery(g.target).val(),f=_.find(SC.ENVIRONMENT.availableCurrencies,function(e){return e.code===d;});var c=SC.Utils.parseUrlOptions(window.location.search);if(window.location.hash!==""&&b.currentView.translator){window.location.hash=a.getConfig("defaultSearchUrl","");}c.cur=f.code;window.location.search=_.reduce(c,function(e,i,h){return i?e+h+"="+i+"&":e;},"?");}});}};});define("MultiHostSupport",function(){return{setHref:function(a){window.location.href=location.protocol+"//"+a;},setSearch:function(a){window.location.search=a;},getCurrentPath:function(){return location.pathname;},mountToApp:function(b){_.extend(b.getLayout().events,{'change select[data-toggle="host-selector"]':"setHost"});_.extend(b.getLayout().events,{'change select[data-toggle="language-selector"]':"setLang"});var a=this;_.extend(b.getLayout(),{setHost:function(f){var d=jQuery(f.target).val(),c;if(Backbone.history._hasPushState){c=d;}else{c=d+a.getCurrentPath();}c=SC.Utils.addParamsToUrl(c,SC.Utils.getSessionParams(b.getConfig("siteSettings.touchpoints.login")));a.setHref(c);},setLang:function(g){var h=jQuery(g.target).val(),j=SC.ENVIRONMENT.availableHosts,k;for(var f=0;f<j.length;f++){var l=j[f],d=_(l.languages).findWhere({host:h});if(d&&d.locale){k=d;break;}}if(k&&k.locale){var c=SC.Utils.parseUrlOptions(window.location.search);c.lang=k.locale;var m=_.reduce(c,function(e,n,i){return n?e+i+"="+n+"&":e;},"?");a.setSearch(m);return m;}}});}};});define("NavigationHelper",["Session","UrlHelper"],function(a){var b={mountToApp:function(c){try{g=require("Content.EnhancedViews");}catch(f){}var d=c.getLayout(),g;_.extend(d,{oldIE:function(){var e=/msie [\w.]+/,h=document.documentMode;return(e.exec(navigator.userAgent.toLowerCase())&&(!h||h<=7));},getUrl:function(e){if(this.oldIE()){return e.data("href");}else{return e.attr("href");}},setUrl:function(e,h){e.attr("href",h);if(this.oldIE()){e.data("href",h);}},showInternalLinkInModal:function(l,i,k){var h=this,j=Backbone.history.fragment||"/",m;this.isRewrited=true;this.originalShowContent=this.showContent;if(g){this.originalOverrideViewSettings=g.overrideViewSettings;}this.showContent=function(e){var n=jQuery.Deferred();if(!m){m=e;}else{if(m!==e){n=h.originalShowContent.apply(h.application.getLayout(),arguments);m.$containerModal.modal("hide");return n;}}if(e&&_.isFunction(e.showInModal)){n=e.showInModal({className:k.data("modal-class-name")});e.$containerModal.on("hide.bs.modal",function(){h.undoNavigationHelperFunctionRewrite();});}else{h.undoNavigationHelperFunctionRewrite();Backbone.history.navigate(i,{trigger:false,replace:true});}return n;};Backbone.history.navigate(i,{trigger:true,replace:true});Backbone.history.navigate(j,{trigger:false,replace:true});},undoNavigationHelperFunctionRewrite:function(){if(this.isRewrited){this.showContent=this.originalShowContent;if(g){g.overrideViewSettings=this.originalOverrideViewSettings;}this.isRewrited=false;}},showExternalLinkInModal:function(k,i,j){var h=new Backbone.View({application:this.application});h.src=i;h.template="iframe";h.page_header=j.data("page-header")||"";h.showInModal({className:(j.data("modal-class-name")||"")+" iframe-modal"});},clickEventListener:function(o){o.preventDefault();var p=jQuery(o.currentTarget),i=this.getUrl(p)||"",n=o.button===1||o.ctrlKey||o.metaKey||p.attr("target")==="_blank",q=p.data("toggle")==="show-in-modal",h=p.attr("disabled"),r=p.data("toggle")==="dropdown",j=/msie [\w.]+/,l=document.documentMode,m=(j.exec(navigator.userAgent.toLowerCase())&&(!l||l<=7));if(h){o.stopPropagation();return;}if(m){i=p.data("href");}if(p.data("original-href")&&!n){i=p.data("original-href");}var k=~i.indexOf("http:")||~i.indexOf("https:")||~i.indexOf("mailto:")||~i.indexOf("tel:");if(i==="#"||i===""||r){return;}if(!n){if(this.$containerModal){this.$containerModal.modal("hide");}if(q){if(k){this.showExternalLinkInModal(o,i,p);}else{this.showInternalLinkInModal(o,i,p);}}else{if(k){document.location.href=i;}else{Backbone.history.navigate(i,{trigger:true});}}}else{window.open(i,_.uniqueId("window"));}},fixNoPushStateLink:function(k){var i=jQuery(k.target),h=this.getUrl(i)||"#";if(Backbone.history.options.pushState||h==="#"||h.indexOf("http://")===0||h.indexOf("https://")===0||h.indexOf("mailto:")===0||h.indexOf("tel:")===0){return;}else{if(i.data("toggle")==="show-in-modal"){i.data("original-href",h);this.setUrl(i,window.location.href);return;}}var j;if(window.location.hash){j=window.location.href.replace(/#.*$/,"#"+h);}else{if(window.location.href.lastIndexOf("#")===window.location.href.length-1){j=window.location.href+h;}else{j=window.location.href+"#"+h;}}this.setUrl(i,j);},getTargetTouchpoint:function(h){var m=this.application,k=a.get("touchpoints"),o=h.data(),i=(k?k[o.touchpoint]:"")||"",e=o.hashtag,l="",j=e&&e.replace("#","");if(o.touchpoint===m.getConfig("currentTouchpoint")){l=j?("#"+j):this.getUrl(h);l=o.keepOptions?this.getKeepOptionsUrl(h):l;}else{if(i.indexOf("https:")>=0){var n=SC.ENVIRONMENT.currentLanguage;if(n){o.parameters=o.parameters?o.parameters+"&lang="+n.locale:"lang="+n.locale;}}if(o.parameters){i+=(~i.indexOf("?")?"&":"?")+o.parameters;}if(e&&e!=="#"&&e!=="#/"){l=_.fixUrl(i+(~i.indexOf("?")?"&":"?")+"fragment="+j);}else{l=_.fixUrl(i);}if(l&&!(~l.indexOf("http:")||~l.indexOf("https:"))){l=location.protocol+"//"+location.host+l;}}if(m.addCrossDomainParameters){l=m.addCrossDomainParameters(l);}l=this.fixTargetHost(l);return l;},touchpointMousedown:function(j){this.isTouchMoveEvent=false;if(j.type==="touchstart"){j.stopPropagation();}var h=jQuery(j.currentTarget),i=this.getTargetTouchpoint(h);if(j.which===2||j.which===3){j.preventDefault();j.stopPropagation();this.setUrl(h,i);}else{if(!i.indexOf("https:")&&h.data("touchpoint")!==c.getConfig("currentTouchpoint")){d.$containerModal&&d.$containerModal.length&&d.$containerModal.modal("hide");_.doPost(i);}else{this.setUrl(h,i);}}},touchpointMouseup:function(j){var h=jQuery(j.currentTarget),k=h.data(),l=j.button!==0||j.ctrlKey||j.metaKey||h.attr("target")==="_blank";if(!l&&this.application.getConfig("currentTouchpoint")&&this.application.getConfig("currentTouchpoint")===k.touchpoint&&k.hashtag){var i=k.hashtag;i=i[0]==="#"?i.substring(1):i;i=i[0]==="/"?i:"/"+i;this.setUrl(h,i);}if(j.type==="touchend"&&!this.isTouchMoveEvent){j.stopPropagation();j.preventDefault();h.trigger("click");}},touchpointTouchMove:function(){this.isTouchMoveEvent=true;},getDomain:function(e){return e.split("/")[2]||null;},getProtocol:function(e){return e.split("/")[0]||null;},getKeepOptionsUrl:function(e){if(_.getWindow().location.href.indexOf("?")>0&&e.data("keep-options")){var o=_.parseUrlOptions(_.getWindow().location.href);if(e.data("keep-options")!=="*"){var l=e.data("keep-options").split(","),p=_(o).keys();_(p).each(function(i){if(!_(l).contains(i)){delete o[i];}});}var n=(this.getUrl(e)&&this.getUrl(e).indexOf("?")>0)?_.parseUrlOptions(this.getUrl(e)):{},k="",h=this.getUrl(e)||"";n=_.extend(n,o);h=h.indexOf("?")>0?(h.substring(0,h.indexOf("?"))):h;var q=_(n).keys();for(var j=0;j<q.length;j++){var m=q[j];k+=m+"="+n[m]+(j<q.length-1?"&":"");}return h+(k?("?"+k):"");}else{return this.getUrl(e);}},getTargetHost:function(){var j=SC.ENVIRONMENT.availableHosts,k;if(j&&j.length){for(var e=0;e<j.length;e++){var h=j[e],l=_(h.languages).findWhere({locale:SC.ENVIRONMENT.currentLanguage.locale});if(l&&l.host){k=l.host;break;}}}return k;},fixTargetHost:function(e){var i=e;if(!~e.indexOf("https:")){var h=this.getTargetHost();if(h){i=i.replace(/(http:\/\/)([^/?#]*)([^>]*)/gi,function(k,m,l,j){return m+h+j;});}i=SC.Utils.addParamsToUrl(i,SC.Utils.getSessionParams(c.getConfig("siteSettings.touchpoints.login")));}return i;},keepOptionsMousedown:function(j){var h=jQuery(j.currentTarget),i=this.getKeepOptionsUrl(h);this.setUrl(h,i);}});_.extend(d.events,{'touchstart a[data-touchpoint]:not([data-navigation="ignore-click"])':"touchpointMousedown",'touchmove a[data-touchpoint]:not([data-navigation="ignore-click"])':"touchpointTouchMove",'mousedown a[data-touchpoint]:not([data-navigation="ignore-click"])':"touchpointMousedown",'touchend a[data-touchpoint]:not([data-navigation="ignore-click"])':"touchpointMouseup",'mouseup a[data-touchpoint]:not([data-navigation="ignore-click"])':"touchpointMouseup",'mousedown a[data-keep-options]:not([data-touchpoint]):not([data-navigation="ignore-click"])':"keepOptionsMousedown",'mousedown a:not([data-touchpoint]):not([data-navigation="ignore-click"])':"fixNoPushStateLink",'touchstart a:not([data-touchpoint]):not([data-navigation="ignore-click"])':"fixNoPushStateLink",'click a:not([data-navigation="ignore-click"])':"clickEventListener"});}};return b;});define("LiveOrder.Collection",["LiveOrder.Model"],function(a){return Backbone.Collection.extend({model:a});});define("LiveOrder.Model",["Order.Model","OrderLine.Model","OrderLine.Collection","ItemDetails.Model","Session"],function(b,d,c,a,e){var f={};f.Model=d.extend({urlRoot:_.getAbsoluteUrl("services/live-order-line.ss")});f.Collection=c.extend({model:f.Model,url:_.getAbsoluteUrl("services/live-order-line.ss")});return b.extend({urlRoot:_.getAbsoluteUrl("services/live-order.ss"),linesCollection:f.Collection,url:function(){var g=b.prototype.url.apply(this,arguments);return g+"&t="+new Date().getTime();},initialize:function(){b.prototype.initialize.apply(this,arguments);this.on("change:touchpoints",function(g,h){e.set("touchpoints",h);});},getLatestAddition:function(){var g=null;if(this.get("latest_addition")){g=this.get("lines").get(this.get("latest_addition"));}if(!g&&this.get("lines").length){g=this.get("lines").at(0);}return g;},wrapOptionsSuccess:function(i){var g=this,h=this.application;i=i||{};i.success=_.wrap(i.success||jQuery.noop,function(n,k,j){var m=j;if(_.isString(j)){m=k;}g.set(m);n.apply(g,_.toArray(arguments).slice(1));var l=g.get("lines").get(g.get("latest_addition")),o=l&&l.get("item");o&&h&&h.trackEvent&&h.trackEvent({category:"add-to-cart",action:"button",label:o.get("_url")+o.getQueryString(),value:1});});i.killerId=h&&h.killerId;return i;},addItem:function(h,g){return this.addItems([h],g);},addItems:function(l,o){var g=this.linesCollection;var p=_.map(l,function(r){var q=r.getItemOptionsForCart();return{item:{internalid:r.get("internalid")},quantity:r.get("quantity"),options:_.values(q).length?q:null};});var m=this,i=new g(p);if(this.optimistic){var k=this.optimistic.item.getPrice(),h=new d({quantity:this.optimistic.quantity,item:this.optimistic.item.attributes,rate_formatted:k.price_formatted,rate:k.price});h.get("item").itemOptions=this.optimistic.item.itemOptions;if(m.application.loadCart().state()==="resolved"){var j=SC.Utils.findItemInCart(m.optimistic.item,m.application.getCart());if(j){j.set("quantity",j.get("quantity")+parseInt(this.optimistic.quantity,10));h=j;}else{this.get("lines").add(h);}}else{h.set("quantity",0);}this.optimisticLine=h;this.trigger("change");}var n=i.sync("create",i,this.wrapOptionsSuccess(o));if(n){n.fail(function(){if(m.optimistic){if(m.application.loadCart().state()==="resolved"){var q=SC.Utils.findItemInCart(m.optimistic.item,m.application.getCart());if(q){q.set("quantity",q.get("quantity")-parseInt(m.optimistic.quantity,10));if(!q.get("quantity")){m.get("lines").remove(q);}}m.set("latest_addition",m.get("latest_addition_original"));m.trigger("change");}}});}return n;},updateItem:function(j,k,i){var g=this.get("lines").get(j),h=k.getItemOptionsForCart();g.set({quantity:k.get("quantity"),options:_.values(h).length?h:null});g.ongoingPromise=g.save({},this.wrapOptionsSuccess(i));return g.ongoingPromise;},updateLine:function(g,h){g.set("quantity",parseInt(g.get("quantity"),10));g.ongoingPromise=g.save({},this.wrapOptionsSuccess(h));return g.ongoingPromise;},removeLine:function(g,h){g.ongoingPromise=g.destroy(this.wrapOptionsSuccess(h));return g.ongoingPromise;},submit:function(){this.set("internalid",null);var g=this,h=this.get("paymentmethods").findWhere({type:"creditcard"}),i=this.get("paymentmethods").findWhere({type:"paypal"});if(h&&!h.get("creditcard")){this.get("paymentmethods").remove(h);}if(i&&!i.get("complete")){this.get("paymentmethods").remove(i);}return this.save().fail(function(){g.set("internalid","cart");}).done(function(){g.application.trackEvent&&g.application.trackEvent({category:"place-order",action:"button",label:"",value:1});});},save:function(){if(this.get("confirmation")){return jQuery.Deferred().resolve();}return b.prototype.save.apply(this,arguments);},getTotalItemCount:function(){return _.reduce(this.get("lines").pluck("quantity"),function(g,h){return g+(parseFloat(h)||1);},0);},parse:function(g,h){if(h&&!h.parse){return;}return g;},getUnsetLines:function(){return this.get("lines").filter(function(g){return !g.get("shipaddress")&&g.get("isshippable");});},getNonShippableLines:function(){return this.get("lines").filter(function(g){return !g.get("isshippable");});},getSetLines:function(){return this.get("lines").filter(function(g){return g.get("shipaddress")&&g.get("isshippable");});},getShippableLines:function(){return this.get("lines").filter(function(g){return g.get("isshippable");});},getItemsIds:function(){return this.get("lines").map(function(g){return g.get("item").get("internalid");});},getIfThereAreDeliverableItems:function(){return this.get("lines").length!==this.getNonShippableLines().length;}});});define("Order.Model",["OrderLine.Collection","OrderShipmethod.Collection","Address.Collection","CreditCard.Collection","OrderPaymentmethod.Collection"],function(b,d,e,c,a){return Backbone.Model.extend({linesCollection:b,initialize:function(f){this.on("change:lines",function(h,g){h.set("lines",new h.linesCollection(g),{silent:true});});this.trigger("change:lines",this,f&&f.lines||[]);this.on("change:shipmethods",function(g,h){g.set("shipmethods",new d(h),{silent:true});});this.trigger("change:shipmethods",this,f&&f.shipmethods||[]);this.on("change:multishipmethods",function(h,g){if(g){_.each(_.keys(g),function(i){g[i]=new d(g[i],{silent:true});});}h.set("multishipmethods",g,{silent:true});});this.trigger("change:multishipmethods",this,f&&f.multishipmethods||[]);this.on("change:addresses",function(g,h){g.set("addresses",new e(h),{silent:true});});this.trigger("change:addresses",this,f&&f.addresses||[]);this.on("change:paymentmethods",function(g,h){g.set("paymentmethods",new a(h),{silent:true});});this.trigger("change:paymentmethods",this,f&&f.paymentmethods||[]);}});});define("OrderFulfillment.Collection",["OrderFulfillment.Model"],function(a){return Backbone.Collection.extend({model:a});});define("OrderFulfillment.Model",function(){return Backbone.Model.extend({});});define("OrderLine.Collection",["OrderLine.Model"],function(a){return Backbone.Collection.extend({model:a});});define("OrderLine.Model",["ItemDetails.Model"],function(a){return Backbone.Model.extend({initialize:function(b){this.on("change:item",function(c,d){c.set("minimumquantity",d.minimumquantity);c.set("item",new a(_.extend(d,{line_id:c.get("internalid"),options:c.get("options"),quantity:c.get("quantity"),minimumquantity:c.get("minimumquantity")})),{silent:true});});this.trigger("change:item",this,b&&b.item||{});this.on("error",function(e,f){var c=JSON.parse(f.responseText),d=c.errorDetails;if(d&&d.status==="LINE_ROLLBACK"){e.set("internalid",d.newLineId);}});_.extend(this,Backbone.Validation.mixin);},validation:{quantity:{fn:function(){if(this.get("quantity")<this.get("item").get("_minimumQuantity",true)){return _("The minimum quantity for this item is $(0).").translate(this.get("item").get("_minimumQuantity",true));}}}},toJSON:function(){var b=this.attributes.options;if(b instanceof Array){var d={};_.each(b,function(f){d[f.id.toLowerCase()]=f.value;});b=d;}var c=this.attributes.item.get("_matrixParent")&&this.attributes.item.get("_matrixParent").get("_id");return{item:{internalid:c?c:this.attributes.item.get("_id")},quantity:this.attributes.quantity,internalid:this.attributes.internalid,options:b,splitquantity:parseInt(this.attributes.splitquantity,10),shipaddress:this.attributes.shipaddress,shipmethod:this.attributes.shipmethod};},getPrice:function(){var b=this.attributes.item.getPrice();return{price:this.get("rate"),price_formatted:this.get("rate_formatted"),compare_price:b.compare_price,compare_price_formatted:b.compare_price_formatted};}});});define("OrderPaymentmethod.Collection",["OrderPaymentmethod.Model"],function(a){return Backbone.Collection.extend({model:a});});define("OrderPaymentmethod.Model",function(){return Backbone.Model.extend({getFormattedPaymentmethod:function(){return this.get("type");}});});define("OrderShipmethod.Collection",["OrderShipmethod.Model"],function(a){return Backbone.Collection.extend({model:a,comparator:"name"});});define("OrderShipmethod.Model",function(){return Backbone.Model.extend({getFormattedShipmethod:function(){return this.get("name");}});});define("PlacedOrder.Collection",["PlacedOrder.Model"],function(a){return Backbone.Collection.extend({model:a,url:"services/placed-order.ss",parse:function(b){this.totalRecordsFound=b.totalRecordsFound;this.recordsPerPage=b.recordsPerPage;return b.records;},update:function(c){var b=c.range||{};this.fetch({data:{filter:c.filter&&c.filter.value,sort:c.sort.value,order:c.order,from:b.from?new Date(b.from.replace(/-/g,"/")).getTime():null,to:b.to?new Date(b.to.replace(/-/g,"/")).getTime():null,page:c.page},reset:true,killerId:c.killerId});}});});define("PlacedOrder",["PlacedOrder.Model","PlacedOrder.Collection"],function(b,a){return{Model:b,Collection:a};});define("PlacedOrder.Model",["Order.Model","OrderFulfillment.Collection","ReturnAuthorization.Collection","Receipt.Collection"],function(a,d,b,c){return a.extend({urlRoot:"services/placed-order.ss",initialize:function(e){a.prototype.initialize.apply(this,arguments);this.on("change:fulfillments",function(g,f){g.set("fulfillments",new d(f),{silent:true});});this.trigger("change:fulfillments",this,e&&e.fulfillments||[]);this.on("change:receipts",function(f,g){f.set("receipts",new c(g),{silent:true});});this.trigger("change:receipts",this,e&&e.receipts||[]);this.on("change:returnauthorizations",function(f,g){f.set("returnauthorizations",new b(g),{silent:true});});this.trigger("change:returnauthorizations",this,e&&e.returnauthorizations||[]);}});});define("OrderHistory",["OrderHistory.Views","OrderHistory.Router"],function(b,a){return{Views:b,Router:a,MenuItems:{id:"orders",name:_("Orders").translate(),index:1,children:[{id:"ordershistory",name:_("Order History").translate(),url:"ordershistory",index:1,permission:"transactions.tranFind.1,transactions.tranSalesOrd.1"}]},mountToApp:function(c){return new a(c);}};});define("OrderHistory.Router",["OrderHistory.Views","PlacedOrder.Model","PlacedOrder.Collection"],function(b,c,a){return Backbone.Router.extend({routes:{ordershistory:"ordersHistory","ordershistory?:options":"ordersHistory","ordershistory/view/:id":"orderDetails"},initialize:function(d){this.application=d;},ordersHistory:function(e){e=(e)?SC.Utils.parseUrlOptions(e):{page:1};e.page=e.page||1;var f=new a(),d=new b.List({application:this.application,page:e.page,collection:f});f.on("reset",d.showContent,d);d.showContent();},orderDetails:function(f){var e=new c({internalid:f}),d=new b.Details({application:this.application,id:f,model:e});e.on("change",d.showContent,d).fetch();}});});define("OrderHistory.Views",["ItemDetails.Model","TrackingServices","ListHeader","ReturnAuthorization.GetReturnableLines"],function(c,b,f,d){var e={};var a=function(i){i.preventDefault();i.stopPropagation();var g=this.$(i.target),h=this.$(g.data("content-selector")).html();g.popover({content:h+'<a class="close" href="#">&times;</a>',trigger:"manual",html:true}).popover("toggle");jQuery(document.body).one("click",".popover .close",function(j){j.preventDefault();g.popover("hide");});};e.Details=Backbone.View.extend({template:"order_details",title:_("Order Details").translate(),page_header:_("Order Details").translate(),attributes:{"class":"OrderDetailsView"},events:{"click [rel=clickover]":"showTrakingNumbers","click [data-re-order-item-link]":"reorderItem",'click [data-type="info-returns"] a':"goToReturns"},getReturnAuthorizations:function(){var h=this.model.get("returnauthorizations"),g=0;h.each(function(i){g+=i.get("lines")?i.get("lines").length:0;});h.totalLines=g;return h;},getNonShippableItems:function(){var g=this;if(!this.non_shippable){this.non_shippable=[];this.model.get("lines").each(function(h){if(!h.get("isfulfillable")){g.non_shippable.push(h);}});}return this.non_shippable;},getFulfillmentAddresses:function(){var g=this;if(!this.fulfillmentAddresses){this.fulfillmentAddresses=[];var h=this.model.get("shipaddress")&&this.model.get("addresses").get(this.model.get("shipaddress"))?this.model.get("shipaddress"):null;if(h){g.fulfillmentAddresses.push(h);}else{this.model.get("fulfillments").each(function(i){g.fulfillmentAddresses.push(i.get("shipaddress"));});this.fulfillmentAddresses=_.uniq(this.fulfillmentAddresses);}}return this.fulfillmentAddresses;},getFulfillments:function(g){var i=[];var h=this;this.model.get("fulfillments").each(function(j){if((h.model.get("shipaddress")||j.get("shipaddress")===g)&&!j.get("is_pending")){_.each(j.get("lines"),function(k){h.model.get("lines").each(function(l){if(l.get("internalid")===k.line_id){k.rate=l.get("amount");k.partial_quantity=k.quantity;k.quantity=l.get("quantity");}});});i.push(j);}});return i;},getUnfulfilled:function(){var g=this;if(!this.unfulfilled){this.unfulfilled=[];this.model.get("lines").each(function(h){if(!h.get("isfulfillable")){return false;}var j=parseInt(h.get("quantity"),10);g.model.get("fulfillments").each(function(k){_.each(k.get("lines"),function(l){if(h.get("internalid")===l.line_id){j-=l.quantity;}});});if(j>0){var i=new Backbone.Model(h.attributes);i.set("partial_quantity",j);i.set("item",h.get("item"));g.unfulfilled.push(i);}});}return this.unfulfilled;},showContent:function(){this.application.getLayout().showContent(this,"ordershistory",[{text:_("Order History").translate(),href:"/ordershistory"},{text:"#"+this.model.get("order_number"),href:"/ordershistory/view/"+this.model.get("id")}]);},showTrakingNumbers:a,trackEventReorderAll:function(h){var g=this;0<h.length&&h.forEach(function(i){g.trackEventReorder(i);});},trackEventReorder:function(h){var g=this.options.application;h&&g.trackEvent&&g.trackEvent({category:"Reorder",action:"button",label:h.get("_url")+h.getQueryString(),value:1});},goToCart:function(){window.location=this.options.application.getConfig("siteSettings.touchpoints.viewcart");},reorderItem:function(k){k.preventDefault();var i=this,h=this.$(k.target),g=this.model.get("lines").get(this.$(k.target).data("re-order-item-link")),j=new c({internalid:g.get("item").get("internalid"),quantity:h.data("partial-quantity"),options:g.get("options")});this.application.getCart().addItem(j).done(function(){i.trackEventReorder(j);jQuery("p.success-message").remove();var l=jQuery("<p/>").addClass("success-message"),m=j.get("quantity");if(m>1){l.html(_('$(0) items successfully added to <a href="#" data-touchpoint="viewcart">your cart</a></br>').translate(m)).insertAfter(h);}else{l.html(_('Item successfully added to <a href="#" data-touchpoint="viewcart">your cart</a></br>').translate()).insertAfter(h);}setTimeout(function(){l.fadeOut(function(){l.remove();});},3500);});},goToReturns:function(h){h.preventDefault();var g=this.$("div.returnauthorizations-details-header").first();g.find("div.well-secundary a.pull-right i").addClass("icon-minus");this.$("div.returnauthorizations-details-body").show();jQuery("html, body").animate({scrollTop:g.offset().top},500);},initialize:function(g){this.application=g.application;},getTrackingServiceName:function(g){return b.getServiceName(g);},getTrackingServiceUrl:function(g){return b.getServiceUrl(g);},isReturnable:function(){var g=new d(this.model);return this.model.get("isReturnable")&&g.calculateLines().validLines.length;}});e.List=Backbone.View.extend({template:"order_history",title:_("Order History").translate(),className:"OrderListView",page_header:_("Order History").translate(),attributes:{"class":"OrderListView"},events:{'click [data-action="navigate"]':"navigateToOrder"},showContent:function(){this.application.getLayout().showContent(this,"ordershistory",[{text:this.title,href:"/ordershistory"}]);},showTrakingNumbers:a,getTrackingServiceUrl:function(g){return b.getServiceUrl(g);},getTrackingServiceName:function(g){return b.getServiceName(g);},initialize:function(h){this.application=h.application;this.collection=h.collection;var g=_.dateToString(new Date());this.rangeFilterOptions={fromMin:"1800-01-02",fromMax:g,toMin:"1800-01-02",toMax:g};this.listenCollection();this.listHeader=new f({view:this,application:this.application,collection:this.collection,sorts:this.sortOptions,rangeFilter:"date",rangeFilterLabel:_("From").translate()});},navigateToOrder:function(g){g.preventDefault();if(!jQuery(g.target).closest('[data-type="accordion"]').length){var h=jQuery(g.target).closest('[data-action="navigate"]').data("id");Backbone.history.navigate("#ordershistory/view/"+h,{trigger:true});}},listenCollection:function(){this.setLoading(true);this.collection.on({request:jQuery.proxy(this,"setLoading",true),reset:jQuery.proxy(this,"setLoading",false)});},setLoading:function(g){this.isLoading=g;},sortOptions:[{value:"date",name:_("Sort By Date").translate(),selected:true},{value:"number",name:_("Sort By Number").translate()},{value:"amount",name:_("Sort By Amount").translate()}]});return e;});define("ReturnAuthorization.Collection",["ReturnAuthorization.Model"],function(a){return Backbone.Collection.extend({model:a,url:"services/return-authorization.ss",parse:function(b){this.totalRecordsFound=b.totalRecordsFound;this.recordsPerPage=b.recordsPerPage;return b.records;},update:function(c){var b=c.range||{},e=b.from&&_.stringToDate(b.from),d=b.to&&_.stringToDate(b.to);this.fetch({data:{sort:c.sort.value,order:c.order,from:e?e.getTime():null,to:d?d.getTime():null,page:c.page},reset:true,killerId:c.killerId});}});});define("ReturnAuthorization.GetReturnableLines",function(){var a=function(c,b){var d={notConsiderFulfillments:false};this.options=_.extend(d,b);this.createdFrom=c;this.line_ids={};};_.extend(a.prototype,{initialize:function(){var b=this.createdFrom.get("lines");b.each(function(c){this.line_ids[c.id]=this.options.notConsiderFulfillments?c.get("quantity"):0;},this);return this;},_setFulfilledQuantities:function(){var e=this.createdFrom,b=e.get("lines"),c=this,d=e.get("fulfillments");if(d){d.each(function(f){_.each(f.get("lines"),function(g){var h=b.get(g.line_id);if(h){c.line_ids[h.id]+=parseFloat(g.quantity);}});});}return this;},_setReturnedQuantities:function(){var d=this.createdFrom,c=this,b=d.get("lines");d.get("returnauthorizations").each(function(e){e.get("lines").each(function(f){var g=f.get("item").id,h=b.find(function(i){return i.get("item").id===g;});c.line_ids[h.id]+=parseFloat(f.get("quantity"));});});return this;},_setInvalidLines:function(){var g=[],f={},d=[],e=this.createdFrom,c=this,b=e.get("lines");_.each(_.keys(this.line_ids),function(h){var i=b.get(h);if(c.line_ids[h]&&i.get("item").get("_isReturnable")){g.push(i);f[h]=c.line_ids[h];}else{d.push(i);}});return{validLines:g,invalidLines:d,validLineIdsQuantities:f};},calculateLines:function(){if(!this.options.notConsiderFulfillments){return this.initialize()._setFulfilledQuantities()._setReturnedQuantities()._setInvalidLines();}return this.initialize()._setReturnedQuantities()._setInvalidLines();}});return a;});define("ReturnAuthorization",["ReturnAuthorization.Model","ReturnAuthorization.Collection","ReturnAuthorization.Views","ReturnAuthorization.Router"],function(d,b,c,a){return{Model:d,Collection:b,Views:c,Router:a,MenuItems:{parent:"orders",id:"returns",name:_("Returns").translate(),url:"returns",index:2,permission:"transactions.tranFind.1,transactions.tranRtnAuth.1"},mountToApp:function(e){return new this.Router(e);}};});define("ReturnAuthorization.Model",["OrderLine.Collection"],function(a){return Backbone.Model.extend({urlRoot:"services/return-authorization.ss",initialize:function(b){this.on("change:lines",function(d,c){d.set("lines",new a(c),{silent:true});});this.trigger("change:lines",this,b&&b.lines||[]);}});});define("ReturnAuthorization.Router",["ReturnAuthorization.Model","ReturnAuthorization.Collection","ReturnAuthorization.Views"],function(c,a,b){return Backbone.Router.extend({routes:{returns:"list","returns?:options":"list","returns/:id":"details","returns/:id?:options":"details","returns/new/:type/:id":"form","returns/new/:id":"confirmation"},initialize:function(d){this.application=d;},list:function(e){var f=_.parseUrlOptions(e),g=new a(),d=new b.List({application:this.application,collection:g,page:f.page});if(f.cancel){d.message=_("Good! Your request was successfully cancelled.").translate();Backbone.history.navigate(_.removeUrlParameter(Backbone.history.fragment,"cancel"),{replace:true});}g.on("reset",jQuery.proxy(d,"showContent","returns"));d.showContent("returns");},details:function(f){var e=new c({internalid:f}),d=new b.Detail({application:this.application,model:e});e.fetch().then(jQuery.proxy(d,"showContent","returns"));},form:function(g,i){var h=this.getCreatedFrom(g,i),f=this.application,e=new c(),d=new b.Form({application:f,model:e,createdFrom:h});h.fetch().then(jQuery.proxy(d,"showContent"));e.on("save",function(){new b.Confirmation({application:f,model:e}).showContent("returns");Backbone.history.navigate("/returns/new/"+e.get("internalid"),{trigger:false});});},confirmation:function(f){var e=new c({internalid:f}),d=new b.Confirmation({application:this.application,model:e});e.fetch().then(jQuery.proxy(d,"showContent","returns"));},getCreatedFrom:function(d,f){var e=null;if(d==="invoice"){e=require("Invoice.Model");}else{if(d==="order"){e=require("PlacedOrder.Model");}}return new e({internalid:f});}});});define("ReturnAuthorization.Views.Cancel",function(){return Backbone.View.extend({template:"return_authorization_cancel",title:_("Cancel Return Request").translate(),page_header:_("Cancel Return Request").translate(),events:{'click [data-action="delete"]':"confirm"},initialize:function(a){this.application=a.application;},confirm:function(){this.model.save({status:"cancelled"}).then(jQuery.proxy(this,"dismiss"));},dismiss:function(){this.$containerModal.modal("hide");}});});define("ReturnAuthorization.Views.Confirmation",function(){return Backbone.View.extend({template:"return_authorization_confirmation",title:_("Request Return").translate(),page_header:_("Confirmation").translate(),page_title:_("Request Return").translate(),attributes:{"class":"ReturnAuthorizationConfirmation"},initialize:function(a){this.application=a.application;},showContent:function(){this.application.getLayout().showContent(this,"returns",[{text:this.title,href:"/returns"}]);},getCreatedFromLabel:function(){return this.model.get("createdfrom").type==="SalesOrd"?"Order":"Invoice";}});});define("ReturnAuthorization.Views.Detail",["ReturnAuthorization.Views.Cancel"],function(a){return Backbone.View.extend({template:"return_authorization_detail",title:_("Return Details").translate(),events:{'click [data-action="cancel"]':"cancel"},attributes:{"class":"ReturnAuthorizationDetail"},initialize:function(b){this.application=b.application;},showContent:function(){var b=this.model.get("tranid"),c=_('Return request <span class="strong-text return-number">#$(0)</span>').translate(b);this.page_title=c;this.page_header=c;this.application.getLayout().showContent(this,"returns",[{text:_("Returns").translate(),href:"/returns"},{text:_("Return").translate()+" #"+b,href:"/returns"}]);},getLinkedRecordUrl:function(){var b=this.model.get("createdfrom");return b?(b.type==="SalesOrd"?"/ordershistory/view/":"/invoices/")+b.internalid:"";},getCreatedFromLabel:function(){var b=this.model.get("createdfrom");return b?b.type==="SalesOrd"?"Order":"Invoice":"";},cancel:function(){new a({application:this.application,model:this.model}).showInModal("returns");this.model.once("sync",jQuery.proxy(this,"redirect"));},redirect:function(){Backbone.history.navigate("returns?cancel="+this.model.get("internalid"),{trigger:true});}});});define("ReturnAuthorization.Views.Form",["ListHeader","OrderLine.Collection","ReturnAuthorization.GetReturnableLines"],function(c,b,a){return Backbone.View.extend({template:"return_authorization_form",title:_("Return Products").translate(),page_header:_("Return Products").translate(),events:{'click [data-type="return-line"]':"toggleLineHandler",'click [data-action="apply-reason"]':"applyReasonHandler",'change select[name="reason"]':"changeReasonHandler",'change input[name="quantity"]':"changeQuantityHandler",'change input[name="reason-text"]':"textReasonHandler",'change textarea[name="comments"]':"changeCommentHandler","submit form":"saveForm"},attributes:{"class":"ReturnAuthorizationForm"},initialize:function(d){this.application=d.application;this.createdFrom=d.createdFrom;this.reasons=this.application.getConfig("returnAuthorization.reasons")||[];this.createdFrom.on("sync",jQuery.proxy(this,"initListHeader"));},getLinkedRecordUrl:function(){var d=this.createdFrom;return(d.get("type")==="salesorder"?"/ordershistory/view/":"/invoices/")+d.get("internalid");},initListHeader:function(){var d=this.getLines();this.listHeader=new c({view:this,application:this.application,collection:d,selectable:true,classes:"list-header-slim"});if(d.length===1){this.selectAll();}return this;},showContent:function(){this.application.getLayout().showContent(this,"returns","returns",true);return this;},getLineId:function(d){return this.$(d).closest('[data-type="return-line"]').data("id");},selectAll:function(){return this.setLines({checked:true}).showContent();},unselectAll:function(){return this.setLines({reason:null,checked:false,returnQty:null,textReason:null}).showContent();},setLines:function(d){this.getLines().each(function(e){e.set(d);});return this;},setActiveLines:function(d){_.each(this.getActiveLines(),function(e){e.set(d);});return this;},toggleLineHandler:function(f){var d=this.$(f.target);if(d.data("toggle")!==false){this.toggleLine(this.getLineId(d));}},toggleLine:function(e){var d=this.getLine(e);d.set("checked",!d.get("checked"));if(!d.get("checked")){d.set({reason:null,returnQty:null,textReason:null});}return this.showContent();},parseLines:function(){var f=new a(this.createdFrom),d=f.calculateLines(),e=this.createdFrom.get("lines");this.createdFrom.set("invalidLines",new b(d.invalidLines));e.remove(d.invalidLines);e.each(function(g){g.set("quantity",d.validLineIdsQuantities[g.id]);});return this;},getLines:function(){return this.lines||(this.lines=this.parseLines().createdFrom.get("lines"));},getLine:function(d){return this.getLines().get(d);},getActiveLines:function(){return this.getLines().filter(function(d){return d.get("checked");});},getTotalItemsToReturn:function(){return _.reduce(this.getActiveLines(),function(e,d){return e+parseFloat(d.get("returnQty")||d.get("quantity"));},0);},changeQuantityHandler:function(g){var f=g.target,d=this.getLineId(f);return this.setLine(d,"returnQty",Math.min(f.value,this.getLine(d).get("quantity"))).showContent();},changeReasonHandler:function(g){var f=g.target,d=this.getLineId(f);this.setLine(d,"reason",f.value).showContent();this.$('[data-type="return-line"][data-id="'+d+'"] input[name="reason-text"]').focus();},textReasonHandler:function(f){var d=f.target;return this.setLine(this.getLineId(d),"textReason",d.value);},changeCommentHandler:function(d){this.comments=d.target.value;return this;},setLine:function(f,d,e){this.getLine(f).set(d,e);return this;},applyReasonHandler:function(f){var d=this.getLine(this.getLineId(f.target));f.preventDefault();f.stopPropagation();return this.setActiveLines({reason:d.get("reason"),textReason:d.get("textReason")}).showContent();},saveForm:function(g){var f=this.createdFrom,d={id:f.get("internalid"),type:f.get("type"),lines:this.getActiveLinesData(),comments:this.getComments()};g.preventDefault();if(this.isValid(d)){return Backbone.View.prototype.saveForm.call(this,g,this.model,d);}},isValid:function(g){var e=this,d=g.lines,i=g.comments,h=_.filter(d,function(j){return !j.reason;}),f=_.filter(d,function(j){return j.reason&&j.reason.length>4000;});if(!d.length){return this.showError("You must select at least one item for this return request.");}if(h.length){_.each(h,function(j){e.$('[data-id="'+j.id+'"] .control-group').addClass("error");});return this.showError("You must select a reason for return.");}if(f.length){_.each(f,function(j){e.$('[data-id="'+j.id+'"] .control-group').addClass("error");});return this.showError("The reason contains more that the maximum number (4000) of characters allowed.");}if(i&&i.length>999){return this.showError("The comment contains more than the maximum number (999) of characters allowed.");}return true;},getActiveLinesData:function(){var d=null;return _.map(this.getActiveLines(),function(e){d=e.get("reason");return{id:e.get("internalid"),quantity:e.get("returnQty")||e.get("quantity"),reason:d==="other"?e.get("textReason"):d};});},getComments:function(){return this.comments||"";},getDetailsMacro:function(d){return function(){return SC.macros.itemActionsEditQuantity({isActive:d.get("checked"),returnQuantity:d.get("returnQty"),lineQuantity:d.get("quantity")});};},getActionsMacro:function(d){var e=this.getActiveLines(),f=this.reasons;return function(){return SC.macros.itemActionsReasonsSelector({isActive:d.get("checked"),reasons:f,selectedReason:d.get("reason"),textReason:d.get("textReason"),active_lines_length:e.length});};}});});define("ReturnAuthorization.Views",["ReturnAuthorization.Views.List","ReturnAuthorization.Views.Detail","ReturnAuthorization.Views.Form","ReturnAuthorization.Views.Confirmation","ReturnAuthorization.Views.Cancel"],function(d,a,c,e,b){return{List:d,Detail:a,Form:c,Confirmation:e,Cancel:b};});define("ReturnAuthorization.Views.List",["ListHeader"],function(a){return Backbone.View.extend({template:"return_authorization_list",className:"ReturnAuthorizationList",title:_("Returns").translate(),page_header:_("Return requests").translate(),attributes:{"class":"ReturnAuthorizationList"},initialize:function(d){var c=d.application;this.application=c;this.listenCollection();var b=_.dateToString(new Date());this.rangeFilterOptions={fromMin:"1800-01-02",fromMax:b,toMin:"1800-01-02",toMax:b};this.listHeader=new a({view:this,application:c,collection:this.collection,sorts:this.sortOptions,rangeFilter:"date",rangeFilterLabel:_("Requested from").translate(),listHeaderId:"returns"});},listenCollection:function(){this.setLoading(true);this.collection.on({request:jQuery.proxy(this,"setLoading",true),reset:jQuery.proxy(this,"setLoading",false)});},setLoading:function(b){this.isLoading=b;},sortOptions:[{value:"date",name:_("Sort by Date").translate(),selected:true},{value:"number",name:_("Sort by Number").translate()}]});});define("OrderItem.Collection",["OrderItem.Model"],function(a){return Backbone.Collection.extend({url:"services/orderitems.ss",model:a,parse:function(b){this.totalRecordsFound=b.totalRecordsFound;this.recordsPerPage=b.recordsPerPage;return b.records;},update:function(b,e){var d={sort:b.sort.value,order_id:this.order_id,order:b.order,page:b.page};if(!this.order_id){var c=b.filter.value.apply(e.view);c=c&&c.split("T");d.from=c[0]?_.stringToDate(c[0]).getTime():null;d.to=c[1]?_.stringToDate(c[1]).getTime():null;}this.fetch({data:d,reset:true,killerId:b.killerId});}});});define("OrderItem",["OrderItem.Views","OrderItem.Model","OrderItem.Router","OrderItem.Collection"],function(c,d,a,b){return{Views:c,Model:d,Router:a,Collection:b,MenuItems:{parent:"orders",id:"reorderitems",name:_("Reorder Items").translate(),url:"reorderItems",index:4,permission:"transactions.tranFind.1,transactions.tranSalesOrd.1"},mountToApp:function(e){this.application=e;return new a(e);}};});define("OrderItem.Model",["ItemDetails"],function(a){return Backbone.Model.extend({urlRoot:"services/orderitems.ss",validation:{},parse:function(b){if(b.item){b.id=b.item.internalid;b.internalid=b.item.internalid+"|"+JSON.stringify(b.options_object);b.item=new a.Model(b.item);}return b;}});});define("OrderItem.Router",["OrderItem.Views","OrderItem.Collection"],function(b,a){return Backbone.Router.extend({routes:{reorderItems:"reorderItems","reorderItems?:options":"reorderItems"},initialize:function(c){this.application=c;},reorderItems:function(d){if(d){d=SC.Utils.parseUrlOptions(d);}else{d={page:1};}var e=new a(),c=new b.ReorderList({application:this.application,sort:d.sort||0,order_id:d.order_id||0,page:d.page||1,collection:e});if(c.order_id){e.setParameters({order_id:c.order_id});}c.collection.on("reset",c.render,c);c.showContent();}});});define("OrderItem.Views",["ItemDetails.Model","ListHeader"],function(a,c){var b={};b.ReorderList=Backbone.View.extend({template:"reorder_items",className:"OrderItemReorderListView",title:_("Reorder Items").translate(),page_header:_("Reorder Items").translate(),attributes:{"class":"OrderItemReorderListView"},events:{"click .add-to-cart-btn":"orderItems",'change [data-toggle="quantity"]':"setQuantity",'blur [data-toggle="quantity"]':"validateItemQuantity"},initialize:function(d){if(d.order_id){this.basePath="reorderItems/order/"+d.order_id+"/";this.collection.order_id=d.order_id;}else{this.basePath="reorderItems/";}this.listenCollection();this.listHeader=new c({view:this,application:d.application,collection:this.collection,filters:d.order_id?null:this.filterOptions,sorts:d.order_id?this.sortOptionsSingleOrder:this.sortOptions,showCurrentPage:true});if(d.order_id){this.listHeader.on("afterViewRender",this.attachOrderLink,this);}},attachOrderLink:function(){if(this.collection.length){this.listHeader.$el.removeClass("hidden");var d=jQuery("<a/>").addClass("pull-left").attr("href","/ordershistory/view/"+this.options.order_id).html(_("Order Number: #$(0)").translate(this.collection.at(0).get("tranid"))).wrap("<div></div>").parent();this.listHeader.$(".paginator-content").prepend(d.html());}else{this.listHeader.$el.addClass("hidden");}},validateItemQuantity:function(g){var h=jQuery(g.target),f=parseInt(h.val(),10)||1,d=h.data("line-id");h.val(f);this.collection.get(d).get("item").set("quantity",f);},listenCollection:function(){this.setLoading(true);this.collection.on({request:jQuery.proxy(this,"setLoading",true),reset:jQuery.proxy(this,"setLoading",false)});},getItemExtraDetailsMacro:function(d){return function(){return d.get("trandate")?'<p class="text-light">'+_("Last purchased on $(0)").translate(d.get("trandate"))+"</p>":"";};},getItemDetailsMacro:function(d){return function(){return SC.macros.itemActionsReturnQuantity({lineId:d.id,item:d.get("item"),itemQuantity:d.get("item").get("quantity"),parentInternalId:d.get("item").get("parent_internalid"),formatOptions:d.get("options_object")});};},setLoading:function(d){this.isLoading=d;},setQuantity:function(g){var h=jQuery(g.target),f=h.val(),d=h.data("line-id");this.collection.get(d).get("item").set("quantity",f);},showContent:function(){if(Backbone.history.getHash().indexOf("reorderItems")===-1){return;}var f=[{text:this.title,href:"/reorderItems"}];if(this.options.order_id&&this.collection.at(0)&&this.collection.at(0).get("order_number")){var e=this.collection.at(0).get("order_number");this.title=_("Reorder Items from Order #$(0)").translate(e);f.push({text:_("Order #$(0)").translate(e),href:"/reorderItems/order/"+this.options.order_id});}var d=true;this.options.application.getLayout().showContent(this,"reorderitems",f,d);},trackEventReorder:function(e){var d=this.options.application;e&&d.trackEvent&&d.trackEvent({category:"Reorder",action:"button",label:e.get("_url")+e.getQueryString(),value:1});},orderItems:function(g){g.preventDefault();var m=this,i=this.options.application,n=this.$(g.target).closest(".reorder-item-line-container"),k=n.data("id"),j=this.collection.get(k),h=j.get("item"),f=n.find("input[name=item_quantity]"),d;h.setOptionsArray(j.get("options_object"),true);h.set("quantity",parseInt(f.val(),10)||1);d=h;if(parseInt(d.get("quantity"),10)>0||isNaN(d.get("quantity"))){if(isNaN(d.get("quantity"))){d.set("quantity",1);}i.getCart().addItem(d).done(function(){m.trackEventReorder(d);jQuery("p.success-message").remove();var e=jQuery("<p/>");if(d.get("quantity")>1){e.addClass("success-message pull-right").html(_('$(0) Items successfully added to <a href="#" data-touchpoint="viewcart">your cart</a><br/>').translate(d.get("quantity"))).wrap('<div class="row-fluid"></div>').parent().appendTo(n);}else{e.addClass("success-message pull-right").html(_('Item successfully added to <a href="#" data-touchpoint="viewcart">your cart</a></br>').translate()).wrap('<div class="row-fluid"></div>').parent().appendTo(n);}setTimeout(function(){e.fadeOut(function(){e.remove();});},6000);});}else{jQuery("p.success-message").remove();var l=jQuery("<p/>");l.addClass("success-message pull-right").html(_("The number of items must be positive.").translate()).wrap('<div class="row-fluid"></div>').parent().appendTo(n);}},getStringDateFromDaysCount:function(e){var d=new Date();return new Date(d.setDate(d.getDate()-e));},sortOptionsSingleOrder:[{value:"price",name:_("By Price").translate(),selected:true},{value:"name",name:_("By Name").translate()}],sortOptions:[{value:"quantity",name:_("By Frequently Purchased").translate(),selected:true},{value:"date",name:_("By Most Recently Purchased").translate()},{value:"price",name:_("By Price").translate()},{value:"name",name:_("By Name").translate()}],filterOptions:[{value:function(){return _.dateToString(this.getStringDateFromDaysCount(15))+"T"+_.dateToString(new Date());},name:_("Show last 15 days").translate(),className:"reorder-items-filter-last-15-days",selected:true},{value:function(){return _.dateToString(this.getStringDateFromDaysCount(30))+"T"+_.dateToString(new Date());},name:_("Show last 30 days").translate(),className:"reorder-items-filter-last-30-days"},{value:function(){return _.dateToString(this.getStringDateFromDaysCount(60))+"T"+_.dateToString(new Date());},name:_("Show last 60 days").translate(),className:"reorder-items-filter-last-60-days"},{value:function(){return _.dateToString(this.getStringDateFromDaysCount(90))+"T"+_.dateToString(new Date());},name:_("Show last 90 days").translate(),className:"reorder-items-filter-last-90-days"},{value:function(){return _.dateToString(this.getStringDateFromDaysCount(180))+"T"+_.dateToString(new Date());},name:_("Show last 180 days").translate(),className:"reorder-items-filter-last-180-days"}]});return b;});define("Profile",["Profile.Views","Profile.Router","User.Model"],function(c,a,b){return{Views:c,Router:a,MenuItems:[{id:"home",name:_("Overview").translate(),url:"overview",index:0},{id:"settings",name:_("Settings").translate(),index:4,children:[{id:"profileinformation",name:_("Profile Information").translate(),url:"profileinformation",index:1},{id:"emailpreferences",name:_("Email Preferences").translate(),url:"emailpreferences",index:2},{id:"updateyourpassword",name:_("Update Your Password").translate(),url:"updateyourpassword",index:5}]}],mountToApp:function(d){var e=d.getLayout();d.UserModel=b.extend({urlRoot:"services/profile.ss"});d.getUser().on("change:name change:lastname change:companyname",function(){e.updateHeader();});return new a(d);}};});define("Profile.Router",["Profile.Views","PlacedOrder.Collection","Profile.UpdatePassword.Model"],function(c,b,a){return Backbone.Router.extend({routes:{"":"home",overview:"home",profileinformation:"profileInformation",emailpreferences:"emailPreferences",updateyourpassword:"updateYourPassword"},initialize:function(d){this.application=d;},home:function(){var e=new b(),d=new c.Home({application:this.application,model:this.application.getUser(),collection:e});e.fetch({data:{page:1,order:1,sort:"date",results_per_page:d.application.getConfig("homeRecentOrdersQuantity",3)},error:function(f,g){g.preventDefault=true;}}).always(function(){d.showContent();});},profileInformation:function(){var e=this.application.getUser(),d=new c.Information({application:this.application,model:e});d.useLayoutError=true;e.on("save",d.showSuccess,d);d.showContent();},emailPreferences:function(){var e=this.application.getUser(),d=new c.EmailPreferences({application:this.application,model:e});d.useLayoutError=true;e.on("save",d.showSuccess,d);d.showContent();},updateYourPassword:function(){var e=new a({current_password:"",confirm_password:"",password:""});e.set(this.application.getUser().attributes);var d=new c.UpdateYourPassword({application:this.application,model:e});d.useLayoutError=true;e.on("save",d.showSuccess,d);d.showContent();}});});define("Profile.UpdatePassword.Model",function(){return Backbone.Model.extend({urlRoot:"services/profile.ss",validation:{current_password:{required:true,msg:_("Current password is required").translate()},confirm_password:[{required:true,msg:_("Confirm password is required").translate()},{equalTo:"password",msg:_("New Password and Confirm Password do not match").translate()}],password:{required:true,msg:_("New  password is required").translate()}}});});define("Profile.Views",["TrackingServices"],function(a){var b={};b.Home=Backbone.View.extend({template:"home",title:_("Welcome!").translate(),attributes:{"class":"ProfileHomeView"},events:{},initialize:function(c){this.model=c.model;this.application=c.application;this.customerSupportURL=this.application.getConfig("customerSupportURL");this.model.on("change",this.showContent,this);this.addresses=this.model.get("addresses");this.creditcards=this.model.get("creditcards");this.addresses.on("reset destroy change add",this.showContent,this);this.creditcards.on("reset destroy change add",this.showContent,this);},destroy:function(){this.addresses.off(null,null,this);this.creditcards.off(null,null,this);this.offEventsOfDefaults();this._destroy();},offEventsOfDefaults:function(){this.defaultCreditCard&&this.defaultCreditCard.off(null,null,this);this.defaultShippingAddress&&this.defaultShippingAddress.off(null,null,this);},showContent:function(){this.offEventsOfDefaults();this.defaultShippingAddress=this.addresses.findWhere({defaultshipping:"T"});this.defaultCreditCard=this.creditcards.findWhere({ccdefault:"T"});this.defaultShippingAddress&&this.defaultShippingAddress.on("change",this.showContent,this);this.defaultCreditCard&&this.defaultCreditCard.on("change",this.showContent,this);this.title=this.model.get("firstname")?_("Welcome $(0)!").translate(this.model.get("firstname")):this.title;this.application.getLayout().showContent(this,"home",[]);},getTrackingServiceName:function(c){return a.getServiceName(c);},getTrackingServiceUrl:function(c){return a.getServiceUrl(c);}});b.Information=Backbone.View.extend({template:"profile_information",page_header:_("Profile Information").translate(),title:_("Profile Information").translate(),attributes:{"class":"ProfileInformationView"},events:{"submit form":"saveForm",'change form:has([data-action="reset"])':"toggleReset",'click [data-action="reset"]':"resetForm",'keyup form:has([data-action="reset"])':"toggleReset",'blur input[data-type="phone"]':"formatPhone"},formatPhone:function(d){var c=jQuery(d.target);c.val(_(c.val()).formatPhone());},resetForm:function(c){c.preventDefault();this.showContent();},showSuccess:function(){if(this.$savingForm){var c=_("Profile successfully updated!").translate();this.showContent();this.$('[data-type="alert-placeholder"]').append(SC.macros.message(c,"success",true));}},showContent:function(){this.options.application.getLayout().showContent(this,"profileinformation",[{text:this.title,href:"/profileinformation"}]);this.$("input.no-copy-paste").on("cut copy",function(c){c.preventDefault();});}});b.UpdateYourPassword=Backbone.View.extend({template:"profile_update_your_password",page_header:_("Update Your Password").translate(),title:_("Update Your Password").translate(),attributes:{"class":"ProfileUpdateYourPasswordView"},events:{"submit form":"updatePassword",'change form:has([data-action="reset"])':"toggleReset",'keyup form:has([data-action="reset"])':"toggleReset",'click [data-action="reset"]':"resetForm"},resetForm:function(c){c.preventDefault();this.showContent();},updatePassword:function(c){this.saveForm(c);},showSuccess:function(){if(this.$savingForm){var c=_("Password successfully updated!").translate();this.showContent();this.$('[data-type="alert-placeholder"]').html(SC.macros.message(c,"success",true));}},showContent:function(){this.options.application.getLayout().showContent(this,"updateyourpassword",[{text:this.title,href:"/updateyourpassword"}]);}});b.EmailPreferences=Backbone.View.extend({template:"email_preferences",title:_("Email Preferences").translate(),page_header:_("Email Preferences").translate(),attributes:{"class":"ProfileEmailPreferencesView"},events:{"submit form":"save",'change form:has([data-action="reset"])':"toggleReset",'click [data-action="reset"]':"resetForm",'keyup form:has([data-action="reset"])':"toggleReset","change #emailsubscribe":"emailSubscribeChange"},showContent:function(){this.options.application.getLayout().showContent(this,"emailpreferences",[{text:this.title,href:"emailpreferences"}]);},showSuccess:function(){if(this.$savingForm){this.showContent();this.$('[data-type="alert-placeholder"]').append(SC.macros.message(_("Email Preferences successfully saved!").translate(),"success",true));}},save:function(i){i.preventDefault();var c=jQuery(i.target),g=c.serializeObject(),h={},d=this.model.get("campaignsubscriptions");_.each(g,function(j,e){if(~e.indexOf("subscription-")){h[e.replace("subscription-","")]=(j==="T");}});_.each(d,function(e){e.subscribed=h[e.internalid];});var f={campaignsubscriptions:d,emailsubscribe:g.emailsubscribe==="T"};this.saveForm(i,this.model,f);},resetForm:function(c){c.preventDefault();this.showContent();},emailSubscribeChange:function(){var c=this,d=!c.$("#emailsubscribe").prop("checked");c.$("input[type=checkbox].subscription").prop("disabled",d);}});return b;});define("Receipt.Collection",["Receipt.Model"],function(a){return Backbone.CachedCollection.extend({model:a,url:"services/receipt.ss",initialize:function(){this.once("sync reset",function(){if(!this.original){this.original=this.clone();}});},clearFilters:function(){this.selectedFilter=null;this.selectedSort=null;this.order=null;this.range=null;},update:function(c){var d=this.selectedFilter!==c.filter,e=this.selectedSort!==c.sort,f=this.order!==c.order,b=!_.isEqual(c.range,this.range)&&(this.range||c.range);this.selectedFilter=c.filter;this.selectedSort=c.sort;this.order=c.order;this.range=c.range;if(d){this.applyFilter().applySort();}else{if(b){this.applyRangeFilter().applySort();}else{if(e){this.applySort();}else{if(f){this.reverseOrder();}}}}if(d||e||f||b){this.trigger("reset");}},applyFilter:function(){this.reset(this.selectedFilter.filter.call(this),{silent:true});return this;},fixDateRangeWithTimeZoneOffset:function(b){if(b){var e=new Date().getTimezoneOffset()*60*1000,g=_.stringToDate(b.from),f=_.stringToDate(b.to);if(_.isDateValid(g)&&_.isDateValid(f)){var d=new Date(f.getTime()+e),c=new Date(g.getTime()+e);d.setHours(23,59,59);c.setHours(0,0,0);return{from:c,to:d};}}},applyRangeFilter:function(){var b=this.fixDateRangeWithTimeZoneOffset(this.range)||{},d=b.from&&new Date(b.from).getTime(),c=b.to&&new Date(b.to).getTime();this.reset(this.original.filter(function(f){var e=new Date(f.get("tranDateInMilliseconds")).getTime();if(d&&!c){return e>=d;}if(!d&&c){return e<=c;}if(d&&c){return e>=d&&e<=c;}return true;}),{silent:true});return this;},applySort:function(){this.reset(this.selectedSort.sort.call(this),{silent:true});if(this.order===-1){this.reverseOrder();}return this;},reverseOrder:function(){this.reset(this.models.reverse(),{silent:true});return this;}});});define("Receipt",["Receipt.Views","Receipt.Model","Receipt.Router","Receipt.Collection"],function(c,d,a,b){return{Views:c,Model:d,Router:a,Collection:b,MenuItems:{parent:"orders",id:"receiptshistory",name:_("Receipts").translate(),url:"receiptshistory",index:3,permission:"transactions.tranFind.1,transactions.tranSalesOrd.1"},mountToApp:function(e){return new a(e);}};});define("Receipt.Model",["Order.Model"],function(a){var b=a.extend({urlRoot:"services/receipt.ss",expand:function(){if(this.expanded){this.trigger("expand",this);}else{var c=this;this.fetch().done(function(){c.expanded=true;c.trigger("expand",this);});}}});b.prototype.sync=Backbone.CachedModel.prototype.sync;b.prototype.addToCache=Backbone.CachedModel.prototype.addToCache;return b;});define("Receipt.Router",["Receipt.Views","Receipt.Model","Receipt.Collection"],function(b,c,a){return Backbone.Router.extend({routes:{"receiptshistory/view/:id":"receiptDetails",receiptshistory:"receiptsHistory","receiptshistory?:options":"receiptsHistory"},initialize:function(d){this.application=d;},receiptsHistory:function(){var e=new a(),d=new b.List({application:this.application,collection:e});e.on("reset",d.showContent,d).fetch({data:{type:"cashsale"},reset:true});},receiptDetails:function(f){var e=new c({internalid:f}),d=new b.Details({application:this.application,id:f,model:e});e.on("change",d.showContent,d).fetch();}});});define("Receipt.Views",["OrderHistory.Views","ListHeader"],function(a,c){var b={};b.Details=a.Details.extend({template:"receipt_details",title:_("Receipt Details").translate(),attributes:{"class":"OrderDetailsView"},showContent:function(){this.title=_("Receipt Details").translate();this.options.application.getLayout().showContent(this,"receiptshistory",[{text:_("Receipts").translate(),href:"/receiptshistory"},{text:_("Receipt").translate()+" #"+this.model.get("order_number"),path:"/receiptshistory/view/"+this.model.get("id")}]);}});b.List=Backbone.View.extend({template:"receipt_history",title:_("Receipts").translate(),page_header:_("Receipts").translate(),className:"OrderListView",attributes:{"class":"OrderListView"},initialize:function(e){this.application=e.application;this.collection=e.collection;var d=_.dateToString(new Date());this.rangeFilterOptions={fromMin:"1800-01-02",fromMax:d,toMin:"1800-01-02",toMax:d};this.listenCollection();this.listHeader=new c({view:this,application:e.application,collection:this.collection,sorts:this.sortOptions,rangeFilter:"date",rangeFilterLabel:_("From").translate()});this.collection.on("sync reset",jQuery.proxy(this,"render"));},listenCollection:function(){this.setLoading(true);this.collection.on({request:jQuery.proxy(this,"setLoading",true),reset:jQuery.proxy(this,"setLoading",false)});},setLoading:function(d){this.isLoading=d;},showContent:function(){this.options.application.getLayout().showContent(this,"receiptshistory",[{text:this.title,href:"/receiptshistory"}]);},sortOptions:[{value:"date",name:_("Sort By Date").translate(),sort:function(){return this.sortBy(function(d){return[d.get("tranDateInMilliseconds"),d.get("tranid")];});}},{value:"number",name:_("Sort By Number").translate(),sort:function(){return this.sortBy(function(d){return d.get("tranid");});}},{value:"amount",name:_("Sort By Amount").translate(),sort:function(){return this.sortBy(function(d){return d.get("summary").total;});}}]});return b;});define("Responsive",function(){return{mountToApp:function(a){a.getLayout().on("afterAppendView",function(){if(jQuery(window).width()<=767&&(Backbone.history.fragment===""||Backbone.history.fragment==="overview")){this.application.getLayout().$el.addClass("show-side-nav").removeClass("hide-side-nav");}else{this.application.getLayout().$el.addClass("hide-side-nav").removeClass("show-side-nav");}});}};});define("SiteSearch",["Facets.Translator","TypeAhead.Model","Session"],function(e,c,b){var a=function(){var h=[],f=SC.Utils.parseUrlOptions(window.location.href);_.each(f,function(k,i){var j=i.toLowerCase();if(j==="order"||j==="show"||j==="display"){h.push(j+"="+k);}});var g=h.join("&");if(g.length>0){g="&"+g;}return g;};var d={searchEventHandler:function(f){f.preventDefault();this.$search.find("input").data("typeahead").select();},seeAllEventHandler:function(g,f){this.search(f.query);},focusEventHandler:function(){this.$search.find("input").typeahead("lookup");},formatKeywords:function(i,h){var g=i.getConfig("searchPrefs.keywordsFormatter");if(g&&_.isFunction(g)){h=g(h);var f=i.getConfig("searchPrefs.maxLength")||99999;if(h.length>f){h=h.substring(0,f);}}return h;},search:function(f){var j=this.currentView;f=d.formatKeywords(this.getApplication(),f);if(this.getApplication().getConfig("isSearchGlobal")||!(j&&j.options.translator instanceof e)){var g=this.getApplication().getConfig("defaultSearchUrl"),i=this.typeaheadConfig.application.Configuration.facetDelimiters,h=i.betweenFacetsAndOptions+"keywords"+i.betweenOptionNameAndValue;if(this.getApplication().getConfig("currentTouchpoint")!=="home"){window.location.href=b.get("touchpoints.home")+"#"+g+h+f;}else{Backbone.history.navigate(g+h+f+a(),{trigger:true});this.$search.find("input").val("");}}else{Backbone.history.navigate(j.options.translator.cloneForOption("keywords",f).getUrl(),{trigger:true});}},processAnchorTags:function(m,l){var i,j,h,k,f=this,g=this.getApplication().getConfig("defaultSearchUrl");l.$menu.find("a").each(function(o,n){i=jQuery(n);j=i.parent().data("value");h=l.results[j];k=h?h.get("_url"):g+"?keywords="+j.replace("see-all-","")+a();i.attr({href:k}).data({touchpoint:"home",hashtag:(k.indexOf("/")===0)?k.replace("/",""):k}).click(function(){l.$menu.hide();});f.getApplication().getLayout().touchpointMousedown({currentTarget:i});});l.$menu.off("click");},typeaheadConfig:{source:function(g,h){var f=this;f.ajaxDone=false;this.model=this.model||this.options.model;this.labels=this.labels||this.options.labels;this.results=this.results||this.options.results;this.application=this.application||this.options.application;g=d.formatKeywords(this.application,jQuery.trim(g));if(g.length>=this.options.minLength){this.labels=["see-all-"+g];h(this.labels);}this.model.fetch({data:{q:g,sort:this.options.sort,limit:this.options.limit,offset:0},killerId:_.uniqueId("ajax_killer_")},{silent:true}).done(function(){f.ajaxDone=true;f.results={};f.labels=["see-all-"+g];f.model.get("items").each(function(i){f.results[i.get("_id")+g]=i;f.labels.push(i.get("_id")+g);});h(f.labels);f.$element.trigger("processed",f);});},matcher:function(f){return ~f.indexOf(d.formatKeywords(this.application,jQuery.trim(this.query)));},highlighter:function(i){var f="",h=this.options.macro,g=this.results[i];if(g){f=h&&SC.macros[h]?SC.macros[h](g,this.query,this.application):_.highlightKeyword(i,this.query);}else{if(_.size(this.results)){f="<strong>"+this.options.seeAllLabel+'<span class="hide">'+_(this.query).escape()+"</span></strong>";}else{if(this.ajaxDone){f="<strong>"+this.options.noResultsLabel+'<span class="hide">'+_(this.query).escape()+"</span></strong>";}else{f="<strong>"+this.options.searchingLabel+'<span class="hide">'+_(this.query).escape()+"</span></strong>";}}}return f;},updater:function(h){var f=this.$menu.find('li[data-value="'+h+'"] a'),g=f.attr("href");if(g&&g!=="#"){f.trigger("click");}return"";},labels:[],results:{},model:new c(),seeAllLabel:_("See all results").translate(),noResultsLabel:_("No results").translate(),searchingLabel:_("Searching...").translate()}};return{SiteSearch:d,mountToApp:function(g){var h=g.getLayout(),f=g.getConfig("typeahead");_.extend(h,d);_.extend(h.key_elements,{search:"#site-search-container"});h.updateUI();_.extend(h.events,{"submit #site-search-container form":"searchEventHandler","focus #site-search-container input":"focusEventHandler","seeAll #site-search-container input":"seeAllEventHandler","processed #site-search-container input":"processAnchorTags"});c.mountToApp(g);d.typeaheadConfig=_.extend(d.typeaheadConfig,{application:g,minLength:f.minLength,items:f.maxResults+1,macro:f.macro,limit:f.maxResults,sort:f.sort});h.on("afterRender",function(){h.$search.find("input").typeahead(d.typeaheadConfig);});}};});define("TypeAhead.Model",["ItemDetails.Collection","Session"],function(c,a){var b=Backbone.CachedModel.prototype.fetch;return Backbone.CachedModel.extend({url:function(){var d=_.addParamsToUrl("/api/items",_.extend({},this.searchApiMasterOptions,a.getSearchApiParams()));return d;},initialize:function(){this.on("change:items",function(e,d){if(!(d instanceof c)){e.set("items",new c(_.compact(d)));}});},fetch:function(d){d=d||{};d.cache=true;return b.apply(this,arguments);}},{mountToApp:function(d){this.prototype.searchApiMasterOptions=d.getConfig("searchApiMasterOptions.typeAhead");}});});define("Session",function(){return{get:function(b,a){return _.getPathFromObject(SC.getSessionInfo(),b,a);},set:function(b,a){SC.getSessionInfo()[b]=a;},getSearchApiParams:function(){var b={};var a=this.get("language.locale","");if(~a.indexOf("_")){var c=a.split("_");b.language=c[0];b.country=c[1];}else{b.language=a;}b.currency=this.get("currency.code","");b.pricelevel=this.get("priceLevel","");if(_.parseUrlOptions(location.search).nocache==="T"){b.nocache="T";}return b;}};});define("UrlHelper",function(){var d={url:"",listeners:{},parameters:{},setUrl:function(f){var e=this;this.url=f;this.parameters={};_.each(this.listeners,function(h,g){var i=e.getParameterValue(g);if(i){var j=_.isFunction(h)?h(i):h;if(j){if(_.isBoolean(j)){e.parameters[g]=i;}else{e.parameters[g]=j;}}}});},addTokenListener:function(e,f){this.listeners[e]=f;},getParameters:function(){return this.parameters;},getParameterValue:function(f){var e=this.url.match(f+"{1}\\={1}(.*?[^&#]*)");if(e&&e[1]){return e[1];}else{return"";}},clearValues:function(){this.url="";this.listeners={};this.parameters={};}};function c(f){if(!new RegExp("^http").test(f)){var g=d.getParameters(),e="",h="";_.each(g,function(j,k){h=f.match(new RegExp(k+"{1}\\={1}(.*?[^&]*)"));if(!h){e=~f.indexOf("?")?"&":"?";f+=e+k+"="+g[k];}});}return f;}function b(f,i,g){var h=f.match(new RegExp(i+"{1}\\={1}(.*?[^(&|#)]*)")),e="";if(h){return f.replace(h[0],i+"="+g);}else{e=~f.indexOf("?")?"&":"?";return f+e+i+"="+g;}}function a(e,g){var f=e.match(new RegExp("(\\?|&)"+g+"{1}\\={1}(.*?[^(&|#)]*)"));if(f){if(~f[0].indexOf("?")&&~e.indexOf("&")){return e.replace(f[0]+"&","?");}else{return e.replace(f[0],"");}}else{return e;}}_.extend(SC.Utils,{fixUrl:c,setUrlParameter:b,removeUrlParameter:a});_.mixin(SC.Utils);return _.extend(d,{mountToApp:function(f){var e=this;f.getLayout().on("afterAppendView",function(){e.setUrl(window.location.href);});}});});define("User.Model",["Address.Collection","CreditCard.Collection"],function(b,a){SC.ApplicationSkeleton.prototype.UserModel=Backbone.Model.extend({validation:{firstname:{required:true,msg:_("First Name is required").translate()},lastname:{required:true,msg:_("Last Name is required").translate()},email:{required:true,pattern:"email",msg:_("Valid Email is required").translate()},phone:{required:true,fn:_.validatePhone},companyname:{required:true,msg:_("Company Name is required").translate()},confirm_email:function(d,c,e){if(jQuery.trim(e.email)!==this.attributes.email&&jQuery.trim(d)!==jQuery.trim(e.email)){return _("Emails do not match match").translate();}},current_password:function(d,c,e){if(jQuery.trim(e.email)!==this.attributes.email&&(_.isNull(d)||_.isUndefined(d)||(_.isString(d)&&jQuery.trim(d)===""))){return _("Current password is required").translate();}}},initialize:function(c){this.on("change:addresses",function(d,e){d.set("addresses",new b(e),{silent:true});this.get("addresses").on("change:defaultshipping change:defaultbilling add destroy reset",this.checkDefaultsAddresses,this);});this.on("change:creditcards",function(e,d){e.set("creditcards",new a(d),{silent:true});this.get("creditcards").on("change:ccdefault add destroy reset",this.checkDefaultsCreditCard,this);});this.on("change:lastname",function(d){d.validation.lastname={required:true,msg:_("Last Name is required").translate()};});this.on("change:phone",function(d){d.validation.phone={required:false,fn:_.validatePhone};});this.on("change:balance",function(d){var e;if(typeof BigNumber!=="undefined"){e=BigNumber(d.get("creditlimit")).minus(d.get("balance"));}else{e=d.get("creditlimit")-d.get("balance");}d.set("balance_available",e);d.set("balance_available_formatted",_.formatCurrency(e));});this.set("addresses",c&&c.addresses||new b());this.set("creditcards",c&&c.creditcards||new a());},checkDefaultsAddresses:function(c){var e=this.get("addresses"),d=e.model;if(c instanceof d){if(c.get("defaultshipping")==="T"){_.each(e.where({defaultshipping:"T"}),function(f){if(c!==f){f.set({defaultshipping:"F"},{silent:true});}});}if(c.get("defaultbilling")==="T"){_.each(e.where({defaultbilling:"T"}),function(f){if(c!==f){f.set({defaultbilling:"F"},{silent:true});}});}}},checkDefaultsCreditCard:function(e){var c=this.get("creditcards"),f=c.model;if(e.get("ccdefault")==="T"){_.each(c.where({ccdefault:"T"}),function(g){if(g&&e!==g){g.set({ccdefault:"F"},{silent:true});}});}var d=c.find(function(g){return g.get("ccdefault")==="T";});this.set("defaultCreditCard",d||new f({ccdefault:"T"}));}});return SC.ApplicationSkeleton.prototype.UserModel;});define("TrackingServices",function(){var a=function(c){return _.reduce(c,function(d,e){return d+e;},0);},b=function(c){if(!c){return"";}return _.isString(c)?c.replace(" ","").replace("	","").replace("-","").toUpperCase():c+"";};return{services:{UPS:{name:"UPS",url:"http://wwwapps.ups.com/WebTracking/track?track=yes&trackNums=",validate:function(c){c=b(c);if(c.substring(0,2)!=="1Z"||c.length!==18){return false;}var e=parseInt(_.last(c),10),d={A:2,B:3,C:4,D:5,E:6,F:7,G:8,H:9,I:0,J:1,K:2,L:3,M:4,N:5,O:6,P:7,Q:8,R:9,S:0,T:1,U:2,V:3,W:4,X:5,Y:6,Z:7};return e===a(_.map(c.substring(2,c.length),function(g,f){return(d[g]||parseInt(g,10))*(f%2?2:1);}))%10;}},USPS:{name:"USPS",url:"https://tools.usps.com/go/TrackConfirmAction_input?qtc_tLabels1=",validate:function(c){c=b(c);var e=c.length;if(e!==13&&e!==20&&e!==22){return false;}if(_.last(c,2).join("")==="US"){c=c.substring(2,11);}var i=parseInt(_.last(c),10),h=a(_.map(c,function(k,j){return parseInt(k,10)*(j%2?1:3);}))%10;if(i===10-h||h===0){return true;}var d=[8,6,4,2,3,5,9,7],f={0:5,1:0},g=a(_.map(_.initial(c),function(k,j){return k*d[j];}))%11;g=f[g]||(11-g);return i===g;}},FedEx:{name:"FedEx",url:"http://www.fedex.com/Tracking?action=track&tracknumbers=",validate:function(k){k=b(k);var e=k.length;if(e!==12&&e!==15&&e!==22){return false;}if(e===22){if(parseInt(k.substring(0,2),10)===96){k=k.substring(0,7);}else{return false;}}var g=parseInt(_.last(k),10),i=_.initial(k).reverse(),j=10-a(_.map(i,function(m,l){return m*(l%2?1:3);}))%10;if(g===j){return true;}var c=0,d=[1,3,7],f=function(){var l=c;c=c+1<d.length?c+1:0;return l;},h=(a(_.map(i,function(l){return l*d[f()];}))%11)%10;return g===h;}}},defaultUrl:"http://www.google.com/search?q=",getServiceUrl:function(d){var c=_.find(this.services,function(e){return e.validate(b(d));});return(c?c.url:this.defaultUrl)+d;},defaultName:null,getServiceName:function(d){var c=_.find(this.services,function(e){return e.validate(b(d));});return c?c.name:this.defaultName;}};});define("Balance",["Balance.View","Balance.Router"],function(b,a){return{View:b,Router:a,MenuItems:{name:_("Billing").translate(),id:"billing",index:3,children:[{id:"balance",name:_("Account Balance").translate(),url:"balance",index:1}]},mountToApp:function(c){return new a(c);}};});define("Balance.Router",["Balance.View"],function(a){return Backbone.Router.extend({routes:{balance:"showBalance"},initialize:function(b){this.application=b;},showBalance:function(){new a({application:this.application}).showContent();}});});define("Balance.View",function(){return Backbone.View.extend({template:"balance",attributes:{"class":"AccountBalance"},initialize:function(a){this.application=a.application;this.model=this.application.getUser();this.title=_("Account Balance").translate();},showContent:function(){this.application.getLayout().showContent(this,"balance",[{text:this.title,href:"/balance"}]);}});});define("Wizard",["Wizard.Module","Wizard.Router","Wizard.Step","Wizard.StepGroup","Wizard.View"],function(d,b,c,a,e){return{Module:d,Router:b,Step:c,StepGroup:a,View:e};});define("Wizard.Module",function(){return Backbone.View.extend({tagName:"article",template:"wizard_module",errors:[],initialize:function(a){this.wizard=a.wizard;this.step=a.step;this.model=a.wizard.model;if(a.errors){this.errors=a.errors;}},disableInterface:jQuery.noop,enableInterface:jQuery.noop,_render:function(){this.$el.addClass("module-rendered");var a=Backbone.View.prototype._render.apply(this,arguments);if(!this.$('[data-type="alert-placeholder-module"]').length){this.$el.prepend('<div data-type="alert-placeholder-module"></div>');}if(this.error){this.showError();}jQuery(document.body).trigger("resize");return a;},submit:function(){return this.isValid();},cancel:function(){return jQuery.Deferred().resolve();},isValid:function(){return jQuery.Deferred().resolve();},isActive:function(){return _.isFunction(this.options.isActive)?this.options.isActive.apply(this,arguments):true;},getTitle:function(){return _.isFunction(this.options.title)?this.options.title.apply(this):this.options.title||this.title||"";},manageError:function(a){if(this.state!=="future"){this.error=a;this.trigger("error",a);if(this.wizard.getCurrentStep()===this.step){this.showError();}}},showError:function(){this.$('[data-type="alert-placeholder-module"]:first').html(SC.macros.message(this.error.errorMessage,"error",true));this.error=null;},clearError:function(){this.$('[data-type="alert-placeholder-module"]').empty();this.error=null;},clearGeneralMessages:function(){jQuery('[data-type="alert-placeholder-module"]:first').empty();},showGeneralMessage:function(c,b){var a=_.isString(b)?b:b&&"error"||"success";jQuery('[data-type="alert-placeholder-module"]:first').html(SC.macros.message(c,a,true));}});});define("Wizard.Router",["Wizard.View","Wizard.Step","Wizard.StepGroup"],function(c,b,a){return Backbone.Router.extend({step:b,view:c,stepGroup:a,initialize:function(e,d){this.application=e;this.steps={};this.stepsOrder=[];this.stepGroups={};this.handledErrors=[];this.options=d;if(d&&d.model){this.model=d.model;}if(d&&d.steps){this.compileConfiguration(d.steps);}this.handledErrors=_.uniq(this.handledErrors);},compileConfiguration:function(e){var d=this;_.each(e,function(h,g){if(h.steps){var f=new d.stepGroup(h.name,h.steps[0].url);f.index=g;d.stepGroups[h.name]=f;_.each(h.steps,function(j){var i=d.step.extend(j);d.steps[j.url]=new i({wizard:d,stepGroup:f});f.steps.push(d.steps[j.url]);d.stepsOrder.push(j.url);d.route(j.url,"runStep");d.route(j.url+"?:options","runStep");});}});},getCurrentStep:function(){return this.steps[this.currentStep];},goToNextStep:function(){var e=this.getNextStepUrl(),d=_.parseUrlOptions(Backbone.history.location.hash);if(e){this.navigate(d.force?_.addParamsToUrl(e,{force:true}):e,{trigger:true});}},getNextStepUrl:function(d){d=d||_.indexOf(this.stepsOrder,this.currentStep);if(~d&&d+1<this.stepsOrder.length){if(this.steps[this.stepsOrder[d+1]].showStep(this)){return this.stepsOrder[d+1];}return this.getNextStepUrl(d+1);}},getFirstStepUrl:function(){var d;if(this.steps[this.stepsOrder[0]].showStep(this)){d=this.stepsOrder[0];}else{this.currentStep=this.stepsOrder[0];d=this.getNextStepUrl();}this.steps[d].hideBackButton=true;return d;},goToPreviousStep:function(){var d=_.addParamsToUrl(this.getPreviousStepUrl(),{force:true});if(d){this.navigate(d,{trigger:true});}},getPreviousStepUrl:function(d){d=d||_.indexOf(this.stepsOrder,this.currentStep);if(d>0){if(this.steps[this.stepsOrder[d-1]].showStep(this)){return this.stepsOrder[d-1];}return this.getPreviousStepUrl(d-1);}},getStepPosition:function(e){var d=_.indexOf(this.stepsOrder,e||this.currentStep);return{fromBegining:d,toLast:this.stepsOrder.length-d-1};},runStep:function(){var f=Backbone.history.fragment,e=this;f=f.split("?")[0];if(this.steps[f]){if((this.application.Configuration.checkout_skip_login&&this.application.getConfig("siteSettings.registration.registrationoptional")==="T"&&this.application.getUser().get("isRecognized")==="F")||this.application.getUser().get("isLoggedIn")==="T"){this.currentStep=f;var h="past",g;_.each(this.stepsOrder,function(i){if(i===f){e.steps[i].present();e.steps[i].state="present";e.steps[i].stepGroup.state="present";e.steps[i].tellModules("present");h="future";g=e.steps[i].stepGroup;}else{e.steps[i].tellModules(h);e.steps[i][h]();e.steps[i].state=h;if(e.steps[i].stepGroup!==g){e.steps[i].stepGroup.state=h;}}});var d=new this.view({model:this.model,wizard:this,currentStep:this.steps[f],application:this.application});d.showContent();}else{Backbone.history.navigate("login-register",{trigger:true});}}},processErrorMessage:function(e){var d=jQuery("<div>").append(e);d.find("a").attr("data-navigation","ignore-click");return d.html();},manageError:function(d,e){if(_.isObject(d)&&d.responseText){d=JSON.parse(d.responseText);}else{if(_.isString(d)||_.isNumber(d)){d={errorCode:"ERR_WS_UNHANDLED_ERROR",errorMessage:d};}else{if(!_.isObject(d)){d={errorCode:"ERR_WS_UNHANDLED_ERROR",errorMessage:_("An error has occurred").translate()};}}}if(~_.indexOf(this.handledErrors,d.errorCode)){this.trigger(d.errorCode,d);}else{if(e){e.moduleError(null,d);}else{this.getCurrentStep().error=d;this.getCurrentStep().showError();}}}});});define("Wizard.Step",function(){return Backbone.View.extend({template:"wizard_step",events:{'click [data-action="previous-step"]':"previousStep",'click [data-action="submit-step"]':"submit"},continueButtonLabel:_("Continue").translate(),hideBackButton:false,bottomMessage:null,bottomMessageClass:"",modules:[],initialize:function(b){this.wizard=b.wizard;this.stepGroup=b.stepGroup;this.moduleInstances=[];this.renderPromise=jQuery.Deferred().resolve();var a=this;_.each(this.modules,function(d){var e={};if(_.isArray(d)){e=d[1];d=d[0];}var c=require(d);var f=new c(_.extend({wizard:a.wizard,step:a,stepGroup:a.stepGroup,className:"orderwizard-module "+d.replace(/\./g,"-").toLowerCase()},e));f.on({ready:function(g){a.moduleReady(this,g);},navbar_toggle:function(g){a.moduleNavbarToggle(this,g);},change_enable_continue:function(i,h){var g=_.extend({onlyContinue:false},h);i?a.enableNavButtons(g):a.disableNavButtons(g);},change_visible_back:function(g){a.changeVisibleNavButtons({backBtn:true,visible:g});},update_step_name:function(){a.$('[data-type="wizard-step-name-container"]').text(a.getName());},change_label_continue:function(g){a.changeLabelContinue(g);},error:function(g){a.moduleError(this,g);}});_.each(f.errors,function(g){a.wizard.handledErrors.push(g);a.wizard.on(g,function(h){f.manageError(h);});});if(f.modules){_.each(f.modules,function(g){_.each(g.instance.errors,function(h){a.wizard.handledErrors.push(h);a.wizard.on(h,function(i){g.instance.manageError(i);});});});}a.moduleInstances.push(f);});},removeReadyFromModules:function(){_.each(this.moduleInstances,function(a){a.isReady=false;});},moduleReady:function(b,c){var a=this;if(b.isReady!==c){b.isReady=c;if(a.stepAdvance()&&a.state==="present"){this.renderPromise.done(function(){a.submit();});}}},moduleError:function(b,a){if(!b&&this.state!=="future"){this.error=a;if(this===this.wizard.getCurrentStep()){this.showError();}}},hasErrors:function(){return this.error||_.some(this.moduleInstances,function(a){return a.error;});},showError:function(){if(this.error){this.$('[data-type="alert-placeholder-step"]').html(SC.macros.message(this.wizard.processErrorMessage(this.error.errorMessage),"error",true));jQuery("html, body").animate({scrollTop:0},600);this.error=null;}},stepAdvance:function(){return this.areAllModulesReady()&&this.isStepReady();},areAllModulesReady:function(){var b=_(this.moduleInstances).chain().pluck("isReady").uniq().value(),a=_.parseUrlOptions(Backbone.history.location.hash);return !a.force&&b.length===1&&b[0]===true;},isStepReady:function(){return false;},moduleNavbarToggle:function(c,a){var b=this;this.renderPromise.done(function(){c.navigationToggle=a;var d=_(b.moduleInstances).chain().pluck("navigationToggle").uniq().value();if(d.length===1&&d[0]===false){b.$(".step-navigation-buttons").hide();}else{b.$(".step-navigation-buttons").show();}});},tellModules:function(a){_.each(this.moduleInstances,function(b){_.isFunction(b[a])&&b[a]();b.state=a;});},past:function(){this.validate();},present:jQuery.noop,future:function(){this.error=null;_.each(this.moduleInstances,function(a){a.error=null;});},render:function(){var c=this,a=this.wizard.getStepPosition();this.removeReadyFromModules();this.renderPromise=jQuery.Deferred();this.currentModelState=JSON.stringify(this.wizard.model);this.$el.attr({"data-from-begining":a.fromBegining,"data-to-last":a.toLast});this._render();var b=this.$("#wizard-step-content");b.empty();var d=[];_.each(this.moduleInstances,function(i){i.isReady=false;i.render();var h=b,f=i.options.container;if(f){var g=false;if(!d[f]){d[f]=true;g=true;}var e=c.$(f);if(e.length){if(g){e.empty();}h=e;}}h.append(i.$el);});this.wizard.application.getLayout().once("afterAppendView",function(){c.renderPromise.resolve();});this.showError();return this;},previousStep:function(c){c&&this.disableNavButtons();var b=[];_.each(this.moduleInstances,function(d){b.push(d.cancel());});var a=this;jQuery.when.apply(jQuery,b).then(function(){a.wizard.goToPreviousStep();},function(d){if(d){a.wizard.manageError(d,a);c&&a.enableNavButtons();}});},submitErrorHandler:function(a){this.enableNavButtons();this.wizard.manageError(a,this);_.each(this.moduleInstances,function(b){b.enableInterface();});},submit:function(c){c&&this.disableNavButtons();var b=[];_.each(this.moduleInstances,function(d){b.push(d.submit(c));d.disableInterface();});var a=this;jQuery.when.apply(jQuery,b).then(function(){a.save().always(function(){a.enableNavButtons();}).done(function(){a.wizard.goToNextStep();}).fail(function(d){a.submitErrorHandler(d);});},function(d){a.submitErrorHandler(d);});},showStep:function(){return _.some(_.filter(this.moduleInstances,function(a){return !a.options.exclude_on_skip_step;}),function(a){return a.isActive();});},changeLabelContinue:function(a){this._executeAfterRender(function(){this.wizard.application.getLayout().$('[data-action="submit-step"]').html(a||this.continueButtonLabel);},this);this.changedContinueButtonLabel=a||this.continueButtonLabel;},_save:function(){if(this.wizard.model&&this.currentModelState!==JSON.stringify(this.wizard.model)){return this.wizard.model.save().fail(function(a){a.preventDefault=true;});}else{return jQuery.Deferred().resolveWith(this);}},save:function(){return this._save();},validate:function(){var b=[];_.each(this.moduleInstances,function(c){b.push(c.isValid());});var a=this;jQuery.when.apply(jQuery,b).fail(function(c){a.wizard.manageError(c,a);});},disableNavButtons:function(a){this._executeAfterRender(function(){var b='[data-action="edit-module"], ';if(!a||!a.onlyContinue){b+='[data-action="previous-step"], ';}if(!a||!a.notDisableTouchs){b+="[data-touchpoint], ";}if(!a||!a.notDisableBreads){b+=".breadcrumb a, .wizard-step-link a, ";}b+=' [data-action="submit-step"]';this.wizard.application.getLayout().$(b).attr("disabled",true);},this);},changeVisibleNavButtons:function(a){this._executeAfterRender(function(){var b="";if(a.continueBtn){b=(b?", ":"")+'[data-action="edit-module"]';}if(a.backBtn){b+=(b?", ":"")+'[data-action="previous-step"]';}this.wizard.application.getLayout().$(b).css("display",a.visible?"block":"none");},this);},enableNavButtons:function(a){this._executeAfterRender(function(){var b='[data-action="edit-module"], ';if(!a||!a.onlyContinue){b+='[data-action="previous-step"], ';}if(!a||!a.notDisableTouchs){b+="[data-touchpoint], ";}if(!a||!a.notDisableBreads){b+=".breadcrumb a, .wizard-step-link a, ";}b+=' [data-action="submit-step"]';this.wizard.application.getLayout().$(b).attr("disabled",false);},this);},_executeAfterRender:function(b,a){if(this.renderPromise.state()!=="resolved"){this.renderPromise.done(_.bind(b,a));}else{_.bind(b,a)();}},getName:function(){return this.name;}});});define("Wizard.StepGroup",function(){function a(c,b){this.name=c;this.url="/"+b;this.steps=[];this.hasErrors=function(){return _.some(this.steps,function(d){return d.hasErrors();});};this.getErrors=function(){var d=[];_.each(this.steps,function(e){_.each(e.moduleInstances,function(f){if(_.isArray(f.error)){_.each(f.error,function(g){d.push(g);});}else{if(_.isObject(f.error)){d.push(f.error);}else{if(_.isString(f.error)){d.push({errorCode:"ERR_WS_UNHANDLED_ERROR",errorMessage:f.error});}}}});});return d;};this.showStepGroup=function(){return _.some(this.steps,function(d){return d.showStep();});};}return a;});define("Wizard.View",function(){return Backbone.View.extend({template:"wizard",initialize:function(a){this.wizard=a.wizard;this.currentStep=a.currentStep;},render:function(){this._render();this.currentStep.render();this.$("#wizard-content").empty().append(this.currentStep.$el);},showError:function(a){this.wizard.manageError(a);}});});define("ListHeader",function(){var a=Backbone.View.extend({template:"list_header",events:{'change [data-action="filter"]':"filterHandler",'change [data-action="sort"]':"sortHandler",'click [data-action="toggle-sort"]':"toggleSortHandler",'change [data-action="select-all"]':"selectAll",'change [data-action="unselect-all"]':"unselectAll",'change [data-action="range-filter"]':"rangeFilterHandler",'click [data-action="toggle-filters"]':"toggleFilters"},initialize:function(c){var b=c.view;_.extend(this,c);this.avoidFirstFetch=c.avoidFirstFetch;this.totalCount=c.totalCount;this.rangeFilterOptions=b.rangeFilterOptions||{};this.rangeFilterLabel=c.rangeFilterLabel;b.on("afterViewRender",jQuery.proxy(this,"appendToView"));this.expandedStatePath=this.view.className?this.view.className+".expanded":"state.expanded";a.setPersistedState(this.expandedStatePath,a.getPersistedState(this.expandedStatePath,false));},toggleFilters:function(f){f.preventDefault();var c=jQuery(f.currentTarget),b=c.find(".filter-icon"),d=a.getPersistedState(this.expandedStatePath,false);d?b.addClass("icon-chevron-down").removeClass("icon-chevron-up"):b.removeClass("icon-chevron-down").addClass("icon-chevron-up");a.setPersistedState(this.expandedStatePath,!d);c.parents('[data-type="accordion"]').toggleClass("well").toggleClass("facet-header-white-well").find('[data-type="accordion-body"]').stop().slideToggle();},getExpanded:function(){return a.getPersistedState(this.expandedStatePath,false);},appendToView:function(b){var c=b.$el.find('[data-type="list-header-placeholder"]');this.render();this.$el.prependTo(c.length?c:b.$el);this.delegateEvents();},getInitialDateRange:function(c){if(this.rangeFilter){var b=this.getRangeFromUrl(c);if(b.from||b.to){this.validateDateRange(b);return b;}else{var d=this.notUseDefaultDateRange?this.quantityDaysRange:this.application.getConfig("filterRangeQuantityDays");if(d){var f=new Date(),e=new Date();f.setDate(f.getDate()-d);return{from:_.dateToString(f),to:_.dateToString(e)};}}}},getUnselectedLength:function(){return this.collection.filter(function(b){return !b.get("checked");}).length;},getCollectionLength:function(){return this.collection.length;},setSelecteds:function(){var b=_.parseUrlOptions(Backbone.history.fragment);this.selectedFilter=this.getFilterFromUrl(b.filter);this.selectedRange=this.getInitialDateRange(b.range);this.selectedSort=this.getSortFromUrl(b.sort);this.order=this.getOrderFromUrl(b.order);this.page=this.getPageFromUrl(b.page);this.selectedDisplay=this.getDisplayFromUrl(b.display);},render:function(){if(this.totalCount===0){return;}if(!this.selectedFilter&&!this.selectedSort&&!this.order&&!this.selectedRange&&!this.selectedDisplay){this.setSelecteds();if(!this.avoidFirstFetch){this.updateCollection();}}return this._render();},updateCollection:function(){var b=null,c=this.collection;if(this.selectedRange){b={from:this.selectedRange.from,to:this.selectedRange.to};}c.update&&c.update({filter:this.selectedFilter,range:b,sort:this.selectedSort,order:this.order,page:this.page,killerId:this.application.killerId},this);return this;},getFilter:function(b){return _(this.filters).find(function(c){return _.isFunction(c.value)?c.value.apply(this.view)===b:c.value===b;},this);},getSort:function(b){return _.findWhere(this.sorts,{value:b});},getDisplay:function(b){return _.findWhere(this.displays,{id:b});},getFilterFromUrl:function(b){return this.getFilter(b)||this.getDefaultFilter();},getRangeFromUrl:function(c){var b=c?c.split("to"):[];return{from:b[0],to:b[1]};},getSortFromUrl:function(b){return this.getSort(b)||this.getDefaultSort();},getOrderFromUrl:function(b){return b==="inverse"?-1:1;},getDisplayFromUrl:function(b){return this.getDisplay(b)||this.getDefaultDisplay();},getPageFromUrl:function(c){var b=parseInt(c,10);return !isNaN(b)&&b>0?b:1;},pager:function(d){var b=parseInt(d,10),c=Backbone.history.fragment;return isNaN(b)||b===1?_.removeUrlParameter(c,"page"):_.setUrlParameter(c,"page",b);},displayer:function(c){var b=Backbone.history.fragment;return c===this.getDefaultDisplay().id?_.removeUrlParameter(b,"display"):_.setUrlParameter(b,"display",c);},getDefaultFilter:function(){return this.defaultFilter||(this.defaultFilter=_.findWhere(this.filters,{selected:true})||_.first(this.filters));},getDefaultSort:function(){return this.defaultSort||(this.defaultSort=_.findWhere(this.sorts,{selected:true})||_.first(this.sorts));},getDefaultDisplay:function(){return this.defaultDisplay||(this.defaultDisplay=_.findWhere(this.displays,{selected:true})||_.first(this.displays));},isDefaultFilter:function(b){return this.getDefaultFilter()===b;},isDefaultSort:function(b){return this.getDefaultSort()===b;},isDefaultDisplay:function(b){return this.getDefaultDisplay()===b;},filterHandler:function(b){this.unselectAll({silent:true});this.selectedFilter=this.getFilter(b.target.value);this.updateUrl();},sortHandler:function(b){this.selectedSort=this.getSort(b.target.value);this.updateUrl();},toggleSortHandler:function(){this.order*=-1;this.updateUrl();},selectAll:function(){if("selectAll" in this.view){this.view.selectAll();}return this;},unselectAll:function(b){if("unselectAll" in this.view){this.view.unselectAll(b);}return this;},rangeFilterHandler:_.throttle(function(){var b=this.selectedRange,c=this.$('[data-action="range-filter"]');c.each(function(){if(this.value){b[this.name]=this.value;}else{delete b[this.name];}});if(this.validateDateRange(b)){this.updateUrl();}else{this.showError(_("Invalid date format.").translate());}return this;},2500,{leading:false}),validateDateRange:function(c){var j=this.rangeFilterOptions,h=true,f=new Date(c.to),g=new Date(c.from),b=new Date(j.toMin),e=new Date(j.toMax),d=new Date(j.fromMin),i=new Date(j.fromMax);if(j.toMin&&_.isDateValid(b)&&_.isDateValid(f)&&f.getTime()<b.getTime()){c.to=j.toMin;}else{if(!c.to||(j.toMax&&_.isDateValid(e)&&_.isDateValid(f)&&f.getTime()>e.getTime())){c.to=j.toMax;}}if(!c.from||(j.fromMin&&_.isDateValid(d)&&_.isDateValid(g)&&g.getTime()<d.getTime())){c.from=j.fromMin;}else{if(j.fromMax&&_.isDateValid(i)&&_.isDateValid(g)&&g.getTime()>i.getTime()){c.from=j.fromMax;}}if(c.to&&!_.isDateValid(_.stringToDate(c.to))){h=false;delete c.to;}if(c.from&&!_.isDateValid(_.stringToDate(c.from))){h=false;delete c.from;}return h;},updateUrl:function(){var b=Backbone.history.fragment;b=this.isDefaultFilter(this.selectedFilter)?_.removeUrlParameter(b,"filter"):_.setUrlParameter(b,"filter",_.isFunction(this.selectedFilter.value)?this.selectedFilter.value.apply(this.view):this.selectedFilter.value);b=this.isDefaultSort(this.selectedSort)?_.removeUrlParameter(b,"sort"):_.setUrlParameter(b,"sort",this.selectedSort.value);b=this.order===1?_.removeUrlParameter(b,"order"):_.setUrlParameter(b,"order","inverse");if(this.selectedRange){b=this.selectedRange.from&&this.selectedRange.to?_.setUrlParameter(b,"range",this.selectedRange.from+"to"+this.selectedRange.to):_.removeUrlParameter(b,"range");}b=_.removeUrlParameter(b,"page");this.page=1;Backbone.history.navigate(b,{trigger:false});return this.updateCollection();}});a=_.extend(a,{setPersistedState:function(c,b){return _.setPathFromObject(this.state=this.state||{},c,b);},getPersistedState:function(c,b){return _.getPathFromObject(this.state=this.state||{},c,b);}});return a;});define("PaymentWizard.CreditTransaction.Collection",["PaymentWizard.CreditTransaction.Model"],function(a){return Backbone.Collection.extend({model:a});});define("PaymentWizard.CreditTransaction.Model",function(){function a(d,b,c){if(isNaN(parseFloat(d))){return _("The amount to apply is not a valid number").translate();}if(d<=0){return _("The amount to apply has to be positive").translate();}if(d>c.remaining){return _("The amount to apply cannot exceed the remaining amount").translate();}if(c.orderTotal<0){return _("The amount to apply cannot exceed the remaining payment total").translate();}}return Backbone.Model.extend({validation:{amount:{fn:a}},initialize:function(){if(!this.get("type")){this.set("type","Deposit");}}});});define("PaymentWizard.EditAmount.View",function(){return Backbone.View.extend({template:"payment_wizard_edit_amount_layout",events:{'submit [data-action="edit-amount-form"]':"modifyAmount",'change [name="amount"]':"changedAmount"},changedAmount:function(b){var a=parseFloat(jQuery(b.target).val());if(this.model.get("discountapplies")){if(a===this.model.get("due")){this.$(".discountSection").show();this.$(".discountWarning").hide();}else{this.$(".discountSection").hide();this.$(".discountWarning").show();}}},initialize:function(a){this.parentView=a.parentView;this.model=a.model;this.type=a.type;this.selectedInvoicesLength=a.selectedInvoicesLength;this.invoicesTotal=a.invoicesTotal;if(this.type==="invoice"){this.original_amount_attribute="total";this.amount_due_attribute="due";this.input_label=_("Amount to Pay").translate();this.original_amount_label=_("Original Amount").translate();this.amount_due_label=_("Amount Due").translate();this.page_header=_("Invoice #$(0)").translate(this.model.get("refnum"));this.title=_("Amount to pay for invoice #$(0)").translate(this.model.get("refnum"));}else{if(this.type==="deposit"){this.input_label=_("Amount to apply").translate();this.original_amount_label=_("Remaining amount").translate();this.original_amount_attribute="remaining";this.page_header=_("Deposit #$(0)").translate(this.model.get("refnum"));this.title=_("Amount to apply for deposit #$(0)").translate(this.model.get("refnum"));}else{if(this.type==="credit"){this.input_label=_("Amount to apply").translate();this.original_amount_attribute="remaining";this.original_amount_label=_("Remaining amount").translate();this.page_header=_("$(0) #$(1)").translate(this.model.get("type"),this.model.get("refnum"));this.title=_("Amount to apply for credit #$(0)").translate(this.model.get("refnum"));}}}this.page_header="<b>"+this.page_header.toUpperCase()+"</b>";},modifyAmount:function(d){var a=this.model,b=a.get("amount"),c=parseFloat(this.$(".amountToPayInput").val()),g=this.parentView.wizard.model,f=a.get("orderTotal")||g.calculeTotal(true);d.preventDefault();if(a.get("discountapplies")&&c===a.get("due")){c=a.get("duewithdiscount");}a.set("amount",c).set("orderTotal",g.calculeTotal(true)).validate();if(a.isValid()){a.set("amount_formatted",_.formatCurrency(c));if(this.type==="invoice"){g.distributeCredits();}else{g.calculeTotal();}this.$containerModal.modal("hide");this.destroy();}else{a.set({amount:b,orderTotal:f});}}});});define("PaymentWizard",["PaymentWizard.View","PaymentWizard.Step","PaymentWizard.Router"],function(c,b,a){return{View:c,Step:b,Router:a,mountToApp:function(d){var e=d.getLayout();_.extend(e,{updateLayout:function(){this.updateHeader();this.updateFooter();}});_.extend(e.events,{'click [data-action="update-layout"]':"updateLayout"});return new a(d,{profile:d.getUser(),model:d.getLivePayment(),steps:d.getConfig("paymentWizardSteps")});}};});define("PaymentWizard.Module.Addresses",["OrderWizard.Module.Address.Billing"],function(a){return a.extend({itemsPerRow:3,initialize:function(){a.prototype.initialize.apply(this,arguments);this.wizard.model.on("change:payment",jQuery.proxy(this,"changeTotal"));},changeTotal:function(){var d=this.model.previous("payment"),b=this.model.previous("confirmation"),c=this.model.get("payment");if(((d===0&&c!==0)||(d!==0&&c===0))&&!b){this.render();}},getSelectedAddress:function(){if(!this.addressId&&!this.unset){var b=this.addresses.findWhere({defaultbilling:"T"});this.addressId=b&&b.id;if(this.addressId){this.model.set(this.manage,this.addressId);}}return this.addresses.get(this.addressId)||this.getEmptyAddress();},unsetAddress:function(){this.unset=true;a.prototype.unsetAddress.apply(this,arguments);},isValid:function(){if(this.wizard.hidePayment()){return jQuery.Deferred().resolve();}else{return a.prototype.isValid.apply(this,arguments);}},isActive:function(){if(this.wizard.hidePayment()){return false;}else{return a.prototype.isActive.apply(this,arguments);}}});});define("PaymentWizard.Module.Confirmation",["Wizard.Module"],function(a){return a.extend({template:"payment_wizard_confirmation_module",future:function(){var b=this.wizard.model;if(b.get("confirmation")){b.unset("confirmation",{silent:true});}}});});define("PaymentWizard.Module.ConfirmationNavigation",["Wizard.Module"],function(a){return a.extend({template:"payment_wizard_confirmation_navigation_module"});});define("PaymentWizard.Module.CreditTransaction",["Wizard.Module","PaymentWizard.EditAmount.View"],function(b,a){return b.extend({template:"payment_wizard_credit_transaction_module",events:{'click [data-type="transaction"]:not(.disabled)':"toggleTransactionHandler",'click [data-type="transaction"] [data-action="edit"]':"editTransaction"},initialize:function(c){this.transaction_type=c.transaction_type;this.wizard=c.wizard;this.application=this.wizard.application;this.addEventListeners();},render:function(){this.collection=this.wizard.model.get(this.transaction_type==="credit"?"credits":"deposits");if(this.collection.length){this._render();}},addEventListeners:function(){this.wizard.model.on("change:credits_total",jQuery.proxy(this,"render"));this.wizard.model.on("change:deposits_total",jQuery.proxy(this,"render"));},toggleTransactionHandler:function(c){this.toggleTransaction(jQuery(c.target).closest('[data-type="transaction"]').data("id"));},toggleTransaction:function(d){var c=this.collection.get(d);if(c){this[c.get("apply")?"unselectTransaction":"selectTransaction"](c);this.render();}},selectTransaction:function(c){if(c){c.set("checked",true);}if(this.transaction_type==="credit"){return this.application.getLivePayment().selectCredit(c.id);}else{return this.application.getLivePayment().selectDeposit(c.id);}},unselectTransaction:function(c){if(c){c.set("checked",false);}if(this.transaction_type==="credit"){return this.application.getLivePayment().unselectCredit(c.id);}else{return this.application.getLivePayment().unselectDeposit(c.id);}},editTransaction:function(c){var f=jQuery(c.target).parents('[data-type="transaction"]').data("id"),d=this.collection.get(f);c.preventDefault();c.stopPropagation();this.application.getLayout().showInModal(new a({application:this.application,parentView:this,model:d,type:this.transaction_type,selectedInvoicesLength:this.wizard.model.getSelectedInvoices().length,invoicesTotal:this.wizard.model.get("invoices_total")}),{application:this.application});}});});define("PaymentWizard.Module.Invoice",["Wizard.Module","ListHeader","Invoice","PaymentWizard.EditAmount.View"],function(c,e,d,a){function b(f){return f/1000/60/60/24;}return c.extend({template:"payment_wizard_invoice_module",events:{'click [data-type="invoice"]:not(.disabled)':"toggleInvoiceHandler",'click [data-action="edit"]':"editInvoice"},initialize:function(f){this.wizard=f.wizard;this.invoices=new d.InvoiceCollection();this.invoices.reset(this.wizard.model.get("invoices").models);this.listHeader=new e({view:this,application:f.wizard.application,collection:this.invoices,filters:this.filterOptions,sorts:this.sortOptions,selectable:true});this.addEventListeners();},addEventListeners:function(){var f=this;this.invoices.on("reset",jQuery.proxy(this,"render"));this.wizard.model.on("change:invoices_total",jQuery.proxy(this,"render"));this.wizard.model.on("change:invoices",function(){f.invoices.clearFilters();f.invoices.reset(f.wizard.model.get("invoices").models);f.invoices.original=f.invoices.clone();});},present:function(){this.renderable=true;this.listHeader.updateCollection();},render:function(){if(this.renderable){this._render();}},filterOptions:[{value:"overdue",name:_("Show Overdue").translate(),filter:function(){return this.original.filter(function(f){return !f.get("dueinmilliseconds")||f.get("isOverdue");});}},{value:"next7days",name:_("Show Due next 7 days").translate(),filter:function(){return this.original.filter(function(f){return !f.get("dueinmilliseconds")||b(f.get("dueinmilliseconds"))<=7;});}},{value:"next30days",name:_("Show Due next 30 days").translate(),filter:function(){return this.original.filter(function(f){return !f.get("dueinmilliseconds")||b(f.get("dueinmilliseconds"))<=30;});}},{value:"next60days",name:_("Show Due next 60 days").translate(),filter:function(){return this.original.filter(function(f){return !f.get("dueinmilliseconds")||b(f.get("dueinmilliseconds"))<=60;});}},{value:"next90days",name:_("Show Due next 90 days").translate(),filter:function(){return this.original.filter(function(f){return !f.get("dueinmilliseconds")||b(f.get("dueinmilliseconds"))<=90;});}},{value:"all",name:_("Show All").translate(),selected:true,filter:function(){return this.original.models;}}],sortOptions:[{value:"duedate",name:_("By Due Date").translate(),selected:true,sort:function(){return this.models.sort(function(g,f){var i=g.get("dueinmilliseconds")||0,h=f.get("dueinmilliseconds")||0;if(i!==h){return i<h?-1:1;}return g.get("tranid")<f.get("tranid")?-1:1;});}},{value:"invoicenumber",name:_("By Invoice Number").translate(),sort:function(){return this.sortBy(function(f){return f.get("tranid");});}},{value:"amountdue",name:_("By Amount Due").translate(),sort:function(){return this.sortBy(function(f){return f.get("amount");});}}],toggleInvoiceHandler:function(g){var f=jQuery(g.target);if(f.data("toggle")!=="show-in-modal"){this.toggleInvoice(f.closest('[data-type="invoice"]').data("id"));}},toggleInvoice:function(f){f=this.invoices.get(f);if(f){this[f.get("apply")?"unselectInvoice":"selectInvoice"](f);}this.render();},selectInvoice:function(f){f.set("checked",true);this.wizard.model.selectInvoice(f);this.render();},unselectInvoice:function(f){f.set("checked",false);this.wizard.model.unselectInvoice(f);this.render();},selectAll:function(){var g=this,f=false;this.invoices.each(function(h){if(!h.get("apply")){f=true;g.selectInvoice(h);}});},unselectAll:function(){var g=this,f=false;this.invoices.each(function(h){if(h.get("apply")){f=true;g.unselectInvoice(h);}});},editInvoice:function(j){var f=jQuery(j.target),h=f.closest('[data-type="invoice"]'),g=h.find('[data-action="select"]'),i=this.invoices.get(g.val());j.preventDefault();j.stopPropagation();this.wizard.application.getLayout().showInModal(new a({application:this.wizard.application,parentView:this,model:i,type:"invoice"}),{application:this.wizard.application});},past:function(){var f=this.wizard;if(!f.model.getSelectedInvoices().length&&!f.model.get("confirmation")){f.navigate("/"+f.steps[f.stepsOrder[0]].stepGroup.url);}}});});define("PaymentWizard.Module.PaymentMethod.Creditcard",["OrderWizard.Module.PaymentMethod.Creditcard"],function(a){return a.extend({itemsPerRow:3,showDefaults:true,render:function(){if(this.wizard.hidePayment()){this.$el.empty();}else{a.prototype.render.apply(this,arguments);}},initialize:function(){a.prototype.initialize.apply(this,arguments);this.wizard.model.on("change:payment",jQuery.proxy(this,"changeTotal"));},changeTotal:function(){var e=this.model.previous("payment"),b=this.model.previous("confirmation"),c=this.model.get("confirmation"),d=this.model.get("payment");if(((e===0&&d!==0)||(e!==0&&d===0))&&!b&&!c){this.render();}}});});define("PaymentWizard.Module.ShowCreditTransaction",["Wizard.Module","PaymentWizard.CreditTransaction.Collection"],function(b,a){return b.extend({template:"payment_wizard_show_credit_transaction_module",initialize:function(c){this.transaction_type=c.transaction_type;this.wizard=c.wizard;this.wizard.model.on("change:confirmation",jQuery.proxy(this,"render"));},render:function(){var c=this.wizard.model.get("confirmation");if(c){this.collection=new a(_.where(c[this.transaction_type==="credit"?"credits":"deposits"],{apply:true}));}else{this.collection=this.wizard.model.getAppliedTransactions(this.transaction_type==="credit"?"credits":"deposits");}if(this.collection.length){this._render();}}});});define("PaymentWizard.Module.ShowInvoices",["Wizard.Module","Invoice.Collection"],function(a,b){return a.extend({template:"payment_wizard_showinvoices_module",initialize:function(c){this.wizard=c.wizard;this.wizard.model.on("change:confirmation",jQuery.proxy(this,"render"));},render:function(){if(this.wizard.model.get("confirmation")){this.invoices=new b(_.where(this.wizard.model.get("confirmation").invoices,{apply:true}));}else{this.invoices=this.wizard.model.getSelectedInvoices();}this._render();}});});define("PaymentWizard.Module.ShowPayments",["OrderWizard.Module.ShowPayments"],function(a){return a.extend({render:function(){if(this.wizard.hidePayment()){this.$el.empty();}else{a.prototype.render.apply(this,arguments);}},totalChange:jQuery.noop});});define("PaymentWizard.Module.ShowTotal",["Wizard.Module"],function(a){return a.extend({template:"payment_wizard_showtotal_module",initialize:function(b){this.wizard=b.wizard;this.wizard.model.on("change:payment",jQuery.proxy(this,"render"));}});});define("PaymentWizard.Module.Summary",["Wizard.Module"],function(a){return a.extend({template:"payment_wizard_summary_module",initialize:function(b){this.is_active=false;this.options=b;this.wizard=b.wizard;this.wizard.model.on("change",jQuery.proxy(this,"render"));},isActive:function(){return this.is_active;},future:function(){this.is_active=false;},present:function(){this.is_active=true;},past:function(){this.is_active=false;},render:function(){this.continueButtonDisabled="";if(this.options.submit){this.continueButtonLabel=_("Submit").translate();}else{var b=this.wizard.model.getSelectedInvoices();this.continueButtonLabel=_("Next").translate();if(!b.length){this.continueButtonDisabled='disabled="disabled"';}}this._render();if(this.isActive()){this.trigger("change_enable_continue",!this.continueButtonDisabled);this.trigger("change_label_continue",this.continueButtonLabel);}}});});define("PaymentWizard.Router",["Wizard.Router","PaymentWizard.View","PaymentWizard.Step"],function(b,a,c){return b.extend({view:a,step:c,runStep:function(){if(SC.ENVIRONMENT.permissions.transactions.tranCustPymt<2){this.application.getLayout().forbiddenError();}else{b.prototype.runStep.apply(this,arguments);}},hidePayment:function(){return(!this.model.get("payment")&&!this.model.get("confirmation"))||(this.model.get("confirmation")&&!this.model.get("confirmation").payment);}});});define("PaymentWizard.Step",["Wizard.Step"],function(a){return a.extend({template:"payment_wizard_step",headerMacro:"simplifiedHeader",footerMacro:"simplifiedFooter",render:function(){var b=this.wizard.application.getLayout();if(!b.originalHeader){b.originalHeader=b.$("header.site-header").html();}b.$("#site-header").html(SC.macros[this.headerMacro](b));b.$("#site-footer").html(SC.macros[this.footerMacro](b));a.prototype.render.apply(this,arguments);b.updateUI();b.trigger("afterRender");}});});define("PaymentWizard.View",["Wizard.View"],function(a){return a.extend({template:"payment_wizard_layout",bodyClass:"force-hide-side-nav",initialize:function(){a.prototype.initialize.apply(this,arguments);this.title=_("Make a Payment").translate();},showContent:function(){var b=this.options.application.getLayout();a.prototype.showContent.apply(this,arguments).done(function(){b.hideBreadcrumb();});}});});define("TransactionHistory.Collection",["TransactionHistory.Model"],function(a){return Backbone.Collection.extend({model:a,url:"services/transaction-history.ss",parse:function(b){this.totalRecordsFound=b.totalRecordsFound;this.recordsPerPage=b.recordsPerPage;return b.records;},update:function(c){var b=c.range||{};this.fetch({data:{filter:c.filter.value,sort:c.sort.value,order:c.order,from:b.from?new Date(b.from.replace(/-/g,"/")).getTime():null,to:b.to?new Date(b.to.replace(/-/g,"/")).getTime():null,page:c.page},reset:true,killerId:c.killerId});}});});define("TransactionHistory",["TransactionHistory.Model","TransactionHistory.Collection","TransactionHistory.Views","TransactionHistory.Router"],function(d,b,c,a){return{Model:d,Collection:b,Views:c,Router:a,MenuItems:{parent:"billing",id:"transactionhistory",name:_("Transaction History").translate(),url:"transactionhistory",permissionOperator:"OR",permission:"transactions.tranCustInvc.1, transactions.tranCustCred.1, transactions.tranCustPymt.1, transactions.tranCustDep.1, transactions.tranDepAppl.1",index:3},mountToApp:function(e){return new a(e);}};});define("TransactionHistory.Model",function(){return Backbone.Model.extend({urlRoot:"services/transaction-history.ss",getTypeLabel:function(){var a=this.get("recordtype");if(a==="creditmemo"){a=_("Credit Memo").translate();}else{if(a==="customerpayment"){a=_("Payment").translate();}else{if(a==="customerdeposit"){a=_("Deposit").translate();}else{if(a==="depositapplication"){a=_("Deposit Application").translate();}else{if(a==="invoice"){a=_("Invoice").translate();}else{if(a==="returnauthorization"){a=_("Return Authorization").translate();}}}}}}return a;},getTypeUrl:function(){var a=this.get("recordtype"),b="transactionhistory/"+a;if(a==="invoice"){b="invoices";}else{if(a==="returnauthorization"){b="returns";}}return b+"/"+this.get("internalid");}});});define("TransactionHistory.Router",["TransactionHistory.Collection","TransactionHistory.Views","Deposit.Model","Deposit.Views","DepositApplication.Model","DepositApplication.Views","CreditMemo.Model","CreditMemo.Views","CustomerPayment.Model","CustomerPayment.Views"],function(d,i,a,f,j,e,b,g,c,h){return Backbone.Router.extend({routes:{transactionhistory:"transactionHistory","transactionhistory?:options":"transactionHistory","transactionhistory/creditmemo/:id":"creditmemoDetails","transactionhistory/depositapplication/:id":"depositapplicationDetails","transactionhistory/customerdeposit/:id":"despositDetails","transactionhistory/customerpayment/:id":"customerPaymentDetails"},initialize:function(k){this.application=k;},transactionHistory:function(l){l=(l)?SC.Utils.parseUrlOptions(l):{page:1};l.page=l.page||1;var m=new d(),k=new i.List({application:this.application,collection:m,page:l.page});m.on("reset",k.showContent,k);k.showContent();},creditmemoDetails:function(m){var l=new b({internalid:m}),k=new g.Details({application:this.application,id:m,model:l});l.on("change",k.showContent,k).fetch({killerId:this.application.killerId});},customerPaymentDetails:function(m){var l=new c({internalid:m}),k=new h.Details({application:this.application,id:m,model:l});l.on("change",k.showContent,k).fetch({killerId:this.application.killerId});},despositDetails:function(m){var l=new a({internalid:m}),k=new f.Details({application:this.application,id:m,model:l});l.on("change",k.showContent,k).fetch({killerId:this.application.killerId});},depositapplicationDetails:function(m){var l=new j({internalid:m}),k=new e.Details({application:this.application,id:m,model:l});l.on("change",k.showContent,k).fetch({killerId:this.application.killerId});}});});define("TransactionHistory.Views",["TrackingServices","ListHeader"],function(a,c){var b={};b.List=Backbone.View.extend({template:"transaction_history",title:_("Transaction History").translate(),page_header:_("Transaction History").translate(),attributes:{"class":"TransactionHistory"},initialize:function(f){this.application=f.application;this.listenCollection();var e=new Date(),d=e.getFullYear()+"-"+(e.getMonth()+1)+"-"+e.getDate();this.rangeFilterOptions={fromMin:"1800-01-02",fromMax:d,toMin:"1800-01-02",toMax:d};this.listHeader=new c({view:this,application:this.application,collection:this.collection,filters:this.filterOptions,sorts:this.sortOptions,rangeFilter:"date",rangeFilterLabel:_("From").translate()});},listenCollection:function(){this.setLoading(true);this.collection.on({request:jQuery.proxy(this,"setLoading",true),reset:jQuery.proxy(this,"setLoading",false)});},setLoading:function(d){this.isLoading=d;},showContent:function(){this.application.getLayout().showContent(this,"transactionhistory",[{text:this.title,href:"/transactionhistory"}]);},filterOptions:[{value:"all",name:_("Show all record types").translate(),selected:true},{value:"creditmemo",name:_("Show Credit Memo").translate(),permission:"transactions.tranCustCred.1"},{value:"customerpayment",name:_("Show Payment").translate(),permission:"transactions.tranCustPymt.1"},{value:"customerdeposit",name:_("Show Deposit").translate(),permission:"transactions.tranCustDep.1"},{value:"depositapplication",name:_("Show Deposit Application").translate(),permission:"transactions.tranDepAppl.1"},{value:"invoice",name:_("Show Invoices").translate(),permission:"transactions.tranCustInvc.1"},{value:"returnauthorization",name:_("Show Return Authoziations").translate(),permission:"transactions.tranRtnAuth.1"}],sortOptions:[{value:"date",name:_("by Date").translate(),selected:true},{value:"number",name:_("by Number").translate()},{value:"amount",name:_("by Amount").translate()}]});return b;});define("LivePayment",["LivePayment.Model"],function(a){return{mountToApp:function(b){b.getLivePayment=function(){if(!b.livePaymentInstance){b.livePaymentInstance=new a(SC.ENVIRONMENT.LIVEPAYMENT?SC.ENVIRONMENT.LIVEPAYMENT:{},{application:b});}return b.livePaymentInstance;};}};});define("LivePayment.Model",["Invoice.Collection","PaymentWizard.CreditTransaction.Collection","Address.Collection","OrderPaymentmethod.Collection"],function(d,b,c,a){return Backbone.Model.extend({urlRoot:"services/live-payment.ss",initialize:function(f,g){this.application=g.application;var e=this.application.getUser();this.set("invoices_total",0);this.on("sync",function(h){h.set("invoices_total",0);});this.on("change:addresses",function(h,i){h.set("addresses",new c(i),{silent:true});});this.trigger("change:addresses",this,f&&f.addresses||[]);this.on("change:paymentmethods",function(h,i){h.set("paymentmethods",new a(i),{silent:true});});this.trigger("change:paymentmethods",this,f&&f.paymentmethod||[]);this.on("change:invoices",function(h,i){h.set("invoices",new d(i),{silent:true});});this.trigger("change:invoices",this,f&&f.invoices||[]);this.on("change:deposits",function(i,h){i.set("deposits",new b(h),{silent:true});});this.trigger("change:deposits",this,f&&f.deposits||[]);this.on("change:credits",function(h,i){h.set("credits",new b(i),{silent:true});});this.trigger("change:credits",this,f&&f.credits||[]);this.on("change:balance",function(h){e.set("balance",h.get("balance"));e.set("balance_formatted",h.get("balance_formatted"));});},getSelectedInvoices:function(){return new d(this.get("invoices").filter(function(e){return e.get("apply");}));},getAppliedTransactions:function(e){return new b(this.get(e).filter(function(f){return f.get("apply");}));},selectInvoice:function(f){f=this.get("invoices").get(f);if(f&&f.get("due")){f.set("apply",true);f.set("checked",true);var e=f.get("amount")?f.get("amount"):f.get("due");f.set("amount",e);f.set("amount_formatted",_.formatCurrency(e));}return this.distributeCredits();},unselectInvoice:function(e){e=this.get("invoices").get(e);if(e){e.set("apply",false);e.set("checked",false);}return this.distributeCredits();},selectCredit:function(f){f=this.get("credits").get(f);if(f&&f.get("remaining")){f.set("apply",true);var e=BigNumber(f.get("remaining")).minus(this.get("payment")).toNumber();if(BigNumber(e).greaterThan(0)){e=BigNumber(f.get("remaining")).minus(e).toNumber();}else{e=f.get("remaining");}f.set("amount",e);f.set("amount_formatted",_.formatCurrency(e));}return this.calculeTotal();},selectDeposit:function(e){e=this.get("deposits").get(e);if(e&&e.get("remaining")){e.set("apply",true);var f=BigNumber(e.get("remaining")).minus(this.get("payment")).toNumber();if(BigNumber(f).greaterThan(0)){f=BigNumber(e.get("remaining")).minus(f).toNumber();}else{f=e.get("remaining");}e.set("amount",f);e.set("amount_formatted",_.formatCurrency(f));}return this.calculeTotal();},unselectCredit:function(e){e=this.get("credits").get(e);if(e){e.set("apply",false);e.set("amount",0);e.set("amount_formatted",_.formatCurrency(0));}return this.calculeTotal();},unselectDeposit:function(e){e=this.get("deposits").get(e);if(e){e.set("apply",false);e.set("amount",0);e.set("amount_formatted",_.formatCurrency(0));}return this.calculeTotal();},normalizeDate:function(e){if(!e){return;}else{if(e instanceof Date){return e.getTime();}else{if(typeof e==="string"){return Date.parse(e);}else{if(typeof e==="number"){return e;}}}}},distributeCredits:function(){var f=this,i=new d(this.getSelectedInvoices().sortBy(function(j){return f.normalizeDate(j.get("duedate"));})),e=this.get("deposits"),h=this.get("credits"),g=0;i.each(function(j){g=BigNumber(g).plus(j.get("amount")).toNumber();});e.each(function(j){if(BigNumber(j.get("remaining")).greaterThan(0)&&BigNumber(g).greaterThan(0)){var k=BigNumber(g).greaterThanOrEqualTo(j.get("remaining"))?j.get("remaining"):g;j.set("apply",true);j.set("amount",k);j.set("amount_formatted",_.formatCurrency(k));g=BigNumber(g).minus(k).toNumber();}else{j.set("apply",false);j.set("amount",0);j.set("amount_formatted",_.formatCurrency(0));}});h.each(function(k){if(BigNumber(k.get("remaining")).greaterThan(0)&&BigNumber(g).greaterThan(0)){var j=BigNumber(g).greaterThanOrEqualTo(k.get("remaining"))?k.get("remaining"):g;k.set("apply",true);k.set("amount",j);k.set("amount_formatted",_.formatCurrency(j));g=BigNumber(g).minus(j).toNumber();}else{k.set("apply",false);k.set("amount",0);k.set("amount_formatted",_.formatCurrency(0));}});this.calculeTotal();},calculeTotal:function(j){var k=0,f=0,m=0,h=0,l=this,i=new d(this.getSelectedInvoices().sortBy(function(n){return l.normalizeDate(n.get("duedate"));})),e=this.get("deposits"),g=this.get("credits");i.each(function(n){k=BigNumber(k).plus(n.get("amount")).toNumber();});f=k;e.each(function(n){m=BigNumber(m).plus(n.get("amount")).toNumber();f=BigNumber(f).minus(n.get("amount")).toNumber();});g.each(function(n){h=BigNumber(h).plus(n.get("amount")).toNumber();f=BigNumber(f).minus(n.get("amount")).toNumber();});if(!j){this.set("invoices_total_formatted",_.formatCurrency(k));this.set("invoices_total",k);this.set("deposits_total_formatted",_.formatCurrency(BigNumber(m).negated().toNumber()));this.set("deposits_total",m);this.set("credits_total_formatted",_.formatCurrency(BigNumber(h).negated().toNumber()));this.set("credits_total",h);this.set("payment_formatted",_.formatCurrency(f));this.set("payment",f);}return f;}});});define("Invoice.Collection",["Invoice.Model"],function(a){return Backbone.Collection.extend({model:a,url:"services/receipt.ss",initialize:function(){this.once("sync reset",function(){if(!this.original){this.original=this.clone();}});},getOpenInvoices:function(){return this.filter(function(c){var b=c.get("status");return _.isObject(b)?b.internalid==="open":b==="open";});},getPaidInvoices:function(){return this.filter(function(c){var b=c.get("status");return _.isObject(b)?b.internalid!=="open":b!=="open";});},clearFilters:function(){this.selectedFilter=null;this.selectedSort=null;this.order=null;this.range=null;},update:function(c){var d=this.selectedFilter!==c.filter,e=this.selectedSort!==c.sort,f=this.order!==c.order,b=!_.isEqual(c.range,this.range)&&(this.range||c.range);this.selectedFilter=c.filter;this.selectedSort=c.sort;this.order=c.order;this.range=c.range;if(d){this.applyFilter().applySort();}else{if(b){this.applyRangeFilter().applySort();}else{if(e){this.applySort();}else{if(f){this.reverseOrder();}}}}if(d||e||f||b){this.trigger("reset");}},applyFilter:function(){this.reset(this.selectedFilter.filter.call(this),{silent:true});return this;},fixDateRangeWithTimeZoneOffset:function(b){if(b){var e=new Date().getTimezoneOffset()*60*1000,g=_.stringToDate(b.from),f=_.stringToDate(b.to);if(_.isDateValid(g)&&_.isDateValid(f)){var d=new Date(f.getTime()+e),c=new Date(g.getTime()+e);d.setHours(23,59,59);c.setHours(0,0,0);return{from:c,to:d};}}},applyRangeFilter:function(){var b=this.fixDateRangeWithTimeZoneOffset(this.range)||{},d=b.from&&new Date(b.from).getTime(),c=b.to&&new Date(b.to).getTime();this.reset(this.original.filter(function(f){var e=new Date(f.get("tranDateInMilliseconds")).getTime();if(d&&!c){return e>=d;}if(!d&&c){return e<=c;}if(d&&c){return e>=d&&e<=c;}return true;}),{silent:true});return this;},applySort:function(){this.reset(this.selectedSort.sort.call(this),{silent:true});if(this.order===-1){this.reverseOrder();}return this;},reverseOrder:function(){this.reset(this.models.reverse(),{silent:true});return this;}});});define("Invoice.Details.View",["ReturnAuthorization.GetReturnableLines"],function(a){return Backbone.View.extend({template:"invoice_details",events:{'click [data-type="make-a-payment"]':"makeAPayment"},initialize:function(b){this.application=b.application;this.navSource=b.referer==="paidinvoices"?"/paid-invoices":"/invoices";},showContent:function(){var c=this.model.get("order_number"),b=this;this.page_header=_('Invoice <span class="strong-text">#$(0)</span>').translate(c);this.title=_("Invoice Details").translate();this.page_title=_('Invoice <span class="strong-text">#$(0)</span>').translate(c);this.options.application.getLayout().showContent(this,"invoices",[{text:_("Invoices").translate(),href:b.navSource},{text:_("Invoice #$(0)").translate(c),href:"/invoices/view/"+b.model.get("internalid")}]);},makeAPayment:function(){this.application.getLivePayment().selectInvoice(this.model.id);this.application.getUser().get("invoices").trigger("userInvocesChange");},isReturnable:function(){var b=new a(this.model,{notConsiderFulfillments:true});return b.calculateLines().validLines.length;}});});define("Invoice",["Invoice.Model","Invoice.Collection","Invoice.OpenList.View","Invoice.PaidList.View","Invoice.Details.View","Invoice.Router"],function(f,e,c,b,d,a){return{Model:f,InvoiceCollection:e,OpenListView:c,PaidListView:b,DetailsView:d,Router:a,MenuItems:{parent:"billing",id:"invoices",name:_("Invoices").translate(),url:"invoices",index:2,permission:"transactions.tranCustInvc.1,transactions.tranSalesOrd.1"},mountToApp:function(g){g.getUser().set("invoices",new e());return new a(g);}};});define("Invoice.Model",["OrderLine.Collection","OrderShipmethod.Collection","Address.Collection","CreditCard.Collection","OrderPaymentmethod.Collection","InvoicePayment.Collection","CreditMemo.Collection","InvoiceDepositApplication.Collection","ReturnAuthorization.Collection","OrderFulfillment.Collection"],function(a,d,h,k,b,f,e,j,i,c){function g(l){if(isNaN(parseFloat(l))){return _("The amount to pay is not a valid number").translate();}if(l<=0){return _("The amount to apply has to be positive").translate();}if(l>this.get("due")){return _("The amount to pay cannot exceed the remaining").translate();}}return Backbone.Model.extend({urlRoot:"services/receipt.ss",validation:{amount:{fn:g}},initialize:function(l){this.on("change:lines",function(n,m){n.set("lines",new a(m),{silent:true});});this.trigger("change:lines",this,l&&l.lines||[]);this.on("change:shipmethods",function(m,n){m.set("shipmethods",new d(n),{silent:true});});this.trigger("change:shipmethods",this,l&&l.shipmethods||[]);this.on("change:addresses",function(m,n){m.set("addresses",new h(n),{silent:true});});this.trigger("change:addresses",this,l&&l.addresses||[]);this.on("change:paymentmethods",function(m,n){m.set("paymentmethods",new b(n),{silent:true});});this.trigger("change:paymentmethods",this,l&&l.paymentmethod||[]);this.on("change:payments",function(m,n){m.set("payments",new f(n),{silent:true});});this.trigger("change:payments",this,l&&l.payments||[]);this.on("change:credit_memos",function(m,n){m.set("credit_memos",new e(n),{silent:true});});this.trigger("change:credit_memos",this,l&&l.credit_memos||[]);this.on("change:deposit_applications",function(m,n){m.set("deposit_applications",new j(n),{silent:true});});this.trigger("change:deposit_applications",this,l&&l.deposit_applications||[]);this.on("change:returnauthorizations",function(m,n){m.set("returnauthorizations",new i(n),{silent:true});});this.trigger("change:returnauthorizations",this,l&&l.returnauthorizations||[]);this.on("change:fulfillments",function(n,m){n.set("fulfillments",new c(m),{silent:true});});this.trigger("change:fulfillments",this,l&&l.fulfillments||[]);},isPayFull:function(){if(this.get("discountapplies")){return this.get("amount")===this.get("duewithdiscount");}else{return this.get("amount")===this.get("due");}}});});define("Invoice.OpenList.View",["Invoice.Collection","ListHeader"],function(b,c){function a(d){return d/1000/60/60/24;}return Backbone.View.extend({template:"open_invoices_list",title:_("Invoices").translate(),page_header:_("Invoices").translate(),attributes:{"class":"Invoices"},events:{'click [data-type="invoice"]':"toggleInvoiceHandler"},initialize:function(f){var d=this,e=f.application;this.application=e;this.user=e.getUser();this.disableCheckField="disable_payment";this.listHeader=new c({view:this,headerMarkup:function(){var g=d.getSelectedInvoicesLength();return SC.macros.makePaymentAction({invoices:d.collection,selected_invoices_length:g});},application:e,collection:this.collection,filters:this.filterOptions,sorts:this.sortOptions,selectable:true});this.getInvoicesList();this.listHeader.getUnselectedLength=this.getUnselectedLength;this.listHeader.getCollectionLength=this.getCollectionLength;this.collection.on("sync reset",function(){var g=this;e.getLivePayment().getSelectedInvoices().each(function(h){g.get(h).set("checked",true);});d.render();});},getCollectionLength:function(){var d=this.view;return this.collection.filter(function(e){return !e.get(d.disableCheckField);}).length;},getUnselectedLength:function(){var d=this.view;return this.collection.filter(function(e){return !e.get(d.disableCheckField)&&!e.get("checked");}).length;},getSelectedInvoicesLength:function(){return this.collection.filter(function(d){return d.get("checked");}).length;},toggleInvoiceHandler:function(d){this.toggleInvoice(jQuery(d.target).closest('[data-type="invoice"]').data("id"));},toggleInvoice:function(d){d=this.collection.get(d);if(d){this[d.get("checked")?"unselectInvoice":"selectInvoice"](d);this.render();}},getInvoicesList:function(){var e=this.application.getLivePayment().get("invoices"),d=this;this.collection.each(function(g){var f=e.get(g.id);g.set(d.disableCheckField,!!(f&&f.get("due")===0));});return this.collection;},selectInvoice:function(d){if(d){d.set("checked",true);}return this.application.getLivePayment().selectInvoice(d.id);},unselectInvoice:function(d){if(d){d.set("checked",false);}return this.application.getLivePayment().unselectInvoice(d.id);},selectAll:function(){var e=this,d=false;this.collection.each(function(f){if(!f.get("checked")&&!f.get(e.disableCheckField)){d=true;e.selectInvoice(f,{silent:true});}});if(d){this.render();}},unselectAll:function(){var e=this,d=false;this.collection.each(function(f){if(f.get("checked")){d=true;e.unselectInvoice(f,{silent:true});}});if(d){this.render();}},showContent:function(){this.options.application.getLayout().showContent(this,"invoices",[{text:this.title,href:"/invoices"}]);},filterOptions:[{value:"overdue",name:_("Show Overdue").translate(),filter:function(){return this.original.filter(function(d){return !d.get("dueinmilliseconds")||d.get("isOverdue");});}},{value:"next7days",name:_("Show Due next 7 days").translate(),filter:function(){return this.original.filter(function(d){return !d.get("dueinmilliseconds")||a(d.get("dueinmilliseconds"))<=7;});}},{value:"next30days",name:_("Show Due next 30 days").translate(),filter:function(){return this.original.filter(function(d){return !d.get("dueinmilliseconds")||a(d.get("dueinmilliseconds"))<=30;});}},{value:"next60days",name:_("Show Due next 60 days").translate(),filter:function(){return this.original.filter(function(d){return !d.get("dueinmilliseconds")||a(d.get("dueinmilliseconds"))<=60;});}},{value:"next90days",name:_("Show Due next 90 days").translate(),filter:function(){return this.original.filter(function(d){return !d.get("dueinmilliseconds")||a(d.get("dueinmilliseconds"))<=90;});}},{value:"all",name:_("Show All").translate(),selected:true,filter:function(){return this.original.models;}}],sortOptions:[{value:"duedate",name:_("By Due Date").translate(),selected:true,sort:function(){return this.models.sort(function(e,d){var g=e.get("dueinmilliseconds")||0,f=d.get("dueinmilliseconds")||0;if(g!==f){return g<f?-1:1;}return e.get("tranid")<d.get("tranid")?-1:1;});}},{value:"trandate",name:_("By Invoice Date").translate(),sort:function(){return this.models.sort(function(e,d){var g=e.get("tranDateInMilliseconds")||0,f=d.get("tranDateInMilliseconds")||0;if(g!==f){return g<f?-1:1;}return e.get("tranid")<d.get("tranid")?-1:1;});}},{value:"invoicenumber",name:_("By Invoice Number").translate(),sort:function(){return this.sortBy(function(d){return d.get("tranid");});}},{value:"amountdue",name:_("By Amount Due").translate(),sort:function(){return this.sortBy(function(d){return d.get("amountremaining");});}}]});});define("Invoice.PaidList.View",["Invoice.Collection","ListHeader"],function(a,b){return Backbone.View.extend({template:"paid_invoices_list",title:_("Invoices").translate(),page_header:_("Invoices").translate(),attributes:{"class":"PaidInvoices"},initialize:function(e){this.user=e.application.getUser();var d=new Date(),c=d.getFullYear()+"-"+(d.getMonth()+1)+"-"+d.getDate();this.rangeFilterOptions={fromMin:"1800-01-02",fromMax:c,toMin:"1800-01-02",toMax:c};this.listHeader=new b({view:this,application:e.application,collection:this.collection,sorts:this.sortOptions,rangeFilter:"date",rangeFilterLabel:_("From").translate()});this.collection.on("sync reset",jQuery.proxy(this,"render"));},showContent:function(){this.options.application.getLayout().showContent(this,"invoices",[{text:this.title,href:"/paid-invoices"}]);},sortOptions:[{value:"closedate",name:_("By Close Date").translate(),selected:true,sort:function(){return this.sortBy(function(c){return[c.get("closedateInMilliseconds"),c.get("tranid")];});}},{value:"trandate",name:_("By Invoice Date").translate(),sort:function(){return this.sortBy(function(c){return[c.get("tranDateInMilliseconds"),c.get("tranid")];});}},{value:"invoicenumber",name:_("By Invoice Number").translate(),sort:function(){return this.sortBy(function(c){return c.get("tranid");});}},{value:"amountdue",name:_("By Amount").translate(),sort:function(){return this.sortBy(function(c){return c.get("summary").total;});}}]});});define("Invoice.Router",["Invoice.Collection","Invoice.Model","Invoice.OpenList.View","Invoice.PaidList.View","Invoice.Details.View"],function(e,b,c,a,d){return Backbone.Router.extend({routes:{invoices:"showOpenInvoicesList","invoices?*options":"showOpenInvoicesList","paid-invoices":"showPaidInvoicesList","paid-invoices?*options":"showPaidInvoicesList","invoices/:id":"showInvoice","invoices/:id/:referer":"showInvoice"},initialize:function(f){this.application=f;},showOpenInvoicesList:function(){var g=new e(),f=new c({application:this.application,collection:g});g.on("sync",f.showContent,f).fetch({data:{type:"invoice",status:"open"},killerId:this.application.killerId});},showPaidInvoicesList:function(){var g=new e(),f=new a({application:this.application,collection:g});g.on("sync",f.showContent,f).fetch({data:{type:"invoice",status:"paid"},killerId:this.application.killerId});},showInvoice:function(i,h){var g=new b({internalid:i}),f=new d({application:this.application,model:g,referer:h});g.on("change",f.showContent,f).fetch({data:{type:"invoice"},killerId:this.application.killerId});}});});define("InvoiceDepositApplication.Collection",["InvoiceDepositApplication.Model"],function(a){return Backbone.Collection.extend({model:a});});define("InvoiceDepositApplication.Model",function(){return Backbone.Model.extend({});});define("InvoicePayment.Collection",["InvoicePayment.Model"],function(a){return Backbone.Collection.extend({model:a});});define("InvoicePayment.Model",function(){return Backbone.Model.extend({});});define("Deposit.Collection",["Deposit.Model"],function(a){return Backbone.Collection.extend({model:a,url:"services/deposit.ss",parse:function(b){return b.records;},comparator:function(c){var b=c.get("datecreated");if(b instanceof Date){return b.getTime();}else{if(typeof b==="number"){return b;}else{if(typeof b==="string"){return Date.parse(b);}}}}});});define("Deposit",["Deposit.Views","Deposit.Model","Deposit.Collection"],function(b,c,a){return{Views:b,Model:c,Collection:a};});define("Deposit.Model",["OrderPaymentmethod.Collection","Invoice.Collection"],function(a,b){return Backbone.Model.extend({urlRoot:"services/deposit.ss",initialize:function(c){this.on("change:paymentmethods",function(d,e){d.set("paymentmethods",new a(e),{silent:true});});this.trigger("change:paymentmethods",this,c&&c.paymentmethod||[]);this.on("change:invoices",function(d,e){d.set("invoices",new b(e),{silent:true});});this.trigger("change:invoices",this,c&&c.invoices||[]);if(!this.get("type")){this.set("type","Deposit");}}});});define("Deposit.Views",function(){var a={};a.Details=Backbone.View.extend({template:"deposit_details",title:_("Deposit Details").translate(),page_header:_("Deposit Details").translate(),attributes:{"class":"DepositDetails"},initialize:function(b){this.application=b.application;this.model=b.model;},showContent:function(){var b=this;this.options.application.getLayout().showContent(this,"transactionhistory",[{text:_("Transaction History").translate(),href:"transactionhistory"},{text:_("Deposit #$(0)").translate(b.model.get("tranid")),href:"transactionhistory/customerdeposit/"+b.model.get("internalid")}]);}});return a;});define("DepositApplication",["DepositApplication.Views","DepositApplication.Model"],function(a,b){return{Views:a,Model:b};});define("DepositApplication.Model",["Invoice.Collection"],function(a){return Backbone.Model.extend({urlRoot:"services/deposit-application.ss",initialize:function(b){this.on("change:invoices",function(c,d){c.set("invoices",new a(d),{silent:true});});this.trigger("change:invoices",this,b&&b.invoices||[]);}});});define("DepositApplication.Views",function(){var a={};a.Details=Backbone.View.extend({template:"deposit_application_details",title:_("Deposit Application Details").translate(),page_header:_("Deposit Application Details").translate(),attributes:{"class":"DepositApplicationDetails"},initialize:function(b){this.application=b.application;this.model=b.model;},showContent:function(){var b=this;this.options.application.getLayout().showContent(this,"transactionhistory",[{text:_("Transaction History").translate(),href:"transactionhistory"},{text:_("Deposit Application #$(0)").translate(b.model.get("tranid")),href:"transactionhistory/depositapplication/"+b.model.get("internalid")}]);}});return a;});define("CustomerPayment",["CustomerPayment.Views","CustomerPayment.Model"],function(a,b){return{Views:a,Model:b};});define("CustomerPayment.Model",["OrderPaymentmethod.Collection"],function(a){return Backbone.Model.extend({urlRoot:"services/payment.ss",initialize:function(b){this.on("change:paymentmethods",function(c,d){c.set("paymentmethods",new a(d),{silent:true});});this.trigger("change:paymentmethods",this,b&&b.paymentmethod||[]);}});});define("CustomerPayment.Views",function(){var a={};a.Details=Backbone.View.extend({template:"customer_payment_details",title:_("Payment Details").translate(),page_header:_("Payment Details").translate(),attributes:{"class":"PaymentDetails"},initialize:function(b){this.application=b.application;},showContent:function(){var b=this;this.application.getLayout().showContent(this,"customerpayment",[{text:_("Transaction History").translate(),href:"/transactionhistory"},{text:_("Payment #$(0)").translate(b.model.get("tranid")),href:"/transactionhistory/customerpayment/"+b.model.get("internalid")}]);}});return a;});define("CreditMemo.Collection",["CreditMemo.Model"],function(a){return Backbone.Collection.extend({model:a,url:"services/credit-memo.ss",parse:function(b){return b.records;},comparator:function(c){var b=c.get("trandate");if(b instanceof Date){return b.getTime();}else{if(typeof b==="number"){return b;}else{if(typeof b==="string"){return Date.parse(b);}}}}});});define("CreditMemo",["CreditMemo.Model","CreditMemo.Collection","CreditMemo.Views"],function(c,a,b){return{Model:c,Collection:a,Views:b};});define("CreditMemo.Model",["ItemDetails.Collection"],function(b){function a(e,c,d){if(isNaN(parseFloat(e))){return _("The amount to apply is not a valid number").translate();}if(e<=0){return _("The amount to apply has to be positive").translate();}if(e>d.remaining){return _("The amount to apply cannot exceed the remaining").translate();}if(d.orderTotal<0){return _("The amount to apply cannot exceed the remaining order total").translate();}}return Backbone.Model.extend({urlRoot:"services/credit-memo.ss",validation:{amount:{fn:a}},initialize:function(c){this.on("change:items",function(e,d){e.set("items",new b(d),{silent:true});});this.trigger("change:items",this,c&&c.items||[]);}});});define("CreditMemo.Views",function(){var a={};a.Details=Backbone.View.extend({template:"credit_memo_details",title:_("Credit Memo Details").translate(),page_header:_("Credit Memo Details").translate(),attributes:{"class":"CreditMemoDetails"},initialize:function(b){this.options=b;},showContent:function(){var b=this;this.options.application.getLayout().showContent(this,"transactionhistory",[{text:_("Transaction History").translate(),href:"transactionhistory"},{text:_("Credit Memo #$(0)").translate(b.model.get("tranid")),href:"transactionhistory/creditmemo/"+b.model.get("internalid")}]);}});return a;});define("ProductList.Collection",["ProductList.Model"],function(a){return Backbone.Collection.extend({url:_.getAbsoluteUrl("services/product-list.ss"),model:a,filtered:function(b){return new this.constructor(this.filter(b));}});});define("ProductList",["ProductListControl.Views","ProductListDetails.View","ProductList.Collection","ProductList.Model","ProductListItem.Collection","ProductListItem.Model","ProductList.Router","ProductListDeletion.View","ProductListCreation.View","ProductListLists.View"],function(i,g,e,c,b,l,f,m,a,k){var j=function(n){if(!n.ProductListModule.isProductListEnabled()){return undefined;}return{id:"product_list_dummy",name:n.ProductListModule.isSingleList()?_("Loading list...").translate():_("Loading lists...").translate(),url:"",index:2};};var d=function(o){if(!o.ProductListModule.isProductListEnabled()){return undefined;}var p=o.getProductLists(),n={id:function(q){var s=q.ProductListModule.isSingleList();if(s){var r=p.at(0);return"productlist_"+(r.get("internalid")?r.get("internalid"):("tmpl_"+r.get("templateid")));}else{return"productlists";}},name:function(q){return q.ProductListModule.isSingleList()?p.at(0).get("name"):_("Product Lists").translate();},url:function(q){var s=q.ProductListModule.isSingleList();if(s){var r=p.at(0);return"productlist/"+(r.get("internalid")?r.get("internalid"):("tmpl_"+r.get("templateid")));}else{return"";}},index:2,children:function(r){if(r.ProductListModule.isSingleList()){return[];}var q=[{id:"productlist_all",name:_("All my lists").translate(),url:"productlists/?",index:1}];p.each(function(s){q.push({id:"productlist_"+(s.get("internalid")||"tmpl_"+s.get("templateid")),url:"productlist/"+(s.get("internalid")||"tmpl_"+s.get("templateid")),name:s.get("name")+"&nbsp;("+s.get("items").length+")",index:2});});return q;}};return n;};var h=function(){var q={};var v={control:'[data-type="product-lists-control"]'};var x={Control:i,Details:g,NewList:a,Lists:k,Delete:m},n={ProductList:c,ProductListItem:l},s={ProductList:e,ProductListItem:b};var p=function(){var y=q;return y.getConfig("product_lists")!==undefined;};var w=function(){var y=q;return !y.getConfig("product_lists.additionEnabled")&&y.getConfig("product_lists.list_templates")&&_.filter(y.getConfig("product_lists.list_templates"),function(z){return !z.type||z.type.name!=="later";}).length===1;};var o=function(y){q=y;y.getProductListsPromise=function(){if(!y.productListsInstancePromise){y.productListsInstancePromise=jQuery.Deferred();y.productListsInstance=new e();y.productListsInstance.application=y;y.productListsInstance.fetch().done(function(z){y.productListsInstance.set(z);y.productListsInstancePromise.resolve(y.productListsInstance);});}return y.productListsInstancePromise;};y.getProductLists=function(){if(!y.productListsInstance){y.productListsInstance=new e();y.productListsInstance.application=y;}return y.productListsInstance;};y.getProductList=function(A){var z=new c();z.set("internalid",A);return z.fetch();};y.getSavedForLaterProductList=function(){var z=new c();z.set("internalid","later");return z.fetch();};y.ProductListModule=h;y.getUserPromise().done(function(){if(SC.ENVIRONMENT.PRODUCTLISTS_CONFIG){y.Configuration.product_lists=SC.ENVIRONMENT.PRODUCTLISTS_CONFIG;}if(y.ProductListModule.isProductListEnabled()){var z=y.getLayout();y.ProductListModule.renderProductLists();z.on("afterAppendView",function(A){y.ProductListModule.renderProductLists(A);});z.on("afterAppendToDom",function(){y.ProductListModule.renderProductLists();});y.getProductListsPromise().done(function(){z.replaceMenuItem&&z.replaceMenuItem(function(D){return D&&D.id==="product_list_dummy";},d);z.updateMenuItemsUI&&z.updateMenuItemsUI();if(y.ProductListModule.isSingleList()){var B=y.getProductLists().at(0),C=z.$(".header-profile-single-productlist");if(B&&C){var A="#productlist/"+(B.get("internalid")?B.get("internalid"):("tmpl_"+B.get("templateid")));C.text(B.get("name"));C.attr("data-hashtag",A);z.updateUI();}}});l.prototype.keyMapping=y.getConfig("itemKeyMapping",{});l.prototype.itemOptionsConfig=y.getConfig("itemOptions",[]);}});return new f(y);};var t=function(z){var y=q;jQuery(v.control).each(function(){var A=z||y.getLayout().currentView,B=y.ProductListModule.isSingleList(),C=jQuery(this);y.getProductListsPromise().done(function(){if(A&&A.model&&A.model.getPosibleOptions){var D=null;if(B){D=new i.ControlSingle({collection:y.getProductLists(),product:A.model,application:y});}else{D=new i.Control({collection:y.getProductLists(),product:A.model,application:y});}C.empty().append(D.$el);D.render();}});if(y.getProductListsPromise().state()==="pending"){C.empty().append('<button class="btn">'+B?_("Loading List...").translate():_("Loading Lists...").translate()+"</button>");}});};var u=function(y){var z=q;if(!z.ProductListModule.isProductListEnabled()){return;}SC.ENVIRONMENT.customer_internalid=z.getUser().get("internalid");z.ProductListModule.renderControl(y);};var r=function(z){if(z.getPosibleOptions().length){var y=z.getSelectedMatrixChilds();if(y.length===1){return y[0].get("internalid")+"";}}return z.get("_id")+"";};return{Views:x,Models:n,Collections:s,Router:f,isProductListEnabled:p,isSingleList:w,mountToApp:o,renderControl:t,renderProductLists:u,internalGetProductId:r,placeholder:v,MenuItems:j};}();return h;});define("ProductList.Model",["ProductListItem.Collection"],function(c){function a(e,d){var f=300;if(e&&e.length>f){return _("$(0) must be at most $(1) characters").translate(d,f);}}function b(e,d){if(!e){return _("Name is required").translate();}return a(e,d);}return Backbone.Model.extend({urlRoot:_.getAbsoluteUrl("services/product-list.ss"),defaults:{name:"",description:"",items:new c(),scope:{id:"2",name:"private"},type:{id:"1",name:"default"}},validation:{name:{fn:b},description:{fn:a}},url:function(){var d=Backbone.Model.prototype.url.apply(this,arguments);return d+"&t="+new Date().getTime();},initialize:function(d){var e;if(d&&d.items){e=new c(d.items);}else{e=new c([]);}this.set("items",e);},checked:function(d,e){return this.get("items").some(function(f){if(f.item.internalid===d){var g=f.get("options");if(_.isEmpty(g)&&_.isEmpty(e)){return true;}else{return _.isEqual(g,e);}}return false;});},getOutOfStockItems:function(d){var e=!_.isUndefined(d)?d:this.get("items");return e.filter(function(f){return !f.get("item").ispurchasable;});},getNotPurchasableItemsDueToMinimumQuantity:function(d){var e=!_.isUndefined(d)?d:this.get("items");return e.filter(function(f){return !f.fulfillsMinimumQuantityRequirement();});},someCheckedItemsExist:function(){return this.get("items").some(function(d){return d.get("checked");});},canBeAddedToCart:function(d){var e=!_.isUndefined(d)?this.get("items").filter(function(f){return f.get("checked");}):this.get("items");return e.length&&this.getOutOfStockItems(e).length===0&&this.getNotPurchasableItemsDueToMinimumQuantity(e).length===0;}});});define("ProductList.Router",["ProductList.Model"],function(a){return Backbone.Router.extend({routes:{productlists:"showProductListsList","productlists/?*options":"showProductListsList","productlist/:id":"showProductListDetails","productlist/:id/?*options":"showProductListDetails"},initialize:function(b){this.application=b;},showProductListDetails:function(i,g){var h="tmpl_",e=this,d=i.indexOf("?"),b;if(d!==-1){g=i.substring(d);b=parseInt(i,10);if(!isNaN(b)){i=b+"";}}if(i.indexOf(h)===0){var c=i.substring(h.length,d!==-1?d:i.length),f=e.application.getProductLists().fetch();f.done(function(){var j=e.application.getProductLists().findWhere({templateid:c});e.doShowProductListDetails(j,g);});}else{e.application.getProductList(i).done(function(j){e.doShowProductListDetails(new a(j),g);});}},doShowProductListDetails:function(d,c){var e=_.parseUrlOptions(c),b=new this.application.ProductListModule.Views.Details({application:this.application,params:e,model:d,includeSortingFilteringHeader:true});b.showContent("productlist_"+(d.get("internalid")?d.get("internalid"):"tmpl_"+d.get("templateid")));},showProductListsList:function(c){var b=this;this.application.getProductListsPromise().done(function(){var e=_.parseUrlOptions(c),d=new b.application.ProductListModule.Views.Lists({application:b.application,params:e,collection:b.application.getProductLists()});d.showContent("productlist_all");});}});});define("ProductListAddedToCart.View",function(){return Backbone.View.extend({template:"product_list_added_to_cart",attributes:{"class":"product-list-added-to-cart"},title:_("Added to Cart").translate(),initialize:function(a){this.options=a;this.application=a.application;},render:function(){Backbone.View.prototype.render.apply(this);var c=this.options.list,a=this.options.not_purchasable_items_count;if(c&&a>0){var b=a===1?_("One item not available for purchase was not added to the cart.").translate():_("$(0) items not available for purchase were not added to the cart.").translate(a);this.showWarningMessage(b);}},showWarningMessage:function(a){this.$("[data-warning-message]").empty().append(a);}});});define("ProductListControl.Views",["ProductList.Model","ProductListItem.Collection","Session"],function(b,d,a){var c={};c.Control=Backbone.View.extend({template:"product_list_control",attributes:{"class":"dropdown product-lists"},events:{'click [data-type="show-new-list"]':"showNewProductList",'click [data-action="show-productlist-control"]':"toggleProductListControl"},initialize:function(e){this.product=e.product;this.collection=e.collection;this.application=e.application;this.moveOptions=e.moveOptions;if(this.moveOptions){this.mode="move";}jQuery(document).click(function(g){if(jQuery(g.target).parents().index(jQuery(g.target).closest('[data-type^="productlist-control"]'))===-1&&jQuery(g.target).attr("class")&&jQuery(g.target).attr("class").indexOf("productlist-control")===-1){if(jQuery('[data-type="productlist-control"]').is(":visible")){var f=jQuery('[data-type="productlist-control"]');f.find('form[data-type="add-new-list-form"]').hide();f.find('[data-type="show-add-new-list-form"]').show();f.slideUp();}}});},render:function(){this.is_visible=this.$('[data-type="productlist-control"]').is(":visible");Backbone.View.prototype.render.apply(this);var e=this;e.collection.each(function(i){var h=new c.ControlItem({model:i,product:e.product,application:e.application,parentView:e});e.$("ul").prepend(h.render().el);});var f=this.getNewProductListModel(),g=new c.ControlNewItem({model:f,application:e.application,parentView:e});e.$('[data-type="new-item-container"]').html(g.render().el);if(this.application.getUser().get("isLoggedIn")==="T"&&!e.isReadyForList()){e.$('[data-action="show-productlist-control"]').attr("disabled","true");}e.confirm_message&&e.saveAndShowConfirmationMessage(e.confirm_message);},getNewProductListModel:function(){return new b();},toggleProductListControl:function(g){if(this.mode==="move"){g&&g.stopPropagation();}if(!this.validateLogin()){return;}var f=this.$('[data-type="productlist-control"]');if(f.is(":visible")){f.find('form[data-type="add-new-list-form"]').hide();f.find('[data-type="show-add-new-list-form"]').show();f.slideUp();}else{if(this.mode==="move"){jQuery('[data-type="productlist-control"]').hide();}f.slideDown();}},validateLogin:function(){if(this.application.getUser().get("isLoggedIn")==="F"){var e=a.get("touchpoints.login");e+="&origin="+this.application.getConfig("currentTouchpoint");if(this.$el.closest(".modal-product-detail").size()>0){var f=this.$el.closest(".modal-product-detail").find('[data-name="view-full-details"]').data("hashtag");e+="&origin_hash="+f.replace("#/","");}else{e+="&origin_hash="+Backbone.history.fragment;}window.location.href=e;return false;}return true;},validateGiftCertificate:function(e){if(e.itemOptions&&e.itemOptions.GIFTCERTRECIPIENTEMAIL){if(!Backbone.Validation.patterns.email.test(e.itemOptions.GIFTCERTRECIPIENTEMAIL.label)){this.render();this.showError(_("Recipient email is invalid").translate());return false;}}return true;},getItemOptions:function(f){var e={};_.each(f,function(h,g){e[g]={value:h.internalid,displayvalue:h.label};});return e;},addNewProductToList:function(e){this.addItemToList(this.product,e,true);this.saveAndShowConfirmationMessage(this.$('.ul-product-lists [type="checkbox"]:checked').size()>1?_("Good! You added this item to your product lists").translate():_("Good! You added this item to your product list").translate());},addItemToList:function(g,h,f){if(!this.validateGiftCertificate(this.product)){return;}var e=this;if(!h.get("internalid")){h.save().done(function(j){var i=new b(j);e.application.getProductLists().add(i,{merge:true});e.doAddItemToList(g,i,f);});}else{e.doAddItemToList(g,h,f);}},getNewItemData:function(e,f){return{description:"",options:this.getItemOptions(e.itemOptions),quantity:e.get("quantity"),productList:{id:f.get("internalid"),owner:f.get("owner").id},item:{internalid:this.getProductId(e)}};},doAddItemToList:function(h,i,g){var e=this,f=this.getNewItemData(h,i);i.get("items").create(f,{success:function(){e.collection.trigger("changed");e.render();if(!g){e.saveAndShowConfirmationMessage(e.$('.ul-product-lists [type="checkbox"]:checked').size()>1?_("Good! You added this item to your product lists").translate():_("Good! You added this item to your product list").translate());}}});},moveProductHandler:function(e){var f=this;if(!e.get("internalid")){e.save().done(function(h){var g=new b(h);f.application.getProductLists().add(g,{merge:true});f.moveProduct(g);});}else{f.application.getProductLists().add(e,{merge:true});f.moveProduct(e);}},moveProduct:function(e){var f=this,g=this.moveOptions.productListItem,i=g.clone(),h=this.moveOptions.parentView;i.set("productList",{id:e.get("internalid")});f.toggleProductListControl();e.get("items").create(i,{success:function(l){var m=h.application,j=f.application.getProductLists().findWhere({internalid:f.moveOptions.parentView.model.get("internalid")}),k=f.application.getProductLists().findWhere({internalid:e.get("internalid")});f.doMoveProduct(j,k,g,l);h.model.get("items").remove(g);h.render();m.getLayout().updateMenuItemsUI();m.getLayout().currentView.showConfirmationMessage(_("Good! You successfully moved the item from this to $(0)").translate('<a href="/productlist/'+e.get("internalid")+'">'+e.get("name")+"</a>"));}});},doMoveProduct:function(h,g,e,f){if(g.get("items") instanceof Array){g.set("items",new d());}g.get("items").add(f);h.get("items").remove(e);this.collection.trigger("changed");},getProductId:function(e){if(this.application.ProductListModule){return this.application.ProductListModule.internalGetProductId(e);}else{return e.get("_id")+"";}},isAvailable:function(){return true;},isReadyForList:function(){return this.mode==="move"||this.product.isSelectionComplete();},showNewProductList:function(g){var f=jQuery(g.target);f.siblings('[data-type="add-new-list-form"]').show();f.hide();this.$('[data-type="new-product-list-name"]').focus();},saveAndShowConfirmationMessage:function(e){this.confirm_message=e;this.showConfirmationMessage(this.confirm_message);},hideConfirmationMessage:function(){this.confirm_message=null;this.$("[data-confirm-message]").hide();}});c.ControlItem=Backbone.View.extend({tagName:"li",template:"product_list_control_item",events:{'click [data-action="product-list-item"]':"pListItemHandler"},initialize:function(e){this.model=e.model;this.product=e.product;this.application=e.application;this.parentView=e.parentView;},checked:function(){return this.parentView.mode!=="move"?this.model.checked(this.parentView.getProductId(this.product),this.parentView.getItemOptions(this.product.itemOptions)):false;},pListItemHandler:function(h){var f=this,g=jQuery(h.target);if(f.parentView.mode==="move"){f.moveProduct();}else{f.addRemoveProduct(g);}},moveProduct:function(){this.parentView.moveProductHandler(this.model);},addRemoveProduct:function(e){if(e.is(":checked")){this.parentView.addItemToList(this.product,this.model);}else{this.removeItemFromList(this.product);}},removeItemFromList:function(g){var e=this,f=this.parentView.getProductId(g),h=e.model.get("items").find(function(i){return parseInt(i.get("item").internalid,10)===parseInt(f,10);});if(h){h.set("productList",{id:e.model.get("internalid"),owner:e.model.get("owner").id});this.model.get("items").remove(h);h.destroy().done(function(){e.model.collection.trigger("changed");e.parentView.render();e.parentView.hideConfirmationMessage();});}else{e.parentView.render();}}});c.ControlNewItem=Backbone.View.extend({tagName:"div",template:"product_list_control_new_pl",events:{'click [data-action="create-and-move"]':"saveForm",'click [data-type="show-add-new-list-form"]':"showNewListForm"},initialize:function(e){this.application=e.application;this.model=e.model;this.parentView=e.parentView;},saveForm:function(){if(!this.parentView.validateGiftCertificate(this.parentView.product)){return;}var e=this;Backbone.View.prototype.saveForm.apply(this,arguments).done(function(){var f=e.model,g=e.parentView;f.set("items",new d(f.get("items")));if(g.mode==="move"){g.moveProductHandler(f);g.collection.add(e.model,{merge:true});}else{g.collection.add(f);g.addNewProductToList(f);}});},showNewListForm:function(h){h&&h.stopPropagation();var f=jQuery(this.el);var g=f.find('form[data-type="add-new-list-form"]');if(g){g.show();this.$('[data-type="new-product-list-name"]').focus();f.find(h.target).hide();}}});c.ControlSingle=Backbone.View.extend({template:"product_list_control_single",attributes:{"class":"product-lists-single"},events:{'click [data-type="add-product-to-single-list"]':"addItemToSingleList"},addItemToList:c.Control.prototype.addItemToList,doAddItemToList:c.Control.prototype.doAddItemToList,saveAndShowConfirmationMessage:c.Control.prototype.saveAndShowConfirmationMessage,isReadyForList:c.Control.prototype.isReadyForList,validateGiftCertificate:c.Control.prototype.validateGiftCertificate,getItemOptions:c.Control.prototype.getItemOptions,validateLogin:c.Control.prototype.validateLogin,getProductId:c.Control.prototype.getProductId,initialize:function(e){this.product=e.product;this.collection=e.collection;this.application=e.application;this.single_list=this.collection.at(0);},render:function(){Backbone.View.prototype.render.apply(this);if(!this.isReadyForList()){this.$('[data-type="add-product-to-single-list"]').attr("disabled","true");}},getProductsInternalid:function(){return _(this.single_list.get("items").models).map(function(e){return e.get("item").internalid;});},addItemToSingleList:function(g){if(!this.validateLogin()){return;}var f=this;g.preventDefault();if(!f.single_list.get("internalid")){f.single_list.save().done(function(){f.single_list.set("items",new d([]));f.renderAfterAdded(f);});}else{f.renderAfterAdded(f);}},renderAfterAdded:function(e){if(!this.validateGiftCertificate(e.product)){return;}e.addItemToList(e.product,e.single_list);e.render();e.saveAndShowConfirmationMessage(_("Good! You added this item to your product list").translate());this.$('[data-type="add-product-to-single-list"]').attr("disabled","true");}});return c;});define("ProductListCreation.View",["ProductList.Model","ProductListItem.Collection"],function(a,b){return Backbone.View.extend({template:"product_list_new",attributes:{"class":"container product-list-new"},events:{"submit form":"saveForm",'keypress [type="text"]':"preventEnter"},initialize:function(c){this.application=c.application;this.parentView=c.parentView;this.model=c.model;this.isEdit=this.model.get("internalid");this.page_header=this.getTitle();},preventEnter:function(c){if(c.keyCode===13){c.preventDefault();}},getTitle:function(){this.$('[name="name"]').focus();return this.isEdit?_("Edit your list").translate():_("Create a new list").translate();},saveForm:function(){var c=this,d=Backbone.View.prototype.saveForm.apply(c,arguments);d&&d.done(function(){c.model.set("items",new b(c.model.get("items")));c.$containerModal&&c.$containerModal.modal("hide");if(c.isEdit){c.application.getProductLists().add(c.model,{merge:true});c.application.getLayout().updateMenuItemsUI();c.parentView.render();if(c.parentView.$el.hasClass("ProductListDetailsView")){c.parentView.showConfirmationMessage(_("Good! The list was successfully updated. ").translate());}else{c.parentView.showConfirmationMessage(_("Good! Your $(0) list was successfully updated. ").translate('<a href="/productlist/'+c.model.get("internalid")+'">'+c.model.get("name")+"</a>"));}}else{c.application.getProductLists().add(c.model);c.application.getLayout().updateMenuItemsUI();c.parentView.showConfirmationMessage(_("Good! Your $(0) list was successfully created. ").translate('<a href="/productlist/'+c.model.get("internalid")+'">'+c.model.get("name")+"</a>"));}c.parentView.highlightList&&c.parentView.highlightList(c.model.get("internalid"));});},getName:function(){return this.$(".product-list-new-name-input input").val();},getNotes:function(){return this.$(".product-list-new-notes-input textarea").val();}});});define("ProductListDeletion.View",function(){return Backbone.View.extend({template:"product_list_delete_confirm",title:_("Delete item").translate(),attributes:{"class":"view product-list-delete-confirm"},page_header:_("Delete item").translate(),events:{'click [data-action="delete"]':"confirmDelete"},initialize:function(a){this.application=a.application;this.parentView=a.parentView;this.target=a.target;this.title=a.title;this.page_header=a.title;this.body=a.body;this.confirm_delete_method=a.confirm_delete_method;this.confirmLabel=a.confirmLabel||_("Yes, Remove It").translate();},confirmDelete:function(){this.parentView[this.confirm_delete_method](this.target);},render:function(){Backbone.View.prototype.render.apply(this,arguments);var a=this;this.$containerModal.on("shown.bs.modal",function(){a.$('[data-action="delete"]').focus();});},getTitle:function(){return _("Delete product list").translate();}});});define("ProductListDetails.View",["ProductListItem.Collection","ProductListDeletion.View","ProductList.Model","ItemDetails.Model","ProductListLists.View","ProductListAddedToCart.View","ProductListItemEdit.View","ProductListItem.Model","ProductListControl.Views","ListHeader"],function(a,h,b,d,i,c,f,j,g,e){return Backbone.View.extend({template:"product_list_details",className:"ProductListDetailsView",attributes:{"class":"ProductListDetailsView"},events:{'click [data-action="add-to-cart"]':"addItemToCartHandler",'click [data-action="add-items-to-cart"]':"addItemsToCartBulkHandler",'click [data-action="delete-item"]':"askDeleteListItem",'click [data-action="delete-items"]':"deleteItemsHandler",'click [data-action="edit-item"]':"askEditListItem",'click [data-action="update-item-quantity"]':"updateListItemQuantity",'click [data-ui-action="show-edit-notes"]':"showEditNotes",'click [data-ui-action="cancel-edit-notes-form"]':"showViewNotes",'click [data-ui-action="plus-one"]':"addPlusOne",'click [data-ui-action="minus-one"]':"addMinusOne",'click [data-action="add-list-to-cart"]':"addListToCart_",'click [data-action="edit-list"]':"editListHandler",'click [data-action="delete-list"]':"deleteListHandler",'change [name="item_quantity"]':"updateItemQuantity",'keyup [name="item_quantity"]':"updateItemQuantity",'submit [data-action="update-quantity-item-list"]':"updateItemQuantityFormSubmit",'click [data-type="product-list-item"]':"toggleProductListItemHandler"},sortOptions:[{value:"name",name:_("Sort by name").translate(),selected:true},{value:"price",name:_("Sort by price").translate()},{value:"created",name:_("Sort by date Added").translate()},{value:"priority",name:_("Sort by priority").translate()}],initialize:function(k){this.options=k;this.model=k.model;this.application=k.application;this.cart=this.application.getCart();this.displayOptions=this.application.getConfig("product_lists.itemsDisplayOptions");this.sflMode=k.sflMode;this.addToCartCallback=k.addToCartCallback;this.includeSortingFilteringHeader=k.includeSortingFilteringHeader;this.title=this.model.get("name");this.collection=this.model.get("items");this.collection.productListId=this.model.get("internalid");this.setupListHeader(this.collection);this.collection.on("reset",jQuery.proxy(this,"render"));},setupListHeader:function(l){if(!this.includeSortingFilteringHeader){return;}var k=this;this.listHeader=new e({view:this,application:this.application,headerMarkup:function(){return SC.macros.productListBulkActions(k.model);},hideFilterExpandable:function(){return this.collection.length<2;},selectable:true,collection:l,sorts:this.sortOptions,displays:this.displayOptions});},addListToCart_:function(){this.addListToCart(this.model);},addListToCart:i.prototype.addListToCart,askDeleteListItem:function(k){k.stopPropagation();this.deleteConfirmationView=new h({application:this.application,parentView:this,target:k.target,title:_("Delete selected items").translate(),body:_("Are you sure you want to remove selected items?").translate(),confirmLabel:_("Yes").translate(),confirm_delete_method:"deleteListItemHandler"});this.application.getLayout().showInModal(this.deleteConfirmationView);},addItemToCartHandler:function(m){m.stopPropagation();m.preventDefault();var s=this,r=s.$(m.target).closest("article").data("id"),n=s.model.get("items").findWhere({internalid:r.toString()}),o=n.get("item"),k=o.internalid,l=s.getItemForCart(k,n.get("quantity"));l.set("_optionsDetails",o.itemoptions_detail);l.setOptionsArray(n.getOptionsArray(),true);var p=this.addItemToCart(l),q=null;if(this.sflMode){q=jQuery.when(p,this.deleteListItem(n)).then(jQuery.proxy(this,"executeAddToCartCallback"));}else{q=jQuery.when(p).then(jQuery.proxy(this,"showConfirmationHelper",n));}if(q){this.disableElementsOnPromise(q,'article[data-item-id="'+k+'"] a, article[data-item-id="'+k+'"] button');}},_getSelection:function(){var l=this,k=[],n=[],m=[];_.each(this.collection.models,function(p){if(p.get("checked")!==true){return;}k.push(p);var o=p.get("item").internalid;var q=l.getItemForCart(o,p.get("quantity"),p.get("options"));n.push(q);m.push('article[data-item-id="'+o+'"] a, article[data-item-id="'+o+'"] button');});return{items:k,items_for_cart:n,button_selector:m};},addItemsToCartBulkHandler:function(n){n.preventDefault();var l=this;var k=this._getSelection();if(k.items.length<1){return;}var m=k.button_selector.join(",");var o=this.cart.addItems(k.items_for_cart);o.then(function(){l.unselectAll();l.showConfirmationHelper();});if(o){this.disableElementsOnPromise(o,m);}},deleteItemsHandler:function(o){o.preventDefault();var m=this,l=this._getSelection(),k=[];if(l.items.length<1){return;}var n=_.findWhere(m.application.getProductLists().models,{id:m.model.id});_.each(l.items,function(p){p.url=j.prototype.url;n&&n.get("items").remove(p);k.push(p.destroy().promise());});jQuery.when.apply(jQuery,k).then(function(){m.render();m.application.getLayout().updateMenuItemsUI();m.showConfirmationMessage(_("The selected items were removed from your product list").translate());});},selectAll:function(){_.each(this.collection.models,function(k){k.set("checked",true);});this.render();},unselectAll:function(){_.each(this.collection.models,function(k){k.set("checked",false);});this.render();},executeAddToCartCallback:function(){if(!this.addToCartCallback){return;}this.addToCartCallback();},showConfirmationHelper:function(k){this.showConfirmationMessage(_('Good! The items were successfully added to your cart. You can continue to <a href="#" data-touchpoint="viewcart">view cart and checkout</a>').translate());if(_.isUndefined(k)===true){return;}this.addedToCartView=new c({application:this.application,parentView:this,item:k});this.application.getLayout().showInModal(this.addedToCartView);},getItemForCart:function(m,l,k){return new d({internalid:m,quantity:l,options:k});},addItemToCart:function(k){return this.cart.addItem(k);},deleteListItemHandler:function(n){var k=this,m=jQuery(n).closest("article").data("id"),l=this.model.get("items").findWhere({internalid:m+""});var o=function(){if(k.application.getLayout().updateMenuItemsUI){k.application.getLayout().updateMenuItemsUI();}k.deleteConfirmationView.$containerModal.modal("hide");k.render();k.showConfirmationMessage(_("The item was removed from your product list").translate());};var p=k.application.getProductLists().where({internalid:k.model.id});if(p.length>0){p[0].get("items").remove(l);}k.deleteListItem(l,o);},deleteListItem:function(k,l){this.model.get("items").remove(k);k.url=j.prototype.url;var m=k.destroy();m&&l&&m.done(function(){l();});},askEditListItem:function(m){m.stopPropagation();var l=this.$(m.target).closest("article").data("id"),k=this.model.get("items").findWhere({internalid:l.toString()});this.editView=new f({application:this.application,parentView:this,target:m.target,model:k,title:_("Edit Item").translate(),confirm_edit_method:"editListItemHandler"});this.editView.showInModal();},updateListItemQuantity:function(n){n.preventDefault();var l=this.$(n.target).closest("article").data("id"),m=this.model.get("items").findWhere({internalid:l.toString()}),k=m.get("item").minimumquantity;this.updateItemQuantityHelper(m,k);},editListItemHandler:function(l){var k=this,m=l.save();if(!m){return;}m.done(function(o){var n=new j(o);k.model.get("items").add(n,{merge:true});k.editView.$containerModal.modal("hide");k.editView.destroy();k.render();});},getDisplayOption:function(){var k=(this.options.params&&this.options.params.display)||"list";return _(this.displayOptions).findWhere({id:k});},render:function(){Backbone.View.prototype.render.apply(this,arguments);var m=this,l=[],k=this.model.get("items"),o=this.application.ProductListModule.isSingleList();k.each(function(p){if(!p.get("item").ispurchasable){l.push(p);}m.renderOptions(p);if(!o){m.renderMove(p);}});var n=null;if(l.length===1){n=_("$(0) of $(1) items in your list is currently not available for purchase. If you decide to add the list to your cart, only available products will be added.").translate(l.length,k.length);}else{if(l.length>1){n=_("$(0) of $(1) items in your list are currently not available for purchase. If you decide to add the list to your cart, only available products will be added.").translate(l.length,k.length);}}if(n){m.showWarningMessage(n);}return this;},renderOptions:function(k){var m=k.get("itemDetails");var l=m.getPosibleOptions();this.$('article[data-id="'+k.id+'"]').find('div[data-type="all-options"]').each(function(p,n){var r=jQuery(n).empty(),o=_.map((r.data("exclude-options")||"").split(","),function(s){return jQuery.trim(s);}),q="";_.each(l,function(s){if(!_.contains(o,s.cartOptionId)){q+=m.renderOptionSelected(s);}});r.append(q);if(q.length===0){r.remove();}});},renderMove:function(m){var l=this;var k=this.$('article[data-id="'+m.id+'"]').find('div[data-type="productlist-control-move"]');var n=new g.Control({collection:l.getMoveLists(l.application.getProductLists(),l.model,m),product:m.get("item"),application:l.application,moveOptions:{parentView:l,productListItem:m}});jQuery(k).empty().append(n.$el);n.render();},getMoveLists:function(l,m,k){return l.filtered(function(n){return n.get("internalid")!==m.get("internalid")&&!n.get("items").find(function(o){return o.get("item").internalid+""===k.get("item").internalid+"";});});},editListHandler:function(k){k.preventDefault();i.prototype.editList.apply(this,[this.model]);},deleteListHandler:function(k){k.preventDefault();this.deleteConfirmationView=new h({application:this.application,parentView:this,target:null,title:_("Delete list").translate(),body:_("Are you sure you want to remove this list?").translate(),confirm_delete_method:"deleteList"});this.application.getLayout().showInModal(this.deleteConfirmationView);},deleteList:function(){var k=this,l=this.model;this.application.getProductLists().remove(l);l.url=b.prototype.url;l.destroy().done(function(){k.deleteConfirmationView.$containerModal.modal("hide");Backbone.history.navigate("/productlists",{trigger:true});k.application.getLayout().updateMenuItemsUI();k.application.getLayout().currentView.showConfirmationMessage(_("Your $(0) list was removed").translate('<span class="product-list-name">'+l.get("name")+"</span>"));});},getViewLabel:function(){return"productlist_"+(this.model.get("internalid")?this.model.get("internalid"):"tmpl_"+this.model.get("templateid"));},showContent:function(){var k=[{text:_("Product Lists").translate(),href:"/productlists"},{text:this.model.get("name"),href:"/productlist/"+(this.model.get("internalid")?this.model.get("internalid"):"tmpl_"+this.model.get("templateid"))}];if(this.application.ProductListModule.isSingleList()){k.splice(0,1);}this.application.getLayout().showContent(this,this.getViewLabel(),k);},updateItemQuantityFormSubmit:function(k){k.preventDefault();this.updateItemQuantity(k);},updateItemQuantityHelper:function(m,l){m.set("quantity",l);var k=this,n=m.save();if(n){n.done(function(p){var o=new j(p);k.model.get("items").add(o,{merge:true});k.render();});}return n;},updateItemQuantity:_.debounce(function(p){p.preventDefault();var o=this.$(p.target).closest("article").data("id"),n=this.model.get("items").findWhere({internalid:o.toString()}),k=jQuery(p.target).closest("form").serializeObject(),r=jQuery(p.target).closest("form").find('[name="item_quantity"]'),m=parseInt(k.item_quantity,10),q=parseInt(n.get("quantity"),10);m=(m>0)?m:q;r.val(m);if(m===q){return;}r.val(m).prop("disabled",true);var l=this.updateItemQuantityHelper(n,m);if(!l){return;}l.always(function(){r.prop("disabled",false);});},600),toggleProductListItemHandler:function(k){this.toggleProductListItem(jQuery(k.target).closest("article").data("id"));},toggleProductListItem:function(k){k=this.collection.get(k);if(k){this[k.get("checked")?"unselectProductListItem":"selectProductListItem"](k);this.render();}},selectProductListItem:function(k){if(k){k.set("checked",true);}},unselectProductListItem:function(k){if(k){k.set("checked",false);}}});});define("ProductListItem.Collection",["ProductListItem.Model"],function(a){return Backbone.Collection.extend({model:a,url:_.getAbsoluteUrl("services/product-list-item.ss"),initialize:function(b){this.options=b;},update:function(b){this.fetch({data:{productlistid:this.productListId,internalid:null,sort:b.sort.value,order:b.order,page:b.page},reset:true,killerId:b.killerId});}});});define("ProductListItem.Model",["ItemDetails.Model"],function(a){return Backbone.Model.extend({urlRoot:_.getAbsoluteUrl("services/product-list-item.ss"),defaults:{priority:{id:"2",name:"medium"},options:""},validation:{name:{required:true,msg:_("Name is required").translate()}},url:function(){var b=Backbone.Model.prototype.url.apply(this,arguments);var c=this.get("productList");if(c&&c.owner){b+="&user="+c.owner;}return b+"&t="+new Date().getTime();},initialize:function(b){this.item=b.item;if(this.item&&this.item.matrix_parent&&this.item.itemoptions_detail){this.item.itemoptions_detail.fields=this.item.matrix_parent.itemoptions_detail.fields;this.item.matrixchilditems_detail=this.item.matrix_parent.matrixchilditems_detail;}var c=new a(this.item);c.setOptionsArray(this.getOptionsArray(),true);c.set("quantity",this.get("quantity"));this.set("itemDetails",c);},getOptionsArray:function(){var c=[],b=this.get("options");_.each(b,function(e,d){c.push({id:d,value:e.value,displayvalue:e.displayvalue});});return c;},getProductName:function(){if(!this.get("item")){return null;}var b=this.get("item");if(b&&b.matrix_parent&&b.matrix_parent.internalid){return b.matrix_parent.storedisplayname2||b.matrix_parent.displayname;}return b.storedisplayname2||b.displayname;},isSelectionCompleteForEdit:function(){var c=this.get("itemDetails"),d=c.getPosibleOptions();for(var b=0;b<d.length;b++){var e=d[b];if(e.isMandatory&&!c.getOption(e.cartOptionId)){return false;}}return true;},fulfillsMinimumQuantityRequirement:function(){var b=this.get("item").minimumquantity;if(!b){return true;}return parseInt(b,10)<=parseInt(this.get("quantity"),10);}});});define("ProductListItemEdit.View",["ProductListItem.Model"],function(a){function b(d){var c={};_.each(d,function(f,e){c[e]={value:f.internalid,displayvalue:f.label};});return c;}return Backbone.View.extend({template:"product_list_edit_item",title:_("Edit item").translate(),page_header:_("Edit item").translate(),events:{'click [data-action="edit"]':"edit",'blur [data-toggle="text-option"]':"setOption",'click [data-toggle="set-option"]':"setOption",'change [data-toggle="select-option"]':"setOption",'change [name="quantity"]':"updateQuantity",'keypress [name="quantity"]':"ignoreEnter",'change [name="description"]':"updateDescription",'keypress [name="description"]':"ignoreEnter",'change [name="priority"]':"updatePriority",'keydown [data-toggle="text-option"]':"tabNavigationFix",'focus [data-toggle="text-option"]':"tabNavigationFix"},initialize:function(d){this.application=d.application;this.parentView=d.parentView;this.target=d.target;this.title=d.title;this.page_header=d.title;if(!d.model){throw new Error("A model is needed");}var c=jQuery.extend(true,{},d.model.attributes);this.model=new a(c);this.confirm_edit_method=d.confirm_edit_method;},edit:function(){if(this.model.isSelectionCompleteForEdit()){var c=this.model.get("itemDetails");this.$('[data-action="edit"]').attr("disabled","true");this.$('[data-action="cancel"]').attr("disabled","true");this.model.set("options",b(c.itemOptions));this.model.set("item",{id:this.application.ProductListModule.internalGetProductId(c)});this.model.set("listid",this.parentView.model.id);this.parentView[this.confirm_edit_method](this.model);}},updateQuantity:function(d){var c=parseInt(jQuery(d.target).val(),10),f=this.model.get("quantity");c=(c>0)?c:f;jQuery(d.target).val(c);if(c!==f){this.model.set("quantity",c);this.storeFocus(d);}},updateDescription:function(f){var d=jQuery(f.target).val(),c=this.model.get("description");if(d!==c){this.model.set("description",d);this.storeFocus(f);}},updatePriority:function(f){var c=jQuery(f.target).val(),d=this.model.get("priority");if(c!==d){this.model.set("priority",{id:c});this.storeFocus(f);}},setOption:function(h){var c=jQuery(h.target),g=c.val()||c.data("value")||null,f=c.closest('[data-type="option"]').data("cart-option-id");h.preventDefault();if(c.data("active")){g=null;}var i=this.model.get("itemDetails");try{i.setOption(f,g);}catch(d){_.each(i.getPosibleOptions(),function(e){e.isMatrixDimension&&i.setOption(e.cartOptionId,null);});i.setOption(f,g);}this.storeFocus(h);this.render();},storeFocus:function(){var c=this.$(":focus").get(0);this.focusedElement=c?SC.Utils.getFullPathForElement(c):null;},tabNavigationFix:function(c){this.hideError();this.tabNavigation=(c.type==="keydown"&&c.which===9);this.tabNavigationUpsidedown=c.shiftKey;this.tabNavigationCurrent=SC.Utils.getFullPathForElement(c.target);},afterAppend:function(){this.focusedElement&&this.$(this.focusedElement).focus();if(this.tabNavigation){var d=this.$(":input").index(this.$(this.tabNavigationCurrent).get(0)),c=this.tabNavigationUpsidedown?d-1:d+1;this.$(":input:eq("+c+")").focus();}},showInModal:function(c){this.template="product_list_edit_item";return this.application.getLayout().showInModal(this,c);},ignoreEnter:function(c){if(c.keyCode===13){c.preventDefault();c.stopPropagation();}}});});define("ProductListLists.View",["ProductListDetails.View","ProductList.Model","ProductListItem.Collection","ProductListCreation.View","ItemDetails.Model","ProductListAddedToCart.View","ProductListDeletion.View","ListHeader"],function(c,f,h,d,b,e,a,g){return Backbone.View.extend({template:"product_list_lists",title:_("Product Lists").translate(),className:"ProductListListsView",attributes:{"class":"ProductListListsView"},events:{'change [data-action="sort-by"]':"sortBy",'click [data-action="add-list"]':"createProductList",'click [data-action="delete-list"]':"askDeleteList",'click [data-action="edit-list"]':"editListHandler",'click [data-action="share-list"]':"shareList",'click [data-action="add-to-cart"]':"addListToCartHandler",'click [data-action="select"]':"toggleProductListHandler",'click [data-action="navigate"]':"navigateToItems"},initialize:function(i){this.options=i;this.application=i.application;this.listHeader=new g({view:this,displays:true,hideFilterExpandable:true,application:this.application,collection:this.collection,headerMarkup:'<button class="btn pull-right add-list" data-action="add-list">'+_("Create New List").translate()+"</button>"});},render:function(){Backbone.View.prototype.render.apply(this,arguments);if(!this.collection.length){this.newProductListView=new d({application:this.application,parentView:this,model:new f()});this.newProductListView.render();this.$('[data-type="new-product-list"]').append(this.newProductListView.$el);}},createProductList:function(){this.newProductListView=new d({application:this.application,parentView:this,model:new f()});this.application.getLayout().showInModal(this.newProductListView);},askDeleteList:function(i){this.deleteConfirmationView=new a({application:this.application,parentView:this,target:i.target,title:_("Delete list").translate(),body:_("Are you sure you want to remove this list?").translate(),confirm_delete_method:"deleteListHandler"});this.application.getLayout().showInModal(this.deleteConfirmationView);},deleteListHandler:function(k){var i=this,j=this.getListFromDom(jQuery(k));this.collection.remove(j);j.url=f.prototype.url;j.destroy().done(function(){i.application.getLayout().updateMenuItemsUI();i.showConfirmationMessage(_("Your $(0) list was removed").translate('<span class="product-list-name">'+j.get("name")+"</span>"));i.deleteConfirmationView.$containerModal.modal("hide");});},highlightList:function(j){var i=jQuery(this.el).find("article[data-product-list-id="+j+"]");if(i){i.addClass("new-list");setTimeout(function(){i.removeClass("new-list");},3000);}},addListToCartHandler:function(j){j.preventDefault();var i=this.getCurrentList(j);this.addListToCart(i);},addListToCart:function(m){var j=[],k=this,i=0;m.get("items").each(function(p){var o=p.get("item");if(o.ispurchasable){var n=new b({internalid:o.internalid,quantity:p.get("quantity")});n.set("_optionsDetails",o.itemoptions_detail);n.setOptionsArray(p.getOptionsArray(),true);j.push(n);}else{i++;}});if(j.length===0){var l=_("All items in the list are not available for purchase.").translate();k.showWarningMessage(l);return;}this.application.getCart().addItems(j).done(function(){k.application.getProductList(m.get("internalid")).done(function(n){k.addedToCartView=new e({application:k.application,parentView:k,list:new f(n),not_purchasable_items_count:i});var o;if(m.get("items").length>1){o=_('Good! $(1) items from your $(0) list were successfully added to your cart. You can continue to <a href="">view your cart and checkout</a>').translate('<a class="product-list-name" href="/productlist/'+m.get("internalid")+'">'+m.get("name")+"</a>",m.get("items").length);}else{o=_('Good! $(1) item from your $(0) list was successfully added to your cart. You can continue to <a href="" data-touchpoint="viewcart">view your cart and checkout</a>').translate('<a class="product-list-name" href="/productlist/'+m.get("internalid")+'">'+m.get("name")+"</a>",m.get("items").length);}k.showConfirmationMessage(o);k.application.getLayout().showInModal(k.addedToCartView);});});},editListHandler:function(j){var i=this.getListFromDom(jQuery(j.target));this.editList(i);},getListFromDom:function(i){var j=i.closest("[data-product-list-id]").data("product-list-id")+"";return this.options.collection.where({internalid:j})[0];},editList:function(i){this.newProductListView=new d({application:this.application,parentView:this,model:i});this.application.getLayout().showInModal(this.newProductListView);},getViewLabel:function(){return"productlist_all";},showContent:function(){this.application.getLayout().showContent(this,this.getViewLabel(),[{text:_("Product Lists").translate(),href:"/productlists"}]);},toggleProductListItemHandler:function(i){this.toggleProductListItem(jQuery(i.target).closest("article").data("id"));},toggleProductListHandler:function(i){this.toggleProductList(jQuery(i.target).closest("article").data("id"));},toggleProductList:function(j){var i=this.collection.get(j);if(i){this[i.get("checked")?"unselectProductList":"selectProductList"](i);this.render();}},selectProductList:function(i){if(i){i.set("checked",true);}},unselectProductList:function(i){if(i){i.set("checked",false);}},getCurrentList:function(j){var k=jQuery(j.target).closest("[data-product-list-id]").data("product-list-id")+"",i=this.options.collection.findWhere({internalid:k});return i;},navigateToItems:function(l){var k=this.getCurrentList(l),i=k.get("internalid"),j="/productlist/"+(i?i:"tmpl_"+k.get("templateid"));Backbone.history.navigate(j,{trigger:true});}});});define("OrderWizard.Module.Address.Billing",["OrderWizard.Module.Address"],function(a){return a.extend({manage:"billaddress",sameAsManage:"shipaddress",errors:["ERR_CHK_INCOMPLETE_ADDRESS","ERR_CHK_SELECT_BILLING_ADDRESS","ERR_CHK_INVALID_BILLING_ADDRESS","ERR_WS_INVALID_BILLING_ADDRESS"],sameAsMessage:_("Same as shipping address").translate(),selectAddressErrorMessage:{errorCode:"ERR_CHK_SELECT_BILLING_ADDRESS",errorMessage:_("Please select a billing address").translate()},invalidAddressErrorMessage:{errorCode:"ERR_CHK_INVALID_BILLING_ADDRESS",errorMessage:_("The selected billing address is invalid").translate()},reRenderOnFirstAddressCreation:function(){if(!this.wizard.model.get("temp"+this.manage)){this.render();}},getIsCurrentUserGuest:function(){if(this.wizard.model.get("ismultishipto")){return false;}return a.prototype.getIsCurrentUserGuest.apply(this,arguments);},onEventHandlersOn:function(){this.wizard.model.on("ismultishiptoUpdated",function(){this.sameAs=false;this.render();},this);this.wizard.model.on("address_added",this.reRenderOnFirstAddressCreation,this);},isAddressIdValidForRemoval:function(b){if(!this.wizard.model.get("ismultishipto")){return a.prototype.isAddressIdValidForRemoval.apply(this,arguments);}return !_.find(this.wizard.model.getSetLines(),function(c){return +c.get("shipaddress")===+b;});},onEventHandlersOff:function(){this.wizard.model.off("ismultishiptoUpdated",null,this);this.wizard.model.off("address_added",null,this);}});});define("OrderWizard.Module.Address",["Wizard.Module","Address.Views","Address.Model"],function(a,b,c){return a.extend({template:"order_wizard_address_module",selectMessage:_("Use this Address").translate(),sameAsMessage:_("Same as Address").translate(),selectAddressErrorMessage:{errorCode:"ERR_CHK_SELECT_AN_ADDRESS",errorMessage:_("Please select an address").translate()},invalidAddressErrorMessage:{errorCode:"ERR_CHK_INVALID_ADDRESS",errorMessage:_("The selected address is invalid").translate()},events:{'click [data-action="submit"]':"submit",'click [data-action="select"]':"selectAddress",'click [data-action="change-address"]':"changeAddressHandler",'change [data-action="same-as"]':"markSameAsHandler","change form":"changeForm"},errors:["ERR_CHK_INCOMPLETE_ADDRESS","ERR_CHK_INVALID_ADDRESS"],render:function(e){if(!this.isActive()){return this.$el.empty();}this.addresses=this.wizard.options.profile.get("addresses");this.isGuest=this.getIsCurrentUserGuest();this.isSameAsEnabled=_.isFunction(this.options.enable_same_as)?this.options.enable_same_as():this.options.enable_same_as;this.addressId=this.model.get(this.manage);this.evaluateDisablingSameAsCheckBox();if(this.addressId&&~this.addressId.indexOf("null")){this.setAddress(null,{silent:true});}this.evaluateSameAs();this.address=this.getSelectedAddress();this.eventHandlersOn();this._render();this.addressView=null;this.addressListView=null;var d=this.address.isNew();if((this.isSameAsEnabled&&this.sameAs)||this.addressId&&!d){null;}else{if(this.getAddressesToShow().length&&!this.isGuest){this.createAddressListView();}else{this.createAddressDetailsView();if(this.isGuest&&!d){this.setAddress(this.address.id,{silent:true});}}}if(!e&&this.address&&this.addressId&&this.address.get("isvalid")==="T"){this.trigger("ready",true);}},enableInterface:function(){this.$('[data-action="change-address"]').attr("disabled",false);this.evaluateDisablingSameAsCheckBox();if(!this.disableSameAsCheckBox){this.$('[data-action="same-as"]').attr("disabled",false);}},evaluateDisablingSameAsCheckBox:function(e){var d=this.disableSameAsCheckBox;this.disableSameAsCheckBox=(this.model.get(this.sameAsManage)===undefined||this.model.get(this.sameAsManage)===null||this.model.get(this.sameAsManage)==="-------null")&&!this.model.get("temp"+this.sameAsManage);if(d!==this.disableSameAsCheckBox&&e){this.render();}},disableInterface:function(){this.$('[data-action="change-address"], [data-action="same-as"]').attr("disabled",true);},getChangeLinkText:function(){return this.getIsCurrentUserGuest()?_("Edit Address").translate():_("Change address").translate();},getIsCurrentUserGuest:function(){return this.wizard.options.profile.get("isGuest")==="T";},createAddressListView:function(){this.addressListView=new b.List({application:this.wizard.application,collection:this.addresses});this.addressListView.$el=this.$("#address-module-list-placeholder");this.addressListView.remove=_.bind(this.validateAddressRemoval,this.addressListView,this);Backbone.Validation.bind(this.addressListView);this.addressListView.delegateEvents();},validateAddressRemoval:function(d,h){var g=jQuery(h.target).data("id");if(d.isAddressIdValidForRemoval(g)){return b.List.prototype.remove.call(this,h);}var f=d.sameAsManage==="billaddress"?_("(billing address)").translate():d.sameAsManage==="shipaddress"?_("(shipping address)").translate():"";if(confirm(_("The selected address is in use. $(0) Are you sure you want to delete this address?").translate(f))){return this.removeAddressModel(g);}},isAddressIdValidForRemoval:function(e){var d=this.model.get(this.sameAsManage);return(+e!==+d);},createAddressDetailsView:function(){this.addressView=new b.Details({application:this.wizard.application,collection:this.addresses,model:this.address,manage:this.manage});this.addressView.$el=this.$("#address-module-form-placeholder");Backbone.Validation.bind(this.addressView);this.addressView.delegateEvents();},evaluateSameAs:function(){var f=this.addressId,d=this.getTheOtherAddress(),e=d&&d.get("internalid")||null;if(f&&f===e){this.sameAs=true;}else{if(!this.tempAddress&&f!==e){this.sameAs=false;}else{this.sameAs=this.sameAs&&(f||this.tempAddress||(this.isGuest&&this.addresses.length));}}this.model.set("sameAs",this.sameAs);},eventHandlersOn:function(){var e=this,d=this.sameAsManage;this.eventHandlersOff();this.addresses.on("reset destroy change add",jQuery.proxy(this,"render",true),this).on("destroy",function(f){if(e.model.get(d)===f.id){e.model.set(d,null);}},this);this.model.on("change:"+d,function(f,g){if(e.isSameAsEnabled&&e.sameAs){e.setAddress(g);e.render();}else{if(e.isSameAsEnabled){this.evaluateDisablingSameAsCheckBox(true);}}},this);if(this.isSameAsEnabled&&this.sameAs){this.model.on("change:temp"+d,function(f,g){e.tempAddress=g;e.render();},this);}else{if(this.isSameAsEnabled){this.model.once("change:temp"+d,function(){if(!this.model.get(d)){this.render();}},e);}}_.isFunction(this.onEventHandlersOn)&&this.onEventHandlersOn();},eventHandlersOff:function(){this.addresses&&this.addresses.off(null,null,this);this.model.off("change:"+this.sameAsManage,null,this).off("change:temp"+this.sameAsManage,null,this);_.isFunction(this.onEventHandlersOff)&&this.onEventHandlersOff();},past:function(){this.eventHandlersOff();},future:function(){this.eventHandlersOff();},selectAddress:function(d){jQuery(".wizard-content .alert-error").hide();this.setAddress(jQuery(d.target).data("id").toString());this.render();this.trigger("ready",true);},setAddress:function(e,d){this.model.set(this.manage,e,d);this.addressId=e;return this;},unsetAddress:function(d,e){this.setAddress(null,e);this.tempAddress=null;if(!d){this.render();}},changeAddressHandler:function(g){g.preventDefault();g.stopPropagation();var d=jQuery(g.currentTarget),f=d.attr("disabled");this.changeAddress(f);},changeAddress:function(d){if(d){return;}if(this.options.edit_url){this.unsetAddress(true);Backbone.history.navigate(this.options.edit_url+"?force=true",{trigger:true});}else{this.unsetAddress();}},submit:function(){if(!this.isActive()){return jQuery.Deferred().resolve();}var e=this;if(this.addressView){var g=jQuery.Event("submit",{target:this.addressView.$("form").get(0)}),d=this.addressView.saveForm(g);var f=jQuery.Deferred();if(d&&!d.frontEndValidationError){d.done(function(h){e.setAddress(h.internalid);var i=(e.isGuest||e.addresses.length===0)?{silent:true}:null;e.addresses.add(h,i);e.model.set("temp"+e.manage,null);e.newAddressCreated&&e.newAddressCreated(h.internalid,i);e.render();f.resolve();});}else{f.reject({errorCode:"ERR_CHK_INCOMPLETE_ADDRESS",errorMessage:_("The address is incomplete").translate()});}return f;}else{return this.isValid();}},isValid:function(){if(!this.isActive()||this.tempAddress){return jQuery.Deferred().resolve();}var e=this.wizard.options.profile.get("addresses"),d=e&&e.get(this.model.get(this.manage));if(d){if(d.get("isvalid")==="T"){return jQuery.Deferred().resolve();}return jQuery.Deferred().reject(this.invalidAddressErrorMessage);}return jQuery.Deferred().reject(this.selectAddressErrorMessage);},changeForm:function(d){this.model.set("temp"+this.manage,jQuery(d.target).closest("form").serializeObject());},markSameAsHandler:function(f){var d=jQuery(f.target).prop("checked");this.markSameAs(d);},markSameAs:function(d){this.sameAs=d;this.model.set("sameAs",d);this.setAddress(d?this.model.get(this.sameAsManage):null);this.tempAddress=d?this.model.get("temp"+this.sameAsManage):null;this.render();},getSelectedAddress:function(){if(!this.addressId){if(this.sameAs&&this.tempAddress){return new c(this.tempAddress);}if(this.isGuest){return this.getFixedAddress();}}return this.addresses.get(this.addressId)||this.getEmptyAddress();},getEmptyAddress:function(){return new c(this.isSameAsEnabled&&this.sameAs?null:this.model.get("temp"+this.manage));},getTheOtherAddress:function(){return this.addresses.get(this.model.get(this.sameAsManage));},getAddressesToShow:function(){if(this.isGuest&&this.isSameAsEnabled){var d=this.model.get(this.sameAsManage);return new Backbone.Collection(this.addresses.reject(function(e){return e.id===d;}));}else{return new Backbone.Collection(this.addresses.models);}},getFixedAddress:function(){var d=this.getAddressesToShow();return d.length?d.at(0):this.getEmptyAddress();},manageError:function(d){if(d&&d.errorCode!=="ERR_CHK_INCOMPLETE_ADDRESS"){a.prototype.manageError.apply(this,arguments);}}});});define("OrderWizard.Module.PaymentMethod.Creditcard",["OrderWizard.Module.PaymentMethod","CreditCard.Views","CreditCard.Model","OrderPaymentmethod.Model"],function(d,b,c,a){return d.extend({template:"order_wizard_paymentmethod_creditcard_module",securityNumberErrorMessage:{errorCode:"ERR_CHK_INCOMPLETE_SECURITY_NUMBER",errorMessage:undefined},selectMessage:_("Use this Card").translate(),events:{'click [data-action="select"]':"selectCreditCard",'click [data-action="change-creditcard"]':"changeCreditCard",'mouseover [data-toggle="popover"]':"openPopover"},errors:["ERR_CHK_INCOMPLETE_CREDITCARD","ERR_CHK_SELECT_CREDITCARD","ERR_CHK_INCOMPLETE_SECURITY_NUMBER","ERR_WS_INVALID_PAYMENT"],isActive:function(){var e=_.findWhere(this.wizard.application.getConfig("siteSettings.paymentmethods",[]),{creditcard:"T"});return e&&e.internalid;},render:function(){var e=this,f=this.model.get("paymentmethods").findWhere({type:"creditcard"});this.creditcard=null;this.paymentMethod=f||new a({type:"creditcard"});var g=this.paymentMethod.get("creditcard");this.requireccsecuritycode=SC.ENVIRONMENT.siteSettings.checkout.requireccsecuritycode==="T";this.creditcards=this.wizard.options.profile.get("creditcards");this.creditcards.off(null,null,this);this.creditcards.on("reset destroy change add",function(){var i=e.model.get("paymentmethods").findWhere({type:"creditcard"}),h=i&&i.get("creditcard")&&i.get("creditcard").internalid;if(h&&e.creditcards.get(h)){e.setCreditCard({id:h});}else{if(h){e.unsetCreditCard();}}e.render();},this);if(!this.creditcards.length){this.creditcard=new c({},{paymentMethdos:this.wizard.application.getConfig("siteSettings.paymentmethods")});if(this.requireccsecuritycode){this.creditcard.validation.ccsecuritycode={fn:function(h){e.securityNumberErrorMessage.errorMessage=_.validateSecurityCode(h);if(e.securityNumberErrorMessage.errorMessage){return e.securityNumberErrorMessage.errorMessage;}}};}}else{if(g&&g.internalid){this.creditcard=this.creditcards.get(g.internalid);}else{if(this.wizard.options.profile.get("isGuest")==="T"){this.creditcard=this.creditcards.at(0);this.setCreditCard({id:this.creditcard.id});}else{if(!this.unset){this.creditcard=this.creditcards.findWhere({ccdefault:"T"});if(this.creditcard&&this.creditcard.id){this.setCreditCard({id:this.creditcard.id});}}}}}this._render();if(!this.creditcards.length){this.creditcardListView=null;this.creditcardView=new b.Details({application:this.wizard.application,collection:this.creditcards,model:this.creditcard});this.creditcardView.$el=this.$("#creditcard-module-form-placeholder");Backbone.Validation.bind(this.creditcardView);this.creditcardView.delegateEvents();}else{this.creditcardView=null;this.creditcardListView=new b.List({application:this.wizard.application,collection:this.creditcards});this.creditcardListView.$el=this.$("#creditcard-module-list-placeholder");Backbone.Validation.bind(this.creditcardListView);this.creditcardListView.delegateEvents();}this.isValid().done(function(){e.trigger("ready",!e.requireccsecuritycode);});},changeCreditCard:function(g){if(this.wizard.application.getUser().get("isGuest")!=="T"){this.unsetCreditCard(g);}else{var f=this;g.preventDefault();g.stopPropagation();this.creditcard.destroy({wait:true}).then(function(){f.creditcards.reset([]);f.wizard.application.getUser().get("creditcards").reset([]);});}},openPopover:function(g){g.preventDefault();g.stopPropagation();var f=this.$(g.target);f.popover({trigger:"manual",html:true}).popover("toggle");this.closePopover(f);},closePopover:function(e){e.on("mouseout",function(f){f.preventDefault();e.popover("hide");});this.$el.one("click",'[data-type="close-popover"]',function(f){f.preventDefault();e.popover("hide");});},getAvailableCreditcards:function(){var e=[],g=this.wizard.application.getUser().get("creditcards");g.each(function(h){e.push(h.get("paymentmethod").name);});if(!e.length){var f=_.where(this.wizard.application.getConfig("siteSettings.paymentmethods"),{creditcard:"T",ispaypal:"F"});_.each(f,function(h,i){e.push(f[i].name);});}return _.unique(e);},selectCreditCard:function(f){this.setCreditCard({id:jQuery(f.target).data("id")});this.trigger("ready",!this.requireccsecuritycode);},setSecurityNumber:function(){if(this.requireccsecuritycode){var e=this.paymentMethod.get("creditcard");if(e){e.ccsecuritycode=this.ccsecuritycode;}}},setCreditCard:function(e){this.paymentMethod=new a({type:"creditcard",creditcard:e.model||this.creditcards.get(e.id).attributes});this.setSecurityNumber();d.prototype.submit.apply(this,arguments);this.render();},unsetCreditCard:function(f){if(f){f.preventDefault();f.stopPropagation();}this.unset=true;this.paymentMethod=new a({type:"creditcard"});this.ccsecuritycode=null;d.prototype.submit.apply(this,arguments);this.render();},submit:function(){if(this.wizard.hidePayment()){return jQuery.Deferred().resolve();}var f=this;if(this.requireccsecuritycode){this.isSecurityNumberInvalid=false;this.ccsecuritycode=this.$('input[name="ccsecuritycode"]').val();}if(this.creditcardView){var h=jQuery.Event("click",{target:this.creditcardView.$("form").get(0)}),e=this.creditcardView.saveForm(h);if(!e||e.frontEndValidationError){return jQuery.Deferred().reject({errorCode:"ERR_CHK_INCOMPLETE_CREDITCARD",errorMessage:_("The Credit Card is incomplete").translate()});}var g=jQuery.Deferred();e.done(function(i){f.creditcardView=null;delete f.creditcard.validation.ccsecuritycode;f.wizard.options.profile.get("creditcards").add(i,{silent:true});f.setCreditCard({model:i});g.resolve();}).fail(function(){g.reject().apply(e,arguments);});return g;}else{this.setSecurityNumber();d.prototype.submit.apply(this,arguments);return this.isValid().fail(function(i){if(i===f.securityNumberErrorMessage){f.isSecurityNumberInvalid=true;}f.render();}).done(function(){f.isSecurityNumberInvalid=false;f._render();});}},past:function(){this.clearCCSecurityCode();delete this.ccsecuritycode;},future:function(){this.clearCCSecurityCode();delete this.ccsecuritycode;},clearCCSecurityCode:function(){var e=this.paymentMethod&&this.paymentMethod.get("creditcard");if(e){e.ccsecuritycode=null;}},isValid:function(){if(this.wizard.hidePayment()){return jQuery.Deferred().resolve();}var e=this.wizard.options.profile.get("creditcards"),f=this.model.get("paymentmethods").findWhere({type:"creditcard"}),g=f&&f.get("creditcard");if(g&&e.length&&e.get(g.internalid)){this.securityNumberErrorMessage.errorMessage=_.validateSecurityCode(g.ccsecuritycode);if(!this.requireccsecuritycode||!this.securityNumberErrorMessage.errorMessage){return jQuery.Deferred().resolve();}else{return jQuery.Deferred().reject(this.securityNumberErrorMessage);}}else{return jQuery.Deferred().reject({errorCode:"ERR_CHK_SELECT_CREDITCARD",errorMessage:_("Please select a credit card").translate()});}},manageError:function(e){if(e&&e.errorCode!=="ERR_CHK_INCOMPLETE_CREDITCARD"){d.prototype.manageError.apply(this,arguments);if(e.errorCode==="ERR_WS_INVALID_PAYMENT"){this.unsetCreditCard();}}}});});define("OrderWizard.Module.PaymentMethod",["Wizard.Module"],function(a){return a.extend({submit:function(){var b=this.model.get("paymentmethods");b.remove(b.where({primary:true}));var c=this.paymentMethod;c.set("primary",true);b.add(c);return jQuery.Deferred().resolve();}});});define("OrderWizard.Module.ShowPayments",["Wizard.Module"],function(a){return a.extend({template:"order_wizard_showpayments_module",initialize:function(){a.prototype.initialize.apply(this,arguments);this.application=this.wizard.application;this.profile=this.wizard.options.profile;},getPaymentmethods:function(){return _.reject(this.model.get("paymentmethods").models,function(b){return b.get("type")==="giftcertificate";});},getGiftCertificates:function(){return this.model.get("paymentmethods").where({type:"giftcertificate"});},past:function(){this.model.off("change",this.totalChange,this);this.profile.get("addresses").off("change",this.render,this);},present:function(){this.model.off("change",this.totalChange,this);this.profile.get("addresses").off("change",this.render,this);this.model.on("change",this.totalChange,this);this.profile.get("addresses").on("change",this.render,this);},future:function(){this.model.off("change",this.totalChange,this);this.profile.get("addresses").off("change",this.render,this);},totalChange:function(){var d=this.model.previous("summary").total,b=this.model.previous("confirmation"),c=this.model.get("summary").total;if(((d===0&&c!==0)||(d!==0&&c===0))&&!b){this.render();}}});});define("PrintStatement",["PrintStatement.Model","PrintStatement.Views","PrintStatement.Router"],function(c,b,a){return{Views:b,Router:a,Model:c,MenuItems:{parent:"billing",id:"printstatement",name:_("Print a Statement").translate(),url:"printstatement",index:4,permission:"transactions.tranStatement.2"},mountToApp:function(d){return new a(d);}};});define("PrintStatement.Model",function(){return Backbone.Model.extend({urlRoot:"services/print-statement.ss",parse:function(a){return a;}});});define("PrintStatement.Router",["PrintStatement.Views","PrintStatement.Model","ErrorManagement"],function(b,c,a){return Backbone.Router.extend({routes:{printstatement:"printstatement"},initialize:function(d){this.application=d;},printstatement:function(){var d;if(SC.ENVIRONMENT.permissions.transactions.tranStatement===2){d=new b.Details({application:this.application,model:new c()});}else{d=new a.Views.ForbiddenError({application:this.application});}d.showContent();return d;}});});define("PrintStatement.Views",function(){var a={};a.Details=Backbone.View.extend({template:"print_statement",title:_("Print a Statement").translate(),page_header:_("Print a Statement").translate(),attributes:{"class":"PrintStatement"},events:{"submit form":"printAction",'click [data-action="email"]':"emailAction"},initialize:function(b){this.application=b.application;this.model=b.model;var c=this.application.getConfig("filterRangeQuantityDays");this.initialStatementDate=new Date();this.initialStartDate=new Date();this.initialStartDate.setDate(this.initialStartDate.getDate()-c);},showContent:function(){var b=this;b.application.getLayout().showContent(b,"printstatement",[{text:_("Print Statement").translate(),href:"/printstatement"}]);},printAction:function(b){this.printStatement(b,false);},emailAction:function(c){var b=this;this.printStatement(c,true,function(d){jQuery.ajax(d.url).done(function(){b.showError(_("Email sent successfully").translate(),"success");});});},printStatement:function(i,f,j){i.preventDefault();this.hideError();var d=this,h=jQuery(i.target).closest("form").serializeObject(),c=new Date(h.statementDate.replace(/-/g,"/")).getTime(),b=new Date(h.startDate.replace(/-/g,"/")).getTime();h.email=f?true:null;if(h.startDate&&isNaN(b)||isNaN(c)){d.showError(_("Invalid date format").translate());}else{h.statementDate=c;if(h.startDate){h.startDate=b;}if(f){var g=this.saveForm(i,this.model,h);g&&g.done(j);}else{h.asset="print-statement";window.open(_.getDownloadPdfUrl(h));}}}});return a;});define("Quote.Collection",["Quote.Model"],function(a){return Backbone.Collection.extend({model:a,url:"services/quote.ss",parse:function(b){this.totalRecordsFound=b.totalRecordsFound;this.recordsPerPage=b.recordsPerPage;return b.records;},update:function(c){var b=c.range||{},e=b.from&&_.stringToDate(b.from),d=b.to&&_.stringToDate(b.to);this.fetch({data:{filter:c.filter.value,sort:c.sort.value,order:c.order,from:e?e.getTime():null,to:d?d.getTime():null,page:c.page},reset:true,killerId:c.killerId});}});});define("Quote",["Quote.Model","Quote.Collection","Quote.Views","Quote.Router"],function(d,b,c,a){return{Collection:b,Model:d,Router:a,Views:c,MenuItems:{parent:"orders",id:"quotes",name:_("Quotes").translate(),url:"quotes",index:5,permission:"transactions.tranFind.1,transactions.tranEstimate.1"},mountToApp:function(e){return new a(e);}};});define("Quote.Model",["OrderLine.Collection"],function(a){return Backbone.Model.extend({urlRoot:"services/quote.ss",initialize:function(b){this.on("change:lineItems",function(c,d){c.set("lineItems",new a(d),{silent:true});});this.trigger("change:lineItems",this,b&&b.lineItems||[]);}});});define("Quote.Router",["Quote.Model","Quote.Collection","Quote.Views"],function(c,a,b){return Backbone.Router.extend({routes:{quotes:"list","quotes?:options":"list","quotes/:id":"details"},initialize:function(d){this.application=d;},list:function(e){var f=new a(),d=new b.List({application:this.application,collection:f,page:e&&e.page});f.on("reset",jQuery.proxy(d,"showContent","quotes"));d.showContent("returns");},details:function(f){var e=new c({internalid:f}),d=new b.Details({application:this.application,model:e});e.fetch().then(jQuery.proxy(d,"showContent","quotes"));}});});define("Quote.Views",["ListHeader"],function(b){var a={};a.List=Backbone.View.extend({template:"quote_list",className:"QuoteList",title:_("Quotes").translate(),page_header:_("Quotes").translate(),attributes:{"class":"QuoteList"},initialize:function(e){this.application=e.application;var d=new Date(),c=d.getFullYear()+"-"+(d.getMonth()+1)+"-"+d.getDate();this.rangeFilterOptions={fromMin:"1800-01-02",fromMax:c,toMin:"1800-01-02",toMax:c};this.listenCollection();this.setupListHeader();},setupListHeader:function(){this.listHeader=new b({view:this,application:this.application,collection:this.collection,filters:this.filterOptions,sorts:this.sortOptions});},listenCollection:function(){this.setLoading(true);this.collection.on({request:jQuery.proxy(this,"setLoading",true),reset:jQuery.proxy(this,"setLoading",false)});},setLoading:function(c){this.isLoading=c;},filterOptions:[{value:"0",name:_("Show all statuses").translate(),selected:true},{value:"14",name:_("Closed Lost").translate()},{value:"7",name:_("Qualified").translate()},{value:"8",name:_("In Discussion").translate()},{value:"9",name:_("Identified Decision Makers").translate()},{value:"10",name:_("Proposal").translate()},{value:"11",name:_("In Negotiation").translate()},{value:"12",name:_("Purchasing").translate()}],sortOptions:[{value:"tranid",name:_("by Number").translate(),selected:true},{value:"trandate",name:_("by Request date").translate()},{value:"duedate",name:_("by Expiration date").translate()},{value:"total",name:_("by Amount").translate()}],showContent:function(){this.application.getLayout().showContent(this,"quotes",[{text:this.title,href:"/quotes"}]);}});a.Details=Backbone.View.extend({template:"quote_details",title:_("Quote Details").translate(),attributes:{"class":"QuoteDetails"},initialize:function(c){this.application=c.application;},showContent:function(){var c=this.model.get("tranid")||"",d=_('Quote <span class="strong-text quote-id">#$(0)</span>').translate(c);this.page_title=this.title;this.page_header=d;this.application.getLayout().showContent(this,"quotes",[{text:_("Quotes").translate(),href:"/quotes"},{text:_("Quote").translate()+" #"+c,href:"/quotes"}]);}});return a;});define("Case.Collection",["Case.Model"],function(a){return Backbone.Collection.extend({url:_.getAbsoluteUrl("services/case.ss"),model:a,initialize:function(){this.once("sync reset",function(){if(!this.original){this.original=this.clone();}});},parse:function(b){this.totalRecordsFound=b.totalRecordsFound;this.recordsPerPage=b.recordsPerPage;return b.records;},update:function(b){var c=b.filter||{};this.fetch({data:{filter:c.value,sort:b.sort.value,order:b.order,page:b.page},reset:true,killerId:b.killerId});}});});define("Case",["CaseDetail.View","Case.Collection","Case.Model","Case.Router","CaseCreate.View","CaseList.View"],function(b,d,h,a,g,f){var e=function(i){if(!i.CaseModule.isEnabled()){return undefined;}return{id:function(){return"cases";},name:function(){return _("Cases").translate();},index:5,children:function(){var j=[{parent:"cases",id:"cases_all",name:_("Support Cases").translate(),url:"cases",index:1},{parent:"cases",id:"newcase",name:_("Submit New Case").translate(),url:"newcase",index:2}];return j;},permission:"lists.listCase.1"};};var c=function(){var m={};var j={CaseDetail:b,NewCase:g,CaseList:f},n={Case:h},k={Case:d};var l=function(){var o=m;return o.getConfig("cases.config")!==undefined&&SC.ENVIRONMENT.CASES.enabled;};var i=function(o){m=o;o.CaseModule=c;return new a(o);};return{Views:j,Models:n,Collections:k,Router:a,isEnabled:l,mountToApp:i,MenuItems:e};}();return c;});define("Case.Model",function(){function a(f,d,e){if(e.include_email&&!f){return _("Email is required").translate();}}function b(e,d){var f=4000;if(e&&e.length>f){return _("$(0) must be at most $(1) characters").translate(d,f);}}function c(e,d){if(!e){return _("$(0) is required").translate(d);}return b(e,d);}return Backbone.Model.extend({urlRoot:_.getAbsoluteUrl("services/case.ss"),defaults:{},validation:{title:{required:true,msg:_("Subject is required").translate()},message:{fn:c},reply:{fn:c},email:{fn:a}}});});define("Case.Router",["Case.Model","Case.Collection","CaseFields.Model"],function(c,b,a){return Backbone.Router.extend({routes:{cases:"showCasesList","cases?:options":"showCasesList","cases/:id":"showCase",newcase:"createNewCase"},initialize:function(d){this.application=d;},showCase:function(h,g){var d=new a(),f=new c({internalid:h}),e=new this.application.CaseModule.Views.CaseDetail({application:this.application,params:_.parseUrlOptions(g),fields:d,model:f});jQuery.when(f.fetch(),d.fetch()).then(jQuery.proxy(e,"showContent"));},showCasesList:function(e){var f=_.parseUrlOptions(e),d=new a();jQuery.when(d.fetch()).then(jQuery.proxy(this,"showCasesListHelper",d,f));},showCasesListHelper:function(d,i){var h=new b(),e=new this.application.CaseModule.Views.CaseList({application:this.application,collection:h,options:i,page:i&&i.page,fields:d});if(this.application.getLayout().currentView){var g=this.application.getLayout().currentView.newCaseId,f=this.application.getLayout().currentView.newCaseMessage;if(!(_.isUndefined(f)&&_.isUndefined(g))){e.new_case_message=f;e.new_case_internalid=g;e.inform_new_case=true;delete this.application.getLayout().currentView.newCaseId;delete this.application.getLayout().currentView.newCaseMessage;}}e.collection.on("reset",e.render,e);e.showContent();},createNewCase:function(g,f){var d=new a(),e=new this.application.CaseModule.Views.NewCase({application:this.application,params:_.parseUrlOptions(f),fields:d,model:new c()});jQuery.when(d.fetch()).then(jQuery.proxy(e,"showContent"));}});});define("CaseCreate.View",function(){return Backbone.View.extend({template:"case_new",title:_("How can we help you?").translate(),page_header:_("How can we help you?").translate(),events:{"submit form":"saveForm",'keypress [type="text"]':"preventEnter",'click input[name="include_email"]':"includeAnotherEmail"},attributes:{"class":"newCase"},initialize:function(a){this.options=a;this.application=a.application;this.fields=a.fields;this.user=this.application.getUser();this.model.on("sync",jQuery.proxy(this,"showSuccess"));},preventEnter:function(a){if(a.keyCode===13){a.preventDefault();}},showContent:function(){this.options.application.getLayout().showContent(this,"newcase",[{text:this.title,href:"/newcase"}]);},showSuccess:function(){var b=_("support case #$(0)").translate(this.model.get("caseNumber")),d=this.model.get("internalid"),c='<a href="/cases/'+d+'">'+b+"</a>",a=_("Good! your $(0) was submitted. We will contact you briefly.").translate(c);this.newCaseId=d;this.newCaseMessage=a;Backbone.history.navigate("cases",{trigger:true});},includeAnotherEmail:function(){this.$(".case-new-email").collapse("toggle");var a=this.$(".input-case-email");a.prop("disabled",!a.prop("disabled"));}});});define("CaseDetail.View",function(){return Backbone.View.extend({template:"case_detail",initialize:function(a){this.options=a;this.application=a.application;this.fields=a.fields;this.user=this.application.getUser();},showContent:function(){var a=this.model.get("caseNumber");this.page_header=_("Case #$(0):").translate(a);this.title=_("Case Details").translate();this.page_title=_("Case #$(0):").translate(a);this.options.application.getLayout().showContent(this,"cases",[{text:this.title,href:"/case/"+this.model.get("internalid")}]);},events:{"submit form":"customSaveForm",'click [data-action="reset"]':"resetForm",'click [data-action="close-case"]':"closeCase",'keypress [type="text"]':"preventEnter"},customSaveForm:function(b){b.preventDefault();var a=this,c=Backbone.View.prototype.saveForm.apply(this,arguments);c&&c.done(function(){a.showContent();a.showConfirmationMessage(_("Good! Your message was sent. A support representative should contact you briefly.").translate());});},attributes:{"class":"caseDetail"},preventEnter:function(a){if(a.keyCode===13){a.preventDefault();}},closeCase:function(b){b.preventDefault();var a=this;this.model.set("reply",{reply:""});this.model.set("status",{id:SC.ENVIRONMENT.CASES.CONFIG.default_values.status_close.id});this.model.save().done(function(){a.showContent();a.showConfirmationMessage(_("Case successfully closed").translate());});},resetForm:function(a){a.preventDefault();this.showContent();}});});define("CaseFields.Model",function(){return Backbone.Model.extend({urlRoot:_.getAbsoluteUrl("services/case-fields.ss")});});define("CaseList.View",["ListHeader"],function(a){return Backbone.View.extend({template:"case_list",title:_("Support Cases").translate(),page_header:_("Support Cases").translate(),attributes:{"class":"caseManagement"},initialize:function(b){this.options=b;this.application=b.application;this.fields=b.fields;this.listenCollection();this.setupListHeader();},setupListHeader:function(){this.listHeader=new a({view:this,application:this.application,collection:this.collection,filters:this.initializeFilterOptions(),sorts:this.sortOptions});},listenCollection:function(){this.setLoading(true);this.collection.on({request:jQuery.proxy(this,"setLoading",true),reset:jQuery.proxy(this,"setLoading",false)});},setLoading:function(b){this.isLoading=b;},initializeFilterOptions:function(){var c=[{value:"all",name:_("Show All Statuses").translate(),selected:true,filter:function(){return this.original.models;}}],b=this.fields?this.fields.get("statuses"):[];_.each(b,function(d){var e={value:d.id,name:d.text,filter:function(){return this.original.filter(function(f){return f.get("status").id===d.id;});}};c.push(e);});return c;},sortOptions:[{value:"caseNumber",name:_("by Case number").translate(),selected:true},{value:"createdDate",name:_("by Creation date").translate()},{value:"lastMessageDate",name:_("by Last Message date").translate()}],showContent:function(){this.application.getLayout().showContent(this,"cases_all",[{text:this.title,href:"/cases"}]);},render:function(){Backbone.View.prototype.render.apply(this,arguments);if(!_.isUndefined(this.inform_new_case)){this.informNewCaseCreation();if(!this.isLoading){delete this.inform_new_case;}}},informNewCaseCreation:function(){this.highlightNewCase(this.new_case_internalid);this.showConfirmationMessage(this.new_case_message);},highlightNewCase:function(c){var b=jQuery(this.el).find("a[data-id="+c+"]");if(b&&b.length===1){b.addClass("case-list-new-case-highlight");setTimeout(function(){b.removeClass("case-list-new-case-highlight");},3000);}}});});jQuery(document).ready(function(){SC.compileMacros(SC.templates.macros);require(["Merchandising.Rule","Content.DataModels"],function(d,b){var a=SC.Application("MyAccount");a.getConfig().siteSettings=SC.ENVIRONMENT.siteSettings||{};if(SC.ENVIRONMENT.CONTENT){b.Urls.Collection.getInstance().reset(SC.ENVIRONMENT.CONTENT);delete SC.ENVIRONMENT.CONTENT;if(SC.ENVIRONMENT.DEFAULT_PAGE){b.Pages.Collection.getInstance().reset(SC.ENVIRONMENT.DEFAULT_PAGE);delete SC.ENVIRONMENT.DEFAULT_PAGE;}}if(SC.ENVIRONMENT.MERCHANDISING){var c=_.map(SC.ENVIRONMENT.MERCHANDISING,function(f,e){f.internalid=e;return f;});d.Collection.getInstance().reset(c);delete SC.ENVIRONMENT.MERCHANDISING;}jQuery(a.start(function(){var e=a.getUser();if(SC.ENVIRONMENT.PROFILE){e.set(SC.ENVIRONMENT.PROFILE);if(e.get("isperson")&&a.getConfig("siteSettings.registration.companyfieldmandatory")!=="T"){delete e.validation.companyname;}if(!e.get("isperson")){delete e.validation.firstname;}if(!e.get("lastname")||!e.get("isperson")){delete e.validation.lastname;}if(!e.get("phone")){delete e.validation.phone;}delete SC.ENVIRONMENT.PROFILE;if(SC.ENVIRONMENT.LIVEPAYMENT){if(SC.ENVIRONMENT.LIVEPAYMENT.balance){e.set("balance",SC.ENVIRONMENT.LIVEPAYMENT.balance);}if(SC.ENVIRONMENT.LIVEPAYMENT.balance_formatted){e.set("balance_formatted",SC.ENVIRONMENT.LIVEPAYMENT.balance_formatted);}}}if(SC.ENVIRONMENT.ADDRESS){e.get("addresses").reset(SC.ENVIRONMENT.ADDRESS);delete SC.ENVIRONMENT.ADDRESS;}else{e.get("addresses").reset([]);}if(SC.ENVIRONMENT.CREDITCARD){e.get("creditcards").reset(SC.ENVIRONMENT.CREDITCARD);delete SC.ENVIRONMENT.CREDITCARD;}else{e.get("creditcards").reset([]);}if(SC.ENVIRONMENT.CASES){a.Configuration.cases={enabled:SC.ENVIRONMENT.CASES.enabled,config:SC.ENVIRONMENT.CASES.CONFIG};}if(SC.ENVIRONMENT.contextError){a.getLayout().$("#site-header").hide();a.getLayout().$("#site-footer").hide();a.getLayout().internalError(SC.ENVIRONMENT.contextError.errorMessage,"Error "+SC.ENVIRONMENT.contextError.errorStatusCode+": "+SC.ENVIRONMENT.contextError.errorCode);}else{var f=_.parseUrlOptions(location.search).fragment;if(f&&!location.hash){location.hash=decodeURIComponent(f);}Backbone.history.start();}a.getLayout().appendToDom();}));});});